function EO(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var CO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var x1={exports:{}},Hh={},A1={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pl=Symbol.for("react.element"),IO=Symbol.for("react.portal"),PO=Symbol.for("react.fragment"),RO=Symbol.for("react.strict_mode"),xO=Symbol.for("react.profiler"),AO=Symbol.for("react.provider"),NO=Symbol.for("react.context"),OO=Symbol.for("react.forward_ref"),DO=Symbol.for("react.suspense"),LO=Symbol.for("react.memo"),MO=Symbol.for("react.lazy"),NT=Symbol.iterator;function UO(t){return t===null||typeof t!="object"?null:(t=NT&&t[NT]||t["@@iterator"],typeof t=="function"?t:null)}var N1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O1=Object.assign,D1={};function wa(t,e,n){this.props=t,this.context=e,this.refs=D1,this.updater=n||N1}wa.prototype.isReactComponent={};wa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function L1(){}L1.prototype=wa.prototype;function vy(t,e,n){this.props=t,this.context=e,this.refs=D1,this.updater=n||N1}var yy=vy.prototype=new L1;yy.constructor=vy;O1(yy,wa.prototype);yy.isPureReactComponent=!0;var OT=Array.isArray,M1=Object.prototype.hasOwnProperty,by={current:null},U1={key:!0,ref:!0,__self:!0,__source:!0};function F1(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)M1.call(e,i)&&!U1.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];r.children=c}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Pl,type:t,key:s,ref:o,props:r,_owner:by.current}}function FO(t,e){return{$$typeof:Pl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ty(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pl}function VO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var DT=/\/+/g;function Ip(t,e){return typeof t=="object"&&t!==null&&t.key!=null?VO(""+t.key):e.toString(36)}function Qu(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Pl:case IO:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+Ip(o,0):i,OT(r)?(n="",t!=null&&(n=t.replace(DT,"$&/")+"/"),Qu(r,e,n,"",function(l){return l})):r!=null&&(Ty(r)&&(r=FO(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(DT,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",OT(t))for(var a=0;a<t.length;a++){s=t[a];var c=i+Ip(s,a);o+=Qu(s,e,n,c,r)}else if(c=UO(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=i+Ip(s,a++),o+=Qu(s,e,n,c,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function gu(t,e,n){if(t==null)return t;var i=[],r=0;return Qu(t,i,"","",function(s){return e.call(n,s,r++)}),i}function jO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Yt={current:null},Ju={transition:null},$O={ReactCurrentDispatcher:Yt,ReactCurrentBatchConfig:Ju,ReactCurrentOwner:by};function V1(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:gu,forEach:function(t,e,n){gu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gu(t,function(){e++}),e},toArray:function(t){return gu(t,function(e){return e})||[]},only:function(t){if(!Ty(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=wa;he.Fragment=PO;he.Profiler=xO;he.PureComponent=vy;he.StrictMode=RO;he.Suspense=DO;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$O;he.act=V1;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=O1({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=by.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)M1.call(e,c)&&!U1.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];i.children=a}return{$$typeof:Pl,type:t.type,key:r,ref:s,props:i,_owner:o}};he.createContext=function(t){return t={$$typeof:NO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:AO,_context:t},t.Consumer=t};he.createElement=F1;he.createFactory=function(t){var e=F1.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:OO,render:t}};he.isValidElement=Ty;he.lazy=function(t){return{$$typeof:MO,_payload:{_status:-1,_result:t},_init:jO}};he.memo=function(t,e){return{$$typeof:LO,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=Ju.transition;Ju.transition={};try{t()}finally{Ju.transition=e}};he.unstable_act=V1;he.useCallback=function(t,e){return Yt.current.useCallback(t,e)};he.useContext=function(t){return Yt.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return Yt.current.useDeferredValue(t)};he.useEffect=function(t,e){return Yt.current.useEffect(t,e)};he.useId=function(){return Yt.current.useId()};he.useImperativeHandle=function(t,e,n){return Yt.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return Yt.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return Yt.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return Yt.current.useMemo(t,e)};he.useReducer=function(t,e,n){return Yt.current.useReducer(t,e,n)};he.useRef=function(t){return Yt.current.useRef(t)};he.useState=function(t){return Yt.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return Yt.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return Yt.current.useTransition()};he.version="18.3.1";A1.exports=he;var m=A1.exports;const Le=gy(m),BO=EO({__proto__:null,default:Le},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zO=m,qO=Symbol.for("react.element"),HO=Symbol.for("react.fragment"),WO=Object.prototype.hasOwnProperty,KO=zO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GO={key:!0,ref:!0,__self:!0,__source:!0};function j1(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)WO.call(e,i)&&!GO.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:qO,type:t,key:s,ref:o,props:r,_owner:KO.current}}Hh.Fragment=HO;Hh.jsx=j1;Hh.jsxs=j1;x1.exports=Hh;var I=x1.exports,$1={exports:{}},Cn={},B1={exports:{}},z1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,ee){var ne=W.length;W.push(ee);e:for(;0<ne;){var Pe=ne-1>>>1,ve=W[Pe];if(0<r(ve,ee))W[Pe]=ee,W[ne]=ve,ne=Pe;else break e}}function n(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var ee=W[0],ne=W.pop();if(ne!==ee){W[0]=ne;e:for(var Pe=0,ve=W.length,He=ve>>>1;Pe<He;){var Ee=2*(Pe+1)-1,mn=W[Ee],Ni=Ee+1,Oi=W[Ni];if(0>r(mn,ne))Ni<ve&&0>r(Oi,mn)?(W[Pe]=Oi,W[Ni]=ne,Pe=Ni):(W[Pe]=mn,W[Ee]=ne,Pe=Ee);else if(Ni<ve&&0>r(Oi,ne))W[Pe]=Oi,W[Ni]=ne,Pe=Ni;else break e}}return ee}function r(W,ee){var ne=W.sortIndex-ee.sortIndex;return ne!==0?ne:W.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,h=null,f=3,g=!1,b=!1,y=!1,T=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var ee=n(l);ee!==null;){if(ee.callback===null)i(l);else if(ee.startTime<=W)i(l),ee.sortIndex=ee.expirationTime,e(c,ee);else break;ee=n(l)}}function P(W){if(y=!1,S(W),!b)if(n(c)!==null)b=!0,$e(R);else{var ee=n(l);ee!==null&&fe(P,ee.startTime-W)}}function R(W,ee){b=!1,y&&(y=!1,v(_),_=-1),g=!0;var ne=f;try{for(S(ee),h=n(c);h!==null&&(!(h.expirationTime>ee)||W&&!A());){var Pe=h.callback;if(typeof Pe=="function"){h.callback=null,f=h.priorityLevel;var ve=Pe(h.expirationTime<=ee);ee=t.unstable_now(),typeof ve=="function"?h.callback=ve:h===n(c)&&i(c),S(ee)}else i(c);h=n(c)}if(h!==null)var He=!0;else{var Ee=n(l);Ee!==null&&fe(P,Ee.startTime-ee),He=!1}return He}finally{h=null,f=ne,g=!1}}var O=!1,E=null,_=-1,C=5,x=-1;function A(){return!(t.unstable_now()-x<C)}function L(){if(E!==null){var W=t.unstable_now();x=W;var ee=!0;try{ee=E(!0,W)}finally{ee?D():(O=!1,E=null)}}else O=!1}var D;if(typeof w=="function")D=function(){w(L)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ge=le.port2;le.port1.onmessage=L,D=function(){ge.postMessage(null)}}else D=function(){T(L,0)};function $e(W){E=W,O||(O=!0,D())}function fe(W,ee){_=T(function(){W(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){b||g||(b=!0,$e(R))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(W){switch(f){case 1:case 2:case 3:var ee=3;break;default:ee=f}var ne=f;f=ee;try{return W()}finally{f=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,ee){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ne=f;f=W;try{return ee()}finally{f=ne}},t.unstable_scheduleCallback=function(W,ee,ne){var Pe=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Pe+ne:Pe):ne=Pe,W){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=ne+ve,W={id:u++,callback:ee,priorityLevel:W,startTime:ne,expirationTime:ve,sortIndex:-1},ne>Pe?(W.sortIndex=ne,e(l,W),n(c)===null&&W===n(l)&&(y?(v(_),_=-1):y=!0,fe(P,ne-Pe))):(W.sortIndex=ve,e(c,W),b||g||(b=!0,$e(R))),W},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(W){var ee=f;return function(){var ne=f;f=ee;try{return W.apply(this,arguments)}finally{f=ne}}}})(z1);B1.exports=z1;var QO=B1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JO=m,Sn=QO;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var q1=new Set,qc={};function Zs(t,e){ia(t,e),ia(t+"Capture",e)}function ia(t,e){for(qc[t]=e,t=0;t<e.length;t++)q1.add(e[t])}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hm=Object.prototype.hasOwnProperty,YO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,LT={},MT={};function XO(t){return Hm.call(MT,t)?!0:Hm.call(LT,t)?!1:YO.test(t)?MT[t]=!0:(LT[t]=!0,!1)}function ZO(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function eD(t,e,n,i){if(e===null||typeof e>"u"||ZO(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xt(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var It={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){It[t]=new Xt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];It[e]=new Xt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){It[t]=new Xt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){It[t]=new Xt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){It[t]=new Xt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){It[t]=new Xt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){It[t]=new Xt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){It[t]=new Xt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){It[t]=new Xt(t,5,!1,t.toLowerCase(),null,!1,!1)});var ky=/[\-:]([a-z])/g;function wy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ky,wy);It[e]=new Xt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ky,wy);It[e]=new Xt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ky,wy);It[e]=new Xt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){It[t]=new Xt(t,1,!1,t.toLowerCase(),null,!1,!1)});It.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){It[t]=new Xt(t,1,!1,t.toLowerCase(),null,!0,!0)});function _y(t,e,n,i){var r=It.hasOwnProperty(e)?It[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(eD(e,n,r,i)&&(n=null),i||r===null?XO(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var sr=JO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vu=Symbol.for("react.element"),wo=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),Sy=Symbol.for("react.strict_mode"),Wm=Symbol.for("react.profiler"),H1=Symbol.for("react.provider"),W1=Symbol.for("react.context"),Ey=Symbol.for("react.forward_ref"),Km=Symbol.for("react.suspense"),Gm=Symbol.for("react.suspense_list"),Cy=Symbol.for("react.memo"),yr=Symbol.for("react.lazy"),K1=Symbol.for("react.offscreen"),UT=Symbol.iterator;function Ya(t){return t===null||typeof t!="object"?null:(t=UT&&t[UT]||t["@@iterator"],typeof t=="function"?t:null)}var Qe=Object.assign,Pp;function hc(t){if(Pp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Pp=e&&e[1]||""}return`
`+Pp+t}var Rp=!1;function xp(t,e){if(!t||Rp)return"";Rp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var i=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){i=l}t.call(e.prototype)}else{try{throw Error()}catch(l){i=l}t()}}catch(l){if(l&&i&&typeof l.stack=="string"){for(var r=l.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Rp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?hc(t):""}function tD(t){switch(t.tag){case 5:return hc(t.type);case 16:return hc("Lazy");case 13:return hc("Suspense");case 19:return hc("SuspenseList");case 0:case 2:case 15:return t=xp(t.type,!1),t;case 11:return t=xp(t.type.render,!1),t;case 1:return t=xp(t.type,!0),t;default:return""}}function Qm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _o:return"Fragment";case wo:return"Portal";case Wm:return"Profiler";case Sy:return"StrictMode";case Km:return"Suspense";case Gm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case W1:return(t.displayName||"Context")+".Consumer";case H1:return(t._context.displayName||"Context")+".Provider";case Ey:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Cy:return e=t.displayName||null,e!==null?e:Qm(t.type)||"Memo";case yr:e=t._payload,t=t._init;try{return Qm(t(e))}catch{}}return null}function nD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qm(e);case 8:return e===Sy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function G1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function iD(t){var e=G1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function yu(t){t._valueTracker||(t._valueTracker=iD(t))}function Q1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=G1(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Md(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Jm(t,e){var n=e.checked;return Qe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function FT(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Wr(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function J1(t,e){e=e.checked,e!=null&&_y(t,"checked",e,!1)}function Ym(t,e){J1(t,e);var n=Wr(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Xm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Xm(t,e.type,Wr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function VT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Xm(t,e,n){(e!=="number"||Md(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fc=Array.isArray;function Mo(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Wr(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Zm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return Qe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function jT(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(fc(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Wr(n)}}function Y1(t,e){var n=Wr(e.value),i=Wr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function $T(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function X1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function eg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?X1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bu,Z1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bu=bu||document.createElement("div"),bu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var kc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rD=["Webkit","ms","Moz","O"];Object.keys(kc).forEach(function(t){rD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),kc[e]=kc[t]})});function eE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||kc.hasOwnProperty(t)&&kc[t]?(""+e).trim():e+"px"}function tE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=eE(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var sD=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tg(t,e){if(e){if(sD[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function ng(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ig=null;function Iy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var rg=null,Uo=null,Fo=null;function BT(t){if(t=Al(t)){if(typeof rg!="function")throw Error(K(280));var e=t.stateNode;e&&(e=Jh(e),rg(t.stateNode,t.type,e))}}function nE(t){Uo?Fo?Fo.push(t):Fo=[t]:Uo=t}function iE(){if(Uo){var t=Uo,e=Fo;if(Fo=Uo=null,BT(t),e)for(t=0;t<e.length;t++)BT(e[t])}}function rE(t,e){return t(e)}function sE(){}var Ap=!1;function oE(t,e,n){if(Ap)return t(e,n);Ap=!0;try{return rE(t,e,n)}finally{Ap=!1,(Uo!==null||Fo!==null)&&(sE(),iE())}}function Wc(t,e){var n=t.stateNode;if(n===null)return null;var i=Jh(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var sg=!1;if(Gi)try{var Xa={};Object.defineProperty(Xa,"passive",{get:function(){sg=!0}}),window.addEventListener("test",Xa,Xa),window.removeEventListener("test",Xa,Xa)}catch{sg=!1}function oD(t,e,n,i,r,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var wc=!1,Ud=null,Fd=!1,og=null,aD={onError:function(t){wc=!0,Ud=t}};function cD(t,e,n,i,r,s,o,a,c){wc=!1,Ud=null,oD.apply(aD,arguments)}function lD(t,e,n,i,r,s,o,a,c){if(cD.apply(this,arguments),wc){if(wc){var l=Ud;wc=!1,Ud=null}else throw Error(K(198));Fd||(Fd=!0,og=l)}}function eo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function aE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zT(t){if(eo(t)!==t)throw Error(K(188))}function uD(t){var e=t.alternate;if(!e){if(e=eo(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return zT(r),t;if(s===i)return zT(r),e;s=s.sibling}throw Error(K(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==i)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function cE(t){return t=uD(t),t!==null?lE(t):null}function lE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lE(t);if(e!==null)return e;t=t.sibling}return null}var uE=Sn.unstable_scheduleCallback,qT=Sn.unstable_cancelCallback,dD=Sn.unstable_shouldYield,hD=Sn.unstable_requestPaint,it=Sn.unstable_now,fD=Sn.unstable_getCurrentPriorityLevel,Py=Sn.unstable_ImmediatePriority,dE=Sn.unstable_UserBlockingPriority,Vd=Sn.unstable_NormalPriority,pD=Sn.unstable_LowPriority,hE=Sn.unstable_IdlePriority,Wh=null,bi=null;function mD(t){if(bi&&typeof bi.onCommitFiberRoot=="function")try{bi.onCommitFiberRoot(Wh,t,void 0,(t.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:yD,gD=Math.log,vD=Math.LN2;function yD(t){return t>>>=0,t===0?32:31-(gD(t)/vD|0)|0}var Tu=64,ku=4194304;function pc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jd(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=pc(a):(s&=o,s!==0&&(i=pc(s)))}else o=n&~r,o!==0?i=pc(o):s!==0&&(i=pc(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Qn(e),r=1<<n,i|=t[n],e&=~r;return i}function bD(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TD(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Qn(s),a=1<<o,c=r[o];c===-1?(!(a&n)||a&i)&&(r[o]=bD(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function ag(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fE(){var t=Tu;return Tu<<=1,!(Tu&4194240)&&(Tu=64),t}function Np(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Rl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Qn(e),t[e]=n}function kD(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Qn(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function Ry(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Qn(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Ie=0;function pE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var mE,xy,gE,vE,yE,cg=!1,wu=[],Or=null,Dr=null,Lr=null,Kc=new Map,Gc=new Map,kr=[],wD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function HT(t,e){switch(t){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":Lr=null;break;case"pointerover":case"pointerout":Kc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(e.pointerId)}}function Za(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Al(e),e!==null&&xy(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function _D(t,e,n,i,r){switch(e){case"focusin":return Or=Za(Or,t,e,n,i,r),!0;case"dragenter":return Dr=Za(Dr,t,e,n,i,r),!0;case"mouseover":return Lr=Za(Lr,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Kc.set(s,Za(Kc.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Gc.set(s,Za(Gc.get(s)||null,t,e,n,i,r)),!0}return!1}function bE(t){var e=ys(t.target);if(e!==null){var n=eo(e);if(n!==null){if(e=n.tag,e===13){if(e=aE(n),e!==null){t.blockedOn=e,yE(t.priority,function(){gE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=lg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);ig=i,n.target.dispatchEvent(i),ig=null}else return e=Al(n),e!==null&&xy(e),t.blockedOn=n,!1;e.shift()}return!0}function WT(t,e,n){Yu(t)&&n.delete(e)}function SD(){cg=!1,Or!==null&&Yu(Or)&&(Or=null),Dr!==null&&Yu(Dr)&&(Dr=null),Lr!==null&&Yu(Lr)&&(Lr=null),Kc.forEach(WT),Gc.forEach(WT)}function ec(t,e){t.blockedOn===e&&(t.blockedOn=null,cg||(cg=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,SD)))}function Qc(t){function e(r){return ec(r,t)}if(0<wu.length){ec(wu[0],t);for(var n=1;n<wu.length;n++){var i=wu[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Or!==null&&ec(Or,t),Dr!==null&&ec(Dr,t),Lr!==null&&ec(Lr,t),Kc.forEach(e),Gc.forEach(e),n=0;n<kr.length;n++)i=kr[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<kr.length&&(n=kr[0],n.blockedOn===null);)bE(n),n.blockedOn===null&&kr.shift()}var Vo=sr.ReactCurrentBatchConfig,$d=!0;function ED(t,e,n,i){var r=Ie,s=Vo.transition;Vo.transition=null;try{Ie=1,Ay(t,e,n,i)}finally{Ie=r,Vo.transition=s}}function CD(t,e,n,i){var r=Ie,s=Vo.transition;Vo.transition=null;try{Ie=4,Ay(t,e,n,i)}finally{Ie=r,Vo.transition=s}}function Ay(t,e,n,i){if($d){var r=lg(t,e,n,i);if(r===null)Bp(t,e,i,Bd,n),HT(t,i);else if(_D(r,t,e,n,i))i.stopPropagation();else if(HT(t,i),e&4&&-1<wD.indexOf(t)){for(;r!==null;){var s=Al(r);if(s!==null&&mE(s),s=lg(t,e,n,i),s===null&&Bp(t,e,i,Bd,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Bp(t,e,i,null,n)}}var Bd=null;function lg(t,e,n,i){if(Bd=null,t=Iy(i),t=ys(t),t!==null)if(e=eo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=aE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Bd=t,null}function TE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fD()){case Py:return 1;case dE:return 4;case Vd:case pD:return 16;case hE:return 536870912;default:return 16}default:return 16}}var Ir=null,Ny=null,Xu=null;function kE(){if(Xu)return Xu;var t,e=Ny,n=e.length,i,r="value"in Ir?Ir.value:Ir.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return Xu=r.slice(t,1<i?1-i:void 0)}function Zu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _u(){return!0}function KT(){return!1}function In(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?_u:KT,this.isPropagationStopped=KT,this}return Qe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_u)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_u)},persist:function(){},isPersistent:_u}),e}var _a={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oy=In(_a),xl=Qe({},_a,{view:0,detail:0}),ID=In(xl),Op,Dp,tc,Kh=Qe({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==tc&&(tc&&t.type==="mousemove"?(Op=t.screenX-tc.screenX,Dp=t.screenY-tc.screenY):Dp=Op=0,tc=t),Op)},movementY:function(t){return"movementY"in t?t.movementY:Dp}}),GT=In(Kh),PD=Qe({},Kh,{dataTransfer:0}),RD=In(PD),xD=Qe({},xl,{relatedTarget:0}),Lp=In(xD),AD=Qe({},_a,{animationName:0,elapsedTime:0,pseudoElement:0}),ND=In(AD),OD=Qe({},_a,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),DD=In(OD),LD=Qe({},_a,{data:0}),QT=In(LD),MD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},FD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=FD[t])?!!e[t]:!1}function Dy(){return VD}var jD=Qe({},xl,{key:function(t){if(t.key){var e=MD[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Zu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?UD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dy,charCode:function(t){return t.type==="keypress"?Zu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$D=In(jD),BD=Qe({},Kh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),JT=In(BD),zD=Qe({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dy}),qD=In(zD),HD=Qe({},_a,{propertyName:0,elapsedTime:0,pseudoElement:0}),WD=In(HD),KD=Qe({},Kh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GD=In(KD),QD=[9,13,27,32],Ly=Gi&&"CompositionEvent"in window,_c=null;Gi&&"documentMode"in document&&(_c=document.documentMode);var JD=Gi&&"TextEvent"in window&&!_c,wE=Gi&&(!Ly||_c&&8<_c&&11>=_c),YT=" ",XT=!1;function _E(t,e){switch(t){case"keyup":return QD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var So=!1;function YD(t,e){switch(t){case"compositionend":return SE(e);case"keypress":return e.which!==32?null:(XT=!0,YT);case"textInput":return t=e.data,t===YT&&XT?null:t;default:return null}}function XD(t,e){if(So)return t==="compositionend"||!Ly&&_E(t,e)?(t=kE(),Xu=Ny=Ir=null,So=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wE&&e.locale!=="ko"?null:e.data;default:return null}}var ZD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ZD[t.type]:e==="textarea"}function EE(t,e,n,i){nE(i),e=zd(e,"onChange"),0<e.length&&(n=new Oy("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Sc=null,Jc=null;function e2(t){ME(t,0)}function Gh(t){var e=Io(t);if(Q1(e))return t}function t2(t,e){if(t==="change")return e}var CE=!1;if(Gi){var Mp;if(Gi){var Up="oninput"in document;if(!Up){var ek=document.createElement("div");ek.setAttribute("oninput","return;"),Up=typeof ek.oninput=="function"}Mp=Up}else Mp=!1;CE=Mp&&(!document.documentMode||9<document.documentMode)}function tk(){Sc&&(Sc.detachEvent("onpropertychange",IE),Jc=Sc=null)}function IE(t){if(t.propertyName==="value"&&Gh(Jc)){var e=[];EE(e,Jc,t,Iy(t)),oE(e2,e)}}function n2(t,e,n){t==="focusin"?(tk(),Sc=e,Jc=n,Sc.attachEvent("onpropertychange",IE)):t==="focusout"&&tk()}function i2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gh(Jc)}function r2(t,e){if(t==="click")return Gh(e)}function s2(t,e){if(t==="input"||t==="change")return Gh(e)}function o2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zn=typeof Object.is=="function"?Object.is:o2;function Yc(t,e){if(Zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Hm.call(e,r)||!Zn(t[r],e[r]))return!1}return!0}function nk(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ik(t,e){var n=nk(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nk(n)}}function PE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?PE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function RE(){for(var t=window,e=Md();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Md(t.document)}return e}function My(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function a2(t){var e=RE(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&PE(n.ownerDocument.documentElement,n)){if(i!==null&&My(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=ik(n,s);var o=ik(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var c2=Gi&&"documentMode"in document&&11>=document.documentMode,Eo=null,ug=null,Ec=null,dg=!1;function rk(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;dg||Eo==null||Eo!==Md(i)||(i=Eo,"selectionStart"in i&&My(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ec&&Yc(Ec,i)||(Ec=i,i=zd(ug,"onSelect"),0<i.length&&(e=new Oy("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Eo)))}function Su(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Co={animationend:Su("Animation","AnimationEnd"),animationiteration:Su("Animation","AnimationIteration"),animationstart:Su("Animation","AnimationStart"),transitionend:Su("Transition","TransitionEnd")},Fp={},xE={};Gi&&(xE=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);function Qh(t){if(Fp[t])return Fp[t];if(!Co[t])return t;var e=Co[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in xE)return Fp[t]=e[n];return t}var AE=Qh("animationend"),NE=Qh("animationiteration"),OE=Qh("animationstart"),DE=Qh("transitionend"),LE=new Map,sk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(t,e){LE.set(t,e),Zs(e,[t])}for(var Vp=0;Vp<sk.length;Vp++){var jp=sk[Vp],l2=jp.toLowerCase(),u2=jp[0].toUpperCase()+jp.slice(1);rs(l2,"on"+u2)}rs(AE,"onAnimationEnd");rs(NE,"onAnimationIteration");rs(OE,"onAnimationStart");rs("dblclick","onDoubleClick");rs("focusin","onFocus");rs("focusout","onBlur");rs(DE,"onTransitionEnd");ia("onMouseEnter",["mouseout","mouseover"]);ia("onMouseLeave",["mouseout","mouseover"]);ia("onPointerEnter",["pointerout","pointerover"]);ia("onPointerLeave",["pointerout","pointerover"]);Zs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),d2=new Set("cancel close invalid load scroll toggle".split(" ").concat(mc));function ok(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,lD(i,e,void 0,t),t.currentTarget=null}function ME(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break e;ok(r,a,l),s=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break e;ok(r,a,l),s=c}}}if(Fd)throw t=og,Fd=!1,og=null,t}function Fe(t,e){var n=e[gg];n===void 0&&(n=e[gg]=new Set);var i=t+"__bubble";n.has(i)||(UE(e,t,2,!1),n.add(i))}function $p(t,e,n){var i=0;e&&(i|=4),UE(n,t,i,e)}var Eu="_reactListening"+Math.random().toString(36).slice(2);function Xc(t){if(!t[Eu]){t[Eu]=!0,q1.forEach(function(n){n!=="selectionchange"&&(d2.has(n)||$p(n,!1,t),$p(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Eu]||(e[Eu]=!0,$p("selectionchange",!1,e))}}function UE(t,e,n,i){switch(TE(e)){case 1:var r=ED;break;case 4:r=CD;break;default:r=Ay}n=r.bind(null,e,n,t),r=void 0,!sg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Bp(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=ys(a),o===null)return;if(c=o.tag,c===5||c===6){i=s=o;continue e}a=a.parentNode}}i=i.return}oE(function(){var l=s,u=Iy(n),h=[];e:{var f=LE.get(t);if(f!==void 0){var g=Oy,b=t;switch(t){case"keypress":if(Zu(n)===0)break e;case"keydown":case"keyup":g=$D;break;case"focusin":b="focus",g=Lp;break;case"focusout":b="blur",g=Lp;break;case"beforeblur":case"afterblur":g=Lp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=GT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=RD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=qD;break;case AE:case NE:case OE:g=ND;break;case DE:g=WD;break;case"scroll":g=ID;break;case"wheel":g=GD;break;case"copy":case"cut":case"paste":g=DD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=JT}var y=(e&4)!==0,T=!y&&t==="scroll",v=y?f!==null?f+"Capture":null:f;y=[];for(var w=l,S;w!==null;){S=w;var P=S.stateNode;if(S.tag===5&&P!==null&&(S=P,v!==null&&(P=Wc(w,v),P!=null&&y.push(Zc(w,P,S)))),T)break;w=w.return}0<y.length&&(f=new g(f,b,null,n,u),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==ig&&(b=n.relatedTarget||n.fromElement)&&(ys(b)||b[Qi]))break e;if((g||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=l,b=b?ys(b):null,b!==null&&(T=eo(b),b!==T||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=l),g!==b)){if(y=GT,P="onMouseLeave",v="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(y=JT,P="onPointerLeave",v="onPointerEnter",w="pointer"),T=g==null?f:Io(g),S=b==null?f:Io(b),f=new y(P,w+"leave",g,n,u),f.target=T,f.relatedTarget=S,P=null,ys(u)===l&&(y=new y(v,w+"enter",b,n,u),y.target=S,y.relatedTarget=T,P=y),T=P,g&&b)t:{for(y=g,v=b,w=0,S=y;S;S=lo(S))w++;for(S=0,P=v;P;P=lo(P))S++;for(;0<w-S;)y=lo(y),w--;for(;0<S-w;)v=lo(v),S--;for(;w--;){if(y===v||v!==null&&y===v.alternate)break t;y=lo(y),v=lo(v)}y=null}else y=null;g!==null&&ak(h,f,g,y,!1),b!==null&&T!==null&&ak(h,T,b,y,!0)}}e:{if(f=l?Io(l):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var R=t2;else if(ZT(f))if(CE)R=s2;else{R=i2;var O=n2}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(R=r2);if(R&&(R=R(t,l))){EE(h,R,n,u);break e}O&&O(t,f,l),t==="focusout"&&(O=f._wrapperState)&&O.controlled&&f.type==="number"&&Xm(f,"number",f.value)}switch(O=l?Io(l):window,t){case"focusin":(ZT(O)||O.contentEditable==="true")&&(Eo=O,ug=l,Ec=null);break;case"focusout":Ec=ug=Eo=null;break;case"mousedown":dg=!0;break;case"contextmenu":case"mouseup":case"dragend":dg=!1,rk(h,n,u);break;case"selectionchange":if(c2)break;case"keydown":case"keyup":rk(h,n,u)}var E;if(Ly)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else So?_E(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(wE&&n.locale!=="ko"&&(So||_!=="onCompositionStart"?_==="onCompositionEnd"&&So&&(E=kE()):(Ir=u,Ny="value"in Ir?Ir.value:Ir.textContent,So=!0)),O=zd(l,_),0<O.length&&(_=new QT(_,t,null,n,u),h.push({event:_,listeners:O}),E?_.data=E:(E=SE(n),E!==null&&(_.data=E)))),(E=JD?YD(t,n):XD(t,n))&&(l=zd(l,"onBeforeInput"),0<l.length&&(u=new QT("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:l}),u.data=E))}ME(h,e)})}function Zc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function zd(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Wc(t,n),s!=null&&i.unshift(Zc(t,s,r)),s=Wc(t,e),s!=null&&i.push(Zc(t,s,r))),t=t.return}return i}function lo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ak(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&l!==null&&(a=l,r?(c=Wc(n,s),c!=null&&o.unshift(Zc(n,c,a))):r||(c=Wc(n,s),c!=null&&o.push(Zc(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var h2=/\r\n?/g,f2=/\u0000|\uFFFD/g;function ck(t){return(typeof t=="string"?t:""+t).replace(h2,`
`).replace(f2,"")}function Cu(t,e,n){if(e=ck(e),ck(t)!==e&&n)throw Error(K(425))}function qd(){}var hg=null,fg=null;function pg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var mg=typeof setTimeout=="function"?setTimeout:void 0,p2=typeof clearTimeout=="function"?clearTimeout:void 0,lk=typeof Promise=="function"?Promise:void 0,m2=typeof queueMicrotask=="function"?queueMicrotask:typeof lk<"u"?function(t){return lk.resolve(null).then(t).catch(g2)}:mg;function g2(t){setTimeout(function(){throw t})}function zp(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),Qc(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Qc(e)}function Mr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function uk(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),gi="__reactFiber$"+Sa,el="__reactProps$"+Sa,Qi="__reactContainer$"+Sa,gg="__reactEvents$"+Sa,v2="__reactListeners$"+Sa,y2="__reactHandles$"+Sa;function ys(t){var e=t[gi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qi]||n[gi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=uk(t);t!==null;){if(n=t[gi])return n;t=uk(t)}return e}t=n,n=t.parentNode}return null}function Al(t){return t=t[gi]||t[Qi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Io(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function Jh(t){return t[el]||null}var vg=[],Po=-1;function ss(t){return{current:t}}function je(t){0>Po||(t.current=vg[Po],vg[Po]=null,Po--)}function De(t,e){Po++,vg[Po]=t.current,t.current=e}var Kr={},Bt=ss(Kr),on=ss(!1),Vs=Kr;function ra(t,e){var n=t.type.contextTypes;if(!n)return Kr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function an(t){return t=t.childContextTypes,t!=null}function Hd(){je(on),je(Bt)}function dk(t,e,n){if(Bt.current!==Kr)throw Error(K(168));De(Bt,e),De(on,n)}function FE(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(K(108,nD(t)||"Unknown",r));return Qe({},n,i)}function Wd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Kr,Vs=Bt.current,De(Bt,t),De(on,on.current),!0}function hk(t,e,n){var i=t.stateNode;if(!i)throw Error(K(169));n?(t=FE(t,e,Vs),i.__reactInternalMemoizedMergedChildContext=t,je(on),je(Bt),De(Bt,t)):je(on),De(on,n)}var Ui=null,Yh=!1,qp=!1;function VE(t){Ui===null?Ui=[t]:Ui.push(t)}function b2(t){Yh=!0,VE(t)}function os(){if(!qp&&Ui!==null){qp=!0;var t=0,e=Ie;try{var n=Ui;for(Ie=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ui=null,Yh=!1}catch(r){throw Ui!==null&&(Ui=Ui.slice(t+1)),uE(Py,os),r}finally{Ie=e,qp=!1}}return null}var Ro=[],xo=0,Kd=null,Gd=0,Pn=[],Rn=0,js=null,$i=1,Bi="";function ms(t,e){Ro[xo++]=Gd,Ro[xo++]=Kd,Kd=t,Gd=e}function jE(t,e,n){Pn[Rn++]=$i,Pn[Rn++]=Bi,Pn[Rn++]=js,js=t;var i=$i;t=Bi;var r=32-Qn(i)-1;i&=~(1<<r),n+=1;var s=32-Qn(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,$i=1<<32-Qn(e)+r|n<<r|i,Bi=s+t}else $i=1<<s|n<<r|i,Bi=t}function Uy(t){t.return!==null&&(ms(t,1),jE(t,1,0))}function Fy(t){for(;t===Kd;)Kd=Ro[--xo],Ro[xo]=null,Gd=Ro[--xo],Ro[xo]=null;for(;t===js;)js=Pn[--Rn],Pn[Rn]=null,Bi=Pn[--Rn],Pn[Rn]=null,$i=Pn[--Rn],Pn[Rn]=null}var Tn=null,bn=null,ze=!1,Hn=null;function $E(t,e){var n=An(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fk(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Tn=t,bn=Mr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Tn=t,bn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=js!==null?{id:$i,overflow:Bi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=An(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Tn=t,bn=null,!0):!1;default:return!1}}function yg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function bg(t){if(ze){var e=bn;if(e){var n=e;if(!fk(t,e)){if(yg(t))throw Error(K(418));e=Mr(n.nextSibling);var i=Tn;e&&fk(t,e)?$E(i,n):(t.flags=t.flags&-4097|2,ze=!1,Tn=t)}}else{if(yg(t))throw Error(K(418));t.flags=t.flags&-4097|2,ze=!1,Tn=t}}}function pk(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Tn=t}function Iu(t){if(t!==Tn)return!1;if(!ze)return pk(t),ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!pg(t.type,t.memoizedProps)),e&&(e=bn)){if(yg(t))throw BE(),Error(K(418));for(;e;)$E(t,e),e=Mr(e.nextSibling)}if(pk(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){bn=Mr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}bn=null}}else bn=Tn?Mr(t.stateNode.nextSibling):null;return!0}function BE(){for(var t=bn;t;)t=Mr(t.nextSibling)}function sa(){bn=Tn=null,ze=!1}function Vy(t){Hn===null?Hn=[t]:Hn.push(t)}var T2=sr.ReactCurrentBatchConfig;function nc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var i=n.stateNode}if(!i)throw Error(K(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function Pu(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function mk(t){var e=t._init;return e(t._payload)}function zE(t){function e(v,w){if(t){var S=v.deletions;S===null?(v.deletions=[w],v.flags|=16):S.push(w)}}function n(v,w){if(!t)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function i(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function r(v,w){return v=jr(v,w),v.index=0,v.sibling=null,v}function s(v,w,S){return v.index=S,t?(S=v.alternate,S!==null?(S=S.index,S<w?(v.flags|=2,w):S):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,w,S,P){return w===null||w.tag!==6?(w=Yp(S,v.mode,P),w.return=v,w):(w=r(w,S),w.return=v,w)}function c(v,w,S,P){var R=S.type;return R===_o?u(v,w,S.props.children,P,S.key):w!==null&&(w.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===yr&&mk(R)===w.type)?(P=r(w,S.props),P.ref=nc(v,w,S),P.return=v,P):(P=od(S.type,S.key,S.props,null,v.mode,P),P.ref=nc(v,w,S),P.return=v,P)}function l(v,w,S,P){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=Xp(S,v.mode,P),w.return=v,w):(w=r(w,S.children||[]),w.return=v,w)}function u(v,w,S,P,R){return w===null||w.tag!==7?(w=Is(S,v.mode,P,R),w.return=v,w):(w=r(w,S),w.return=v,w)}function h(v,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Yp(""+w,v.mode,S),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case vu:return S=od(w.type,w.key,w.props,null,v.mode,S),S.ref=nc(v,null,w),S.return=v,S;case wo:return w=Xp(w,v.mode,S),w.return=v,w;case yr:var P=w._init;return h(v,P(w._payload),S)}if(fc(w)||Ya(w))return w=Is(w,v.mode,S,null),w.return=v,w;Pu(v,w)}return null}function f(v,w,S,P){var R=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return R!==null?null:a(v,w,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case vu:return S.key===R?c(v,w,S,P):null;case wo:return S.key===R?l(v,w,S,P):null;case yr:return R=S._init,f(v,w,R(S._payload),P)}if(fc(S)||Ya(S))return R!==null?null:u(v,w,S,P,null);Pu(v,S)}return null}function g(v,w,S,P,R){if(typeof P=="string"&&P!==""||typeof P=="number")return v=v.get(S)||null,a(w,v,""+P,R);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case vu:return v=v.get(P.key===null?S:P.key)||null,c(w,v,P,R);case wo:return v=v.get(P.key===null?S:P.key)||null,l(w,v,P,R);case yr:var O=P._init;return g(v,w,S,O(P._payload),R)}if(fc(P)||Ya(P))return v=v.get(S)||null,u(w,v,P,R,null);Pu(w,P)}return null}function b(v,w,S,P){for(var R=null,O=null,E=w,_=w=0,C=null;E!==null&&_<S.length;_++){E.index>_?(C=E,E=null):C=E.sibling;var x=f(v,E,S[_],P);if(x===null){E===null&&(E=C);break}t&&E&&x.alternate===null&&e(v,E),w=s(x,w,_),O===null?R=x:O.sibling=x,O=x,E=C}if(_===S.length)return n(v,E),ze&&ms(v,_),R;if(E===null){for(;_<S.length;_++)E=h(v,S[_],P),E!==null&&(w=s(E,w,_),O===null?R=E:O.sibling=E,O=E);return ze&&ms(v,_),R}for(E=i(v,E);_<S.length;_++)C=g(E,v,_,S[_],P),C!==null&&(t&&C.alternate!==null&&E.delete(C.key===null?_:C.key),w=s(C,w,_),O===null?R=C:O.sibling=C,O=C);return t&&E.forEach(function(A){return e(v,A)}),ze&&ms(v,_),R}function y(v,w,S,P){var R=Ya(S);if(typeof R!="function")throw Error(K(150));if(S=R.call(S),S==null)throw Error(K(151));for(var O=R=null,E=w,_=w=0,C=null,x=S.next();E!==null&&!x.done;_++,x=S.next()){E.index>_?(C=E,E=null):C=E.sibling;var A=f(v,E,x.value,P);if(A===null){E===null&&(E=C);break}t&&E&&A.alternate===null&&e(v,E),w=s(A,w,_),O===null?R=A:O.sibling=A,O=A,E=C}if(x.done)return n(v,E),ze&&ms(v,_),R;if(E===null){for(;!x.done;_++,x=S.next())x=h(v,x.value,P),x!==null&&(w=s(x,w,_),O===null?R=x:O.sibling=x,O=x);return ze&&ms(v,_),R}for(E=i(v,E);!x.done;_++,x=S.next())x=g(E,v,_,x.value,P),x!==null&&(t&&x.alternate!==null&&E.delete(x.key===null?_:x.key),w=s(x,w,_),O===null?R=x:O.sibling=x,O=x);return t&&E.forEach(function(L){return e(v,L)}),ze&&ms(v,_),R}function T(v,w,S,P){if(typeof S=="object"&&S!==null&&S.type===_o&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case vu:e:{for(var R=S.key,O=w;O!==null;){if(O.key===R){if(R=S.type,R===_o){if(O.tag===7){n(v,O.sibling),w=r(O,S.props.children),w.return=v,v=w;break e}}else if(O.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===yr&&mk(R)===O.type){n(v,O.sibling),w=r(O,S.props),w.ref=nc(v,O,S),w.return=v,v=w;break e}n(v,O);break}else e(v,O);O=O.sibling}S.type===_o?(w=Is(S.props.children,v.mode,P,S.key),w.return=v,v=w):(P=od(S.type,S.key,S.props,null,v.mode,P),P.ref=nc(v,w,S),P.return=v,v=P)}return o(v);case wo:e:{for(O=S.key;w!==null;){if(w.key===O)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){n(v,w.sibling),w=r(w,S.children||[]),w.return=v,v=w;break e}else{n(v,w);break}else e(v,w);w=w.sibling}w=Xp(S,v.mode,P),w.return=v,v=w}return o(v);case yr:return O=S._init,T(v,w,O(S._payload),P)}if(fc(S))return b(v,w,S,P);if(Ya(S))return y(v,w,S,P);Pu(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(n(v,w.sibling),w=r(w,S),w.return=v,v=w):(n(v,w),w=Yp(S,v.mode,P),w.return=v,v=w),o(v)):n(v,w)}return T}var oa=zE(!0),qE=zE(!1),Qd=ss(null),Jd=null,Ao=null,jy=null;function $y(){jy=Ao=Jd=null}function By(t){var e=Qd.current;je(Qd),t._currentValue=e}function Tg(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function jo(t,e){Jd=t,jy=Ao=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(nn=!0),t.firstContext=null)}function Dn(t){var e=t._currentValue;if(jy!==t)if(t={context:t,memoizedValue:e,next:null},Ao===null){if(Jd===null)throw Error(K(308));Ao=t,Jd.dependencies={lanes:0,firstContext:t}}else Ao=Ao.next=t;return e}var bs=null;function zy(t){bs===null?bs=[t]:bs.push(t)}function HE(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,zy(e)):(n.next=r.next,r.next=n),e.interleaved=n,Ji(t,i)}function Ji(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var br=!1;function qy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ki(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ur(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,_e&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Ji(t,n)}return r=i.interleaved,r===null?(e.next=e,zy(i)):(e.next=r.next,r.next=e),i.interleaved=e,Ji(t,n)}function ed(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Ry(t,n)}}function gk(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Yd(t,e,n,i){var r=t.updateQueue;br=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(s!==null){var h=r.baseState;o=0,u=l=c=null,a=s;do{var f=a.lane,g=a.eventTime;if((i&f)===f){u!==null&&(u=u.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,y=a;switch(f=e,g=n,y.tag){case 1:if(b=y.payload,typeof b=="function"){h=b.call(g,h,f);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=y.payload,f=typeof b=="function"?b.call(g,h,f):b,f==null)break e;h=Qe({},h,f);break e;case 2:br=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else g={eventTime:g,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=g,c=h):u=u.next=g,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(u===null&&(c=h),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Bs|=o,t.lanes=o,t.memoizedState=h}}function vk(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(K(191,r));r.call(i)}}}var Nl={},Ti=ss(Nl),tl=ss(Nl),nl=ss(Nl);function Ts(t){if(t===Nl)throw Error(K(174));return t}function Hy(t,e){switch(De(nl,e),De(tl,t),De(Ti,Nl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:eg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=eg(e,t)}je(Ti),De(Ti,e)}function aa(){je(Ti),je(tl),je(nl)}function KE(t){Ts(nl.current);var e=Ts(Ti.current),n=eg(e,t.type);e!==n&&(De(tl,t),De(Ti,n))}function Wy(t){tl.current===t&&(je(Ti),je(tl))}var We=ss(0);function Xd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hp=[];function Ky(){for(var t=0;t<Hp.length;t++)Hp[t]._workInProgressVersionPrimary=null;Hp.length=0}var td=sr.ReactCurrentDispatcher,Wp=sr.ReactCurrentBatchConfig,$s=0,Ke=null,ht=null,vt=null,Zd=!1,Cc=!1,il=0,k2=0;function Nt(){throw Error(K(321))}function Gy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zn(t[n],e[n]))return!1;return!0}function Qy(t,e,n,i,r,s){if($s=s,Ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,td.current=t===null||t.memoizedState===null?E2:C2,t=n(i,r),Cc){s=0;do{if(Cc=!1,il=0,25<=s)throw Error(K(301));s+=1,vt=ht=null,e.updateQueue=null,td.current=I2,t=n(i,r)}while(Cc)}if(td.current=eh,e=ht!==null&&ht.next!==null,$s=0,vt=ht=Ke=null,Zd=!1,e)throw Error(K(300));return t}function Jy(){var t=il!==0;return il=0,t}function fi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?Ke.memoizedState=vt=t:vt=vt.next=t,vt}function Ln(){if(ht===null){var t=Ke.alternate;t=t!==null?t.memoizedState:null}else t=ht.next;var e=vt===null?Ke.memoizedState:vt.next;if(e!==null)vt=e,ht=t;else{if(t===null)throw Error(K(310));ht=t,t={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},vt===null?Ke.memoizedState=vt=t:vt=vt.next=t}return vt}function rl(t,e){return typeof e=="function"?e(t):e}function Kp(t){var e=Ln(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var i=ht,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,c=null,l=s;do{var u=l.lane;if(($s&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),i=l.hasEagerState?l.eagerState:t(i,l.action);else{var h={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=h,o=i):c=c.next=h,Ke.lanes|=u,Bs|=u}l=l.next}while(l!==null&&l!==s);c===null?o=i:c.next=a,Zn(i,e.memoizedState)||(nn=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,Ke.lanes|=s,Bs|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Gp(t){var e=Ln(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Zn(s,e.memoizedState)||(nn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function GE(){}function QE(t,e){var n=Ke,i=Ln(),r=e(),s=!Zn(i.memoizedState,r);if(s&&(i.memoizedState=r,nn=!0),i=i.queue,Yy(XE.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,sl(9,YE.bind(null,n,i,r,e),void 0,null),bt===null)throw Error(K(349));$s&30||JE(n,e,r)}return r}function JE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function YE(t,e,n,i){e.value=n,e.getSnapshot=i,ZE(e)&&eC(t)}function XE(t,e,n){return n(function(){ZE(e)&&eC(t)})}function ZE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zn(t,n)}catch{return!0}}function eC(t){var e=Ji(t,1);e!==null&&Jn(e,t,1,-1)}function yk(t){var e=fi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rl,lastRenderedState:t},e.queue=t,t=t.dispatch=S2.bind(null,Ke,t),[e.memoizedState,t]}function sl(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function tC(){return Ln().memoizedState}function nd(t,e,n,i){var r=fi();Ke.flags|=t,r.memoizedState=sl(1|e,n,void 0,i===void 0?null:i)}function Xh(t,e,n,i){var r=Ln();i=i===void 0?null:i;var s=void 0;if(ht!==null){var o=ht.memoizedState;if(s=o.destroy,i!==null&&Gy(i,o.deps)){r.memoizedState=sl(e,n,s,i);return}}Ke.flags|=t,r.memoizedState=sl(1|e,n,s,i)}function bk(t,e){return nd(8390656,8,t,e)}function Yy(t,e){return Xh(2048,8,t,e)}function nC(t,e){return Xh(4,2,t,e)}function iC(t,e){return Xh(4,4,t,e)}function rC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sC(t,e,n){return n=n!=null?n.concat([t]):null,Xh(4,4,rC.bind(null,e,t),n)}function Xy(){}function oC(t,e){var n=Ln();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Gy(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function aC(t,e){var n=Ln();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Gy(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function cC(t,e,n){return $s&21?(Zn(n,e)||(n=fE(),Ke.lanes|=n,Bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,nn=!0),t.memoizedState=n)}function w2(t,e){var n=Ie;Ie=n!==0&&4>n?n:4,t(!0);var i=Wp.transition;Wp.transition={};try{t(!1),e()}finally{Ie=n,Wp.transition=i}}function lC(){return Ln().memoizedState}function _2(t,e,n){var i=Vr(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},uC(t))dC(e,n);else if(n=HE(t,e,n,i),n!==null){var r=Jt();Jn(n,t,i,r),hC(n,e,i)}}function S2(t,e,n){var i=Vr(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(uC(t))dC(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Zn(a,o)){var c=e.interleaved;c===null?(r.next=r,zy(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}n=HE(t,e,r,i),n!==null&&(r=Jt(),Jn(n,t,i,r),hC(n,e,i))}}function uC(t){var e=t.alternate;return t===Ke||e!==null&&e===Ke}function dC(t,e){Cc=Zd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function hC(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Ry(t,n)}}var eh={readContext:Dn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},E2={readContext:Dn,useCallback:function(t,e){return fi().memoizedState=[t,e===void 0?null:e],t},useContext:Dn,useEffect:bk,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,nd(4194308,4,rC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return nd(4194308,4,t,e)},useInsertionEffect:function(t,e){return nd(4,2,t,e)},useMemo:function(t,e){var n=fi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=fi();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=_2.bind(null,Ke,t),[i.memoizedState,t]},useRef:function(t){var e=fi();return t={current:t},e.memoizedState=t},useState:yk,useDebugValue:Xy,useDeferredValue:function(t){return fi().memoizedState=t},useTransition:function(){var t=yk(!1),e=t[0];return t=w2.bind(null,t[1]),fi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Ke,r=fi();if(ze){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),bt===null)throw Error(K(349));$s&30||JE(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,bk(XE.bind(null,i,s,t),[t]),i.flags|=2048,sl(9,YE.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=fi(),e=bt.identifierPrefix;if(ze){var n=Bi,i=$i;n=(i&~(1<<32-Qn(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=il++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=k2++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},C2={readContext:Dn,useCallback:oC,useContext:Dn,useEffect:Yy,useImperativeHandle:sC,useInsertionEffect:nC,useLayoutEffect:iC,useMemo:aC,useReducer:Kp,useRef:tC,useState:function(){return Kp(rl)},useDebugValue:Xy,useDeferredValue:function(t){var e=Ln();return cC(e,ht.memoizedState,t)},useTransition:function(){var t=Kp(rl)[0],e=Ln().memoizedState;return[t,e]},useMutableSource:GE,useSyncExternalStore:QE,useId:lC,unstable_isNewReconciler:!1},I2={readContext:Dn,useCallback:oC,useContext:Dn,useEffect:Yy,useImperativeHandle:sC,useInsertionEffect:nC,useLayoutEffect:iC,useMemo:aC,useReducer:Gp,useRef:tC,useState:function(){return Gp(rl)},useDebugValue:Xy,useDeferredValue:function(t){var e=Ln();return ht===null?e.memoizedState=t:cC(e,ht.memoizedState,t)},useTransition:function(){var t=Gp(rl)[0],e=Ln().memoizedState;return[t,e]},useMutableSource:GE,useSyncExternalStore:QE,useId:lC,unstable_isNewReconciler:!1};function Bn(t,e){if(t&&t.defaultProps){e=Qe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function kg(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Qe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Zh={isMounted:function(t){return(t=t._reactInternals)?eo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Jt(),r=Vr(t),s=Ki(i,r);s.payload=e,n!=null&&(s.callback=n),e=Ur(t,s,r),e!==null&&(Jn(e,t,r,i),ed(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Jt(),r=Vr(t),s=Ki(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ur(t,s,r),e!==null&&(Jn(e,t,r,i),ed(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Jt(),i=Vr(t),r=Ki(n,i);r.tag=2,e!=null&&(r.callback=e),e=Ur(t,r,i),e!==null&&(Jn(e,t,i,n),ed(e,t,i))}};function Tk(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Yc(n,i)||!Yc(r,s):!0}function fC(t,e,n){var i=!1,r=Kr,s=e.contextType;return typeof s=="object"&&s!==null?s=Dn(s):(r=an(e)?Vs:Bt.current,i=e.contextTypes,s=(i=i!=null)?ra(t,r):Kr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zh,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function kk(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Zh.enqueueReplaceState(e,e.state,null)}function wg(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},qy(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Dn(s):(s=an(e)?Vs:Bt.current,r.context=ra(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(kg(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Zh.enqueueReplaceState(r,r.state,null),Yd(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function ca(t,e){try{var n="",i=e;do n+=tD(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function Qp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function _g(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var P2=typeof WeakMap=="function"?WeakMap:Map;function pC(t,e,n){n=Ki(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){nh||(nh=!0,Og=i),_g(t,e)},n}function mC(t,e,n){n=Ki(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){_g(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){_g(t,e),typeof i!="function"&&(Fr===null?Fr=new Set([this]):Fr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function wk(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new P2;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=B2.bind(null,t,e,n),e.then(t,t))}function _k(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Sk(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ki(-1,1),e.tag=2,Ur(n,e,1))),n.lanes|=1),t)}var R2=sr.ReactCurrentOwner,nn=!1;function Kt(t,e,n,i){e.child=t===null?qE(e,null,n,i):oa(e,t.child,n,i)}function Ek(t,e,n,i,r){n=n.render;var s=e.ref;return jo(e,r),i=Qy(t,e,n,i,s,r),n=Jy(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Yi(t,e,r)):(ze&&n&&Uy(e),e.flags|=1,Kt(t,e,i,r),e.child)}function Ck(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!o0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,gC(t,e,s,i,r)):(t=od(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Yc,n(o,i)&&t.ref===e.ref)return Yi(t,e,r)}return e.flags|=1,t=jr(s,i),t.ref=e.ref,t.return=e,e.child=t}function gC(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(Yc(s,i)&&t.ref===e.ref)if(nn=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(nn=!0);else return e.lanes=t.lanes,Yi(t,e,r)}return Sg(t,e,n,i,r)}function vC(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Oo,vn),vn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(Oo,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,De(Oo,vn),vn|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,De(Oo,vn),vn|=i;return Kt(t,e,r,n),e.child}function yC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sg(t,e,n,i,r){var s=an(n)?Vs:Bt.current;return s=ra(e,s),jo(e,r),n=Qy(t,e,n,i,s,r),i=Jy(),t!==null&&!nn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Yi(t,e,r)):(ze&&i&&Uy(e),e.flags|=1,Kt(t,e,n,r),e.child)}function Ik(t,e,n,i,r){if(an(n)){var s=!0;Wd(e)}else s=!1;if(jo(e,r),e.stateNode===null)id(t,e),fC(e,n,i),wg(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Dn(l):(l=an(n)?Vs:Bt.current,l=ra(e,l));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==l)&&kk(e,o,i,l),br=!1;var f=e.memoizedState;o.state=f,Yd(e,i,o,r),c=e.memoizedState,a!==i||f!==c||on.current||br?(typeof u=="function"&&(kg(e,n,u,i),c=e.memoizedState),(a=br||Tk(e,n,a,i,f,c,l))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),o.props=i,o.state=c,o.context=l,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,WE(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:Bn(e.type,a),o.props=l,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Dn(c):(c=an(n)?Vs:Bt.current,c=ra(e,c));var g=n.getDerivedStateFromProps;(u=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==c)&&kk(e,o,i,c),br=!1,f=e.memoizedState,o.state=f,Yd(e,i,o,r);var b=e.memoizedState;a!==h||f!==b||on.current||br?(typeof g=="function"&&(kg(e,n,g,i),b=e.memoizedState),(l=br||Tk(e,n,l,i,f,b,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,b,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=b),o.props=i,o.state=b,o.context=c,i=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),i=!1)}return Eg(t,e,n,i,s,r)}function Eg(t,e,n,i,r,s){yC(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&hk(e,n,!1),Yi(t,e,s);i=e.stateNode,R2.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=oa(e,t.child,null,s),e.child=oa(e,null,a,s)):Kt(t,e,a,s),e.memoizedState=i.state,r&&hk(e,n,!0),e.child}function bC(t){var e=t.stateNode;e.pendingContext?dk(t,e.pendingContext,e.pendingContext!==e.context):e.context&&dk(t,e.context,!1),Hy(t,e.containerInfo)}function Pk(t,e,n,i,r){return sa(),Vy(r),e.flags|=256,Kt(t,e,n,i),e.child}var Cg={dehydrated:null,treeContext:null,retryLane:0};function Ig(t){return{baseLanes:t,cachePool:null,transitions:null}}function TC(t,e,n){var i=e.pendingProps,r=We.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),De(We,r&1),t===null)return bg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=nf(o,i,0,null),t=Is(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ig(n),e.memoizedState=Cg,t):Zy(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return x2(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var c={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=jr(r,c),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=jr(a,s):(s=Is(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?Ig(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Cg,i}return s=t.child,t=s.sibling,i=jr(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function Zy(t,e){return e=nf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ru(t,e,n,i){return i!==null&&Vy(i),oa(e,t.child,null,n),t=Zy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function x2(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=Qp(Error(K(422))),Ru(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=nf({mode:"visible",children:i.children},r,0,null),s=Is(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&oa(e,t.child,null,o),e.child.memoizedState=Ig(o),e.memoizedState=Cg,s);if(!(e.mode&1))return Ru(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(K(419)),i=Qp(s,i,void 0),Ru(t,e,o,i)}if(a=(o&t.childLanes)!==0,nn||a){if(i=bt,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Ji(t,r),Jn(i,t,r,-1))}return s0(),i=Qp(Error(K(421))),Ru(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=z2.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,bn=Mr(r.nextSibling),Tn=e,ze=!0,Hn=null,t!==null&&(Pn[Rn++]=$i,Pn[Rn++]=Bi,Pn[Rn++]=js,$i=t.id,Bi=t.overflow,js=e),e=Zy(e,i.children),e.flags|=4096,e)}function Rk(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),Tg(t.return,e,n)}function Jp(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function kC(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Kt(t,e,i.children,n),i=We.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Rk(t,n,e);else if(t.tag===19)Rk(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(De(We,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Xd(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Jp(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Xd(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Jp(e,!0,n,null,s);break;case"together":Jp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function id(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Yi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=jr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=jr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function A2(t,e,n){switch(e.tag){case 3:bC(e),sa();break;case 5:KE(e);break;case 1:an(e.type)&&Wd(e);break;case 4:Hy(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;De(Qd,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(De(We,We.current&1),e.flags|=128,null):n&e.child.childLanes?TC(t,e,n):(De(We,We.current&1),t=Yi(t,e,n),t!==null?t.sibling:null);De(We,We.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return kC(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),De(We,We.current),i)break;return null;case 22:case 23:return e.lanes=0,vC(t,e,n)}return Yi(t,e,n)}var wC,Pg,_C,SC;wC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Pg=function(){};_C=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Ts(Ti.current);var s=null;switch(n){case"input":r=Jm(t,r),i=Jm(t,i),s=[];break;case"select":r=Qe({},r,{value:void 0}),i=Qe({},i,{value:void 0}),s=[];break;case"textarea":r=Zm(t,r),i=Zm(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=qd)}tg(n,i);var o;n=null;for(l in r)if(!i.hasOwnProperty(l)&&r.hasOwnProperty(l)&&r[l]!=null)if(l==="style"){var a=r[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(qc.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in i){var c=i[l];if(a=r!=null?r[l]:void 0,i.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(qc.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&Fe("scroll",t),s||a===c||(s=[])):(s=s||[]).push(l,c))}n&&(s=s||[]).push("style",n);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};SC=function(t,e,n,i){n!==i&&(e.flags|=4)};function ic(t,e){if(!ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ot(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function N2(t,e,n){var i=e.pendingProps;switch(Fy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(e),null;case 1:return an(e.type)&&Hd(),Ot(e),null;case 3:return i=e.stateNode,aa(),je(on),je(Bt),Ky(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Iu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hn!==null&&(Mg(Hn),Hn=null))),Pg(t,e),Ot(e),null;case 5:Wy(e);var r=Ts(nl.current);if(n=e.type,t!==null&&e.stateNode!=null)_C(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(K(166));return Ot(e),null}if(t=Ts(Ti.current),Iu(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[gi]=e,i[el]=s,t=(e.mode&1)!==0,n){case"dialog":Fe("cancel",i),Fe("close",i);break;case"iframe":case"object":case"embed":Fe("load",i);break;case"video":case"audio":for(r=0;r<mc.length;r++)Fe(mc[r],i);break;case"source":Fe("error",i);break;case"img":case"image":case"link":Fe("error",i),Fe("load",i);break;case"details":Fe("toggle",i);break;case"input":FT(i,s),Fe("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Fe("invalid",i);break;case"textarea":jT(i,s),Fe("invalid",i)}tg(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Cu(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Cu(i.textContent,a,t),r=["children",""+a]):qc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Fe("scroll",i)}switch(n){case"input":yu(i),VT(i,s,!0);break;case"textarea":yu(i),$T(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=qd)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=X1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[gi]=e,t[el]=i,wC(t,e,!1,!1),e.stateNode=t;e:{switch(o=ng(n,i),n){case"dialog":Fe("cancel",t),Fe("close",t),r=i;break;case"iframe":case"object":case"embed":Fe("load",t),r=i;break;case"video":case"audio":for(r=0;r<mc.length;r++)Fe(mc[r],t);r=i;break;case"source":Fe("error",t),r=i;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),r=i;break;case"details":Fe("toggle",t),r=i;break;case"input":FT(t,i),r=Jm(t,i),Fe("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=Qe({},i,{value:void 0}),Fe("invalid",t);break;case"textarea":jT(t,i),r=Zm(t,i),Fe("invalid",t);break;default:r=i}tg(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?tE(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Z1(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Hc(t,c):typeof c=="number"&&Hc(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(qc.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Fe("scroll",t):c!=null&&_y(t,s,c,o))}switch(n){case"input":yu(t),VT(t,i,!1);break;case"textarea":yu(t),$T(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Wr(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?Mo(t,!!i.multiple,s,!1):i.defaultValue!=null&&Mo(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=qd)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ot(e),null;case 6:if(t&&e.stateNode!=null)SC(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(K(166));if(n=Ts(nl.current),Ts(Ti.current),Iu(e)){if(i=e.stateNode,n=e.memoizedProps,i[gi]=e,(s=i.nodeValue!==n)&&(t=Tn,t!==null))switch(t.tag){case 3:Cu(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cu(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[gi]=e,e.stateNode=i}return Ot(e),null;case 13:if(je(We),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ze&&bn!==null&&e.mode&1&&!(e.flags&128))BE(),sa(),e.flags|=98560,s=!1;else if(s=Iu(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(K(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(K(317));s[gi]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ot(e),s=!1}else Hn!==null&&(Mg(Hn),Hn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||We.current&1?pt===0&&(pt=3):s0())),e.updateQueue!==null&&(e.flags|=4),Ot(e),null);case 4:return aa(),Pg(t,e),t===null&&Xc(e.stateNode.containerInfo),Ot(e),null;case 10:return By(e.type._context),Ot(e),null;case 17:return an(e.type)&&Hd(),Ot(e),null;case 19:if(je(We),s=e.memoizedState,s===null)return Ot(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)ic(s,!1);else{if(pt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Xd(t),o!==null){for(e.flags|=128,ic(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return De(We,We.current&1|2),e.child}t=t.sibling}s.tail!==null&&it()>la&&(e.flags|=128,i=!0,ic(s,!1),e.lanes=4194304)}else{if(!i)if(t=Xd(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ic(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ze)return Ot(e),null}else 2*it()-s.renderingStartTime>la&&n!==1073741824&&(e.flags|=128,i=!0,ic(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=it(),e.sibling=null,n=We.current,De(We,i?n&1|2:n&1),e):(Ot(e),null);case 22:case 23:return r0(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?vn&1073741824&&(Ot(e),e.subtreeFlags&6&&(e.flags|=8192)):Ot(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function O2(t,e){switch(Fy(e),e.tag){case 1:return an(e.type)&&Hd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return aa(),je(on),je(Bt),Ky(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Wy(e),null;case 13:if(je(We),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return je(We),null;case 4:return aa(),null;case 10:return By(e.type._context),null;case 22:case 23:return r0(),null;case 24:return null;default:return null}}var xu=!1,Ft=!1,D2=typeof WeakSet=="function"?WeakSet:Set,Z=null;function No(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Ze(t,e,i)}else n.current=null}function Rg(t,e,n){try{n()}catch(i){Ze(t,e,i)}}var xk=!1;function L2(t,e){if(hg=$d,t=RE(),My(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,u=0,h=t,f=null;t:for(;;){for(var g;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==s||i!==0&&h.nodeType!==3||(c=o+i),h.nodeType===3&&(o+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++l===r&&(a=o),f===s&&++u===i&&(c=o),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(fg={focusedElem:t,selectionRange:n},$d=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var y=b.memoizedProps,T=b.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:Bn(e.type,y),T);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(P){Ze(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return b=xk,xk=!1,b}function Ic(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&Rg(e,n,s)}r=r.next}while(r!==i)}}function ef(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function xg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function EC(t){var e=t.alternate;e!==null&&(t.alternate=null,EC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gi],delete e[el],delete e[gg],delete e[v2],delete e[y2])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function CC(t){return t.tag===5||t.tag===3||t.tag===4}function Ak(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||CC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ag(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qd));else if(i!==4&&(t=t.child,t!==null))for(Ag(t,e,n),t=t.sibling;t!==null;)Ag(t,e,n),t=t.sibling}function Ng(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Ng(t,e,n),t=t.sibling;t!==null;)Ng(t,e,n),t=t.sibling}var wt=null,zn=!1;function fr(t,e,n){for(n=n.child;n!==null;)IC(t,e,n),n=n.sibling}function IC(t,e,n){if(bi&&typeof bi.onCommitFiberUnmount=="function")try{bi.onCommitFiberUnmount(Wh,n)}catch{}switch(n.tag){case 5:Ft||No(n,e);case 6:var i=wt,r=zn;wt=null,fr(t,e,n),wt=i,zn=r,wt!==null&&(zn?(t=wt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wt.removeChild(n.stateNode));break;case 18:wt!==null&&(zn?(t=wt,n=n.stateNode,t.nodeType===8?zp(t.parentNode,n):t.nodeType===1&&zp(t,n),Qc(t)):zp(wt,n.stateNode));break;case 4:i=wt,r=zn,wt=n.stateNode.containerInfo,zn=!0,fr(t,e,n),wt=i,zn=r;break;case 0:case 11:case 14:case 15:if(!Ft&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Rg(n,e,o),r=r.next}while(r!==i)}fr(t,e,n);break;case 1:if(!Ft&&(No(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Ze(n,e,a)}fr(t,e,n);break;case 21:fr(t,e,n);break;case 22:n.mode&1?(Ft=(i=Ft)||n.memoizedState!==null,fr(t,e,n),Ft=i):fr(t,e,n);break;default:fr(t,e,n)}}function Nk(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new D2),e.forEach(function(i){var r=q2.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Vn(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:wt=a.stateNode,zn=!1;break e;case 3:wt=a.stateNode.containerInfo,zn=!0;break e;case 4:wt=a.stateNode.containerInfo,zn=!0;break e}a=a.return}if(wt===null)throw Error(K(160));IC(s,o,r),wt=null,zn=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(l){Ze(r,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)PC(e,t),e=e.sibling}function PC(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vn(e,t),li(t),i&4){try{Ic(3,t,t.return),ef(3,t)}catch(y){Ze(t,t.return,y)}try{Ic(5,t,t.return)}catch(y){Ze(t,t.return,y)}}break;case 1:Vn(e,t),li(t),i&512&&n!==null&&No(n,n.return);break;case 5:if(Vn(e,t),li(t),i&512&&n!==null&&No(n,n.return),t.flags&32){var r=t.stateNode;try{Hc(r,"")}catch(y){Ze(t,t.return,y)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&J1(r,s),ng(a,o);var l=ng(a,s);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?tE(r,h):u==="dangerouslySetInnerHTML"?Z1(r,h):u==="children"?Hc(r,h):_y(r,u,h,l)}switch(a){case"input":Ym(r,s);break;case"textarea":Y1(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Mo(r,!!s.multiple,g,!1):f!==!!s.multiple&&(s.defaultValue!=null?Mo(r,!!s.multiple,s.defaultValue,!0):Mo(r,!!s.multiple,s.multiple?[]:"",!1))}r[el]=s}catch(y){Ze(t,t.return,y)}}break;case 6:if(Vn(e,t),li(t),i&4){if(t.stateNode===null)throw Error(K(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(y){Ze(t,t.return,y)}}break;case 3:if(Vn(e,t),li(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Qc(e.containerInfo)}catch(y){Ze(t,t.return,y)}break;case 4:Vn(e,t),li(t);break;case 13:Vn(e,t),li(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(n0=it())),i&4&&Nk(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Ft=(l=Ft)||u,Vn(e,t),Ft=l):Vn(e,t),li(t),i&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(Z=t,u=t.child;u!==null;){for(h=Z=u;Z!==null;){switch(f=Z,g=f.child,f.tag){case 0:case 11:case 14:case 15:Ic(4,f,f.return);break;case 1:No(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){i=f,n=f.return;try{e=i,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(y){Ze(i,n,y)}}break;case 5:No(f,f.return);break;case 22:if(f.memoizedState!==null){Dk(h);continue}}g!==null?(g.return=f,Z=g):Dk(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,l?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=eE("display",o))}catch(y){Ze(t,t.return,y)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(y){Ze(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Vn(e,t),li(t),i&4&&Nk(t);break;case 21:break;default:Vn(e,t),li(t)}}function li(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(CC(n)){var i=n;break e}n=n.return}throw Error(K(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Hc(r,""),i.flags&=-33);var s=Ak(t);Ng(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=Ak(t);Ag(t,a,o);break;default:throw Error(K(161))}}catch(c){Ze(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function M2(t,e,n){Z=t,RC(t)}function RC(t,e,n){for(var i=(t.mode&1)!==0;Z!==null;){var r=Z,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||xu;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||Ft;a=xu;var l=Ft;if(xu=o,(Ft=c)&&!l)for(Z=r;Z!==null;)o=Z,c=o.child,o.tag===22&&o.memoizedState!==null?Lk(r):c!==null?(c.return=o,Z=c):Lk(r);for(;s!==null;)Z=s,RC(s),s=s.sibling;Z=r,xu=a,Ft=l}Ok(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Z=s):Ok(t)}}function Ok(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ft||ef(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Ft)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Bn(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&vk(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}vk(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Qc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}Ft||e.flags&512&&xg(e)}catch(f){Ze(e,e.return,f)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Dk(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Lk(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ef(4,e)}catch(c){Ze(e,n,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(c){Ze(e,r,c)}}var s=e.return;try{xg(e)}catch(c){Ze(e,s,c)}break;case 5:var o=e.return;try{xg(e)}catch(c){Ze(e,o,c)}}}catch(c){Ze(e,e.return,c)}if(e===t){Z=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Z=a;break}Z=e.return}}var U2=Math.ceil,th=sr.ReactCurrentDispatcher,e0=sr.ReactCurrentOwner,On=sr.ReactCurrentBatchConfig,_e=0,bt=null,at=null,Ct=0,vn=0,Oo=ss(0),pt=0,ol=null,Bs=0,tf=0,t0=0,Pc=null,en=null,n0=0,la=1/0,Mi=null,nh=!1,Og=null,Fr=null,Au=!1,Pr=null,ih=0,Rc=0,Dg=null,rd=-1,sd=0;function Jt(){return _e&6?it():rd!==-1?rd:rd=it()}function Vr(t){return t.mode&1?_e&2&&Ct!==0?Ct&-Ct:T2.transition!==null?(sd===0&&(sd=fE()),sd):(t=Ie,t!==0||(t=window.event,t=t===void 0?16:TE(t.type)),t):1}function Jn(t,e,n,i){if(50<Rc)throw Rc=0,Dg=null,Error(K(185));Rl(t,n,i),(!(_e&2)||t!==bt)&&(t===bt&&(!(_e&2)&&(tf|=n),pt===4&&wr(t,Ct)),cn(t,i),n===1&&_e===0&&!(e.mode&1)&&(la=it()+500,Yh&&os()))}function cn(t,e){var n=t.callbackNode;TD(t,e);var i=jd(t,t===bt?Ct:0);if(i===0)n!==null&&qT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&qT(n),e===1)t.tag===0?b2(Mk.bind(null,t)):VE(Mk.bind(null,t)),m2(function(){!(_e&6)&&os()}),n=null;else{switch(pE(i)){case 1:n=Py;break;case 4:n=dE;break;case 16:n=Vd;break;case 536870912:n=hE;break;default:n=Vd}n=UC(n,xC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xC(t,e){if(rd=-1,sd=0,_e&6)throw Error(K(327));var n=t.callbackNode;if($o()&&t.callbackNode!==n)return null;var i=jd(t,t===bt?Ct:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=rh(t,i);else{e=i;var r=_e;_e|=2;var s=NC();(bt!==t||Ct!==e)&&(Mi=null,la=it()+500,Cs(t,e));do try{j2();break}catch(a){AC(t,a)}while(!0);$y(),th.current=s,_e=r,at!==null?e=0:(bt=null,Ct=0,e=pt)}if(e!==0){if(e===2&&(r=ag(t),r!==0&&(i=r,e=Lg(t,r))),e===1)throw n=ol,Cs(t,0),wr(t,i),cn(t,it()),n;if(e===6)wr(t,i);else{if(r=t.current.alternate,!(i&30)&&!F2(r)&&(e=rh(t,i),e===2&&(s=ag(t),s!==0&&(i=s,e=Lg(t,s))),e===1))throw n=ol,Cs(t,0),wr(t,i),cn(t,it()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(K(345));case 2:gs(t,en,Mi);break;case 3:if(wr(t,i),(i&130023424)===i&&(e=n0+500-it(),10<e)){if(jd(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Jt(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=mg(gs.bind(null,t,en,Mi),e);break}gs(t,en,Mi);break;case 4:if(wr(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Qn(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=it()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*U2(i/1960))-i,10<i){t.timeoutHandle=mg(gs.bind(null,t,en,Mi),i);break}gs(t,en,Mi);break;case 5:gs(t,en,Mi);break;default:throw Error(K(329))}}}return cn(t,it()),t.callbackNode===n?xC.bind(null,t):null}function Lg(t,e){var n=Pc;return t.current.memoizedState.isDehydrated&&(Cs(t,e).flags|=256),t=rh(t,e),t!==2&&(e=en,en=n,e!==null&&Mg(e)),t}function Mg(t){en===null?en=t:en.push.apply(en,t)}function F2(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Zn(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wr(t,e){for(e&=~t0,e&=~tf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Qn(e),i=1<<n;t[n]=-1,e&=~i}}function Mk(t){if(_e&6)throw Error(K(327));$o();var e=jd(t,0);if(!(e&1))return cn(t,it()),null;var n=rh(t,e);if(t.tag!==0&&n===2){var i=ag(t);i!==0&&(e=i,n=Lg(t,i))}if(n===1)throw n=ol,Cs(t,0),wr(t,e),cn(t,it()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,gs(t,en,Mi),cn(t,it()),null}function i0(t,e){var n=_e;_e|=1;try{return t(e)}finally{_e=n,_e===0&&(la=it()+500,Yh&&os())}}function zs(t){Pr!==null&&Pr.tag===0&&!(_e&6)&&$o();var e=_e;_e|=1;var n=On.transition,i=Ie;try{if(On.transition=null,Ie=1,t)return t()}finally{Ie=i,On.transition=n,_e=e,!(_e&6)&&os()}}function r0(){vn=Oo.current,je(Oo)}function Cs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,p2(n)),at!==null)for(n=at.return;n!==null;){var i=n;switch(Fy(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Hd();break;case 3:aa(),je(on),je(Bt),Ky();break;case 5:Wy(i);break;case 4:aa();break;case 13:je(We);break;case 19:je(We);break;case 10:By(i.type._context);break;case 22:case 23:r0()}n=n.return}if(bt=t,at=t=jr(t.current,null),Ct=vn=e,pt=0,ol=null,t0=tf=Bs=0,en=Pc=null,bs!==null){for(e=0;e<bs.length;e++)if(n=bs[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}bs=null}return t}function AC(t,e){do{var n=at;try{if($y(),td.current=eh,Zd){for(var i=Ke.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Zd=!1}if($s=0,vt=ht=Ke=null,Cc=!1,il=0,e0.current=null,n===null||n.return===null){pt=1,ol=e,at=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=Ct,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=_k(o);if(g!==null){g.flags&=-257,Sk(g,o,a,s,e),g.mode&1&&wk(s,l,e),e=g,c=l;var b=e.updateQueue;if(b===null){var y=new Set;y.add(c),e.updateQueue=y}else b.add(c);break e}else{if(!(e&1)){wk(s,l,e),s0();break e}c=Error(K(426))}}else if(ze&&a.mode&1){var T=_k(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Sk(T,o,a,s,e),Vy(ca(c,a));break e}}s=c=ca(c,a),pt!==4&&(pt=2),Pc===null?Pc=[s]:Pc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=pC(s,c,e);gk(s,v);break e;case 1:a=c;var w=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Fr===null||!Fr.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var P=mC(s,a,e);gk(s,P);break e}}s=s.return}while(s!==null)}DC(n)}catch(R){e=R,at===n&&n!==null&&(at=n=n.return);continue}break}while(!0)}function NC(){var t=th.current;return th.current=eh,t===null?eh:t}function s0(){(pt===0||pt===3||pt===2)&&(pt=4),bt===null||!(Bs&268435455)&&!(tf&268435455)||wr(bt,Ct)}function rh(t,e){var n=_e;_e|=2;var i=NC();(bt!==t||Ct!==e)&&(Mi=null,Cs(t,e));do try{V2();break}catch(r){AC(t,r)}while(!0);if($y(),_e=n,th.current=i,at!==null)throw Error(K(261));return bt=null,Ct=0,pt}function V2(){for(;at!==null;)OC(at)}function j2(){for(;at!==null&&!dD();)OC(at)}function OC(t){var e=MC(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?DC(t):at=e,e0.current=null}function DC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=O2(n,e),n!==null){n.flags&=32767,at=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{pt=6,at=null;return}}else if(n=N2(n,e,vn),n!==null){at=n;return}if(e=e.sibling,e!==null){at=e;return}at=e=t}while(e!==null);pt===0&&(pt=5)}function gs(t,e,n){var i=Ie,r=On.transition;try{On.transition=null,Ie=1,$2(t,e,n,i)}finally{On.transition=r,Ie=i}return null}function $2(t,e,n,i){do $o();while(Pr!==null);if(_e&6)throw Error(K(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(kD(t,s),t===bt&&(at=bt=null,Ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Au||(Au=!0,UC(Vd,function(){return $o(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=On.transition,On.transition=null;var o=Ie;Ie=1;var a=_e;_e|=4,e0.current=null,L2(t,n),PC(n,t),a2(fg),$d=!!hg,fg=hg=null,t.current=n,M2(n),hD(),_e=a,Ie=o,On.transition=s}else t.current=n;if(Au&&(Au=!1,Pr=t,ih=r),s=t.pendingLanes,s===0&&(Fr=null),mD(n.stateNode),cn(t,it()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(nh)throw nh=!1,t=Og,Og=null,t;return ih&1&&t.tag!==0&&$o(),s=t.pendingLanes,s&1?t===Dg?Rc++:(Rc=0,Dg=t):Rc=0,os(),null}function $o(){if(Pr!==null){var t=pE(ih),e=On.transition,n=Ie;try{if(On.transition=null,Ie=16>t?16:t,Pr===null)var i=!1;else{if(t=Pr,Pr=null,ih=0,_e&6)throw Error(K(331));var r=_e;for(_e|=4,Z=t.current;Z!==null;){var s=Z,o=s.child;if(Z.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(Z=l;Z!==null;){var u=Z;switch(u.tag){case 0:case 11:case 15:Ic(8,u,s)}var h=u.child;if(h!==null)h.return=u,Z=h;else for(;Z!==null;){u=Z;var f=u.sibling,g=u.return;if(EC(u),u===l){Z=null;break}if(f!==null){f.return=g,Z=f;break}Z=g}}}var b=s.alternate;if(b!==null){var y=b.child;if(y!==null){b.child=null;do{var T=y.sibling;y.sibling=null,y=T}while(y!==null)}}Z=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Z=o;else e:for(;Z!==null;){if(s=Z,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ic(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Z=v;break e}Z=s.return}}var w=t.current;for(Z=w;Z!==null;){o=Z;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Z=S;else e:for(o=w;Z!==null;){if(a=Z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ef(9,a)}}catch(R){Ze(a,a.return,R)}if(a===o){Z=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,Z=P;break e}Z=a.return}}if(_e=r,os(),bi&&typeof bi.onPostCommitFiberRoot=="function")try{bi.onPostCommitFiberRoot(Wh,t)}catch{}i=!0}return i}finally{Ie=n,On.transition=e}}return!1}function Uk(t,e,n){e=ca(n,e),e=pC(t,e,1),t=Ur(t,e,1),e=Jt(),t!==null&&(Rl(t,1,e),cn(t,e))}function Ze(t,e,n){if(t.tag===3)Uk(t,t,n);else for(;e!==null;){if(e.tag===3){Uk(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Fr===null||!Fr.has(i))){t=ca(n,t),t=mC(e,t,1),e=Ur(e,t,1),t=Jt(),e!==null&&(Rl(e,1,t),cn(e,t));break}}e=e.return}}function B2(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Jt(),t.pingedLanes|=t.suspendedLanes&n,bt===t&&(Ct&n)===n&&(pt===4||pt===3&&(Ct&130023424)===Ct&&500>it()-n0?Cs(t,0):t0|=n),cn(t,e)}function LC(t,e){e===0&&(t.mode&1?(e=ku,ku<<=1,!(ku&130023424)&&(ku=4194304)):e=1);var n=Jt();t=Ji(t,e),t!==null&&(Rl(t,e,n),cn(t,n))}function z2(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),LC(t,n)}function q2(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(K(314))}i!==null&&i.delete(e),LC(t,n)}var MC;MC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||on.current)nn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return nn=!1,A2(t,e,n);nn=!!(t.flags&131072)}else nn=!1,ze&&e.flags&1048576&&jE(e,Gd,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;id(t,e),t=e.pendingProps;var r=ra(e,Bt.current);jo(e,n),r=Qy(null,e,i,t,r,n);var s=Jy();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,an(i)?(s=!0,Wd(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,qy(e),r.updater=Zh,e.stateNode=r,r._reactInternals=e,wg(e,i,t,n),e=Eg(null,e,i,!0,s,n)):(e.tag=0,ze&&s&&Uy(e),Kt(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(id(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=W2(i),t=Bn(i,t),r){case 0:e=Sg(null,e,i,t,n);break e;case 1:e=Ik(null,e,i,t,n);break e;case 11:e=Ek(null,e,i,t,n);break e;case 14:e=Ck(null,e,i,Bn(i.type,t),n);break e}throw Error(K(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Bn(i,r),Sg(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Bn(i,r),Ik(t,e,i,r,n);case 3:e:{if(bC(e),t===null)throw Error(K(387));i=e.pendingProps,s=e.memoizedState,r=s.element,WE(t,e),Yd(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=ca(Error(K(423)),e),e=Pk(t,e,i,n,r);break e}else if(i!==r){r=ca(Error(K(424)),e),e=Pk(t,e,i,n,r);break e}else for(bn=Mr(e.stateNode.containerInfo.firstChild),Tn=e,ze=!0,Hn=null,n=qE(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),i===r){e=Yi(t,e,n);break e}Kt(t,e,i,n)}e=e.child}return e;case 5:return KE(e),t===null&&bg(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,pg(i,r)?o=null:s!==null&&pg(i,s)&&(e.flags|=32),yC(t,e),Kt(t,e,o,n),e.child;case 6:return t===null&&bg(e),null;case 13:return TC(t,e,n);case 4:return Hy(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=oa(e,null,i,n):Kt(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Bn(i,r),Ek(t,e,i,r,n);case 7:return Kt(t,e,e.pendingProps,n),e.child;case 8:return Kt(t,e,e.pendingProps.children,n),e.child;case 12:return Kt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,De(Qd,i._currentValue),i._currentValue=o,s!==null)if(Zn(s.value,o)){if(s.children===r.children&&!on.current){e=Yi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=Ki(-1,n&-n),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Tg(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(K(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Tg(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Kt(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,jo(e,n),r=Dn(r),i=i(r),e.flags|=1,Kt(t,e,i,n),e.child;case 14:return i=e.type,r=Bn(i,e.pendingProps),r=Bn(i.type,r),Ck(t,e,i,r,n);case 15:return gC(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Bn(i,r),id(t,e),e.tag=1,an(i)?(t=!0,Wd(e)):t=!1,jo(e,n),fC(e,i,r),wg(e,i,r,n),Eg(null,e,i,!0,t,n);case 19:return kC(t,e,n);case 22:return vC(t,e,n)}throw Error(K(156,e.tag))};function UC(t,e){return uE(t,e)}function H2(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function An(t,e,n,i){return new H2(t,e,n,i)}function o0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function W2(t){if(typeof t=="function")return o0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ey)return 11;if(t===Cy)return 14}return 2}function jr(t,e){var n=t.alternate;return n===null?(n=An(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function od(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")o0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case _o:return Is(n.children,r,s,e);case Sy:o=8,r|=8;break;case Wm:return t=An(12,n,e,r|2),t.elementType=Wm,t.lanes=s,t;case Km:return t=An(13,n,e,r),t.elementType=Km,t.lanes=s,t;case Gm:return t=An(19,n,e,r),t.elementType=Gm,t.lanes=s,t;case K1:return nf(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case H1:o=10;break e;case W1:o=9;break e;case Ey:o=11;break e;case Cy:o=14;break e;case yr:o=16,i=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=An(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Is(t,e,n,i){return t=An(7,t,i,e),t.lanes=n,t}function nf(t,e,n,i){return t=An(22,t,i,e),t.elementType=K1,t.lanes=n,t.stateNode={isHidden:!1},t}function Yp(t,e,n){return t=An(6,t,null,e),t.lanes=n,t}function Xp(t,e,n){return e=An(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function K2(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Np(0),this.expirationTimes=Np(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Np(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function a0(t,e,n,i,r,s,o,a,c){return t=new K2(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=An(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qy(s),t}function G2(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wo,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function FC(t){if(!t)return Kr;t=t._reactInternals;e:{if(eo(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(an(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(an(n))return FE(t,n,e)}return e}function VC(t,e,n,i,r,s,o,a,c){return t=a0(n,i,!0,t,r,s,o,a,c),t.context=FC(null),n=t.current,i=Jt(),r=Vr(n),s=Ki(i,r),s.callback=e??null,Ur(n,s,r),t.current.lanes=r,Rl(t,r,i),cn(t,i),t}function rf(t,e,n,i){var r=e.current,s=Jt(),o=Vr(r);return n=FC(n),e.context===null?e.context=n:e.pendingContext=n,e=Ki(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Ur(r,e,o),t!==null&&(Jn(t,r,o,s),ed(t,r,o)),o}function sh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Fk(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function c0(t,e){Fk(t,e),(t=t.alternate)&&Fk(t,e)}function Q2(){return null}var jC=typeof reportError=="function"?reportError:function(t){console.error(t)};function l0(t){this._internalRoot=t}sf.prototype.render=l0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));rf(t,e,null,null)};sf.prototype.unmount=l0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;zs(function(){rf(null,t,null,null)}),e[Qi]=null}};function sf(t){this._internalRoot=t}sf.prototype.unstable_scheduleHydration=function(t){if(t){var e=vE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<kr.length&&e!==0&&e<kr[n].priority;n++);kr.splice(n,0,t),n===0&&bE(t)}};function u0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function of(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Vk(){}function J2(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var l=sh(o);s.call(l)}}var o=VC(e,i,t,0,null,!1,!1,"",Vk);return t._reactRootContainer=o,t[Qi]=o.current,Xc(t.nodeType===8?t.parentNode:t),zs(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var l=sh(c);a.call(l)}}var c=a0(t,0,!1,null,null,!1,!1,"",Vk);return t._reactRootContainer=c,t[Qi]=c.current,Xc(t.nodeType===8?t.parentNode:t),zs(function(){rf(e,c,n,i)}),c}function af(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=sh(o);a.call(c)}}rf(e,o,t,r)}else o=J2(n,e,t,r,i);return sh(o)}mE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=pc(e.pendingLanes);n!==0&&(Ry(e,n|1),cn(e,it()),!(_e&6)&&(la=it()+500,os()))}break;case 13:zs(function(){var i=Ji(t,1);if(i!==null){var r=Jt();Jn(i,t,1,r)}}),c0(t,1)}};xy=function(t){if(t.tag===13){var e=Ji(t,134217728);if(e!==null){var n=Jt();Jn(e,t,134217728,n)}c0(t,134217728)}};gE=function(t){if(t.tag===13){var e=Vr(t),n=Ji(t,e);if(n!==null){var i=Jt();Jn(n,t,e,i)}c0(t,e)}};vE=function(){return Ie};yE=function(t,e){var n=Ie;try{return Ie=t,e()}finally{Ie=n}};rg=function(t,e,n){switch(e){case"input":if(Ym(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=Jh(i);if(!r)throw Error(K(90));Q1(i),Ym(i,r)}}}break;case"textarea":Y1(t,n);break;case"select":e=n.value,e!=null&&Mo(t,!!n.multiple,e,!1)}};rE=i0;sE=zs;var Y2={usingClientEntryPoint:!1,Events:[Al,Io,Jh,nE,iE,i0]},rc={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},X2={bundleType:rc.bundleType,version:rc.version,rendererPackageName:rc.rendererPackageName,rendererConfig:rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=cE(t),t===null?null:t.stateNode},findFiberByHostInstance:rc.findFiberByHostInstance||Q2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nu.isDisabled&&Nu.supportsFiber)try{Wh=Nu.inject(X2),bi=Nu}catch{}}Cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y2;Cn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u0(e))throw Error(K(200));return G2(t,e,null,n)};Cn.createRoot=function(t,e){if(!u0(t))throw Error(K(299));var n=!1,i="",r=jC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=a0(t,1,!1,null,null,n,!1,i,r),t[Qi]=e.current,Xc(t.nodeType===8?t.parentNode:t),new l0(e)};Cn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=cE(e),t=t===null?null:t.stateNode,t};Cn.flushSync=function(t){return zs(t)};Cn.hydrate=function(t,e,n){if(!of(e))throw Error(K(200));return af(null,t,e,!0,n)};Cn.hydrateRoot=function(t,e,n){if(!u0(t))throw Error(K(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=jC;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=VC(e,null,t,1,n??null,r,!1,s,o),t[Qi]=e.current,Xc(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new sf(e)};Cn.render=function(t,e,n){if(!of(e))throw Error(K(200));return af(null,t,e,!1,n)};Cn.unmountComponentAtNode=function(t){if(!of(t))throw Error(K(40));return t._reactRootContainer?(zs(function(){af(null,null,t,!1,function(){t._reactRootContainer=null,t[Qi]=null})}),!0):!1};Cn.unstable_batchedUpdates=i0;Cn.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!of(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return af(t,e,n,!1,i)};Cn.version="18.3.1-next-f1338f8080-20240426";function $C(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($C)}catch(t){console.error(t)}}$C(),$1.exports=Cn;var BC=$1.exports;const Z2=gy(BC);var zC,jk=BC;zC=jk.createRoot,jk.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function al(){return al=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},al.apply(this,arguments)}var Rr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Rr||(Rr={}));const $k="popstate";function eL(t){t===void 0&&(t={});function e(i,r){let{pathname:s,search:o,hash:a}=i.location;return Ug("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:HC(r)}return nL(e,n,null,t)}function ct(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qC(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tL(){return Math.random().toString(36).substr(2,8)}function Bk(t,e){return{usr:t.state,key:t.key,idx:e}}function Ug(t,e,n,i){return n===void 0&&(n=null),al({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ea(e):e,{state:n,key:e&&e.key||i||tL()})}function HC(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Ea(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function nL(t,e,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=Rr.Pop,c=null,l=u();l==null&&(l=0,o.replaceState(al({},o.state,{idx:l}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Rr.Pop;let T=u(),v=T==null?null:T-l;l=T,c&&c({action:a,location:y.location,delta:v})}function f(T,v){a=Rr.Push;let w=Ug(y.location,T,v);l=u()+1;let S=Bk(w,l),P=y.createHref(w);try{o.pushState(S,"",P)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;r.location.assign(P)}s&&c&&c({action:a,location:y.location,delta:1})}function g(T,v){a=Rr.Replace;let w=Ug(y.location,T,v);l=u();let S=Bk(w,l),P=y.createHref(w);o.replaceState(S,"",P),s&&c&&c({action:a,location:y.location,delta:0})}function b(T){let v=r.location.origin!=="null"?r.location.origin:r.location.href,w=typeof T=="string"?T:HC(T);return w=w.replace(/ $/,"%20"),ct(v,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,v)}let y={get action(){return a},get location(){return t(r,o)},listen(T){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener($k,h),c=T,()=>{r.removeEventListener($k,h),c=null}},createHref(T){return e(r,T)},createURL:b,encodeLocation(T){let v=b(T);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:g,go(T){return o.go(T)}};return y}var zk;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(zk||(zk={}));function iL(t,e,n){return n===void 0&&(n="/"),rL(t,e,n,!1)}function rL(t,e,n,i){let r=typeof e=="string"?Ea(e):e,s=GC(r.pathname||"/",n);if(s==null)return null;let o=WC(t);sL(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let l=gL(s);a=pL(o[c],l,i)}return a}function WC(t,e,n,i){e===void 0&&(e=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(s,o,a)=>{let c={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(ct(c.relativePath.startsWith(i),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(i.length));let l=Ps([i,c.relativePath]),u=n.concat(c);s.children&&s.children.length>0&&(ct(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),WC(s.children,e,u,l)),!(s.path==null&&!s.index)&&e.push({path:l,score:hL(l,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let c of KC(s.path))r(s,o,c)}),e}function KC(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=KC(i.join("/")),a=[];return a.push(...o.map(c=>c===""?s:[s,c].join("/"))),r&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function sL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:fL(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const oL=/^:[\w-]+$/,aL=3,cL=2,lL=1,uL=10,dL=-2,qk=t=>t==="*";function hL(t,e){let n=t.split("/"),i=n.length;return n.some(qk)&&(i+=dL),e&&(i+=cL),n.filter(r=>!qk(r)).reduce((r,s)=>r+(oL.test(s)?aL:s===""?lL:uL),i)}function fL(t,e){return t.length===e.length&&t.slice(0,-1).every((i,r)=>i===e[r])?t[t.length-1]-e[e.length-1]:0}function pL(t,e,n){let{routesMeta:i}=t,r={},s="/",o=[];for(let a=0;a<i.length;++a){let c=i[a],l=a===i.length-1,u=s==="/"?e:e.slice(s.length)||"/",h=Hk({path:c.relativePath,caseSensitive:c.caseSensitive,end:l},u),f=c.route;if(!h&&l&&n&&!i[i.length-1].route.index&&(h=Hk({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:Ps([s,h.pathname]),pathnameBase:TL(Ps([s,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(s=Ps([s,h.pathnameBase]))}return o}function Hk(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=mL(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((l,u,h)=>{let{paramName:f,isOptional:g}=u;if(f==="*"){let y=a[h]||"";o=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const b=a[h];return g&&!b?l[f]=void 0:l[f]=(b||"").replace(/%2F/g,"/"),l},{}),pathname:s,pathnameBase:o,pattern:t}}function mL(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),qC(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(i.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function gL(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qC(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function GC(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}function vL(t,e){e===void 0&&(e="/");let{pathname:n,search:i="",hash:r=""}=typeof t=="string"?Ea(t):t;return{pathname:n?n.startsWith("/")?n:yL(n,e):e,search:kL(i),hash:wL(r)}}function yL(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Zp(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function bL(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function QC(t,e){let n=bL(t);return e?n.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function JC(t,e,n,i){i===void 0&&(i=!1);let r;typeof t=="string"?r=Ea(t):(r=al({},t),ct(!r.pathname||!r.pathname.includes("?"),Zp("?","pathname","search",r)),ct(!r.pathname||!r.pathname.includes("#"),Zp("#","pathname","hash",r)),ct(!r.search||!r.search.includes("#"),Zp("#","search","hash",r)));let s=t===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!i&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;r.pathname=f.join("/")}a=h>=0?e[h]:"/"}let c=vL(r,a),l=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const Ps=t=>t.join("/").replace(/\/\/+/g,"/"),TL=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),kL=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,wL=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function _L(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const YC=["post","put","patch","delete"];new Set(YC);const SL=["get",...YC];new Set(SL);/**
 * React Router v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cl(){return cl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},cl.apply(this,arguments)}const d0=m.createContext(null),EL=m.createContext(null),Ol=m.createContext(null),cf=m.createContext(null),or=m.createContext({outlet:null,matches:[],isDataRoute:!1}),XC=m.createContext(null);function Dl(){return m.useContext(cf)!=null}function h0(){return Dl()||ct(!1),m.useContext(cf).location}function ZC(t){m.useContext(Ol).static||m.useLayoutEffect(t)}function as(){let{isDataRoute:t}=m.useContext(or);return t?$L():CL()}function CL(){Dl()||ct(!1);let t=m.useContext(d0),{basename:e,future:n,navigator:i}=m.useContext(Ol),{matches:r}=m.useContext(or),{pathname:s}=h0(),o=JSON.stringify(QC(r,n.v7_relativeSplatPath)),a=m.useRef(!1);return ZC(()=>{a.current=!0}),m.useCallback(function(l,u){if(u===void 0&&(u={}),!a.current)return;if(typeof l=="number"){i.go(l);return}let h=JC(l,JSON.parse(o),s,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ps([e,h.pathname])),(u.replace?i.replace:i.push)(h,u.state,u)},[e,i,o,s,t])}const IL=m.createContext(null);function PL(t){let e=m.useContext(or).outlet;return e&&m.createElement(IL.Provider,{value:t},e)}function RL(){let{matches:t}=m.useContext(or),e=t[t.length-1];return e?e.params:{}}function xL(t,e){return AL(t,e)}function AL(t,e,n,i){Dl()||ct(!1);let{navigator:r}=m.useContext(Ol),{matches:s}=m.useContext(or),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let l=h0(),u;if(e){var h;let T=typeof e=="string"?Ea(e):e;c==="/"||(h=T.pathname)!=null&&h.startsWith(c)||ct(!1),u=T}else u=l;let f=u.pathname||"/",g=f;if(c!=="/"){let T=c.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(T.length).join("/")}let b=iL(t,{pathname:g}),y=ML(b&&b.map(T=>Object.assign({},T,{params:Object.assign({},a,T.params),pathname:Ps([c,r.encodeLocation?r.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?c:Ps([c,r.encodeLocation?r.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),s,n,i);return e&&y?m.createElement(cf.Provider,{value:{location:cl({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Rr.Pop}},y):y}function NL(){let t=jL(),e=_L(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),n?m.createElement("pre",{style:r},n):null,null)}const OL=m.createElement(NL,null);class DL extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?m.createElement(or.Provider,{value:this.props.routeContext},m.createElement(XC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LL(t){let{routeContext:e,match:n,children:i}=t,r=m.useContext(d0);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),m.createElement(or.Provider,{value:e},i)}function ML(t,e,n,i){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),i===void 0&&(i=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=i)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||ct(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,l=-1;if(n&&i&&i.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(l=u),h.route.id){let{loaderData:f,errors:g}=n,b=h.route.loader&&f[h.route.id]===void 0&&(!g||g[h.route.id]===void 0);if(h.route.lazy||b){c=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let g,b=!1,y=null,T=null;n&&(g=a&&h.route.id?a[h.route.id]:void 0,y=h.route.errorElement||OL,c&&(l<0&&f===0?(b=!0,T=null):l===f&&(b=!0,T=h.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),w=()=>{let S;return g?S=y:b?S=T:h.route.Component?S=m.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=u,m.createElement(LL,{match:h,routeContext:{outlet:u,matches:v,isDataRoute:n!=null},children:S})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?m.createElement(DL,{location:n.location,revalidation:n.revalidation,component:y,error:g,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):w()},null)}var eI=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(eI||{}),oh=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(oh||{});function UL(t){let e=m.useContext(d0);return e||ct(!1),e}function FL(t){let e=m.useContext(EL);return e||ct(!1),e}function VL(t){let e=m.useContext(or);return e||ct(!1),e}function tI(t){let e=VL(),n=e.matches[e.matches.length-1];return n.route.id||ct(!1),n.route.id}function jL(){var t;let e=m.useContext(XC),n=FL(oh.UseRouteError),i=tI(oh.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[i]}function $L(){let{router:t}=UL(eI.UseNavigateStable),e=tI(oh.UseNavigateStable),n=m.useRef(!1);return ZC(()=>{n.current=!0}),m.useCallback(function(r,s){s===void 0&&(s={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,cl({fromRouteId:e},s)))},[t,e])}const Wk={};function BL(t,e){Wk[e]||(Wk[e]=!0,console.warn(e))}const Kk=(t,e,n)=>BL(t,"⚠️ React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function zL(t,e){(t==null?void 0:t.v7_startTransition)===void 0&&Kk("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(t==null?void 0:t.v7_relativeSplatPath)===void 0&&!e&&Kk("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function nI(t){let{to:e,replace:n,state:i,relative:r}=t;Dl()||ct(!1);let{future:s,static:o}=m.useContext(Ol),{matches:a}=m.useContext(or),{pathname:c}=h0(),l=as(),u=JC(e,QC(a,s.v7_relativeSplatPath),c,r==="path"),h=JSON.stringify(u);return m.useEffect(()=>l(JSON.parse(h),{replace:n,state:i,relative:r}),[l,h,r,n,i]),null}function qL(t){return PL(t.context)}function di(t){ct(!1)}function HL(t){let{basename:e="/",children:n=null,location:i,navigationType:r=Rr.Pop,navigator:s,static:o=!1,future:a}=t;Dl()&&ct(!1);let c=e.replace(/^\/*/,"/"),l=m.useMemo(()=>({basename:c,navigator:s,static:o,future:cl({v7_relativeSplatPath:!1},a)}),[c,a,s,o]);typeof i=="string"&&(i=Ea(i));let{pathname:u="/",search:h="",hash:f="",state:g=null,key:b="default"}=i,y=m.useMemo(()=>{let T=GC(u,c);return T==null?null:{location:{pathname:T,search:h,hash:f,state:g,key:b},navigationType:r}},[c,u,h,f,g,b,r]);return y==null?null:m.createElement(Ol.Provider,{value:l},m.createElement(cf.Provider,{children:n,value:y}))}function WL(t){let{children:e,location:n}=t;return xL(Fg(e),n)}new Promise(()=>{});function Fg(t,e){e===void 0&&(e=[]);let n=[];return m.Children.forEach(t,(i,r)=>{if(!m.isValidElement(i))return;let s=[...e,r];if(i.type===m.Fragment){n.push.apply(n,Fg(i.props.children,s));return}i.type!==di&&ct(!1),!i.props.index||!i.props.children||ct(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=Fg(i.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const KL="6";try{window.__reactRouterVersion=KL}catch{}const GL="startTransition",Gk=BO[GL];function QL(t){let{basename:e,children:n,future:i,window:r}=t,s=m.useRef();s.current==null&&(s.current=eL({window:r,v5Compat:!0}));let o=s.current,[a,c]=m.useState({action:o.action,location:o.location}),{v7_startTransition:l}=i||{},u=m.useCallback(h=>{l&&Gk?Gk(()=>c(h)):c(h)},[c,l]);return m.useLayoutEffect(()=>o.listen(u),[o,u]),m.useEffect(()=>zL(i),[i]),m.createElement(HL,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:i})}var Qk;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Qk||(Qk={}));var Jk;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Jk||(Jk={}));const iI=m.createContext(null);function JL({children:t}){const[e,n]=m.useState(null),i=m.useCallback((o,a)=>o==="user"&&a==="Useruser"?(n({id:"default_userId",name:"default_userName",email:"default_userEmail",preferences:{emailNotifications:!1,systemAlerts:!1,darkMode:!1}}),!0):!1,[]),r=m.useCallback(()=>{n(null)},[]),s=m.useCallback(o=>{const a={id:o.uid,name:o.displayName||"",email:o.email||"",avatarUrl:o.photoURL||"",preferences:{emailNotifications:!1,systemAlerts:!1,darkMode:!1}};n(a)},[]);return I.jsx(iI.Provider,{value:{user:e,setGoogleUser:s,login:i,logout:r},children:t})}function cs(){const t=m.useContext(iI);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}const rI=m.createContext(null);function YL({children:t}){const[e,n]=m.useState(()=>typeof window>"u"?!1:document.documentElement.classList.contains("dark"));m.useEffect(()=>{e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[e]);const i=()=>{n(r=>!r)};return I.jsx(rI.Provider,{value:{isDarkMode:e,toggleDarkMode:i},children:t})}function XL(){const t=m.useContext(rI);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}function ZL({children:t}){const{user:e}=cs();return e?I.jsx(I.Fragment,{children:t}):I.jsx(nI,{to:"/login",replace:!0})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Oe=(t,e)=>{const n=m.forwardRef(({color:i="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:c,...l},u)=>m.createElement("svg",{ref:u,...eM,width:r,height:r,stroke:i,strokeWidth:o?Number(s)*24/Number(r):s,className:["lucide",`lucide-${tM(t)}`,a].join(" "),...l},[...e.map(([h,f])=>m.createElement(h,f)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=Oe("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=Oe("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=Oe("ArrowLeftToLine",[["path",{d:"M3 19V5",key:"rwsyhb"}],["path",{d:"m13 6-6 6 6 6",key:"1yhaz7"}],["path",{d:"M7 12h14",key:"uoisry"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=Oe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=Oe("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=Oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=Oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=Oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=Oe("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=Oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=Oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=Oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=Oe("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=Oe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=Oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mM=Oe("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=Oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=Oe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=Oe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=Oe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TM=Oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kM=Oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wM=Oe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=Oe("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=Oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SM=Oe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ch=Oe("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),EM=(t,e,n,i)=>{var s,o,a,c;const r=[n,{code:e,...i||{}}];if((o=(s=t==null?void 0:t.services)==null?void 0:s.logger)!=null&&o.forward)return t.services.logger.forward(r,"warn","react-i18next::",!0);Rs(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(c=(a=t==null?void 0:t.services)==null?void 0:a.logger)!=null&&c.warn?t.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},Yk={},$g=(t,e,n,i)=>{Rs(n)&&Yk[n]||(Rs(n)&&(Yk[n]=new Date),EM(t,e,n,i))},sI=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},Bg=(t,e,n)=>{t.loadNamespaces(e,sI(t,n))},Xk=(t,e,n,i)=>{if(Rs(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return Bg(t,n,i);n.forEach(r=>{t.options.ns.indexOf(r)<0&&t.options.ns.push(r)}),t.loadLanguages(e,sI(t,i))},CM=(t,e,n={})=>!e.languages||!e.languages.length?($g(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(i,r)=>{var s;if(((s=n.bindI18n)==null?void 0:s.indexOf("languageChanging"))>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!r(i.isLanguageChangingTo,t))return!1}}),Rs=t=>typeof t=="string",IM=t=>typeof t=="object"&&t!==null,PM=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,RM={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},xM=t=>RM[t],AM=t=>t.replace(PM,xM);let zg={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:AM};const NM=(t={})=>{zg={...zg,...t}},OM=()=>zg;let oI;const DM=t=>{oI=t},LM=()=>oI,MM={type:"3rdParty",init(t){NM(t.options.react),DM(t)}},UM=m.createContext();class FM{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const VM=(t,e)=>{const n=m.useRef();return m.useEffect(()=>{n.current=t},[t,e]),n.current},aI=(t,e,n,i)=>t.getFixedT(e,n,i),jM=(t,e,n,i)=>m.useCallback(aI(t,e,n,i),[t,e,n,i]),Ri=(t,e={})=>{var P,R,O,E;const{i18n:n}=e,{i18n:i,defaultNS:r}=m.useContext(UM)||{},s=n||i||LM();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new FM),!s){$g(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const _=(x,A)=>Rs(A)?A:IM(A)&&Rs(A.defaultValue)?A.defaultValue:Array.isArray(x)?x[x.length-1]:x,C=[_,{},!1];return C.t=_,C.i18n={},C.ready=!1,C}(P=s.options.react)!=null&&P.wait&&$g(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...OM(),...s.options.react,...e},{useSuspense:a,keyPrefix:c}=o;let l=r||((R=s.options)==null?void 0:R.defaultNS);l=Rs(l)?[l]:l||["translation"],(E=(O=s.reportNamespaces).addUsedNamespaces)==null||E.call(O,l);const u=(s.isInitialized||s.initializedStoreOnce)&&l.every(_=>CM(_,s,o)),h=jM(s,e.lng||null,o.nsMode==="fallback"?l:l[0],c),f=()=>h,g=()=>aI(s,e.lng||null,o.nsMode==="fallback"?l:l[0],c),[b,y]=m.useState(f);let T=l.join();e.lng&&(T=`${e.lng}${T}`);const v=VM(T),w=m.useRef(!0);m.useEffect(()=>{const{bindI18n:_,bindI18nStore:C}=o;w.current=!0,!u&&!a&&(e.lng?Xk(s,e.lng,l,()=>{w.current&&y(g)}):Bg(s,l,()=>{w.current&&y(g)})),u&&v&&v!==T&&w.current&&y(g);const x=()=>{w.current&&y(g)};return _&&(s==null||s.on(_,x)),C&&(s==null||s.store.on(C,x)),()=>{w.current=!1,s&&(_==null||_.split(" ").forEach(A=>s.off(A,x))),C&&s&&C.split(" ").forEach(A=>s.store.off(A,x))}},[s,T]),m.useEffect(()=>{w.current&&u&&y(f)},[s,c,u]);const S=[b,s,u];if(S.t=b,S.i18n=s,S.ready=u,u||!u&&!a)return S;throw new Promise(_=>{e.lng?Xk(s,e.lng,l,()=>_()):Bg(s,l,()=>_())})};function $M(){const t=as(),{logout:e}=cs(),{t:n,i18n:i}=Ri(),[r,s]=m.useState(localStorage.getItem("language")||"en"),[o,a]=m.useState(!1);m.useEffect(()=>{i.changeLanguage(r)},[i,r]);const c=()=>{e(),t("/")},l=[{icon:I.jsx(hM,{className:"w-5 h-5"}),label:n("meetingNotes"),path:"/dashboard"},{icon:I.jsx(jg,{className:"w-5 h-5"}),label:n("upload_meeting"),path:"/dashboard/upload"},{icon:I.jsx(ch,{className:"w-5 h-5"}),label:n("new_meeting"),path:"/dashboard/meeting"}],u=()=>{t("/dashboard/profile")},h=()=>{a(!o)};return I.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[I.jsx("div",{className:`w-${o?"20":"64"} bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 relative`,children:I.jsxs("div",{className:"flex flex-col h-full",children:[I.jsx("div",{className:"p-4 flex flex-col space-y-4",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("h1",{className:`${o?"hidden":"text-xl"} font-semibold text-gray-900 dark:text-white`,children:n("dashboard")}),I.jsx("div",{onClick:h,className:"cursor-pointer transform translate-x-2 text-gray-700 dark:text-gray-200 p-2 rounded-full bg-white dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-300 flex justify-center items-center",children:o?I.jsx(nM,{className:"w-5 h-5 "}):I.jsx(rM,{className:"w-5 h-5 rounded-lg"})})]})}),I.jsx("nav",{className:"flex-1 p-4",children:I.jsx("ul",{className:"space-y-2",children:l.map(f=>I.jsx("li",{children:I.jsxs("button",{onClick:()=>t(f.path),className:"w-full flex items-center space-x-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[f.icon,!o&&I.jsx("span",{children:f.label})]})},f.path))})}),I.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:I.jsxs("button",{onClick:u,className:"w-full flex items-center space-x-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[I.jsx(kM,{className:"w-5 h-5"}),!o&&I.jsx("span",{children:n("profile")})]})}),I.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:I.jsxs("button",{onClick:c,className:"w-full flex items-center space-x-3 px-4 py-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/50 rounded-lg transition-colors",children:[I.jsx(gM,{className:"w-5 h-5"}),!o&&I.jsx("span",{children:n("logout")})]})})]})}),I.jsx("div",{className:"flex-1 overflow-auto",children:I.jsx("main",{className:"p-8",children:I.jsx(qL,{})})})]})}function BM(){const t=m.useRef(null);return m.useEffect(()=>{const e=()=>{if(t.current){const n=window.scrollY;t.current.style.transform=`translateY(${n*.5}px)`}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),I.jsxs("div",{className:"relative h-screen overflow-hidden",children:[I.jsx("div",{ref:t,className:"absolute inset-0 z-0",style:{backgroundImage:"url(https://images.unsplash.com/photo-1557804506-669a67965ba0?auto=format&fit=crop&q=80)",backgroundSize:"cover",backgroundPosition:"center",transform:"translateZ(0)"}}),I.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/60 to-black/30"})]})}var qg=new Map,Ou=new WeakMap,Zk=0,zM=void 0;function qM(t){return t?(Ou.has(t)||(Zk+=1,Ou.set(t,Zk.toString())),Ou.get(t)):"0"}function HM(t){return Object.keys(t).sort().filter(e=>t[e]!==void 0).map(e=>`${e}_${e==="root"?qM(t.root):t[e]}`).toString()}function WM(t){const e=HM(t);let n=qg.get(e);if(!n){const i=new Map;let r;const s=new IntersectionObserver(o=>{o.forEach(a=>{var c;const l=a.isIntersecting&&r.some(u=>a.intersectionRatio>=u);t.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=l),(c=i.get(a.target))==null||c.forEach(u=>{u(l,a)})})},t);r=s.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),n={id:e,observer:s,elements:i},qg.set(e,n)}return n}function KM(t,e,n={},i=zM){if(typeof window.IntersectionObserver>"u"&&i!==void 0){const c=t.getBoundingClientRect();return e(i,{isIntersecting:i,target:t,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:c,intersectionRect:c,rootBounds:c}),()=>{}}const{id:r,observer:s,elements:o}=WM(n),a=o.get(t)||[];return o.has(t)||o.set(t,a),a.push(e),s.observe(t),function(){a.splice(a.indexOf(e),1),a.length===0&&(o.delete(t),s.unobserve(t)),o.size===0&&(s.disconnect(),qg.delete(r))}}function GM({threshold:t,delay:e,trackVisibility:n,rootMargin:i,root:r,triggerOnce:s,skip:o,initialInView:a,fallbackInView:c,onChange:l}={}){var u;const[h,f]=m.useState(null),g=m.useRef(l),[b,y]=m.useState({inView:!!a,entry:void 0});g.current=l,m.useEffect(()=>{if(o||!h)return;let S;return S=KM(h,(P,R)=>{y({inView:P,entry:R}),g.current&&g.current(P,R),R.isIntersecting&&s&&S&&(S(),S=void 0)},{root:r,rootMargin:i,threshold:t,trackVisibility:n,delay:e},c),()=>{S&&S()}},[Array.isArray(t)?t.toString():t,h,r,i,s,o,n,c,e]);const T=(u=b.entry)==null?void 0:u.target,v=m.useRef(void 0);!h&&T&&!s&&!o&&v.current!==T&&(v.current=T,y({inView:!!a,entry:void 0}));const w=[f,b.inView,b.entry];return w.ref=w[0],w.inView=w[1],w.entry=w[2],w}function QM(...t){return t.filter(Boolean).join(" ")}function Du({icon:t,title:e,description:n,delay:i=0}){const{ref:r,inView:s}=GM({triggerOnce:!0,threshold:.1});return I.jsxs("div",{ref:r,className:QM("text-center transform transition-all duration-700",s?"opacity-100 translate-y-0":"opacity-0 translate-y-8"),style:{transitionDelay:`${i}ms`},children:[I.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-indigo-100 text-indigo-600 mb-6",children:t}),I.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:e}),I.jsx("p",{className:"text-gray-600",children:n})]})}function em({number:t,title:e,description:n}){return I.jsxs("div",{className:"relative p-6 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[I.jsx("div",{className:"absolute -top-4 left-6 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:t}),I.jsx("h3",{className:"text-xl font-semibold text-gray-900 mt-4 mb-4",children:e}),I.jsx("p",{className:"text-gray-600",children:n})]})}function JM(){const t=as(),{t:e}=Ri();return I.jsx("footer",{className:"bg-gray-900 text-gray-400 py-12",children:I.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center space-x-2 text-white mb-4",children:[I.jsx(ch,{className:"w-6 h-6"}),I.jsx("span",{className:"text-xl font-semibold",children:e("footer.title")})]}),I.jsx("p",{className:"text-sm",children:e("footer.description")})]}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-white font-semibold mb-4",children:e("footer.quickLinks")}),I.jsxs("ul",{className:"space-y-2",children:[I.jsx("li",{children:I.jsx("button",{onClick:()=>t("/login"),className:"hover:text-white transition-colors",children:e("footer.login")})}),I.jsx("li",{children:I.jsx("button",{onClick:()=>t("/login"),className:"hover:text-white transition-colors",children:e("footer.signUp")})})]})]}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-white font-semibold mb-4",children:e("footer.legal")}),I.jsxs("ul",{className:"space-y-2",children:[I.jsx("li",{children:I.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:e("footer.privacyPolicy")})}),I.jsx("li",{children:I.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:e("footer.termsOfService")})})]})]})]}),I.jsx("div",{className:"border-t border-gray-800 mt-12 pt-8 text-center text-sm",children:I.jsxs("p",{children:["© ",new Date().getFullYear()," ",e("footer.title"),". ",e("footer.copyright")]})})]})})}var ew={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},YM=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},lI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){const s=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,l=c?t[r+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|l>>6,g=l&63;c||(g=64,o||(f=64)),i.push(n[u],n[h],n[f],n[g])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):YM(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){const s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const l=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||l==null||h==null)throw new XM;const f=s<<2|a>>4;if(i.push(f),l!==64){const g=a<<4&240|l>>2;if(i.push(g),h!==64){const b=l<<6&192|h;i.push(b)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZM=function(t){const e=cI(t);return lI.encodeByteArray(e,!0)},lh=function(t){return ZM(t).replace(/\./g,"")},uI=function(t){try{return lI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5=()=>e5().__FIREBASE_DEFAULTS__,n5=()=>{if(typeof process>"u"||typeof ew>"u")return;const t=ew.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},i5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&uI(t[1]);return e&&JSON.parse(e)},lf=()=>{try{return t5()||n5()||i5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},dI=t=>{var e,n;return(n=(e=lf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},hI=t=>{const e=dI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},fI=()=>{var t;return(t=lf())===null||t===void 0?void 0:t.config},pI=t=>{var e;return(e=lf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[lh(JSON.stringify(n)),lh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function o5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zt())}function a5(){var t;const e=(t=lf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function c5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function l5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function u5(){const t=zt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function d5(){return!a5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gI(){try{return typeof indexedDB=="object"}catch{return!1}}function vI(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function h5(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5="FirebaseError";class si extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=f5,Object.setPrototypeOf(this,si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,to.prototype.create)}}class to{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?p5(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new si(r,a,i)}}function p5(t,e){return t.replace(m5,(n,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const m5=/\{\$([^}]+)}/g;function g5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ll(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const s=t[r],o=e[r];if(tw(s)&&tw(o)){if(!ll(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function tw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function v5(t,e){const n=new y5(t,e);return n.subscribe.bind(n)}class y5{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let r;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");b5(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:i},r.next===void 0&&(r.next=tm),r.error===void 0&&(r.error=tm),r.complete===void 0&&(r.complete=tm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function b5(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function tm(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T5=1e3,k5=2,w5=4*60*60*1e3,_5=.5;function nw(t,e=T5,n=k5){const i=e*Math.pow(n,t),r=Math.round(_5*i*(Math.random()-.5)*2);return Math.min(w5,i+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t){return t&&t._delegate?t._delegate:t}class Mn{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new r5;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(C5(e))try{this.getOrInitializeService({instanceIdentifier:vs})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=vs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vs){return this.instances.has(e)}getOptions(e=vs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,n){var i;const r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:E5(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=vs){return this.component?this.component.multipleInstances?e:vs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function E5(t){return t===vs?void 0:t}function C5(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new S5(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(me||(me={}));const P5={debug:me.DEBUG,verbose:me.VERBOSE,info:me.INFO,warn:me.WARN,error:me.ERROR,silent:me.SILENT},R5=me.INFO,x5={[me.DEBUG]:"log",[me.VERBOSE]:"log",[me.INFO]:"info",[me.WARN]:"warn",[me.ERROR]:"error"},A5=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),r=x5[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let uf=class{constructor(e){this.name=e,this._logLevel=R5,this._logHandler=A5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?P5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,me.DEBUG,...e),this._logHandler(this,me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,me.VERBOSE,...e),this._logHandler(this,me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,me.INFO,...e),this._logHandler(this,me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,me.WARN,...e),this._logHandler(this,me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,me.ERROR,...e),this._logHandler(this,me.ERROR,...e)}};const N5=(t,e)=>e.some(n=>t instanceof n);let iw,rw;function O5(){return iw||(iw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function D5(){return rw||(rw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yI=new WeakMap,Hg=new WeakMap,bI=new WeakMap,nm=new WeakMap,f0=new WeakMap;function L5(t){const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n($r(t.result)),r()},o=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&yI.set(n,t)}).catch(()=>{}),f0.set(e,t),e}function M5(t){if(Hg.has(t))return;const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Hg.set(t,e)}let Wg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Hg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $r(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function U5(t){Wg=t(Wg)}function F5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(im(this),e,...n);return bI.set(i,e.sort?e.sort():[e]),$r(i)}:D5().includes(t)?function(...e){return t.apply(im(this),e),$r(yI.get(this))}:function(...e){return $r(t.apply(im(this),e))}}function V5(t){return typeof t=="function"?F5(t):(t instanceof IDBTransaction&&M5(t),N5(t,O5())?new Proxy(t,Wg):t)}function $r(t){if(t instanceof IDBRequest)return L5(t);if(nm.has(t))return nm.get(t);const e=V5(t);return e!==t&&(nm.set(t,e),f0.set(e,t)),e}const im=t=>f0.get(t);function TI(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=$r(o);return i&&o.addEventListener("upgradeneeded",c=>{i($r(o.result),c.oldVersion,c.newVersion,$r(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",l=>r(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const j5=["get","getKey","getAll","getAllKeys","count"],$5=["put","add","delete","clear"],rm=new Map;function sw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rm.get(e))return rm.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=$5.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||j5.includes(n)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let l=c.store;return i&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),r&&c.done]))[0]};return rm.set(e,s),s}U5(t=>({...t,get:(e,n,i)=>sw(e,n)||t.get(e,n,i),has:(e,n)=>!!sw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(z5(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function z5(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kg="@firebase/app",ow="0.10.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=new uf("@firebase/app"),q5="@firebase/app-compat",H5="@firebase/analytics-compat",W5="@firebase/analytics",K5="@firebase/app-check-compat",G5="@firebase/app-check",Q5="@firebase/auth",J5="@firebase/auth-compat",Y5="@firebase/database",X5="@firebase/data-connect",Z5="@firebase/database-compat",e4="@firebase/functions",t4="@firebase/functions-compat",n4="@firebase/installations",i4="@firebase/installations-compat",r4="@firebase/messaging",s4="@firebase/messaging-compat",o4="@firebase/performance",a4="@firebase/performance-compat",c4="@firebase/remote-config",l4="@firebase/remote-config-compat",u4="@firebase/storage",d4="@firebase/storage-compat",h4="@firebase/firestore",f4="@firebase/vertexai",p4="@firebase/firestore-compat",m4="firebase",g4="11.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg="[DEFAULT]",v4={[Kg]:"fire-core",[q5]:"fire-core-compat",[W5]:"fire-analytics",[H5]:"fire-analytics-compat",[G5]:"fire-app-check",[K5]:"fire-app-check-compat",[Q5]:"fire-auth",[J5]:"fire-auth-compat",[Y5]:"fire-rtdb",[X5]:"fire-data-connect",[Z5]:"fire-rtdb-compat",[e4]:"fire-fn",[t4]:"fire-fn-compat",[n4]:"fire-iid",[i4]:"fire-iid-compat",[r4]:"fire-fcm",[s4]:"fire-fcm-compat",[o4]:"fire-perf",[a4]:"fire-perf-compat",[c4]:"fire-rc",[l4]:"fire-rc-compat",[u4]:"fire-gcs",[d4]:"fire-gcs-compat",[h4]:"fire-fst",[p4]:"fire-fst-compat",[f4]:"fire-vertex","fire-js":"fire-js",[m4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Map,y4=new Map,Qg=new Map;function aw(t,e){try{t.container.addComponent(e)}catch(n){Xi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ei(t){const e=t.name;if(Qg.has(e))return Xi.debug(`There were multiple attempts to register component ${e}.`),!1;Qg.set(e,t);for(const n of uh.values())aw(n,t);for(const n of y4.values())aw(n,t);return!0}function ls(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Br=new to("app","Firebase",b4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Mn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Br.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=g4;function kI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Gg,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Br.create("bad-app-name",{appName:String(r)});if(n||(n=fI()),!n)throw Br.create("no-options");const s=uh.get(r);if(s){if(ll(n,s.options)&&ll(i,s.config))return s;throw Br.create("duplicate-app",{appName:r})}const o=new I5(r);for(const c of Qg.values())o.addComponent(c);const a=new T4(n,i,o);return uh.set(r,a),a}function df(t=Gg){const e=uh.get(t);if(!e&&t===Gg&&fI())return kI();if(!e)throw Br.create("no-app",{appName:t});return e}function ln(t,e,n){var i;let r=(i=v4[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xi.warn(a.join(" "));return}ei(new Mn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4="firebase-heartbeat-database",w4=1,ul="firebase-heartbeat-store";let sm=null;function wI(){return sm||(sm=TI(k4,w4,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ul)}catch(n){console.warn(n)}}}}).catch(t=>{throw Br.create("idb-open",{originalErrorMessage:t.message})})),sm}async function _4(t){try{const n=(await wI()).transaction(ul),i=await n.objectStore(ul).get(_I(t));return await n.done,i}catch(e){if(e instanceof si)Xi.warn(e.message);else{const n=Br.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xi.warn(n.message)}}}async function cw(t,e){try{const i=(await wI()).transaction(ul,"readwrite");await i.objectStore(ul).put(e,_I(t)),await i.done}catch(n){if(n instanceof si)Xi.warn(n.message);else{const i=Br.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Xi.warn(i.message)}}}function _I(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=1024,E4=30*24*60*60*1e3;class C4{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new P4(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lw();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=E4}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Xi.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=lw(),{heartbeatsToSend:i,unsentEntries:r}=I4(this._heartbeatsCache.heartbeats),s=lh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Xi.warn(n),""}}}function lw(){return new Date().toISOString().substring(0,10)}function I4(t,e=S4){const n=[];let i=t.slice();for(const r of t){const s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),uw(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),uw(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class P4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gI()?vI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await _4(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return cw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return cw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function uw(t){return lh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R4(t){ei(new Mn("platform-logger",e=>new B5(e),"PRIVATE")),ei(new Mn("heartbeat",e=>new C4(e),"PRIVATE")),ln(Kg,ow,t),ln(Kg,ow,"esm2017"),ln("fire-js","")}R4("");function p0(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function SI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const x4=SI,EI=new to("auth","Firebase",SI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh=new uf("@firebase/auth");function A4(t,...e){dh.logLevel<=me.WARN&&dh.warn(`Auth (${Ca}): ${t}`,...e)}function ad(t,...e){dh.logLevel<=me.ERROR&&dh.error(`Auth (${Ca}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Si(t,...e){throw g0(t,...e)}function Yn(t,...e){return g0(t,...e)}function m0(t,e,n){const i=Object.assign(Object.assign({},x4()),{[e]:n});return new to("auth","Firebase",i).create(e,{appName:t.name})}function xs(t){return m0(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function N4(t,e,n){const i=n;if(!(e instanceof i))throw i.name!==e.constructor.name&&Si(t,"argument-error"),m0(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function g0(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return EI.create(t,...e)}function re(t,e,...n){if(!t)throw g0(e,...n)}function qi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ad(e),new Error(e)}function Zi(t,e){t||qi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function O4(){return dw()==="http:"||dw()==="https:"}function dw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(O4()||mI()||"connection"in navigator)?navigator.onLine:!0}function L4(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zi(n>e,"Short delay should be less than long delay!"),this.isMobile=o5()||l5()}get(){return D4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t,e){Zi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U4=new Ml(3e4,6e4);function y0(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ia(t,e,n,i,r={}){return II(t,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=Ll(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l=Object.assign({method:e,headers:c},s);return c5()||(l.referrerPolicy="no-referrer"),CI.fetch()(PI(t,t.config.apiHost,n,a),l)})}async function II(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},M4),e);try{const r=new V4(t),s=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Lu(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Lu(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Lu(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Lu(t,"user-disabled",o);const u=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw m0(t,u,l);Si(t,u)}}catch(r){if(r instanceof si)throw r;Si(t,"network-request-failed",{message:String(r)})}}async function F4(t,e,n,i,r={}){const s=await Ia(t,e,n,i,r);return"mfaPendingCredential"in s&&Si(t,"multi-factor-auth-required",{_serverResponse:s}),s}function PI(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?v0(t.config,r):`${t.config.apiScheme}://${r}`}class V4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Yn(this.auth,"network-request-failed")),U4.get())})}}function Lu(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Yn(t,e,i);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(t,e){return Ia(t,"POST","/v1/accounts:delete",e)}async function RI(t,e){return Ia(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $4(t,e=!1){const n=oi(t),i=await n.getIdToken(e),r=b0(i);re(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:xc(om(r.auth_time)),issuedAtTime:xc(om(r.iat)),expirationTime:xc(om(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function om(t){return Number(t)*1e3}function b0(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return ad("JWT malformed, contained fewer than 3 sections"),null;try{const r=uI(n);return r?JSON.parse(r):(ad("Failed to decode base64 JWT payload"),null)}catch(r){return ad("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function hw(t){const e=b0(t);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof si&&B4(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function B4({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=xc(this.lastLoginAt),this.creationTime=xc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hh(t){var e;const n=t.auth,i=await t.getIdToken(),r=await dl(t,RI(n,{idToken:i}));re(r==null?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?xI(s.providerUserInfo):[],a=H4(t.providerData,o),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Yg(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function q4(t){const e=oi(t);await hh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function H4(t,e){return[...t.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function xI(t){return t.map(e=>{var{providerId:n}=e,i=p0(e,["providerId"]);return{providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W4(t,e){const n=await II(t,{},async()=>{const i=Ll({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=PI(t,r,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",CI.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function K4(t,e){return Ia(t,"POST","/v2/accounts:revokeToken",y0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){re(e.length!==0,"internal-error");const n=hw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:r,expiresIn:s}=await W4(e,n);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:r,expirationTime:s}=n,o=new Bo;return i&&(re(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(re(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(re(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bo,this.toJSON())}_performRefresh(){return qi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t,e){re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Hi{constructor(e){var{uid:n,auth:i,stsTokenManager:r}=e,s=p0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new z4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Yg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await dl(this,this.stsTokenManager.getToken(this.auth,e));return re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return $4(this,e)}reload(){return q4(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Hi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await hh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zi(this.auth.app))return Promise.reject(xs(this.auth));const e=await this.getIdToken();return await dl(this,j4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var i,r,s,o,a,c,l,u;const h=(i=n.displayName)!==null&&i!==void 0?i:void 0,f=(r=n.email)!==null&&r!==void 0?r:void 0,g=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,b=(o=n.photoURL)!==null&&o!==void 0?o:void 0,y=(a=n.tenantId)!==null&&a!==void 0?a:void 0,T=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,v=(l=n.createdAt)!==null&&l!==void 0?l:void 0,w=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:S,emailVerified:P,isAnonymous:R,providerData:O,stsTokenManager:E}=n;re(S&&E,e,"internal-error");const _=Bo.fromJSON(this.name,E);re(typeof S=="string",e,"internal-error"),pr(h,e.name),pr(f,e.name),re(typeof P=="boolean",e,"internal-error"),re(typeof R=="boolean",e,"internal-error"),pr(g,e.name),pr(b,e.name),pr(y,e.name),pr(T,e.name),pr(v,e.name),pr(w,e.name);const C=new Hi({uid:S,auth:e,email:f,emailVerified:P,displayName:h,isAnonymous:R,photoURL:b,phoneNumber:g,tenantId:y,stsTokenManager:_,createdAt:v,lastLoginAt:w});return O&&Array.isArray(O)&&(C.providerData=O.map(x=>Object.assign({},x))),T&&(C._redirectEventId=T),C}static async _fromIdTokenResponse(e,n,i=!1){const r=new Bo;r.updateFromServerResponse(n);const s=new Hi({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await hh(s),s}static async _fromGetAccountInfoResponse(e,n,i){const r=n.users[0];re(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?xI(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new Bo;a.updateFromIdToken(i);const c=new Hi({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Yg(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw=new Map;function Wi(t){Zi(t instanceof Function,"Expected a class definition");let e=fw.get(t);return e?(Zi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,fw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}AI.type="NONE";const pw=AI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t,e,n){return`firebase:${t}:${e}:${n}`}class zo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=cd(this.userKey,r.apiKey,s),this.fullPersistenceKey=cd("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Hi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new zo(Wi(pw),e,i);const r=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let s=r[0]||Wi(pw);const o=cd(i,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=Hi._fromJSON(e,u);l!==s&&(a=h),s=l;break}}catch{}const c=r.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new zo(s,e,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==s)try{await l._remove(o)}catch{}})),new zo(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UI(e))return"Blackberry";if(FI(e))return"Webos";if(OI(e))return"Safari";if((e.includes("chrome/")||DI(e))&&!e.includes("edge/"))return"Chrome";if(MI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function NI(t=zt()){return/firefox\//i.test(t)}function OI(t=zt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function DI(t=zt()){return/crios\//i.test(t)}function LI(t=zt()){return/iemobile/i.test(t)}function MI(t=zt()){return/android/i.test(t)}function UI(t=zt()){return/blackberry/i.test(t)}function FI(t=zt()){return/webos/i.test(t)}function T0(t=zt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function G4(t=zt()){var e;return T0(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Q4(){return u5()&&document.documentMode===10}function VI(t=zt()){return T0(t)||MI(t)||FI(t)||UI(t)||/windows phone/i.test(t)||LI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jI(t,e=[]){let n;switch(t){case"Browser":n=mw(zt());break;case"Worker":n=`${mw(zt())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ca}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});i.onAbort=n,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y4(t,e={}){return Ia(t,"GET","/v2/passwordPolicy",y0(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=6;class Z4{constructor(e){var n,i,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:X4,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,i,r,s,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e,n,i,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gw(this),this.idTokenSubscription=new gw(this),this.beforeStateQueue=new J4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wi(n)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await zo.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await RI(this,{idToken:e}),i=await Hi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(zi(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await hh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=L4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zi(this.app))return Promise.reject(xs(this));const n=e?oi(e):null;return n&&re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zi(this.app)?Promise.reject(xs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zi(this.app)?Promise.reject(xs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Y4(this),n=new Z4(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new to("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await K4(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wi(e)||this._popupRedirectResolver;re(n,this,"argument-error"),this.redirectPersistenceManager=await zo.create(this,[Wi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,r){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(n["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&A4(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function hf(t){return oi(t)}class gw{constructor(e){this.auth=e,this.observer=null,this.addObserver=v5(n=>this.observer=n)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tU(t){k0=t}function nU(t){return k0.loadJS(t)}function iU(){return k0.gapiScript}function rU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sU(t,e){const n=ls(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),s=n.getOptions();if(ll(s,e??{}))return r;Si(r,"already-initialized")}return n.initialize({options:e})}function oU(t,e){const n=(e==null?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Wi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function aU(t,e,n){const i=hf(t);re(i._canInitEmulator,i,"emulator-config-failed"),re(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=$I(e),{host:o,port:a}=cU(e),c=a===null?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),lU()}function $I(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function cU(t){const e=$I(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:vw(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:vw(o)}}}function vw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function lU(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return qi("not implemented")}_getIdTokenResponse(e){return qi("not implemented")}_linkToIdToken(e,n){return qi("not implemented")}_getReauthenticationResolver(e){return qi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qo(t,e){return F4(t,"POST","/v1/accounts:signInWithIdp",y0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU="http://localhost";class qs extends BI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new qs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Si("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=n,s=p0(n,["providerId","signInMethod"]);if(!i||!r)return null;const o=new qs(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return qo(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,qo(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,qo(e,n)}buildRequest(){const e={requestUri:uU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ll(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul extends w0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends Ul{constructor(){super("facebook.com")}static credential(e){return qs._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _r.credential(e.oauthAccessToken)}catch{return null}}}_r.FACEBOOK_SIGN_IN_METHOD="facebook.com";_r.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends Ul{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return qs._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Fi.credential(n,i)}catch{return null}}}Fi.GOOGLE_SIGN_IN_METHOD="google.com";Fi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends Ul{constructor(){super("github.com")}static credential(e){return qs._fromParams({providerId:Sr.PROVIDER_ID,signInMethod:Sr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sr.credentialFromTaggedObject(e)}static credentialFromError(e){return Sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sr.credential(e.oauthAccessToken)}catch{return null}}}Sr.GITHUB_SIGN_IN_METHOD="github.com";Sr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er extends Ul{constructor(){super("twitter.com")}static credential(e,n){return qs._fromParams({providerId:Er.PROVIDER_ID,signInMethod:Er.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Er.credentialFromTaggedObject(e)}static credentialFromError(e){return Er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Er.credential(n,i)}catch{return null}}}Er.TWITTER_SIGN_IN_METHOD="twitter.com";Er.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,r=!1){const s=await Hi._fromIdTokenResponse(e,i,r),o=yw(i);return new ua({user:s,providerId:o,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const r=yw(i);return new ua({user:e,providerId:r,_tokenResponse:i,operationType:n})}}function yw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh extends si{constructor(e,n,i,r){var s;super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,fh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,r){return new fh(e,n,i,r)}}function zI(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fh._fromErrorAndOperation(t,s,e,i):s})}async function dU(t,e,n=!1){const i=await dl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ua._forOperation(t,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hU(t,e,n=!1){const{auth:i}=t;if(zi(i.app))return Promise.reject(xs(i));const r="reauthenticate";try{const s=await dl(t,zI(i,r,e,t),n);re(s.idToken,i,"internal-error");const o=b0(s.idToken);re(o,i,"internal-error");const{sub:a}=o;return re(t.uid===a,i,"user-mismatch"),ua._forOperation(t,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Si(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fU(t,e,n=!1){if(zi(t.app))return Promise.reject(xs(t));const i="signIn",r=await zI(t,i,e),s=await ua._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}function pU(t,e,n,i){return oi(t).onIdTokenChanged(e,n,i)}function mU(t,e,n){return oi(t).beforeAuthStateChanged(e,n)}const ph="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ph,"1"),this.storage.removeItem(ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gU=1e3,vU=10;class HI extends qI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=VI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),r=this.localCache[n];i!==r&&e(n,r,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!n&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);Q4()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,vU):r()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},gU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}HI.type="LOCAL";const yU=HI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI extends qI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}WI.type="SESSION";const KI=WI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const i=new ff(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:r,data:s}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async l=>l(n.origin,s)),c=await bU(a);n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ff.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const l=_0("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(h){const f=h;if(f.data.eventId===l)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(){return window}function kU(t){ki().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(){return typeof ki().WorkerGlobalScope<"u"&&typeof ki().importScripts=="function"}async function wU(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _U(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function SU(){return GI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="firebaseLocalStorageDb",EU=1,mh="firebaseLocalStorage",JI="fbase_key";class Fl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function pf(t,e){return t.transaction([mh],e?"readwrite":"readonly").objectStore(mh)}function CU(){const t=indexedDB.deleteDatabase(QI);return new Fl(t).toPromise()}function Xg(){const t=indexedDB.open(QI,EU);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(mh,{keyPath:JI})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(mh)?e(i):(i.close(),await CU(),e(await Xg()))})})}async function bw(t,e,n){const i=pf(t,!0).put({[JI]:e,value:n});return new Fl(i).toPromise()}async function IU(t,e){const n=pf(t,!1).get(e),i=await new Fl(n).toPromise();return i===void 0?null:i.value}function Tw(t,e){const n=pf(t,!0).delete(e);return new Fl(n).toPromise()}const PU=800,RU=3;class YI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>RU)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ff._getInstance(SU()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await wU(),!this.activeServiceWorker)return;this.sender=new TU(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((n=i[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_U()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xg();return await bw(e,ph,"1"),await Tw(e,ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>bw(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>IU(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Tw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=pf(r,!1).getAll();return new Fl(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YI.type="LOCAL";const xU=YI;new Ml(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XI(t,e){return e?Wi(e):(re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0 extends BI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return qo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function AU(t){return fU(t.auth,new S0(t),t.bypassAuthState)}function NU(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),hU(n,new S0(t),t.bypassAuthState)}async function OU(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),dU(n,new S0(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,n,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AU;case"linkViaPopup":case"linkViaRedirect":return OU;case"reauthViaPopup":case"reauthViaRedirect":return NU;default:Si(this.auth,"internal-error")}}resolve(e){Zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DU=new Ml(2e3,1e4);async function LU(t,e,n){if(zi(t.app))return Promise.reject(Yn(t,"operation-not-supported-in-this-environment"));const i=hf(t);N4(t,e,w0);const r=XI(i,n);return new ks(i,"signInViaPopup",e,r).executeNotNull()}class ks extends ZI{constructor(e,n,i,r,s){super(e,n,r,s),this.provider=i,this.authWindow=null,this.pollId=null,ks.currentPopupAction&&ks.currentPopupAction.cancel(),ks.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){Zi(this.filter.length===1,"Popup operations only handle one event");const e=_0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Yn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ks.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,i;if(!((i=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,DU.get())};e()}}ks.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MU="pendingRedirect",ld=new Map;class UU extends ZI{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=ld.get(this.auth._key());if(!e){try{const i=await FU(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}ld.set(this.auth._key(),e)}return this.bypassAuthState||ld.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function FU(t,e){const n=$U(e),i=jU(t);if(!await i._isAvailable())return!1;const r=await i._get(n)==="true";return await i._remove(n),r}function VU(t,e){ld.set(t._key(),e)}function jU(t){return Wi(t._redirectPersistence)}function $U(t){return cd(MU,t.config.apiKey,t.name)}async function BU(t,e,n=!1){if(zi(t.app))return Promise.reject(xs(t));const i=hf(t),r=XI(i,e),o=await new UU(i,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU=10*60*1e3;class qU{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HU(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var i;if(e.error&&!eP(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";n.onError(Yn(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zU&&this.cachedEventUids.clear(),this.cachedEventUids.has(kw(e))}saveEventToCache(e){this.cachedEventUids.add(kw(e)),this.lastProcessedEventTime=Date.now()}}function kw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function eP({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function HU(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eP(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WU(t,e={}){return Ia(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,GU=/^https?/;async function QU(t){if(t.config.emulator)return;const{authorizedDomains:e}=await WU(t);for(const n of e)try{if(JU(n))return}catch{}Si(t,"unauthorized-domain")}function JU(t){const e=Jg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===i}if(!GU.test(n))return!1;if(KU.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YU=new Ml(3e4,6e4);function ww(){const t=ki().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function XU(t){return new Promise((e,n)=>{var i,r,s;function o(){ww(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ww(),n(Yn(t,"network-request-failed"))},timeout:YU.get()})}if(!((r=(i=ki().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=ki().gapi)===null||s===void 0)&&s.load)o();else{const a=rU("iframefcb");return ki()[a]=()=>{gapi.load?o():n(Yn(t,"network-request-failed"))},nU(`${iU()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw ud=null,e})}let ud=null;function ZU(t){return ud=ud||XU(t),ud}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e3=new Ml(5e3,15e3),t3="__/auth/iframe",n3="emulator/auth/iframe",i3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},r3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s3(t){const e=t.config;re(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?v0(e,n3):`https://${t.config.authDomain}/${t3}`,i={apiKey:e.apiKey,appName:t.name,v:Ca},r=r3.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${Ll(i).slice(1)}`}async function o3(t){const e=await ZU(t),n=ki().gapi;return re(n,t,"internal-error"),e.open({where:document.body,url:s3(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:i3,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Yn(t,"network-request-failed"),a=ki().setTimeout(()=>{s(o)},e3.get());function c(){ki().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},c3=500,l3=600,u3="_blank",d3="http://localhost";class _w{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function h3(t,e,n,i=c3,r=l3){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},a3),{width:i.toString(),height:r.toString(),top:s,left:o}),l=zt().toLowerCase();n&&(a=DI(l)?u3:n),NI(l)&&(e=e||d3,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[g,b])=>`${f}${g}=${b},`,"");if(G4(l)&&a!=="_self")return f3(e||"",a),new _w(null);const h=window.open(e||"",a,u);re(h,t,"popup-blocked");try{h.focus()}catch{}return new _w(h)}function f3(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3="__/auth/handler",m3="emulator/auth/handler",g3=encodeURIComponent("fac");async function Sw(t,e,n,i,r,s){re(t.config.authDomain,t,"auth-domain-config-required"),re(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:Ca,eventId:r};if(e instanceof w0){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",g5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof Ul){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const c=await t._getAppCheckToken(),l=c?`#${g3}=${encodeURIComponent(c)}`:"";return`${v3(t)}?${Ll(a).slice(1)}${l}`}function v3({config:t}){return t.emulator?v0(t,m3):`https://${t.authDomain}/${p3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const am="webStorageSupport";class y3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=KI,this._completeRedirectFn=BU,this._overrideRedirectResult=VU}async _openPopup(e,n,i,r){var s;Zi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Sw(e,n,i,Jg(),r);return h3(e,o,_0())}async _openRedirect(e,n,i,r){await this._originValidation(e);const s=await Sw(e,n,i,Jg(),r);return kU(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:s}=this.eventManagers[n];return r?Promise.resolve(r):(Zi(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await o3(e),i=new qU(e);return n.register("authEvent",r=>(re(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(am,{type:am},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[am];o!==void 0&&n(!!o),Si(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=QU(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return VI()||OI()||T0()}}const b3=y3;var Ew="@firebase/auth",Cw="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function w3(t){ei(new Mn("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;re(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jI(t)},l=new eU(i,r,s,c);return oU(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),ei(new Mn("auth-internal",e=>{const n=hf(e.getProvider("auth").getImmediate());return(i=>new T3(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ln(Ew,Cw,k3(t)),ln(Ew,Cw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3=5*60,S3=pI("authIdTokenMaxAge")||_3;let Iw=null;const E3=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>S3)return;const r=n==null?void 0:n.token;Iw!==r&&(Iw=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function C3(t=df()){const e=ls(t,"auth");if(e.isInitialized())return e.getImmediate();const n=sU(t,{popupRedirectResolver:b3,persistence:[xU,yU,KI]}),i=pI("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=E3(s.toString());mU(n,o,()=>o(n.currentUser)),pU(n,a=>o(a))}}const r=dI("auth");return r&&aU(n,`http://${r}`),n}function I3(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}tU({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=r=>{const s=Yn("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",I3().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});w3("Browser");const tP="@firebase/installations",E0="0.6.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP=1e4,iP=`w:${E0}`,rP="FIS_v2",P3="https://firebaseinstallations.googleapis.com/v1",R3=60*60*1e3,x3="installations",A3="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Hs=new to(x3,A3,N3);function sP(t){return t instanceof si&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP({projectId:t}){return`${P3}/projects/${t}/installations`}function aP(t){return{token:t.token,requestStatus:2,expiresIn:D3(t.expiresIn),creationTime:Date.now()}}async function cP(t,e){const i=(await e.json()).error;return Hs.create("request-failed",{requestName:t,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function lP({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function O3(t,{refreshToken:e}){const n=lP(t);return n.append("Authorization",L3(e)),n}async function uP(t){const e=await t();return e.status>=500&&e.status<600?t():e}function D3(t){return Number(t.replace("s","000"))}function L3(t){return`${rP} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M3({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=oP(t),r=lP(t),s=e.getImmediate({optional:!0});if(s){const l=await s.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={fid:n,authVersion:rP,appId:t.appId,sdkVersion:iP},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await uP(()=>fetch(i,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:aP(l.authToken)}}else throw await cP("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dP(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U3(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F3=/^[cdef][\w-]{21}$/,Zg="";function V3(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=j3(t);return F3.test(n)?n:Zg}catch{return Zg}}function j3(t){return U3(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=new Map;function fP(t,e){const n=mf(t);pP(n,e),$3(n,e)}function pP(t,e){const n=hP.get(t);if(n)for(const i of n)i(e)}function $3(t,e){const n=B3();n&&n.postMessage({key:t,fid:e}),z3()}let ws=null;function B3(){return!ws&&"BroadcastChannel"in self&&(ws=new BroadcastChannel("[Firebase] FID Change"),ws.onmessage=t=>{pP(t.data.key,t.data.fid)}),ws}function z3(){hP.size===0&&ws&&(ws.close(),ws=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3="firebase-installations-database",H3=1,Ws="firebase-installations-store";let cm=null;function C0(){return cm||(cm=TI(q3,H3,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ws)}}})),cm}async function gh(t,e){const n=mf(t),r=(await C0()).transaction(Ws,"readwrite"),s=r.objectStore(Ws),o=await s.get(n);return await s.put(e,n),await r.done,(!o||o.fid!==e.fid)&&fP(t,e.fid),e}async function mP(t){const e=mf(t),i=(await C0()).transaction(Ws,"readwrite");await i.objectStore(Ws).delete(e),await i.done}async function gf(t,e){const n=mf(t),r=(await C0()).transaction(Ws,"readwrite"),s=r.objectStore(Ws),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&fP(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I0(t){let e;const n=await gf(t.appConfig,i=>{const r=W3(i),s=K3(t,r);return e=s.registrationPromise,s.installationEntry});return n.fid===Zg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function W3(t){const e=t||{fid:V3(),registrationStatus:0};return gP(e)}function K3(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(Hs.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=G3(t,n);return{installationEntry:n,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Q3(t)}:{installationEntry:e}}async function G3(t,e){try{const n=await M3(t,e);return gh(t.appConfig,n)}catch(n){throw sP(n)&&n.customData.serverCode===409?await mP(t.appConfig):await gh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function Q3(t){let e=await Pw(t.appConfig);for(;e.registrationStatus===1;)await dP(100),e=await Pw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:i}=await I0(t);return i||n}return e}function Pw(t){return gf(t,e=>{if(!e)throw Hs.create("installation-not-found");return gP(e)})}function gP(t){return J3(t)?{fid:t.fid,registrationStatus:0}:t}function J3(t){return t.registrationStatus===1&&t.registrationTime+nP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y3({appConfig:t,heartbeatServiceProvider:e},n){const i=X3(t,n),r=O3(t,n),s=e.getImmediate({optional:!0});if(s){const l=await s.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={installation:{sdkVersion:iP,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await uP(()=>fetch(i,a));if(c.ok){const l=await c.json();return aP(l)}else throw await cP("Generate Auth Token",c)}function X3(t,{fid:e}){return`${oP(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P0(t,e=!1){let n;const i=await gf(t.appConfig,s=>{if(!vP(s))throw Hs.create("not-registered");const o=s.authToken;if(!e&&tF(o))return s;if(o.requestStatus===1)return n=Z3(t,e),s;{if(!navigator.onLine)throw Hs.create("app-offline");const a=iF(s);return n=eF(t,a),a}});return n?await n:i.authToken}async function Z3(t,e){let n=await Rw(t.appConfig);for(;n.authToken.requestStatus===1;)await dP(100),n=await Rw(t.appConfig);const i=n.authToken;return i.requestStatus===0?P0(t,e):i}function Rw(t){return gf(t,e=>{if(!vP(e))throw Hs.create("not-registered");const n=e.authToken;return rF(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function eF(t,e){try{const n=await Y3(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await gh(t.appConfig,i),n}catch(n){if(sP(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await mP(t.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await gh(t.appConfig,i)}throw n}}function vP(t){return t!==void 0&&t.registrationStatus===2}function tF(t){return t.requestStatus===2&&!nF(t)}function nF(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+R3}function iF(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function rF(t){return t.requestStatus===1&&t.requestTime+nP<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sF(t){const e=t,{installationEntry:n,registrationPromise:i}=await I0(e);return i?i.catch(console.error):P0(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oF(t,e=!1){const n=t;return await aF(n),(await P0(n,e)).token}async function aF(t){const{registrationPromise:e}=await I0(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(t){if(!t||!t.options)throw lm("App Configuration");if(!t.name)throw lm("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw lm(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function lm(t){return Hs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="installations",lF="installations-internal",uF=t=>{const e=t.getProvider("app").getImmediate(),n=cF(e),i=ls(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},dF=t=>{const e=t.getProvider("app").getImmediate(),n=ls(e,yP).getImmediate();return{getId:()=>sF(n),getToken:r=>oF(n,r)}};function hF(){ei(new Mn(yP,uF,"PUBLIC")),ei(new Mn(lF,dF,"PRIVATE"))}hF();ln(tP,E0);ln(tP,E0,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh="analytics",fF="firebase_id",pF="origin",mF=60*1e3,gF="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",R0="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un=new uf("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},kn=new to("analytics","Analytics",vF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(t){if(!t.startsWith(R0)){const e=kn.create("invalid-gtag-resource",{gtagURL:t});return un.warn(e.message),""}return t}function bP(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function bF(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function TF(t,e){const n=bF("firebase-js-sdk-policy",{createScriptURL:yF}),i=document.createElement("script"),r=`${R0}?l=${t}&id=${e}`;i.src=n?n==null?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function kF(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function wF(t,e,n,i,r,s){const o=i[r];try{if(o)await e[o];else{const c=(await bP(n)).find(l=>l.measurementId===r);c&&await e[c.appId]}}catch(a){un.error(a)}t("config",r,s)}async function _F(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await bP(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",i,r||{})}catch(s){un.error(s)}}function SF(t,e,n,i){async function r(s,...o){try{if(s==="event"){const[a,c]=o;await _F(t,e,n,a,c)}else if(s==="config"){const[a,c]=o;await wF(t,e,n,i,a,c)}else if(s==="consent"){const[a,c]=o;t("consent",a,c)}else if(s==="get"){const[a,c,l]=o;t("get",a,c,l)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){un.error(a)}}return r}function EF(t,e,n,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=SF(s,t,e,n),{gtagCore:s,wrappedGtag:window[r]}}function CF(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(R0)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=30,PF=1e3;class RF{constructor(e={},n=PF){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const TP=new RF;function xF(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function AF(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:xF(i)},s=gF.replace("{app-id}",n),o=await fetch(s,r);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw kn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function NF(t,e=TP,n){const{appId:i,apiKey:r,measurementId:s}=t.options;if(!i)throw kn.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw kn.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new LF;return setTimeout(async()=>{a.abort()},mF),kP({appId:i,apiKey:r,measurementId:s},o,a,e)}async function kP(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=TP){var s;const{appId:o,measurementId:a}=t;try{await OF(i,e)}catch(c){if(a)return un.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw c}try{const c=await AF(t);return r.deleteThrottleMetadata(o),c}catch(c){const l=c;if(!DF(l)){if(r.deleteThrottleMetadata(o),a)return un.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw c}const u=Number((s=l==null?void 0:l.customData)===null||s===void 0?void 0:s.httpStatus)===503?nw(n,r.intervalMillis,IF):nw(n,r.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(o,h),un.debug(`Calling attemptFetch again in ${u} millis`),kP(t,h,i,r)}}function OF(t,e){return new Promise((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(s),i(kn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function DF(t){if(!(t instanceof si)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class LF{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function MF(t,e,n,i,r){if(r&&r.global){t("event",n,i);return}else{const s=await e,o=Object.assign(Object.assign({},i),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UF(){if(gI())try{await vI()}catch(t){return un.warn(kn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return un.warn(kn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function FF(t,e,n,i,r,s,o){var a;const c=NF(t);c.then(g=>{n[g.measurementId]=g.appId,t.options.measurementId&&g.measurementId!==t.options.measurementId&&un.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>un.error(g)),e.push(c);const l=UF().then(g=>{if(g)return i.getId()}),[u,h]=await Promise.all([c,l]);CF(s)||TF(s,u.measurementId),r("js",new Date);const f=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return f[pF]="firebase",f.update=!0,h!=null&&(f[fF]=h),r("config",u.measurementId,f),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e){this.app=e}_delete(){return delete Ac[this.app.options.appId],Promise.resolve()}}let Ac={},xw=[];const Aw={};let um="dataLayer",jF="gtag",Nw,wP,Ow=!1;function $F(){const t=[];if(mI()&&t.push("This is a browser extension environment."),h5()||t.push("Cookies are not available."),t.length>0){const e=t.map((i,r)=>`(${r+1}) ${i}`).join(" "),n=kn.create("invalid-analytics-context",{errorInfo:e});un.warn(n.message)}}function BF(t,e,n){$F();const i=t.options.appId;if(!i)throw kn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)un.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw kn.create("no-api-key");if(Ac[i]!=null)throw kn.create("already-exists",{id:i});if(!Ow){kF(um);const{wrappedGtag:s,gtagCore:o}=EF(Ac,xw,Aw,um,jF);wP=s,Nw=o,Ow=!0}return Ac[i]=FF(t,xw,Aw,e,Nw,um,n),new VF(t)}function zF(t=df()){t=oi(t);const e=ls(t,vh);return e.isInitialized()?e.getImmediate():qF(t)}function qF(t,e={}){const n=ls(t,vh);if(n.isInitialized()){const r=n.getImmediate();if(ll(e,n.getOptions()))return r;throw kn.create("already-initialized")}return n.initialize({options:e})}function HF(t,e,n,i){t=oi(t),MF(wP,Ac[t.app.options.appId],e,n,i).catch(r=>un.error(r))}const Dw="@firebase/analytics",Lw="0.10.10";function WF(){ei(new Mn(vh,(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return BF(i,r,n)},"PUBLIC")),ei(new Mn("analytics-internal",t,"PRIVATE")),ln(Dw,Lw),ln(Dw,Lw,"esm2017");function t(e){try{const n=e.getProvider(vh).getImmediate();return{logEvent:(i,r,s)=>HF(n,i,r,s)}}catch(n){throw kn.create("interop-component-reg-failed",{reason:n})}}}WF();var KF="firebase",GF="11.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ln(KF,GF,"app");var Mw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var As,_P;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,_){function C(){}C.prototype=_.prototype,E.D=_.prototype,E.prototype=new C,E.prototype.constructor=E,E.C=function(x,A,L){for(var D=Array(arguments.length-2),le=2;le<arguments.length;le++)D[le-2]=arguments[le];return _.prototype[A].apply(x,D)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,n),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(E,_,C){C||(C=0);var x=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)x[A]=_.charCodeAt(C++)|_.charCodeAt(C++)<<8|_.charCodeAt(C++)<<16|_.charCodeAt(C++)<<24;else for(A=0;16>A;++A)x[A]=_[C++]|_[C++]<<8|_[C++]<<16|_[C++]<<24;_=E.g[0],C=E.g[1],A=E.g[2];var L=E.g[3],D=_+(L^C&(A^L))+x[0]+3614090360&4294967295;_=C+(D<<7&4294967295|D>>>25),D=L+(A^_&(C^A))+x[1]+3905402710&4294967295,L=_+(D<<12&4294967295|D>>>20),D=A+(C^L&(_^C))+x[2]+606105819&4294967295,A=L+(D<<17&4294967295|D>>>15),D=C+(_^A&(L^_))+x[3]+3250441966&4294967295,C=A+(D<<22&4294967295|D>>>10),D=_+(L^C&(A^L))+x[4]+4118548399&4294967295,_=C+(D<<7&4294967295|D>>>25),D=L+(A^_&(C^A))+x[5]+1200080426&4294967295,L=_+(D<<12&4294967295|D>>>20),D=A+(C^L&(_^C))+x[6]+2821735955&4294967295,A=L+(D<<17&4294967295|D>>>15),D=C+(_^A&(L^_))+x[7]+4249261313&4294967295,C=A+(D<<22&4294967295|D>>>10),D=_+(L^C&(A^L))+x[8]+1770035416&4294967295,_=C+(D<<7&4294967295|D>>>25),D=L+(A^_&(C^A))+x[9]+2336552879&4294967295,L=_+(D<<12&4294967295|D>>>20),D=A+(C^L&(_^C))+x[10]+4294925233&4294967295,A=L+(D<<17&4294967295|D>>>15),D=C+(_^A&(L^_))+x[11]+2304563134&4294967295,C=A+(D<<22&4294967295|D>>>10),D=_+(L^C&(A^L))+x[12]+1804603682&4294967295,_=C+(D<<7&4294967295|D>>>25),D=L+(A^_&(C^A))+x[13]+4254626195&4294967295,L=_+(D<<12&4294967295|D>>>20),D=A+(C^L&(_^C))+x[14]+2792965006&4294967295,A=L+(D<<17&4294967295|D>>>15),D=C+(_^A&(L^_))+x[15]+1236535329&4294967295,C=A+(D<<22&4294967295|D>>>10),D=_+(A^L&(C^A))+x[1]+4129170786&4294967295,_=C+(D<<5&4294967295|D>>>27),D=L+(C^A&(_^C))+x[6]+3225465664&4294967295,L=_+(D<<9&4294967295|D>>>23),D=A+(_^C&(L^_))+x[11]+643717713&4294967295,A=L+(D<<14&4294967295|D>>>18),D=C+(L^_&(A^L))+x[0]+3921069994&4294967295,C=A+(D<<20&4294967295|D>>>12),D=_+(A^L&(C^A))+x[5]+3593408605&4294967295,_=C+(D<<5&4294967295|D>>>27),D=L+(C^A&(_^C))+x[10]+38016083&4294967295,L=_+(D<<9&4294967295|D>>>23),D=A+(_^C&(L^_))+x[15]+3634488961&4294967295,A=L+(D<<14&4294967295|D>>>18),D=C+(L^_&(A^L))+x[4]+3889429448&4294967295,C=A+(D<<20&4294967295|D>>>12),D=_+(A^L&(C^A))+x[9]+568446438&4294967295,_=C+(D<<5&4294967295|D>>>27),D=L+(C^A&(_^C))+x[14]+3275163606&4294967295,L=_+(D<<9&4294967295|D>>>23),D=A+(_^C&(L^_))+x[3]+4107603335&4294967295,A=L+(D<<14&4294967295|D>>>18),D=C+(L^_&(A^L))+x[8]+1163531501&4294967295,C=A+(D<<20&4294967295|D>>>12),D=_+(A^L&(C^A))+x[13]+2850285829&4294967295,_=C+(D<<5&4294967295|D>>>27),D=L+(C^A&(_^C))+x[2]+4243563512&4294967295,L=_+(D<<9&4294967295|D>>>23),D=A+(_^C&(L^_))+x[7]+1735328473&4294967295,A=L+(D<<14&4294967295|D>>>18),D=C+(L^_&(A^L))+x[12]+2368359562&4294967295,C=A+(D<<20&4294967295|D>>>12),D=_+(C^A^L)+x[5]+4294588738&4294967295,_=C+(D<<4&4294967295|D>>>28),D=L+(_^C^A)+x[8]+2272392833&4294967295,L=_+(D<<11&4294967295|D>>>21),D=A+(L^_^C)+x[11]+1839030562&4294967295,A=L+(D<<16&4294967295|D>>>16),D=C+(A^L^_)+x[14]+4259657740&4294967295,C=A+(D<<23&4294967295|D>>>9),D=_+(C^A^L)+x[1]+2763975236&4294967295,_=C+(D<<4&4294967295|D>>>28),D=L+(_^C^A)+x[4]+1272893353&4294967295,L=_+(D<<11&4294967295|D>>>21),D=A+(L^_^C)+x[7]+4139469664&4294967295,A=L+(D<<16&4294967295|D>>>16),D=C+(A^L^_)+x[10]+3200236656&4294967295,C=A+(D<<23&4294967295|D>>>9),D=_+(C^A^L)+x[13]+681279174&4294967295,_=C+(D<<4&4294967295|D>>>28),D=L+(_^C^A)+x[0]+3936430074&4294967295,L=_+(D<<11&4294967295|D>>>21),D=A+(L^_^C)+x[3]+3572445317&4294967295,A=L+(D<<16&4294967295|D>>>16),D=C+(A^L^_)+x[6]+76029189&4294967295,C=A+(D<<23&4294967295|D>>>9),D=_+(C^A^L)+x[9]+3654602809&4294967295,_=C+(D<<4&4294967295|D>>>28),D=L+(_^C^A)+x[12]+3873151461&4294967295,L=_+(D<<11&4294967295|D>>>21),D=A+(L^_^C)+x[15]+530742520&4294967295,A=L+(D<<16&4294967295|D>>>16),D=C+(A^L^_)+x[2]+3299628645&4294967295,C=A+(D<<23&4294967295|D>>>9),D=_+(A^(C|~L))+x[0]+4096336452&4294967295,_=C+(D<<6&4294967295|D>>>26),D=L+(C^(_|~A))+x[7]+1126891415&4294967295,L=_+(D<<10&4294967295|D>>>22),D=A+(_^(L|~C))+x[14]+2878612391&4294967295,A=L+(D<<15&4294967295|D>>>17),D=C+(L^(A|~_))+x[5]+4237533241&4294967295,C=A+(D<<21&4294967295|D>>>11),D=_+(A^(C|~L))+x[12]+1700485571&4294967295,_=C+(D<<6&4294967295|D>>>26),D=L+(C^(_|~A))+x[3]+2399980690&4294967295,L=_+(D<<10&4294967295|D>>>22),D=A+(_^(L|~C))+x[10]+4293915773&4294967295,A=L+(D<<15&4294967295|D>>>17),D=C+(L^(A|~_))+x[1]+2240044497&4294967295,C=A+(D<<21&4294967295|D>>>11),D=_+(A^(C|~L))+x[8]+1873313359&4294967295,_=C+(D<<6&4294967295|D>>>26),D=L+(C^(_|~A))+x[15]+4264355552&4294967295,L=_+(D<<10&4294967295|D>>>22),D=A+(_^(L|~C))+x[6]+2734768916&4294967295,A=L+(D<<15&4294967295|D>>>17),D=C+(L^(A|~_))+x[13]+1309151649&4294967295,C=A+(D<<21&4294967295|D>>>11),D=_+(A^(C|~L))+x[4]+4149444226&4294967295,_=C+(D<<6&4294967295|D>>>26),D=L+(C^(_|~A))+x[11]+3174756917&4294967295,L=_+(D<<10&4294967295|D>>>22),D=A+(_^(L|~C))+x[2]+718787259&4294967295,A=L+(D<<15&4294967295|D>>>17),D=C+(L^(A|~_))+x[9]+3951481745&4294967295,E.g[0]=E.g[0]+_&4294967295,E.g[1]=E.g[1]+(A+(D<<21&4294967295|D>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+L&4294967295}i.prototype.u=function(E,_){_===void 0&&(_=E.length);for(var C=_-this.blockSize,x=this.B,A=this.h,L=0;L<_;){if(A==0)for(;L<=C;)r(this,E,L),L+=this.blockSize;if(typeof E=="string"){for(;L<_;)if(x[A++]=E.charCodeAt(L++),A==this.blockSize){r(this,x),A=0;break}}else for(;L<_;)if(x[A++]=E[L++],A==this.blockSize){r(this,x),A=0;break}}this.h=A,this.o+=_},i.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var _=1;_<E.length-8;++_)E[_]=0;var C=8*this.o;for(_=E.length-8;_<E.length;++_)E[_]=C&255,C/=256;for(this.u(E),E=Array(16),_=C=0;4>_;++_)for(var x=0;32>x;x+=8)E[C++]=this.g[_]>>>x&255;return E};function s(E,_){var C=a;return Object.prototype.hasOwnProperty.call(C,E)?C[E]:C[E]=_(E)}function o(E,_){this.h=_;for(var C=[],x=!0,A=E.length-1;0<=A;A--){var L=E[A]|0;x&&L==_||(C[A]=L,x=!1)}this.g=C}var a={};function c(E){return-128<=E&&128>E?s(E,function(_){return new o([_|0],0>_?-1:0)}):new o([E|0],0>E?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return T(l(-E));for(var _=[],C=1,x=0;E>=C;x++)_[x]=E/C|0,C*=4294967296;return new o(_,0)}function u(E,_){if(E.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(E.charAt(0)=="-")return T(u(E.substring(1),_));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=l(Math.pow(_,8)),x=h,A=0;A<E.length;A+=8){var L=Math.min(8,E.length-A),D=parseInt(E.substring(A,A+L),_);8>L?(L=l(Math.pow(_,L)),x=x.j(L).add(l(D))):(x=x.j(C),x=x.add(l(D)))}return x}var h=c(0),f=c(1),g=c(16777216);t=o.prototype,t.m=function(){if(y(this))return-T(this).m();for(var E=0,_=1,C=0;C<this.g.length;C++){var x=this.i(C);E+=(0<=x?x:4294967296+x)*_,_*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(b(this))return"0";if(y(this))return"-"+T(this).toString(E);for(var _=l(Math.pow(E,6)),C=this,x="";;){var A=P(C,_).g;C=v(C,A.j(_));var L=((0<C.g.length?C.g[0]:C.h)>>>0).toString(E);if(C=A,b(C))return L+x;for(;6>L.length;)L="0"+L;x=L+x}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function b(E){if(E.h!=0)return!1;for(var _=0;_<E.g.length;_++)if(E.g[_]!=0)return!1;return!0}function y(E){return E.h==-1}t.l=function(E){return E=v(this,E),y(E)?-1:b(E)?0:1};function T(E){for(var _=E.g.length,C=[],x=0;x<_;x++)C[x]=~E.g[x];return new o(C,~E.h).add(f)}t.abs=function(){return y(this)?T(this):this},t.add=function(E){for(var _=Math.max(this.g.length,E.g.length),C=[],x=0,A=0;A<=_;A++){var L=x+(this.i(A)&65535)+(E.i(A)&65535),D=(L>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);x=D>>>16,L&=65535,D&=65535,C[A]=D<<16|L}return new o(C,C[C.length-1]&-2147483648?-1:0)};function v(E,_){return E.add(T(_))}t.j=function(E){if(b(this)||b(E))return h;if(y(this))return y(E)?T(this).j(T(E)):T(T(this).j(E));if(y(E))return T(this.j(T(E)));if(0>this.l(g)&&0>E.l(g))return l(this.m()*E.m());for(var _=this.g.length+E.g.length,C=[],x=0;x<2*_;x++)C[x]=0;for(x=0;x<this.g.length;x++)for(var A=0;A<E.g.length;A++){var L=this.i(x)>>>16,D=this.i(x)&65535,le=E.i(A)>>>16,ge=E.i(A)&65535;C[2*x+2*A]+=D*ge,w(C,2*x+2*A),C[2*x+2*A+1]+=L*ge,w(C,2*x+2*A+1),C[2*x+2*A+1]+=D*le,w(C,2*x+2*A+1),C[2*x+2*A+2]+=L*le,w(C,2*x+2*A+2)}for(x=0;x<_;x++)C[x]=C[2*x+1]<<16|C[2*x];for(x=_;x<2*_;x++)C[x]=0;return new o(C,0)};function w(E,_){for(;(E[_]&65535)!=E[_];)E[_+1]+=E[_]>>>16,E[_]&=65535,_++}function S(E,_){this.g=E,this.h=_}function P(E,_){if(b(_))throw Error("division by zero");if(b(E))return new S(h,h);if(y(E))return _=P(T(E),_),new S(T(_.g),T(_.h));if(y(_))return _=P(E,T(_)),new S(T(_.g),_.h);if(30<E.g.length){if(y(E)||y(_))throw Error("slowDivide_ only works with positive integers.");for(var C=f,x=_;0>=x.l(E);)C=R(C),x=R(x);var A=O(C,1),L=O(x,1);for(x=O(x,2),C=O(C,2);!b(x);){var D=L.add(x);0>=D.l(E)&&(A=A.add(C),L=D),x=O(x,1),C=O(C,1)}return _=v(E,A.j(_)),new S(A,_)}for(A=h;0<=E.l(_);){for(C=Math.max(1,Math.floor(E.m()/_.m())),x=Math.ceil(Math.log(C)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),L=l(C),D=L.j(_);y(D)||0<D.l(E);)C-=x,L=l(C),D=L.j(_);b(L)&&(L=f),A=A.add(L),E=v(E,D)}return new S(A,E)}t.A=function(E){return P(this,E).h},t.and=function(E){for(var _=Math.max(this.g.length,E.g.length),C=[],x=0;x<_;x++)C[x]=this.i(x)&E.i(x);return new o(C,this.h&E.h)},t.or=function(E){for(var _=Math.max(this.g.length,E.g.length),C=[],x=0;x<_;x++)C[x]=this.i(x)|E.i(x);return new o(C,this.h|E.h)},t.xor=function(E){for(var _=Math.max(this.g.length,E.g.length),C=[],x=0;x<_;x++)C[x]=this.i(x)^E.i(x);return new o(C,this.h^E.h)};function R(E){for(var _=E.g.length+1,C=[],x=0;x<_;x++)C[x]=E.i(x)<<1|E.i(x-1)>>>31;return new o(C,E.h)}function O(E,_){var C=_>>5;_%=32;for(var x=E.g.length-C,A=[],L=0;L<x;L++)A[L]=0<_?E.i(L+C)>>>_|E.i(L+C+1)<<32-_:E.i(L+C);return new o(A,E.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,_P=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,As=o}).apply(typeof Mw<"u"?Mw:typeof self<"u"?self:typeof window<"u"?window:{});var Mu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var SP,gc,EP,dd,ev,CP,IP,PP;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,p,k){return d==Array.prototype||d==Object.prototype||(d[p]=k.value),d};function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Mu=="object"&&Mu];for(var p=0;p<d.length;++p){var k=d[p];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=n(this);function r(d,p){if(p)e:{var k=i;d=d.split(".");for(var N=0;N<d.length-1;N++){var U=d[N];if(!(U in k))break e;k=k[U]}d=d[d.length-1],N=k[d],p=p(N),p!=N&&p!=null&&e(k,d,{configurable:!0,writable:!0,value:p})}}function s(d,p){d instanceof String&&(d+="");var k=0,N=!1,U={next:function(){if(!N&&k<d.length){var $=k++;return{value:p($,d[$]),done:!1}}return N=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}r("Array.prototype.values",function(d){return d||function(){return s(this,function(p,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(d){var p=typeof d;return p=p!="object"?p:d?Array.isArray(d)?"array":p:"null",p=="array"||p=="object"&&typeof d.length=="number"}function l(d){var p=typeof d;return p=="object"&&d!=null||p=="function"}function u(d,p,k){return d.call.apply(d.bind,arguments)}function h(d,p,k){if(!d)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,N),d.apply(p,U)}}return function(){return d.apply(p,arguments)}}function f(d,p,k){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,f.apply(null,arguments)}function g(d,p){var k=Array.prototype.slice.call(arguments,1);return function(){var N=k.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function b(d,p){function k(){}k.prototype=p.prototype,d.aa=p.prototype,d.prototype=new k,d.prototype.constructor=d,d.Qb=function(N,U,$){for(var Q=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)Q[xe-2]=arguments[xe];return p.prototype[U].apply(N,Q)}}function y(d){const p=d.length;if(0<p){const k=Array(p);for(let N=0;N<p;N++)k[N]=d[N];return k}return[]}function T(d,p){for(let k=1;k<arguments.length;k++){const N=arguments[k];if(c(N)){const U=d.length||0,$=N.length||0;d.length=U+$;for(let Q=0;Q<$;Q++)d[U+Q]=N[Q]}else d.push(N)}}class v{constructor(p,k){this.i=p,this.j=k,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function w(d){return/^[\s\xa0]*$/.test(d)}function S(){var d=a.navigator;return d&&(d=d.userAgent)?d:""}function P(d){return P[" "](d),d}P[" "]=function(){};var R=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function O(d,p,k){for(const N in d)p.call(k,d[N],N,d)}function E(d,p){for(const k in d)p.call(void 0,d[k],k,d)}function _(d){const p={};for(const k in d)p[k]=d[k];return p}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(d,p){let k,N;for(let U=1;U<arguments.length;U++){N=arguments[U];for(k in N)d[k]=N[k];for(let $=0;$<C.length;$++)k=C[$],Object.prototype.hasOwnProperty.call(N,k)&&(d[k]=N[k])}}function A(d){var p=1;d=d.split(":");const k=[];for(;0<p&&d.length;)k.push(d.shift()),p--;return d.length&&k.push(d.join(":")),k}function L(d){a.setTimeout(()=>{throw d},0)}function D(){var d=ee;let p=null;return d.g&&(p=d.g,d.g=d.g.next,d.g||(d.h=null),p.next=null),p}class le{constructor(){this.h=this.g=null}add(p,k){const N=ge.get();N.set(p,k),this.h?this.h.next=N:this.g=N,this.h=N}}var ge=new v(()=>new $e,d=>d.reset());class $e{constructor(){this.next=this.g=this.h=null}set(p,k){this.h=p,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,W=!1,ee=new le,ne=()=>{const d=a.Promise.resolve(void 0);fe=()=>{d.then(Pe)}};var Pe=()=>{for(var d;d=D();){try{d.h.call(d.g)}catch(k){L(k)}var p=ge;p.j(d),100>p.h&&(p.h++,d.next=p.g,p.g=d)}W=!1};function ve(){this.s=this.s,this.C=this.C}ve.prototype.s=!1,ve.prototype.ma=function(){this.s||(this.s=!0,this.N())},ve.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function He(d,p){this.type=d,this.g=this.target=p,this.defaultPrevented=!1}He.prototype.h=function(){this.defaultPrevented=!0};var Ee=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,p=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const k=()=>{};a.addEventListener("test",k,p),a.removeEventListener("test",k,p)}catch{}return d}();function mn(d,p){if(He.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var k=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=p,p=d.relatedTarget){if(R){e:{try{P(p.nodeName);var U=!0;break e}catch{}U=!1}U||(p=null)}}else k=="mouseover"?p=d.fromElement:k=="mouseout"&&(p=d.toElement);this.relatedTarget=p,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Ni[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&mn.aa.h.call(this)}}b(mn,He);var Ni={2:"touch",3:"pen",4:"mouse"};mn.prototype.h=function(){mn.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Oi="closure_listenable_"+(1e6*Math.random()|0),GN=0;function QN(d,p,k,N,U){this.listener=d,this.proxy=null,this.src=p,this.type=k,this.capture=!!N,this.ha=U,this.key=++GN,this.da=this.fa=!1}function Xl(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Zl(d){this.src=d,this.g={},this.h=0}Zl.prototype.add=function(d,p,k,N,U){var $=d.toString();d=this.g[$],d||(d=this.g[$]=[],this.h++);var Q=sp(d,p,N,U);return-1<Q?(p=d[Q],k||(p.fa=!1)):(p=new QN(p,this.src,$,!!N,U),p.fa=k,d.push(p)),p};function rp(d,p){var k=p.type;if(k in d.g){var N=d.g[k],U=Array.prototype.indexOf.call(N,p,void 0),$;($=0<=U)&&Array.prototype.splice.call(N,U,1),$&&(Xl(p),d.g[k].length==0&&(delete d.g[k],d.h--))}}function sp(d,p,k,N){for(var U=0;U<d.length;++U){var $=d[U];if(!$.da&&$.listener==p&&$.capture==!!k&&$.ha==N)return U}return-1}var op="closure_lm_"+(1e6*Math.random()|0),ap={};function Ob(d,p,k,N,U){if(Array.isArray(p)){for(var $=0;$<p.length;$++)Ob(d,p[$],k,N,U);return null}return k=Mb(k),d&&d[Oi]?d.K(p,k,l(N)?!!N.capture:!!N,U):JN(d,p,k,!1,N,U)}function JN(d,p,k,N,U,$){if(!p)throw Error("Invalid event type");var Q=l(U)?!!U.capture:!!U,xe=lp(d);if(xe||(d[op]=xe=new Zl(d)),k=xe.add(p,k,N,Q,$),k.proxy)return k;if(N=YN(),k.proxy=N,N.src=d,N.listener=k,d.addEventListener)Ee||(U=Q),U===void 0&&(U=!1),d.addEventListener(p.toString(),N,U);else if(d.attachEvent)d.attachEvent(Lb(p.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return k}function YN(){function d(k){return p.call(d.src,d.listener,k)}const p=XN;return d}function Db(d,p,k,N,U){if(Array.isArray(p))for(var $=0;$<p.length;$++)Db(d,p[$],k,N,U);else N=l(N)?!!N.capture:!!N,k=Mb(k),d&&d[Oi]?(d=d.i,p=String(p).toString(),p in d.g&&($=d.g[p],k=sp($,k,N,U),-1<k&&(Xl($[k]),Array.prototype.splice.call($,k,1),$.length==0&&(delete d.g[p],d.h--)))):d&&(d=lp(d))&&(p=d.g[p.toString()],d=-1,p&&(d=sp(p,k,N,U)),(k=-1<d?p[d]:null)&&cp(k))}function cp(d){if(typeof d!="number"&&d&&!d.da){var p=d.src;if(p&&p[Oi])rp(p.i,d);else{var k=d.type,N=d.proxy;p.removeEventListener?p.removeEventListener(k,N,d.capture):p.detachEvent?p.detachEvent(Lb(k),N):p.addListener&&p.removeListener&&p.removeListener(N),(k=lp(p))?(rp(k,d),k.h==0&&(k.src=null,p[op]=null)):Xl(d)}}}function Lb(d){return d in ap?ap[d]:ap[d]="on"+d}function XN(d,p){if(d.da)d=!0;else{p=new mn(p,this);var k=d.listener,N=d.ha||d.src;d.fa&&cp(d),d=k.call(N,p)}return d}function lp(d){return d=d[op],d instanceof Zl?d:null}var up="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mb(d){return typeof d=="function"?d:(d[up]||(d[up]=function(p){return d.handleEvent(p)}),d[up])}function Rt(){ve.call(this),this.i=new Zl(this),this.M=this,this.F=null}b(Rt,ve),Rt.prototype[Oi]=!0,Rt.prototype.removeEventListener=function(d,p,k,N){Db(this,d,p,k,N)};function Ht(d,p){var k,N=d.F;if(N)for(k=[];N;N=N.F)k.push(N);if(d=d.M,N=p.type||p,typeof p=="string")p=new He(p,d);else if(p instanceof He)p.target=p.target||d;else{var U=p;p=new He(N,d),x(p,U)}if(U=!0,k)for(var $=k.length-1;0<=$;$--){var Q=p.g=k[$];U=eu(Q,N,!0,p)&&U}if(Q=p.g=d,U=eu(Q,N,!0,p)&&U,U=eu(Q,N,!1,p)&&U,k)for($=0;$<k.length;$++)Q=p.g=k[$],U=eu(Q,N,!1,p)&&U}Rt.prototype.N=function(){if(Rt.aa.N.call(this),this.i){var d=this.i,p;for(p in d.g){for(var k=d.g[p],N=0;N<k.length;N++)Xl(k[N]);delete d.g[p],d.h--}}this.F=null},Rt.prototype.K=function(d,p,k,N){return this.i.add(String(d),p,!1,k,N)},Rt.prototype.L=function(d,p,k,N){return this.i.add(String(d),p,!0,k,N)};function eu(d,p,k,N){if(p=d.i.g[String(p)],!p)return!0;p=p.concat();for(var U=!0,$=0;$<p.length;++$){var Q=p[$];if(Q&&!Q.da&&Q.capture==k){var xe=Q.listener,kt=Q.ha||Q.src;Q.fa&&rp(d.i,Q),U=xe.call(kt,N)!==!1&&U}}return U&&!N.defaultPrevented}function Ub(d,p,k){if(typeof d=="function")k&&(d=f(d,k));else if(d&&typeof d.handleEvent=="function")d=f(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(d,p||0)}function Fb(d){d.g=Ub(()=>{d.g=null,d.i&&(d.i=!1,Fb(d))},d.l);const p=d.h;d.h=null,d.m.apply(null,p)}class ZN extends ve{constructor(p,k){super(),this.m=p,this.l=k,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Fb(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fa(d){ve.call(this),this.h=d,this.g={}}b(Fa,ve);var Vb=[];function jb(d){O(d.g,function(p,k){this.g.hasOwnProperty(k)&&cp(p)},d),d.g={}}Fa.prototype.N=function(){Fa.aa.N.call(this),jb(this)},Fa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dp=a.JSON.stringify,eO=a.JSON.parse,tO=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function hp(){}hp.prototype.h=null;function $b(d){return d.h||(d.h=d.i())}function Bb(){}var Va={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fp(){He.call(this,"d")}b(fp,He);function pp(){He.call(this,"c")}b(pp,He);var ds={},zb=null;function tu(){return zb=zb||new Rt}ds.La="serverreachability";function qb(d){He.call(this,ds.La,d)}b(qb,He);function ja(d){const p=tu();Ht(p,new qb(p))}ds.STAT_EVENT="statevent";function Hb(d,p){He.call(this,ds.STAT_EVENT,d),this.stat=p}b(Hb,He);function Wt(d){const p=tu();Ht(p,new Hb(p,d))}ds.Ma="timingevent";function Wb(d,p){He.call(this,ds.Ma,d),this.size=p}b(Wb,He);function $a(d,p){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},p)}function Ba(){this.g=!0}Ba.prototype.xa=function(){this.g=!1};function nO(d,p,k,N,U,$){d.info(function(){if(d.g)if($)for(var Q="",xe=$.split("&"),kt=0;kt<xe.length;kt++){var Se=xe[kt].split("=");if(1<Se.length){var xt=Se[0];Se=Se[1];var At=xt.split("_");Q=2<=At.length&&At[1]=="type"?Q+(xt+"="+Se+"&"):Q+(xt+"=redacted&")}}else Q=null;else Q=$;return"XMLHTTP REQ ("+N+") [attempt "+U+"]: "+p+`
`+k+`
`+Q})}function iO(d,p,k,N,U,$,Q){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+U+"]: "+p+`
`+k+`
`+$+" "+Q})}function so(d,p,k,N){d.info(function(){return"XMLHTTP TEXT ("+p+"): "+sO(d,k)+(N?" "+N:"")})}function rO(d,p){d.info(function(){return"TIMEOUT: "+p})}Ba.prototype.info=function(){};function sO(d,p){if(!d.g)return p;if(!p)return null;try{var k=JSON.parse(p);if(k){for(d=0;d<k.length;d++)if(Array.isArray(k[d])){var N=k[d];if(!(2>N.length)){var U=N[1];if(Array.isArray(U)&&!(1>U.length)){var $=U[0];if($!="noop"&&$!="stop"&&$!="close")for(var Q=1;Q<U.length;Q++)U[Q]=""}}}}return dp(k)}catch{return p}}var nu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Kb={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},mp;function iu(){}b(iu,hp),iu.prototype.g=function(){return new XMLHttpRequest},iu.prototype.i=function(){return{}},mp=new iu;function ur(d,p,k,N){this.j=d,this.i=p,this.l=k,this.R=N||1,this.U=new Fa(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gb}function Gb(){this.i=null,this.g="",this.h=!1}var Qb={},gp={};function vp(d,p,k){d.L=1,d.v=au(Di(p)),d.m=k,d.P=!0,Jb(d,null)}function Jb(d,p){d.F=Date.now(),ru(d),d.A=Di(d.v);var k=d.A,N=d.R;Array.isArray(N)||(N=[String(N)]),uT(k.i,"t",N),d.C=0,k=d.j.J,d.h=new Gb,d.g=PT(d.j,k?p:null,!d.m),0<d.O&&(d.M=new ZN(f(d.Y,d,d.g),d.O)),p=d.U,k=d.g,N=d.ca;var U="readystatechange";Array.isArray(U)||(U&&(Vb[0]=U.toString()),U=Vb);for(var $=0;$<U.length;$++){var Q=Ob(k,U[$],N||p.handleEvent,!1,p.h||p);if(!Q)break;p.g[Q.key]=Q}p=d.H?_(d.H):{},d.m?(d.u||(d.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,p)):(d.u="GET",d.g.ea(d.A,d.u,null,p)),ja(),nO(d.i,d.u,d.A,d.l,d.R,d.m)}ur.prototype.ca=function(d){d=d.target;const p=this.M;p&&Li(d)==3?p.j():this.Y(d)},ur.prototype.Y=function(d){try{if(d==this.g)e:{const At=Li(this.g);var p=this.g.Ba();const co=this.g.Z();if(!(3>At)&&(At!=3||this.g&&(this.h.h||this.g.oa()||vT(this.g)))){this.J||At!=4||p==7||(p==8||0>=co?ja(3):ja(2)),yp(this);var k=this.g.Z();this.X=k;t:if(Yb(this)){var N=vT(this.g);d="";var U=N.length,$=Li(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hs(this),za(this);var Q="";break t}this.h.i=new a.TextDecoder}for(p=0;p<U;p++)this.h.h=!0,d+=this.h.i.decode(N[p],{stream:!($&&p==U-1)});N.length=0,this.h.g+=d,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=k==200,iO(this.i,this.u,this.A,this.l,this.R,At,k),this.o){if(this.T&&!this.K){t:{if(this.g){var xe,kt=this.g;if((xe=kt.g?kt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(xe)){var Se=xe;break t}}Se=null}if(k=Se)so(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,bp(this,k);else{this.o=!1,this.s=3,Wt(12),hs(this),za(this);break e}}if(this.P){k=!0;let Fn;for(;!this.J&&this.C<Q.length;)if(Fn=oO(this,Q),Fn==gp){At==4&&(this.s=4,Wt(14),k=!1),so(this.i,this.l,null,"[Incomplete Response]");break}else if(Fn==Qb){this.s=4,Wt(15),so(this.i,this.l,Q,"[Invalid Chunk]"),k=!1;break}else so(this.i,this.l,Fn,null),bp(this,Fn);if(Yb(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),At!=4||Q.length!=0||this.h.h||(this.s=1,Wt(16),k=!1),this.o=this.o&&k,!k)so(this.i,this.l,Q,"[Invalid Chunked Response]"),hs(this),za(this);else if(0<Q.length&&!this.W){this.W=!0;var xt=this.j;xt.g==this&&xt.ba&&!xt.M&&(xt.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),Ep(xt),xt.M=!0,Wt(11))}}else so(this.i,this.l,Q,null),bp(this,Q);At==4&&hs(this),this.o&&!this.J&&(At==4?ST(this.j,this):(this.o=!1,ru(this)))}else _O(this.g),k==400&&0<Q.indexOf("Unknown SID")?(this.s=3,Wt(12)):(this.s=0,Wt(13)),hs(this),za(this)}}}catch{}finally{}};function Yb(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function oO(d,p){var k=d.C,N=p.indexOf(`
`,k);return N==-1?gp:(k=Number(p.substring(k,N)),isNaN(k)?Qb:(N+=1,N+k>p.length?gp:(p=p.slice(N,N+k),d.C=N+k,p)))}ur.prototype.cancel=function(){this.J=!0,hs(this)};function ru(d){d.S=Date.now()+d.I,Xb(d,d.I)}function Xb(d,p){if(d.B!=null)throw Error("WatchDog timer not null");d.B=$a(f(d.ba,d),p)}function yp(d){d.B&&(a.clearTimeout(d.B),d.B=null)}ur.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(rO(this.i,this.A),this.L!=2&&(ja(),Wt(17)),hs(this),this.s=2,za(this)):Xb(this,this.S-d)};function za(d){d.j.G==0||d.J||ST(d.j,d)}function hs(d){yp(d);var p=d.M;p&&typeof p.ma=="function"&&p.ma(),d.M=null,jb(d.U),d.g&&(p=d.g,d.g=null,p.abort(),p.ma())}function bp(d,p){try{var k=d.j;if(k.G!=0&&(k.g==d||Tp(k.h,d))){if(!d.K&&Tp(k.h,d)&&k.G==3){try{var N=k.Da.g.parse(p)}catch{N=null}if(Array.isArray(N)&&N.length==3){var U=N;if(U[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<d.F)fu(k),du(k);else break e;Sp(k),Wt(18)}}else k.za=U[1],0<k.za-k.T&&37500>U[2]&&k.F&&k.v==0&&!k.C&&(k.C=$a(f(k.Za,k),6e3));if(1>=tT(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else ps(k,11)}else if((d.K||k.g==d)&&fu(k),!w(p))for(U=k.Da.g.parse(p),p=0;p<U.length;p++){let Se=U[p];if(k.T=Se[0],Se=Se[1],k.G==2)if(Se[0]=="c"){k.K=Se[1],k.ia=Se[2];const xt=Se[3];xt!=null&&(k.la=xt,k.j.info("VER="+k.la));const At=Se[4];At!=null&&(k.Aa=At,k.j.info("SVER="+k.Aa));const co=Se[5];co!=null&&typeof co=="number"&&0<co&&(N=1.5*co,k.L=N,k.j.info("backChannelRequestTimeoutMs_="+N)),N=k;const Fn=d.g;if(Fn){const mu=Fn.g?Fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(mu){var $=N.h;$.g||mu.indexOf("spdy")==-1&&mu.indexOf("quic")==-1&&mu.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(kp($,$.h),$.h=null))}if(N.D){const Cp=Fn.g?Fn.g.getResponseHeader("X-HTTP-Session-Id"):null;Cp&&(N.ya=Cp,Ue(N.I,N.D,Cp))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-d.F,k.j.info("Handshake RTT: "+k.R+"ms")),N=k;var Q=d;if(N.qa=IT(N,N.J?N.ia:null,N.W),Q.K){nT(N.h,Q);var xe=Q,kt=N.L;kt&&(xe.I=kt),xe.B&&(yp(xe),ru(xe)),N.g=Q}else wT(N);0<k.i.length&&hu(k)}else Se[0]!="stop"&&Se[0]!="close"||ps(k,7);else k.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?ps(k,7):_p(k):Se[0]!="noop"&&k.l&&k.l.ta(Se),k.v=0)}}ja(4)}catch{}}var aO=class{constructor(d,p){this.g=d,this.map=p}};function Zb(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function eT(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function tT(d){return d.h?1:d.g?d.g.size:0}function Tp(d,p){return d.h?d.h==p:d.g?d.g.has(p):!1}function kp(d,p){d.g?d.g.add(p):d.h=p}function nT(d,p){d.h&&d.h==p?d.h=null:d.g&&d.g.has(p)&&d.g.delete(p)}Zb.prototype.cancel=function(){if(this.i=iT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function iT(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let p=d.i;for(const k of d.g.values())p=p.concat(k.D);return p}return y(d.i)}function cO(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(c(d)){for(var p=[],k=d.length,N=0;N<k;N++)p.push(d[N]);return p}p=[],k=0;for(N in d)p[k++]=d[N];return p}function lO(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(c(d)||typeof d=="string"){var p=[];d=d.length;for(var k=0;k<d;k++)p.push(k);return p}p=[],k=0;for(const N in d)p[k++]=N;return p}}}function rT(d,p){if(d.forEach&&typeof d.forEach=="function")d.forEach(p,void 0);else if(c(d)||typeof d=="string")Array.prototype.forEach.call(d,p,void 0);else for(var k=lO(d),N=cO(d),U=N.length,$=0;$<U;$++)p.call(void 0,N[$],k&&k[$],d)}var sT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uO(d,p){if(d){d=d.split("&");for(var k=0;k<d.length;k++){var N=d[k].indexOf("="),U=null;if(0<=N){var $=d[k].substring(0,N);U=d[k].substring(N+1)}else $=d[k];p($,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function fs(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof fs){this.h=d.h,su(this,d.j),this.o=d.o,this.g=d.g,ou(this,d.s),this.l=d.l;var p=d.i,k=new Wa;k.i=p.i,p.g&&(k.g=new Map(p.g),k.h=p.h),oT(this,k),this.m=d.m}else d&&(p=String(d).match(sT))?(this.h=!1,su(this,p[1]||"",!0),this.o=qa(p[2]||""),this.g=qa(p[3]||"",!0),ou(this,p[4]),this.l=qa(p[5]||"",!0),oT(this,p[6]||"",!0),this.m=qa(p[7]||"")):(this.h=!1,this.i=new Wa(null,this.h))}fs.prototype.toString=function(){var d=[],p=this.j;p&&d.push(Ha(p,aT,!0),":");var k=this.g;return(k||p=="file")&&(d.push("//"),(p=this.o)&&d.push(Ha(p,aT,!0),"@"),d.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&d.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&d.push("/"),d.push(Ha(k,k.charAt(0)=="/"?fO:hO,!0))),(k=this.i.toString())&&d.push("?",k),(k=this.m)&&d.push("#",Ha(k,mO)),d.join("")};function Di(d){return new fs(d)}function su(d,p,k){d.j=k?qa(p,!0):p,d.j&&(d.j=d.j.replace(/:$/,""))}function ou(d,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);d.s=p}else d.s=null}function oT(d,p,k){p instanceof Wa?(d.i=p,gO(d.i,d.h)):(k||(p=Ha(p,pO)),d.i=new Wa(p,d.h))}function Ue(d,p,k){d.i.set(p,k)}function au(d){return Ue(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function qa(d,p){return d?p?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Ha(d,p,k){return typeof d=="string"?(d=encodeURI(d).replace(p,dO),k&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function dO(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var aT=/[#\/\?@]/g,hO=/[#\?:]/g,fO=/[#\?]/g,pO=/[#\?@]/g,mO=/#/g;function Wa(d,p){this.h=this.g=null,this.i=d||null,this.j=!!p}function dr(d){d.g||(d.g=new Map,d.h=0,d.i&&uO(d.i,function(p,k){d.add(decodeURIComponent(p.replace(/\+/g," ")),k)}))}t=Wa.prototype,t.add=function(d,p){dr(this),this.i=null,d=oo(this,d);var k=this.g.get(d);return k||this.g.set(d,k=[]),k.push(p),this.h+=1,this};function cT(d,p){dr(d),p=oo(d,p),d.g.has(p)&&(d.i=null,d.h-=d.g.get(p).length,d.g.delete(p))}function lT(d,p){return dr(d),p=oo(d,p),d.g.has(p)}t.forEach=function(d,p){dr(this),this.g.forEach(function(k,N){k.forEach(function(U){d.call(p,U,N,this)},this)},this)},t.na=function(){dr(this);const d=Array.from(this.g.values()),p=Array.from(this.g.keys()),k=[];for(let N=0;N<p.length;N++){const U=d[N];for(let $=0;$<U.length;$++)k.push(p[N])}return k},t.V=function(d){dr(this);let p=[];if(typeof d=="string")lT(this,d)&&(p=p.concat(this.g.get(oo(this,d))));else{d=Array.from(this.g.values());for(let k=0;k<d.length;k++)p=p.concat(d[k])}return p},t.set=function(d,p){return dr(this),this.i=null,d=oo(this,d),lT(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[p]),this.h+=1,this},t.get=function(d,p){return d?(d=this.V(d),0<d.length?String(d[0]):p):p};function uT(d,p,k){cT(d,p),0<k.length&&(d.i=null,d.g.set(oo(d,p),y(k)),d.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],p=Array.from(this.g.keys());for(var k=0;k<p.length;k++){var N=p[k];const $=encodeURIComponent(String(N)),Q=this.V(N);for(N=0;N<Q.length;N++){var U=$;Q[N]!==""&&(U+="="+encodeURIComponent(String(Q[N]))),d.push(U)}}return this.i=d.join("&")};function oo(d,p){return p=String(p),d.j&&(p=p.toLowerCase()),p}function gO(d,p){p&&!d.j&&(dr(d),d.i=null,d.g.forEach(function(k,N){var U=N.toLowerCase();N!=U&&(cT(this,N),uT(this,U,k))},d)),d.j=p}function vO(d,p){const k=new Ba;if(a.Image){const N=new Image;N.onload=g(hr,k,"TestLoadImage: loaded",!0,p,N),N.onerror=g(hr,k,"TestLoadImage: error",!1,p,N),N.onabort=g(hr,k,"TestLoadImage: abort",!1,p,N),N.ontimeout=g(hr,k,"TestLoadImage: timeout",!1,p,N),a.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else p(!1)}function yO(d,p){const k=new Ba,N=new AbortController,U=setTimeout(()=>{N.abort(),hr(k,"TestPingServer: timeout",!1,p)},1e4);fetch(d,{signal:N.signal}).then($=>{clearTimeout(U),$.ok?hr(k,"TestPingServer: ok",!0,p):hr(k,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(U),hr(k,"TestPingServer: error",!1,p)})}function hr(d,p,k,N,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),N(k)}catch{}}function bO(){this.g=new tO}function TO(d,p,k){const N=k||"";try{rT(d,function(U,$){let Q=U;l(U)&&(Q=dp(U)),p.push(N+$+"="+encodeURIComponent(Q))})}catch(U){throw p.push(N+"type="+encodeURIComponent("_badmap")),U}}function cu(d){this.l=d.Ub||null,this.j=d.eb||!1}b(cu,hp),cu.prototype.g=function(){return new lu(this.l,this.j)},cu.prototype.i=function(d){return function(){return d}}({});function lu(d,p){Rt.call(this),this.D=d,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(lu,Rt),t=lu.prototype,t.open=function(d,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=p,this.readyState=1,Ga(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(p.body=d),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ka(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ga(this)),this.g&&(this.readyState=3,Ga(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dT(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function dT(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var p=d.value?d.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!d.done}))&&(this.response=this.responseText+=p)}d.done?Ka(this):Ga(this),this.readyState==3&&dT(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Ka(this))},t.Qa=function(d){this.g&&(this.response=d,Ka(this))},t.ga=function(){this.g&&Ka(this)};function Ka(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Ga(d)}t.setRequestHeader=function(d,p){this.u.append(d,p)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],p=this.h.entries();for(var k=p.next();!k.done;)k=k.value,d.push(k[0]+": "+k[1]),k=p.next();return d.join(`\r
`)};function Ga(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(lu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function hT(d){let p="";return O(d,function(k,N){p+=N,p+=":",p+=k,p+=`\r
`}),p}function wp(d,p,k){e:{for(N in k){var N=!1;break e}N=!0}N||(k=hT(k),typeof d=="string"?k!=null&&encodeURIComponent(String(k)):Ue(d,p,k))}function Je(d){Rt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Je,Rt);var kO=/^https?$/i,wO=["POST","PUT"];t=Je.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,p,k,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);p=p?p.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():mp.g(),this.v=this.o?$b(this.o):$b(mp),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(p,String(d),!0),this.B=!1}catch($){fT(this,$);return}if(d=k||"",k=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var U in N)k.set(U,N[U]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const $ of N.keys())k.set($,N.get($));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(k.keys()).find($=>$.toLowerCase()=="content-type"),U=a.FormData&&d instanceof a.FormData,!(0<=Array.prototype.indexOf.call(wO,p,void 0))||N||U||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,Q]of k)this.g.setRequestHeader($,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gT(this),this.u=!0,this.g.send(d),this.u=!1}catch($){fT(this,$)}};function fT(d,p){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=p,d.m=5,pT(d),uu(d)}function pT(d){d.A||(d.A=!0,Ht(d,"complete"),Ht(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Ht(this,"complete"),Ht(this,"abort"),uu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),uu(this,!0)),Je.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?mT(this):this.bb())},t.bb=function(){mT(this)};function mT(d){if(d.h&&typeof o<"u"&&(!d.v[1]||Li(d)!=4||d.Z()!=2)){if(d.u&&Li(d)==4)Ub(d.Ea,0,d);else if(Ht(d,"readystatechange"),Li(d)==4){d.h=!1;try{const Q=d.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var k;if(!(k=p)){var N;if(N=Q===0){var U=String(d.D).match(sT)[1]||null;!U&&a.self&&a.self.location&&(U=a.self.location.protocol.slice(0,-1)),N=!kO.test(U?U.toLowerCase():"")}k=N}if(k)Ht(d,"complete"),Ht(d,"success");else{d.m=6;try{var $=2<Li(d)?d.g.statusText:""}catch{$=""}d.l=$+" ["+d.Z()+"]",pT(d)}}finally{uu(d)}}}}function uu(d,p){if(d.g){gT(d);const k=d.g,N=d.v[0]?()=>{}:null;d.g=null,d.v=null,p||Ht(d,"ready");try{k.onreadystatechange=N}catch{}}}function gT(d){d.I&&(a.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function Li(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<Li(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var p=this.g.responseText;return d&&p.indexOf(d)==0&&(p=p.substring(d.length)),eO(p)}};function vT(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function _O(d){const p={};d=(d.g&&2<=Li(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(w(d[N]))continue;var k=A(d[N]);const U=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const $=p[U]||[];p[U]=$,$.push(k)}E(p,function(N){return N.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qa(d,p,k){return k&&k.internalChannelParams&&k.internalChannelParams[d]||p}function yT(d){this.Aa=0,this.i=[],this.j=new Ba,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qa("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qa("baseRetryDelayMs",5e3,d),this.cb=Qa("retryDelaySeedMs",1e4,d),this.Wa=Qa("forwardChannelMaxRetries",2,d),this.wa=Qa("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new Zb(d&&d.concurrentRequestLimit),this.Da=new bO,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=yT.prototype,t.la=8,t.G=1,t.connect=function(d,p,k,N){Wt(0),this.W=d,this.H=p||{},k&&N!==void 0&&(this.H.OSID=k,this.H.OAID=N),this.F=this.X,this.I=IT(this,null,this.W),hu(this)};function _p(d){if(bT(d),d.G==3){var p=d.U++,k=Di(d.I);if(Ue(k,"SID",d.K),Ue(k,"RID",p),Ue(k,"TYPE","terminate"),Ja(d,k),p=new ur(d,d.j,p),p.L=2,p.v=au(Di(k)),k=!1,a.navigator&&a.navigator.sendBeacon)try{k=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!k&&a.Image&&(new Image().src=p.v,k=!0),k||(p.g=PT(p.j,null),p.g.ea(p.v)),p.F=Date.now(),ru(p)}CT(d)}function du(d){d.g&&(Ep(d),d.g.cancel(),d.g=null)}function bT(d){du(d),d.u&&(a.clearTimeout(d.u),d.u=null),fu(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&a.clearTimeout(d.s),d.s=null)}function hu(d){if(!eT(d.h)&&!d.s){d.s=!0;var p=d.Ga;fe||ne(),W||(fe(),W=!0),ee.add(p,d),d.B=0}}function SO(d,p){return tT(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=p.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=$a(f(d.Ga,d,p),ET(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const U=new ur(this,this.j,d);let $=this.o;if(this.S&&($?($=_($),x($,this.S)):$=this.S),this.m!==null||this.O||(U.H=$,$=null),this.P)e:{for(var p=0,k=0;k<this.i.length;k++){t:{var N=this.i[k];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(p+=N,4096<p){p=k;break e}if(p===4096||k===this.i.length-1){p=k+1;break e}}p=1e3}else p=1e3;p=kT(this,U,p),k=Di(this.I),Ue(k,"RID",d),Ue(k,"CVER",22),this.D&&Ue(k,"X-HTTP-Session-Id",this.D),Ja(this,k),$&&(this.O?p="headers="+encodeURIComponent(String(hT($)))+"&"+p:this.m&&wp(k,this.m,$)),kp(this.h,U),this.Ua&&Ue(k,"TYPE","init"),this.P?(Ue(k,"$req",p),Ue(k,"SID","null"),U.T=!0,vp(U,k,null)):vp(U,k,p),this.G=2}}else this.G==3&&(d?TT(this,d):this.i.length==0||eT(this.h)||TT(this))};function TT(d,p){var k;p?k=p.l:k=d.U++;const N=Di(d.I);Ue(N,"SID",d.K),Ue(N,"RID",k),Ue(N,"AID",d.T),Ja(d,N),d.m&&d.o&&wp(N,d.m,d.o),k=new ur(d,d.j,k,d.B+1),d.m===null&&(k.H=d.o),p&&(d.i=p.D.concat(d.i)),p=kT(d,k,1e3),k.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),kp(d.h,k),vp(k,N,p)}function Ja(d,p){d.H&&O(d.H,function(k,N){Ue(p,N,k)}),d.l&&rT({},function(k,N){Ue(p,N,k)})}function kT(d,p,k){k=Math.min(d.i.length,k);var N=d.l?f(d.l.Na,d.l,d):null;e:{var U=d.i;let $=-1;for(;;){const Q=["count="+k];$==-1?0<k?($=U[0].g,Q.push("ofs="+$)):$=0:Q.push("ofs="+$);let xe=!0;for(let kt=0;kt<k;kt++){let Se=U[kt].g;const xt=U[kt].map;if(Se-=$,0>Se)$=Math.max(0,U[kt].g-100),xe=!1;else try{TO(xt,Q,"req"+Se+"_")}catch{N&&N(xt)}}if(xe){N=Q.join("&");break e}}}return d=d.i.splice(0,k),p.D=d,N}function wT(d){if(!d.g&&!d.u){d.Y=1;var p=d.Fa;fe||ne(),W||(fe(),W=!0),ee.add(p,d),d.v=0}}function Sp(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=$a(f(d.Fa,d),ET(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,_T(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=$a(f(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Wt(10),du(this),_T(this))};function Ep(d){d.A!=null&&(a.clearTimeout(d.A),d.A=null)}function _T(d){d.g=new ur(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var p=Di(d.qa);Ue(p,"RID","rpc"),Ue(p,"SID",d.K),Ue(p,"AID",d.T),Ue(p,"CI",d.F?"0":"1"),!d.F&&d.ja&&Ue(p,"TO",d.ja),Ue(p,"TYPE","xmlhttp"),Ja(d,p),d.m&&d.o&&wp(p,d.m,d.o),d.L&&(d.g.I=d.L);var k=d.g;d=d.ia,k.L=1,k.v=au(Di(p)),k.m=null,k.P=!0,Jb(k,d)}t.Za=function(){this.C!=null&&(this.C=null,du(this),Sp(this),Wt(19))};function fu(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function ST(d,p){var k=null;if(d.g==p){fu(d),Ep(d),d.g=null;var N=2}else if(Tp(d.h,p))k=p.D,nT(d.h,p),N=1;else return;if(d.G!=0){if(p.o)if(N==1){k=p.m?p.m.length:0,p=Date.now()-p.F;var U=d.B;N=tu(),Ht(N,new Wb(N,k)),hu(d)}else wT(d);else if(U=p.s,U==3||U==0&&0<p.X||!(N==1&&SO(d,p)||N==2&&Sp(d)))switch(k&&0<k.length&&(p=d.h,p.i=p.i.concat(k)),U){case 1:ps(d,5);break;case 4:ps(d,10);break;case 3:ps(d,6);break;default:ps(d,2)}}}function ET(d,p){let k=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(k*=2),k*p}function ps(d,p){if(d.j.info("Error code "+p),p==2){var k=f(d.fb,d),N=d.Xa;const U=!N;N=new fs(N||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||su(N,"https"),au(N),U?vO(N.toString(),k):yO(N.toString(),k)}else Wt(2);d.G=0,d.l&&d.l.sa(p),CT(d),bT(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Wt(2)):(this.j.info("Failed to ping google.com"),Wt(1))};function CT(d){if(d.G=0,d.ka=[],d.l){const p=iT(d.h);(p.length!=0||d.i.length!=0)&&(T(d.ka,p),T(d.ka,d.i),d.h.i.length=0,y(d.i),d.i.length=0),d.l.ra()}}function IT(d,p,k){var N=k instanceof fs?Di(k):new fs(k);if(N.g!="")p&&(N.g=p+"."+N.g),ou(N,N.s);else{var U=a.location;N=U.protocol,p=p?p+"."+U.hostname:U.hostname,U=+U.port;var $=new fs(null);N&&su($,N),p&&($.g=p),U&&ou($,U),k&&($.l=k),N=$}return k=d.D,p=d.ya,k&&p&&Ue(N,k,p),Ue(N,"VER",d.la),Ja(d,N),N}function PT(d,p,k){if(p&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=d.Ca&&!d.pa?new Je(new cu({eb:k})):new Je(d.pa),p.Ha(d.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function RT(){}t=RT.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function pu(){}pu.prototype.g=function(d,p){return new gn(d,p)};function gn(d,p){Rt.call(this),this.g=new yT(p),this.l=d,this.h=p&&p.messageUrlParams||null,d=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(d?d["X-WebChannel-Content-Type"]=p.messageContentType:d={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(d?d["X-WebChannel-Client-Profile"]=p.va:d={"X-WebChannel-Client-Profile":p.va}),this.g.S=d,(d=p&&p.Sb)&&!w(d)&&(this.g.m=d),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!w(p)&&(this.g.D=p,d=this.h,d!==null&&p in d&&(d=this.h,p in d&&delete d[p])),this.j=new ao(this)}b(gn,Rt),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){_p(this.g)},gn.prototype.o=function(d){var p=this.g;if(typeof d=="string"){var k={};k.__data__=d,d=k}else this.u&&(k={},k.__data__=dp(d),d=k);p.i.push(new aO(p.Ya++,d)),p.G==3&&hu(p)},gn.prototype.N=function(){this.g.l=null,delete this.j,_p(this.g),delete this.g,gn.aa.N.call(this)};function xT(d){fp.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var p=d.__sm__;if(p){e:{for(const k in p){d=k;break e}d=void 0}(this.i=d)&&(d=this.i,p=p!==null&&d in p?p[d]:void 0),this.data=p}else this.data=d}b(xT,fp);function AT(){pp.call(this),this.status=1}b(AT,pp);function ao(d){this.g=d}b(ao,RT),ao.prototype.ua=function(){Ht(this.g,"a")},ao.prototype.ta=function(d){Ht(this.g,new xT(d))},ao.prototype.sa=function(d){Ht(this.g,new AT)},ao.prototype.ra=function(){Ht(this.g,"b")},pu.prototype.createWebChannel=pu.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,PP=function(){return new pu},IP=function(){return tu()},CP=ds,ev={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},nu.NO_ERROR=0,nu.TIMEOUT=8,nu.HTTP_ERROR=6,dd=nu,Kb.COMPLETE="complete",EP=Kb,Bb.EventType=Va,Va.OPEN="a",Va.CLOSE="b",Va.ERROR="c",Va.MESSAGE="d",Rt.prototype.listen=Rt.prototype.K,gc=Bb,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,SP=Je}).apply(typeof Mu<"u"?Mu:typeof self<"u"?self:typeof window<"u"?window:{});const Uw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pa="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks=new uf("@firebase/firestore");function go(){return Ks.logLevel}function X(t,...e){if(Ks.logLevel<=me.DEBUG){const n=e.map(x0);Ks.debug(`Firestore (${Pa}): ${t}`,...n)}}function er(t,...e){if(Ks.logLevel<=me.ERROR){const n=e.map(x0);Ks.error(`Firestore (${Pa}): ${t}`,...n)}}function da(t,...e){if(Ks.logLevel<=me.WARN){const n=e.map(x0);Ks.warn(`Firestore (${Pa}): ${t}`,...n)}}function x0(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(t="Unexpected state"){const e=`FIRESTORE (${Pa}) INTERNAL ASSERTION FAILED: `+t;throw er(e),new Error(e)}function Ge(t,e){t||ce()}function Te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends si{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ut.UNAUTHENTICATED))}shutdown(){}}class JF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class YF{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ge(this.o===void 0);let i=this.i;const r=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve();let s=new Ns;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ns,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{X("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(X("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ns)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==e?(X("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ge(typeof i.accessToken=="string"),new RP(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ge(e===null||typeof e=="string"),new Ut(e)}}class XF{constructor(e,n,i){this.l=e,this.h=n,this.P=i,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class ZF{constructor(e,n,i){this.l=e,this.h=n,this.P=i}getToken(){return Promise.resolve(new XF(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eV{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tV{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ge(this.o===void 0);const i=s=>{s.error!=null&&X("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,X("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{X("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):X("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ge(typeof n.token=="string"),this.R=n.token,new eV(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nV(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=nV(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=e.charAt(r[s]%e.length))}return i}}function be(t,e){return t<e?-1:t>e?1:0}function ha(t,e,n){return t.length===e.length&&t.every((i,r)=>n(i,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wi=class hd{static now(){return hd.fromMillis(Date.now())}static fromDate(e){return hd.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*n));return new hd(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{static fromTimestamp(e){return new oe(e)}static min(){return new oe(new wi(0,0))}static max(){return new oe(new wi(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,n,i){n===void 0?n=0:n>e.length&&ce(),i===void 0?i=e.length-n:i>e.length-n&&ce(),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return hl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof hl?e.forEach(i=>{n.push(i)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let r=0;r<i;r++){const s=e.get(r),o=n.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class et extends hl{construct(e,n,i){return new et(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new te(J.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new et(n)}static emptyPath(){return new et([])}}const rV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gt extends hl{construct(e,n,i){return new Gt(e,n,i)}static isValidIdentifier(e){return rV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Gt(["__name__"])}static fromServerFormat(e){const n=[];let i="",r=0;const s=()=>{if(i.length===0)throw new te(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new te(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new te(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new te(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gt(n)}static emptyPath(){return new Gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(et.fromString(e))}static fromName(e){return new ie(et.fromString(e).popFirst(5))}static empty(){return new ie(et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return et.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new et(e.slice()))}}function sV(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=oe.fromTimestamp(i===1e9?new wi(n+1,0):new wi(n,i));return new Gr(r,ie.empty(),e)}function oV(t){return new Gr(t.readTime,t.key,-1)}class Gr{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Gr(oe.min(),ie.empty(),-1)}static max(){return new Gr(oe.max(),ie.empty(),-1)}}function aV(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vf(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==cV)throw t;X("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(n,s).next(i,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,i)=>{n(e)})}static reject(e){return new q((n,i)=>{i(e)})}static waitFor(e){return new q((n,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&n()},c=>i(c))}),o=!0,s===r&&n()})}static or(e){let n=q.resolve(!1);for(const i of e)n=n.next(r=>r?q.resolve(r):i());return n}static forEach(e,n){const i=[];return e.forEach((r,s)=>{i.push(n.call(this,r,s))}),this.waitFor(i)}static mapArray(e,n){return new q((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(e,n){return new q((i,r)=>{const s=()=>{e()===!0?n().next(()=>{s()},r):i()};s()})}}function uV(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ra(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}yf.oe=-1;function bf(t){return t==null}function tv(t){return t===0&&1/t==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dV(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Fw(e)),e=hV(t.get(n),e);return Fw(e)}function hV(t,e){let n=e;const i=t.length;for(let r=0;r<i;r++){const s=t.charAt(r);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function Fw(t){return t+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Vl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fV(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,n){this.comparator=e,this.root=n||St.EMPTY}insert(e,n){return new st(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new st(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,i)=>(e(n,i),!1))}toString(){const e=[];return this.inorderTraversal((n,i)=>(e.push(`${n}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Uu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Uu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Uu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Uu(this.root,e,this.comparator,!0)}}class Uu{constructor(e,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?i(e.key,n):1,n&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class St{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=i??St.RED,this.left=r??St.EMPTY,this.right=s??St.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,r,s){return new St(e??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return St.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return St.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,St.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,St.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ce();const e=this.left.check();if(e!==this.right.check())throw ce();return e+(this.isRed()?0:1)}}St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw ce()}get value(){throw ce()}get color(){throw ce()}get left(){throw ce()}get right(){throw ce()}copy(e,n,i,r,s){return this}insert(e,n,i){return new St(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.comparator=e,this.data=new st(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,i)=>(e(n),!1))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new jw(this.data.getIterator())}getIteratorFrom(e){return new jw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(i=>{n=n.add(i)}),n}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new mt(this.comparator);return n.data=e,n}}class jw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.fields=e,e.sort(Gt.comparator)}static empty(){return new xr([])}unionWith(e){let n=new mt(Gt.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new xr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ha(this.fields,e.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new xP("Invalid base64 string: "+s):s}}(e);return new Pt(n)}static fromUint8Array(e){const n=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const pV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qr(t){if(Ge(!!t),typeof t=="string"){let e=0;const n=pV.exec(t);if(Ge(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Jr(t){return typeof t=="string"?Pt.fromBase64String(t):Pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Tf(t){const e=t.mapValue.fields.__previous_value__;return A0(e)?Tf(e):e}function fl(t){const e=Qr(t.mapValue.fields.__local_write_time__.timestampValue);return new wi(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e,n,i,r,s,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class pl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new pl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof pl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Yr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?A0(t)?4:vV(t)?9007199254740991:gV(t)?10:11:ce()}function Ei(t,e){if(t===e)return!0;const n=Yr(t);if(n!==Yr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return fl(t).isEqual(fl(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Qr(r.timestampValue),a=Qr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return Jr(r.bytesValue).isEqual(Jr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return nt(r.geoPointValue.latitude)===nt(s.geoPointValue.latitude)&&nt(r.geoPointValue.longitude)===nt(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return nt(r.integerValue)===nt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=nt(r.doubleValue),a=nt(s.doubleValue);return o===a?tv(o)===tv(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ha(t.arrayValue.values||[],e.arrayValue.values||[],Ei);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(Vw(o)!==Vw(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Ei(o[c],a[c])))return!1;return!0}(t,e);default:return ce()}}function ml(t,e){return(t.values||[]).find(n=>Ei(n,e))!==void 0}function fa(t,e){if(t===e)return 0;const n=Yr(t),i=Yr(e);if(n!==i)return be(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=nt(s.integerValue||s.doubleValue),c=nt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return $w(t.timestampValue,e.timestampValue);case 4:return $w(fl(t),fl(e));case 5:return be(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Jr(s),c=Jr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){const u=be(a[l],c[l]);if(u!==0)return u}return be(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=be(nt(s.latitude),nt(o.latitude));return a!==0?a:be(nt(s.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Bw(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,l,u;const h=s.fields||{},f=o.fields||{},g=(a=h.value)===null||a===void 0?void 0:a.arrayValue,b=(c=f.value)===null||c===void 0?void 0:c.arrayValue,y=be(((l=g==null?void 0:g.values)===null||l===void 0?void 0:l.length)||0,((u=b==null?void 0:b.values)===null||u===void 0?void 0:u.length)||0);return y!==0?y:Bw(g,b)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Fu.mapValue&&o===Fu.mapValue)return 0;if(s===Fu.mapValue)return 1;if(o===Fu.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const f=be(c[h],u[h]);if(f!==0)return f;const g=fa(a[c[h]],l[u[h]]);if(g!==0)return g}return be(c.length,u.length)}(t.mapValue,e.mapValue);default:throw ce()}}function $w(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const n=Qr(t),i=Qr(e),r=be(n.seconds,i.seconds);return r!==0?r:be(n.nanos,i.nanos)}function Bw(t,e){const n=t.values||[],i=e.values||[];for(let r=0;r<n.length&&r<i.length;++r){const s=fa(n[r],i[r]);if(s)return s}return be(n.length,i.length)}function pa(t){return nv(t)}function nv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const i=Qr(n);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Jr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let i="[",r=!0;for(const s of n.values||[])r?r=!1:i+=",",i+=nv(s);return i+"]"}(t.arrayValue):"mapValue"in t?function(n){const i=Object.keys(n.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${nv(n.fields[o])}`;return r+"}"}(t.mapValue):ce()}function fd(t){switch(Yr(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Tf(t);return e?16+fd(e):16;case 5:return 2*t.stringValue.length;case 6:return Jr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,s)=>r+fd(s),0)}(t.arrayValue);case 10:case 11:return function(i){let r=0;return Vl(i.fields,(s,o)=>{r+=s.length+fd(o)}),r}(t.mapValue);default:throw ce()}}function iv(t){return!!t&&"integerValue"in t}function N0(t){return!!t&&"arrayValue"in t}function zw(t){return!!t&&"nullValue"in t}function qw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function dm(t){return!!t&&"mapValue"in t}function gV(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Nc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Vl(t.mapValue.fields,(n,i)=>e.mapValue.fields[n]=Nc(i)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Nc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function vV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.value=e}static empty(){return new vi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!dm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nc(n)}setAll(e){let n=Gt.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,i,r),i={},r=[],n=a.popLast()}o?i[a.lastSegment()]=Nc(o):r.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(e){const n=this.field(e.popLast());dm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ei(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=n.mapValue.fields[e.get(i)];dm(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,i){Vl(n,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new vi(Nc(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n,i,r,s,o,a){this.key=e,this.documentType=n,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Vt(e,0,oe.min(),oe.min(),oe.min(),vi.empty(),0)}static newFoundDocument(e,n,i,r){return new Vt(e,1,n,oe.min(),i,r,0)}static newNoDocument(e,n){return new Vt(e,2,n,oe.min(),oe.min(),vi.empty(),0)}static newUnknownDocument(e,n){return new Vt(e,3,n,oe.min(),oe.min(),vi.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,n){this.position=e,this.inclusive=n}}function Hw(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(s.field.isKeyField()?i=ie.comparator(ie.fromName(o.referenceValue),n.key):i=fa(o,n.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ww(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ei(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,n="asc"){this.field=e,this.dir=n}}function yV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{}class ft extends AP{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new TV(e,n,i):n==="array-contains"?new _V(e,i):n==="in"?new SV(e,i):n==="not-in"?new EV(e,i):n==="array-contains-any"?new CV(e,i):new ft(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new kV(e,i):new wV(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(fa(n,this.value)):n!==null&&Yr(this.value)===Yr(n)&&this.matchesComparison(fa(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ci extends AP{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Ci(e,n)}matches(e){return NP(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function NP(t){return t.op==="and"}function OP(t){return bV(t)&&NP(t)}function bV(t){for(const e of t.filters)if(e instanceof Ci)return!1;return!0}function rv(t){if(t instanceof ft)return t.field.canonicalString()+t.op.toString()+pa(t.value);if(OP(t))return t.filters.map(e=>rv(e)).join(",");{const e=t.filters.map(n=>rv(n)).join(",");return`${t.op}(${e})`}}function DP(t,e){return t instanceof ft?function(i,r){return r instanceof ft&&i.op===r.op&&i.field.isEqual(r.field)&&Ei(i.value,r.value)}(t,e):t instanceof Ci?function(i,r){return r instanceof Ci&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&DP(o,r.filters[a]),!0):!1}(t,e):void ce()}function LP(t){return t instanceof ft?function(n){return`${n.field.canonicalString()} ${n.op} ${pa(n.value)}`}(t):t instanceof Ci?function(n){return n.op.toString()+" {"+n.getFilters().map(LP).join(" ,")+"}"}(t):"Filter"}class TV extends ft{constructor(e,n,i){super(e,n,i),this.key=ie.fromName(i.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class kV extends ft{constructor(e,n){super(e,"in",n),this.keys=MP("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class wV extends ft{constructor(e,n){super(e,"not-in",n),this.keys=MP("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function MP(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>ie.fromName(i.referenceValue))}class _V extends ft{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return N0(n)&&ml(n.arrayValue,this.value)}}class SV extends ft{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ml(this.value.arrayValue,n)}}class EV extends ft{constructor(e,n){super(e,"not-in",n)}matches(e){if(ml(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ml(this.value.arrayValue,n)}}class CV extends ft{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!N0(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>ml(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(e,n=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Kw(t,e=null,n=[],i=[],r=null,s=null,o=null){return new IV(t,e,n,i,r,s,o)}function O0(t){const e=Te(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(i=>rv(i)).join(","),n+="|ob:",n+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),bf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(i=>pa(i)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(i=>pa(i)).join(",")),e.ue=n}return e.ue}function D0(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!yV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!DP(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ww(t.startAt,e.startAt)&&Ww(t.endAt,e.endAt)}function sv(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,n=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function PV(t,e,n,i,r,s,o,a){return new kf(t,e,n,i,r,s,o,a)}function UP(t){return new kf(t)}function Gw(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function RV(t){return t.collectionGroup!==null}function Oc(t){const e=Te(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new mt(Gt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new bh(s,i))}),n.has(Gt.keyField().canonicalString())||e.ce.push(new bh(Gt.keyField(),i))}return e.ce}function _i(t){const e=Te(t);return e.le||(e.le=xV(e,Oc(t))),e.le}function xV(t,e){if(t.limitType==="F")return Kw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new bh(r.field,s)});const n=t.endAt?new yh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new yh(t.startAt.position,t.startAt.inclusive):null;return Kw(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function ov(t,e,n){return new kf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function wf(t,e){return D0(_i(t),_i(e))&&t.limitType===e.limitType}function FP(t){return`${O0(_i(t))}|lt:${t.limitType}`}function vo(t){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(r=>LP(r)).join(", ")}]`),bf(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(r=>pa(r)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(r=>pa(r)).join(",")),`Target(${i})`}(_i(t))}; limitType=${t.limitType})`}function _f(t,e){return e.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ie.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(t,e)&&function(i,r){for(const s of Oc(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(i,r){return!(i.startAt&&!function(o,a,c){const l=Hw(o,a,c);return o.inclusive?l<=0:l<0}(i.startAt,Oc(i),r)||i.endAt&&!function(o,a,c){const l=Hw(o,a,c);return o.inclusive?l>=0:l>0}(i.endAt,Oc(i),r))}(t,e)}function AV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function VP(t){return(e,n)=>{let i=!1;for(const r of Oc(t)){const s=NV(r,e,n);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function NV(t,e,n){const i=t.field.isKeyField()?ie.comparator(e.key,n.key):function(s,o,a){const c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?fa(c,l):ce()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return ce()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Vl(this.inner,(n,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return fV(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV=new st(ie.comparator);function Xr(){return OV}const jP=new st(ie.comparator);function vc(...t){let e=jP;for(const n of t)e=e.insert(n.key,n);return e}function DV(t){let e=jP;return t.forEach((n,i)=>e=e.insert(n,i.overlayedDocument)),e}function _s(){return Dc()}function $P(){return Dc()}function Dc(){return new no(t=>t.toString(),(t,e)=>t.isEqual(e))}const LV=new mt(ie.comparator);function we(...t){let e=LV;for(const n of t)e=e.add(n);return e}const MV=new mt(be);function UV(){return MV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FV(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tv(e)?"-0":e}}function VV(t){return{integerValue:""+t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(){this._=void 0}}function jV(t,e,n){return t instanceof av?function(r,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&A0(s)&&(s=Tf(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Th?BP(t,e):t instanceof kh?zP(t,e):function(r,s){const o=BV(r,s),a=Qw(o)+Qw(r.Pe);return iv(o)&&iv(r.Pe)?VV(a):FV(r.serializer,a)}(t,e)}function $V(t,e,n){return t instanceof Th?BP(t,e):t instanceof kh?zP(t,e):n}function BV(t,e){return t instanceof cv?function(i){return iv(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}class av extends Sf{}class Th extends Sf{constructor(e){super(),this.elements=e}}function BP(t,e){const n=qP(e);for(const i of t.elements)n.some(r=>Ei(r,i))||n.push(i);return{arrayValue:{values:n}}}class kh extends Sf{constructor(e){super(),this.elements=e}}function zP(t,e){let n=qP(e);for(const i of t.elements)n=n.filter(r=>!Ei(r,i));return{arrayValue:{values:n}}}class cv extends Sf{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Qw(t){return nt(t.integerValue||t.doubleValue)}function qP(t){return N0(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function zV(t,e){return t.field.isEqual(e.field)&&function(i,r){return i instanceof Th&&r instanceof Th||i instanceof kh&&r instanceof kh?ha(i.elements,r.elements,Ei):i instanceof cv&&r instanceof cv?Ei(i.Pe,r.Pe):i instanceof av&&r instanceof av}(t.transform,e.transform)}class Os{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Os}static exists(e){return new Os(void 0,e)}static updateTime(e){return new Os(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class L0{}function HP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new HV(t.key,Os.none()):new M0(t.key,t.data,Os.none());{const n=t.data,i=vi.empty();let r=new mt(Gt.comparator);for(let s of e.fields)if(!r.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Ef(t.key,i,new xr(r.toArray()),Os.none())}}function qV(t,e,n){t instanceof M0?function(r,s,o){const a=r.value.clone(),c=Yw(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ef?function(r,s,o){if(!pd(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Yw(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(WP(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Lc(t,e,n,i){return t instanceof M0?function(s,o,a,c){if(!pd(s.precondition,o))return a;const l=s.value.clone(),u=Xw(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,i):t instanceof Ef?function(s,o,a,c){if(!pd(s.precondition,o))return a;const l=Xw(s.fieldTransforms,c,o),u=o.data;return u.setAll(WP(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,i):function(s,o,a){return pd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Jw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&ha(i,r,(s,o)=>zV(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class M0 extends L0{constructor(e,n,i,r=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ef extends L0{constructor(e,n,i,r,s=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function WP(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function Yw(t,e,n){const i=new Map;Ge(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,$V(o,a,n[r]))}return i}function Xw(t,e,n){const i=new Map;for(const r of t){const s=r.transform,o=n.data.field(r.field);i.set(r.field,jV(s,o,e))}return i}class HV extends L0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e,n,i,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&qV(s,e,i[r])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Lc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Lc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=$P();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(r.key)?null:a;const c=HP(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(oe.min())}),i}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),we())}isEqual(e){return this.batchId===e.batchId&&ha(this.mutations,e.mutations,(n,i)=>Jw(n,i))&&ha(this.baseMutations,e.baseMutations,(n,i)=>Jw(n,i))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ot,ye;function KP(t){if(t===void 0)return er("GRPC error has no .code"),J.UNKNOWN;switch(t){case ot.OK:return J.OK;case ot.CANCELLED:return J.CANCELLED;case ot.UNKNOWN:return J.UNKNOWN;case ot.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case ot.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case ot.INTERNAL:return J.INTERNAL;case ot.UNAVAILABLE:return J.UNAVAILABLE;case ot.UNAUTHENTICATED:return J.UNAUTHENTICATED;case ot.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case ot.NOT_FOUND:return J.NOT_FOUND;case ot.ALREADY_EXISTS:return J.ALREADY_EXISTS;case ot.PERMISSION_DENIED:return J.PERMISSION_DENIED;case ot.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case ot.ABORTED:return J.ABORTED;case ot.OUT_OF_RANGE:return J.OUT_OF_RANGE;case ot.UNIMPLEMENTED:return J.UNIMPLEMENTED;case ot.DATA_LOSS:return J.DATA_LOSS;default:return ce()}}(ye=ot||(ot={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JV=new As([4294967295,4294967295],0);function Zw(t){const e=QV().encode(t),n=new _P;return n.update(e),new Uint8Array(n.digest())}function e_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new As([n,i],0),new As([r,s],0)]}class U0{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new yc(`Invalid padding: ${n}`);if(i<0)throw new yc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new yc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new yc(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ie=As.fromNumber(this.Te)}Ee(e,n,i){let r=e.add(n.multiply(As.fromNumber(i)));return r.compare(JV)===1&&(r=new As([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=Zw(e),[i,r]=e_(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(e,n,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new U0(s,r,n);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const n=Zw(e),[i,r]=e_(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class yc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,n,i,r,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const r=new Map;return r.set(e,jl.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Cf(oe.min(),r,new st(be),Xr(),we())}}class jl{constructor(e,n,i,r,s){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new jl(i,n,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,n,i,r){this.Re=e,this.removedTargetIds=n,this.key=i,this.Ve=r}}class GP{constructor(e,n){this.targetId=e,this.me=n}}class QP{constructor(e,n,i=Pt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=r}}class t_{constructor(){this.fe=0,this.ge=n_(),this.pe=Pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=we(),n=we(),i=we();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:ce()}}),new jl(this.pe,this.ye,e,n,i)}Ce(){this.we=!1,this.ge=n_()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ge(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class YV{constructor(e){this.Le=e,this.Be=new Map,this.ke=Xr(),this.qe=Vu(),this.Qe=Vu(),this.Ke=new st(be)}$e(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(n,e.Ve):this.We(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.We(n,e.key,e.Ve)}Ge(e){this.forEachTarget(e,n=>{const i=this.ze(n);switch(e.state){case 0:this.je(n)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(n);break;case 3:this.je(n)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),i.De(e.resumeToken));break;default:ce()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((i,r)=>{this.je(r)&&n(r)})}Je(e){const n=e.targetId,i=e.me.count,r=this.Ye(n);if(r){const s=r.target;if(sv(s))if(i===0){const o=new ie(s.path);this.We(n,o,Vt.newNoDocument(o,oe.min()))}else Ge(i===1);else{const o=this.Ze(n);if(o!==i){const a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,l)}}}}}Xe(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=n;let o,a;try{o=Jr(i).toUint8Array()}catch(c){if(c instanceof xP)return da("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new U0(o,r,s)}catch(c){return da(c instanceof yc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,i){return n.me.count===i-this.rt(e,n.targetId)?0:2}rt(e,n){const i=this.Le.getRemoteKeysForTarget(n);let r=0;return i.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),r++)}),r}it(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&sv(a.target)){const c=new ie(a.target.path);this.st(c).has(o)||this.ot(o,c)||this.We(o,c,Vt.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let i=we();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ye(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const r=new Cf(e,n,this.Ke,this.ke,i);return this.ke=Xr(),this.qe=Vu(),this.Qe=Vu(),this.Ke=new st(be),r}Ue(e,n){if(!this.je(e))return;const i=this.ot(e,n.key)?2:0;this.ze(e).Fe(n.key,i),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e)),this.Qe=this.Qe.insert(n.key,this._t(n.key).add(e))}We(e,n,i){if(!this.je(e))return;const r=this.ze(e);this.ot(e,n)?r.Fe(n,1):r.Me(n),this.Qe=this.Qe.insert(n,this._t(n).delete(e)),this.Qe=this.Qe.insert(n,this._t(n).add(e)),i&&(this.ke=this.ke.insert(n,i))}removeTarget(e){this.Be.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let n=this.Be.get(e);return n||(n=new t_,this.Be.set(e,n)),n}_t(e){let n=this.Qe.get(e);return n||(n=new mt(be),this.Qe=this.Qe.insert(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new mt(be),this.qe=this.qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||X("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new t_),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}ot(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Vu(){return new st(ie.comparator)}function n_(){return new st(ie.comparator)}const XV={asc:"ASCENDING",desc:"DESCENDING"},ZV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ej={and:"AND",or:"OR"};class tj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function lv(t,e){return t.useProto3Json||bf(e)?e:{value:e}}function nj(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ij(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Ho(t){return Ge(!!t),oe.fromTimestamp(function(n){const i=Qr(n);return new wi(i.seconds,i.nanos)}(t))}function rj(t,e){return uv(t,e).canonicalString()}function uv(t,e){const n=function(r){return new et(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function JP(t){const e=et.fromString(t);return Ge(tR(e)),e}function hm(t,e){const n=JP(e);if(n.get(1)!==t.databaseId.projectId)throw new te(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(XP(n))}function YP(t,e){return rj(t.databaseId,e)}function sj(t){const e=JP(t);return e.length===4?et.emptyPath():XP(e)}function i_(t){return new et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function XP(t){return Ge(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function oj(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(Ge(u===void 0||typeof u=="string"),Pt.fromBase64String(u||"")):(Ge(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Pt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const u=l.code===void 0?J.UNKNOWN:KP(l.code);return new te(u,l.message||"")}(o);n=new QP(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=hm(t,i.document.name),s=Ho(i.document.updateTime),o=i.document.createTime?Ho(i.document.createTime):oe.min(),a=new vi({mapValue:{fields:i.document.fields}}),c=Vt.newFoundDocument(r,s,o,a),l=i.targetIds||[],u=i.removedTargetIds||[];n=new md(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=hm(t,i.document),s=i.readTime?Ho(i.readTime):oe.min(),o=Vt.newNoDocument(r,s),a=i.removedTargetIds||[];n=new md([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=hm(t,i.document),s=i.removedTargetIds||[];n=new md([],s,r,null)}else{if(!("filter"in e))return ce();{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new GV(r,s),a=i.targetId;n=new GP(a,o)}}return n}function aj(t,e){return{documents:[YP(t,e.path)]}}function cj(t,e){const n={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=YP(t,r);const s=function(l){if(l.length!==0)return eR(Ci.create(l,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(l){if(l.length!==0)return l.map(u=>function(f){return{field:yo(f.field),direction:dj(f.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=lv(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ct:n,parent:r}}function lj(t){let e=sj(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Ge(i===1);const u=n.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(h){const f=ZP(h);return f instanceof Ci&&OP(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(b){return new bh(bo(b.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,bf(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,g=h.values||[];return new yh(g,f)}(n.startAt));let l=null;return n.endAt&&(l=function(h){const f=!h.before,g=h.values||[];return new yh(g,f)}(n.endAt)),PV(e,r,o,s,a,"F",c,l)}function uj(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function ZP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=bo(n.unaryFilter.field);return ft.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=bo(n.unaryFilter.field);return ft.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bo(n.unaryFilter.field);return ft.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bo(n.unaryFilter.field);return ft.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ce()}}(t):t.fieldFilter!==void 0?function(n){return ft.create(bo(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ce()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ci.create(n.compositeFilter.filters.map(i=>ZP(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ce()}}(n.compositeFilter.op))}(t):ce()}function dj(t){return XV[t]}function hj(t){return ZV[t]}function fj(t){return ej[t]}function yo(t){return{fieldPath:t.canonicalString()}}function bo(t){return Gt.fromServerFormat(t.fieldPath)}function eR(t){return t instanceof ft?function(n){if(n.op==="=="){if(qw(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NAN"}};if(zw(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(qw(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NAN"}};if(zw(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(n.field),op:hj(n.op),value:n.value}}}(t):t instanceof Ci?function(n){const i=n.getFilters().map(r=>eR(r));return i.length===1?i[0]:{compositeFilter:{op:fj(n.op),filters:i}}}(t):ce()}function tR(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,n,i,r,s=oe.min(),o=oe.min(),a=Pt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(e){this.ht=e}}function mj(t){const e=lj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ov(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(){this.ln=new vj}addToCollectionParentIndex(e,n){return this.ln.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.ln.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(Gr.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(Gr.min())}updateCollectionGroup(e,n,i){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class vj{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n]||new mt(et.comparator),s=!r.has(i);return this.index[n]=r.add(i),s}has(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mt(et.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Zt{static withCacheSize(e){return new Zt(e,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zt.DEFAULT_COLLECTION_PERCENTILE=10,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zt.DEFAULT=new Zt(41943040,Zt.DEFAULT_COLLECTION_PERCENTILE,Zt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zt.DISABLED=new Zt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new ma(0)}static Qn(){return new ma(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_([t,e],[n,i]){const r=be(t,n);return r===0?be(e,i):r}class yj{constructor(e){this.Gn=e,this.buffer=new mt(s_),this.zn=0}jn(){return++this.zn}Hn(e){const n=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();s_(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class bj{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){X("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ra(n)?X("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await vf(n)}await this.Yn(3e5)})}}class Tj{constructor(e,n){this.Zn=e,this.params=n}calculateTargetCount(e,n){return this.Zn.Xn(e).next(i=>Math.floor(n/100*i))}nthSequenceNumber(e,n){if(n===0)return q.resolve(yf.oe);const i=new yj(n);return this.Zn.forEachTarget(e,r=>i.Hn(r.sequenceNumber)).next(()=>this.Zn.er(e,r=>i.Hn(r))).next(()=>i.maxValue)}removeTargets(e,n,i){return this.Zn.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.Zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(X("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(r_)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(X("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),r_):this.tr(e,n))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,n){let i,r,s,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(X("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,n))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(l=Date.now(),go()<=me.DEBUG&&X("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:h})))}}function kj(t,e){return new Tj(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(){this.changes=new no(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?q.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,n,i,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(i!==null&&Lc(i.mutation,r,xr.empty(),wi.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.getLocalViewOfDocuments(e,i,we()).next(()=>i))}getLocalViewOfDocuments(e,n,i=we()){const r=_s();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,i).next(s=>{let o=vc();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const i=_s();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,we()))}populateOverlays(e,n,i){const r=[];return i.forEach(s=>{n.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,i,r){let s=Xr();const o=Dc(),a=function(){return Dc()}();return n.forEach((c,l)=>{const u=i.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof Ef)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),Lc(u.mutation,l,u.mutation.getFieldMask(),wi.now())):o.set(l.key,xr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new _j(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const i=Dc();let r=new st((o,a)=>o-a),s=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=i.get(c)||xr.empty();u=a.applyToLocalView(l,u),i.set(c,u);const h=(r.get(a.batchId)||we()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=$P();u.forEach(f=>{if(!s.has(f)){const g=HP(n.get(f),i.get(f));g!==null&&h.set(f,g),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return q.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,n,i,r){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RV(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,r):this.getDocumentsMatchingCollectionQuery(e,n,i,r)}getNextDocuments(e,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,r-s.size):q.resolve(_s());let a=-1,c=s;return o.next(l=>q.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?q.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,we())).next(u=>({batchId:a,changes:DV(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(i=>{let r=vc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,i,r){const s=n.collectionGroup;let o=vc();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,c=>{const l=function(h,f){return new kf(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,i,r).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,s,r))).next(o=>{s.forEach((c,l)=>{const u=l.getKey();o.get(u)===null&&(o=o.insert(u,Vt.newInvalidDocument(u)))});let a=vc();return o.forEach((c,l)=>{const u=s.get(c);u!==void 0&&Lc(u.mutation,l,xr.empty(),wi.now()),_f(n,l)&&(a=a.insert(c,l))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,n){return q.resolve(this.Tr.get(n))}saveBundleMetadata(e,n){return this.Tr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Ho(r.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Ir.get(n))}saveNamedQuery(e,n){return this.Ir.set(n.name,function(r){return{name:r.name,query:mj(r.bundledQuery),readTime:Ho(r.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(){this.overlays=new st(ie.comparator),this.Er=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const i=_s();return q.forEach(n,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,n,i){return i.forEach((r,s)=>{this.Tt(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,i){const r=this.Er.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Er.delete(i)),q.resolve()}getOverlaysForCollection(e,n,i){const r=_s(),s=n.length+1,o=new ie(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return q.resolve(r)}getOverlaysForCollectionGroup(e,n,i,r){let s=new st((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>i){let u=s.get(l.largestBatchId);u===null&&(u=_s(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=_s(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=r)););return q.resolve(a)}Tt(e,n,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.Er.get(r.largestBatchId).delete(i.key);this.Er.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new KV(n,i));let s=this.Er.get(n);s===void 0&&(s=we(),this.Er.set(n,s)),this.Er.set(n,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(){this.dr=new mt(gt.Ar),this.Rr=new mt(gt.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,n){const i=new gt(e,n);this.dr=this.dr.add(i),this.Rr=this.Rr.add(i)}mr(e,n){e.forEach(i=>this.addReference(i,n))}removeReference(e,n){this.gr(new gt(e,n))}pr(e,n){e.forEach(i=>this.removeReference(i,n))}yr(e){const n=new ie(new et([])),i=new gt(n,e),r=new gt(n,e+1),s=[];return this.Rr.forEachInRange([i,r],o=>{this.gr(o),s.push(o.key)}),s}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const n=new ie(new et([])),i=new gt(n,e),r=new gt(n,e+1);let s=we();return this.Rr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new gt(e,0),i=this.dr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class gt{constructor(e,n){this.key=e,this.br=n}static Ar(e,n){return ie.comparator(e.key,n.key)||be(e.br,n.br)}static Vr(e,n){return be(e.br,n.br)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Dr=1,this.vr=new mt(gt.Ar)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,r){const s=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new WV(s,n,i,r);this.mutationQueue.push(o);for(const a of r)this.vr=this.vr.add(new gt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Cr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,r=this.Fr(i),s=r<0?0:r;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new gt(n,0),r=new gt(n,Number.POSITIVE_INFINITY),s=[];return this.vr.forEachInRange([i,r],o=>{const a=this.Cr(o.br);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new mt(be);return n.forEach(r=>{const s=new gt(r,0),o=new gt(r,Number.POSITIVE_INFINITY);this.vr.forEachInRange([s,o],a=>{i=i.add(a.br)})}),q.resolve(this.Mr(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,r=i.length+1;let s=i;ie.isDocumentKey(s)||(s=s.child(""));const o=new gt(new ie(s),0);let a=new mt(be);return this.vr.forEachWhile(c=>{const l=c.key.path;return!!i.isPrefixOf(l)&&(l.length===r&&(a=a.add(c.br)),!0)},o),q.resolve(this.Mr(a))}Mr(e){const n=[];return e.forEach(i=>{const r=this.Cr(i);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){Ge(this.Or(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.vr;return q.forEach(n.mutations,r=>{const s=new gt(r.key,n.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.vr=i})}Ln(e){}containsKey(e,n){const i=new gt(n,0),r=this.vr.firstAfterOrEqual(i);return q.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}Or(e,n){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const n=this.Fr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e){this.Nr=e,this.docs=function(){return new st(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,r=this.docs.get(i),s=r?r.size:0,o=this.Nr(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return q.resolve(i?i.document.mutableCopy():Vt.newInvalidDocument(n))}getEntries(e,n){let i=Xr();return n.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Vt.newInvalidDocument(r))}),q.resolve(i)}getDocumentsMatchingQuery(e,n,i,r){let s=Xr();const o=n.path,a=new ie(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||aV(oV(u),i)<=0||(r.has(u.key)||_f(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,i,r){ce()}Lr(e,n){return q.forEach(this.docs,i=>n(i))}newChangeBuffer(e){return new xj(this)}getSize(e){return q.resolve(this.size)}}class xj extends wj{constructor(e){super(),this.hr=e}applyChanges(e){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.hr.addEntry(e,r)):this.hr.removeEntry(i)}),q.waitFor(n)}getFromCache(e,n){return this.hr.getEntry(e,n)}getAllFromCache(e,n){return this.hr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.persistence=e,this.Br=new no(n=>O0(n),D0),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.kr=0,this.qr=new F0,this.targetCount=0,this.Qr=ma.qn()}forEachTarget(e,n){return this.Br.forEach((i,r)=>n(r)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.kr&&(this.kr=n),q.resolve()}Un(e){this.Br.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Qr=new ma(n),this.highestTargetId=n),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,n){return this.Un(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Un(n),q.resolve()}removeTargetData(e,n){return this.Br.delete(n.target),this.qr.yr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,i){let r=0;const s=[];return this.Br.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.Br.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),q.waitFor(s).next(()=>r)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const i=this.Br.get(n)||null;return q.resolve(i)}addMatchingKeys(e,n,i){return this.qr.mr(n,i),q.resolve()}removeMatchingKeys(e,n,i){this.qr.pr(n,i);const r=this.persistence.referenceDelegate,s=[];return r&&n.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.qr.yr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const i=this.qr.Sr(n);return q.resolve(i)}containsKey(e,n){return q.resolve(this.qr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,n){this.Kr={},this.overlays={},this.$r=new yf(0),this.Ur=!1,this.Ur=!0,this.Wr=new Ij,this.referenceDelegate=e(this),this.Gr=new Aj(this),this.indexManager=new gj,this.remoteDocumentCache=function(r){return new Rj(r)}(i=>this.referenceDelegate.zr(i)),this.serializer=new pj(n),this.jr=new Ej(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Cj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.Kr[e.toKey()];return i||(i=new Pj(n,this.referenceDelegate),this.Kr[e.toKey()]=i),i}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,n,i){X("MemoryPersistence","Starting transaction:",e);const r=new Nj(this.$r.next());return this.referenceDelegate.Hr(),i(r).next(s=>this.referenceDelegate.Jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Yr(e,n){return q.or(Object.values(this.Kr).map(i=>()=>i.containsKey(e,n)))}}class Nj extends lV{constructor(e){super(),this.currentSequenceNumber=e}}class V0{constructor(e){this.persistence=e,this.Zr=new F0,this.Xr=null}static ei(e){return new V0(e)}get ti(){if(this.Xr)return this.Xr;throw ce()}addReference(e,n,i){return this.Zr.addReference(i,n),this.ti.delete(i.toString()),q.resolve()}removeReference(e,n,i){return this.Zr.removeReference(i,n),this.ti.add(i.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.ti.add(n.toString()),q.resolve()}removeTarget(e,n){this.Zr.yr(n.targetId).forEach(r=>this.ti.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(s=>this.ti.add(s.toString()))}).next(()=>i.removeTargetData(e,n))}Hr(){this.Xr=new Set}Jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.ti,i=>{const r=ie.fromPath(i);return this.ni(e,r).next(s=>{s||n.removeEntry(r,oe.min())})}).next(()=>(this.Xr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ni(e,n).next(i=>{i?this.ti.delete(n.toString()):this.ti.add(n.toString())})}zr(e){return 0}ni(e,n){return q.or([()=>q.resolve(this.Zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Yr(e,n)])}}class wh{constructor(e,n){this.persistence=e,this.ri=new no(i=>dV(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=kj(this,n)}static ei(e,n){return new wh(e,n)}Hr(){}Jr(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Xn(e){const n=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>n.next(r=>i+r))}nr(e){let n=0;return this.er(e,i=>{n++}).next(()=>n)}er(e,n){return q.forEach(this.ri,(i,r)=>this.ir(e,i,r).next(s=>s?q.resolve():n(r)))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.Lr(e,o=>this.ir(e,o,n).next(a=>{a||(i++,s.removeEntry(o,oe.min()))})).next(()=>s.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,n){return this.ri.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.ri.set(i,e.currentSequenceNumber),q.resolve()}removeReference(e,n,i){return this.ri.set(i,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.ri.set(n,e.currentSequenceNumber),q.resolve()}zr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=fd(e.data.value)),n}ir(e,n,i){return q.or([()=>this.persistence.Yr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.ri.get(n);return q.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,n,i,r){this.targetId=e,this.fromCache=n,this.Wi=i,this.Gi=r}static zi(e,n){let i=we(),r=we();for(const s of n.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new j0(e,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return d5()?8:uV(zt())>0?6:4}()}initialize(e,n){this.Zi=e,this.indexManager=n,this.ji=!0}getDocumentsMatchingQuery(e,n,i,r){const s={result:null};return this.Xi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.es(e,n,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Oj;return this.ts(e,n,o).next(a=>{if(s.result=a,this.Hi)return this.ns(e,n,o,a.size)})}).next(()=>s.result)}ns(e,n,i,r){return i.documentReadCount<this.Ji?(go()<=me.DEBUG&&X("QueryEngine","SDK will not create cache indexes for query:",vo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),q.resolve()):(go()<=me.DEBUG&&X("QueryEngine","Query:",vo(n),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Yi*r?(go()<=me.DEBUG&&X("QueryEngine","The SDK decides to create cache indexes for query:",vo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_i(n))):q.resolve())}Xi(e,n){if(Gw(n))return q.resolve(null);let i=_i(n);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=ov(n,null,"F"),i=_i(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=we(...s);return this.Zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(c=>{const l=this.rs(n,a);return this.ss(n,l,o,c.readTime)?this.Xi(e,ov(n,null,"F")):this.os(e,l,n,c)}))})))}es(e,n,i,r){return Gw(n)||r.isEqual(oe.min())?q.resolve(null):this.Zi.getDocuments(e,i).next(s=>{const o=this.rs(n,s);return this.ss(n,o,i,r)?q.resolve(null):(go()<=me.DEBUG&&X("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),vo(n)),this.os(e,o,n,sV(r,-1)).next(a=>a))})}rs(e,n){let i=new mt(VP(e));return n.forEach((r,s)=>{_f(e,s)&&(i=i.add(s))}),i}ss(e,n,i,r){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ts(e,n,i){return go()<=me.DEBUG&&X("QueryEngine","Using full collection scan to execute query:",vo(n)),this.Zi.getDocumentsMatchingQuery(e,n,Gr.min(),i)}os(e,n,i,r){return this.Zi.getDocumentsMatchingQuery(e,i,r).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,n,i,r){this.persistence=e,this._s=n,this.serializer=r,this.us=new st(be),this.cs=new no(s=>O0(s),D0),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(i)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Sj(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.us))}}function Mj(t,e,n,i){return new Lj(t,e,n,i)}async function iR(t,e){const n=Te(t);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,n.Ps(e),n.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let c=we();for(const l of r){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of s){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(i,c).next(l=>({Ts:l,removedBatchIds:o,addedBatchIds:a}))})})}function rR(t){const e=Te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Gr.getLastRemoteSnapshotVersion(n))}function Uj(t,e){const n=Te(t),i=e.snapshotVersion;let r=n.us;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.hs.newChangeBuffer({trackRemovals:!0});r=n.us;const a=[];e.targetChanges.forEach((u,h)=>{const f=r.get(h);if(!f)return;a.push(n.Gr.removeMatchingKeys(s,u.removedDocuments,h).next(()=>n.Gr.addMatchingKeys(s,u.addedDocuments,h)));let g=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(Pt.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,i)),r=r.insert(h,g),function(y,T,v){return y.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,g,u)&&a.push(n.Gr.updateTargetData(s,g))});let c=Xr(),l=we();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(Fj(s,o,e.documentUpdates).next(u=>{c=u.Is,l=u.Es})),!i.isEqual(oe.min())){const u=n.Gr.getLastRemoteSnapshotVersion(s).next(h=>n.Gr.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.us=r,s))}function Fj(t,e,n){let i=we(),r=we();return n.forEach(s=>i=i.add(s)),e.getEntries(t,i).next(s=>{let o=Xr();return n.forEach((a,c)=>{const l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(oe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):X("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Is:o,Es:r}})}function Vj(t,e){const n=Te(t);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.Gr.getTargetData(i,e).next(s=>s?(r=s,q.resolve(r)):n.Gr.allocateTargetId(i).next(o=>(r=new Ar(e,o,"TargetPurposeListen",i.currentSequenceNumber),n.Gr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.us.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.us=n.us.insert(i.targetId,i),n.cs.set(e,i.targetId)),i})}async function dv(t,e,n){const i=Te(t),r=i.us.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Ra(o))throw o;X("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.us=i.us.remove(e),i.cs.delete(r.target)}function o_(t,e,n){const i=Te(t);let r=oe.min(),s=we();return i.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,u){const h=Te(c),f=h.cs.get(u);return f!==void 0?q.resolve(h.us.get(f)):h.Gr.getTargetData(l,u)}(i,o,_i(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Gr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i._s.getDocumentsMatchingQuery(o,e,n?r:oe.min(),n?s:we())).next(a=>(jj(i,AV(e),a),{documents:a,ds:s})))}function jj(t,e,n){let i=t.ls.get(e)||oe.min();n.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),t.ls.set(e,i)}class a_{constructor(){this.activeTargetIds=UV()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $j{constructor(){this._o=new a_,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,n,i){this.ao[e]=n}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new a_,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bj{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){X("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){X("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ju=null;function fm(){return ju===null?ju=function(){return 268435456+Math.round(2147483648*Math.random())}():ju++,"0x"+ju.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt="WebChannelConnection";class Hj extends class{get Co(){return!1}constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const i=n.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Fo=i+"://"+n.host,this.Mo=`projects/${r}/databases/${s}`,this.xo=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Oo(n,i,r,s,o){const a=fm(),c=this.No(n,i.toUriEncodedString());X("RestConnection",`Sending RPC '${n}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(l,s,o),this.Bo(n,c,l,r).then(u=>(X("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw da("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",c,"request:",r),u})}ko(n,i,r,s,o,a){return this.Oo(n,i,r,s,o)}Lo(n,i,r){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pa}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>n[o]=s),r&&r.headers.forEach((s,o)=>n[o]=s)}No(n,i){const r=zj[n];return`${this.Fo}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,n,i,r){const s=fm();return new Promise((o,a)=>{const c=new SP;c.setWithCredentials(!0),c.listenOnce(EP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case dd.NO_ERROR:const u=c.getResponseJson();X(Dt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case dd.TIMEOUT:X(Dt,`RPC '${e}' ${s} timed out`),a(new te(J.DEADLINE_EXCEEDED,"Request time out"));break;case dd.HTTP_ERROR:const h=c.getStatus();if(X(Dt,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const g=f==null?void 0:f.error;if(g&&g.status&&g.message){const b=function(T){const v=T.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(v)>=0?v:J.UNKNOWN}(g.status);a(new te(b,g.message))}else a(new te(J.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new te(J.UNAVAILABLE,"Connection failed."));break;default:ce()}}finally{X(Dt,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(r);X(Dt,`RPC '${e}' ${s} sending request:`,r),c.send(n,"POST",l,i,15)})}qo(e,n,i){const r=fm(),s=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=PP(),a=IP(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Lo(c.initMessageHeaders,n,i),c.encodeInitMessageHeaders=!0;const u=s.join("");X(Dt,`Creating RPC '${e}' stream ${r}: ${u}`,c);const h=o.createWebChannel(u,c);let f=!1,g=!1;const b=new qj({Eo:T=>{g?X(Dt,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(f||(X(Dt,`Opening RPC '${e}' stream ${r} transport.`),h.open(),f=!0),X(Dt,`RPC '${e}' stream ${r} sending:`,T),h.send(T))},Ao:()=>h.close()}),y=(T,v,w)=>{T.listen(v,S=>{try{w(S)}catch(P){setTimeout(()=>{throw P},0)}})};return y(h,gc.EventType.OPEN,()=>{g||(X(Dt,`RPC '${e}' stream ${r} transport opened.`),b.So())}),y(h,gc.EventType.CLOSE,()=>{g||(g=!0,X(Dt,`RPC '${e}' stream ${r} transport closed`),b.Do())}),y(h,gc.EventType.ERROR,T=>{g||(g=!0,da(Dt,`RPC '${e}' stream ${r} transport errored:`,T),b.Do(new te(J.UNAVAILABLE,"The operation could not be completed")))}),y(h,gc.EventType.MESSAGE,T=>{var v;if(!g){const w=T.data[0];Ge(!!w);const S=w,P=(S==null?void 0:S.error)||((v=S[0])===null||v===void 0?void 0:v.error);if(P){X(Dt,`RPC '${e}' stream ${r} received error:`,P);const R=P.status;let O=function(C){const x=ot[C];if(x!==void 0)return KP(x)}(R),E=P.message;O===void 0&&(O=J.INTERNAL,E="Unknown error status: "+R+" with message "+P.message),g=!0,b.Do(new te(O,E)),h.close()}else X(Dt,`RPC '${e}' stream ${r} received:`,w),b.vo(w)}}),y(a,CP.STAT_EVENT,T=>{T.stat===ev.PROXY?X(Dt,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===ev.NOPROXY&&X(Dt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{b.bo()},0),b}}function pm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sR(t){return new tj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e,n,i=1e3,r=1.5,s=6e4){this.li=e,this.timerId=n,this.Qo=i,this.Ko=r,this.$o=s,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const n=Math.floor(this.Uo+this.Ho()),i=Math.max(0,Date.now()-this.Go),r=Math.max(0,n-i);r>0&&X("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Uo} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,r,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e,n,i,r,s,o,a,c){this.li=e,this.Yo=i,this.Zo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new oR(e,n)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,n){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(er(n.toString()),er("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(n)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),n=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Xo===n&&this.I_(i,r)},i=>{e(()=>{const r=new te(J.UNKNOWN,"Fetching auth token failed: "+i.message);return this.E_(r)})})}I_(e,n){const i=this.T_(this.Xo);this.stream=this.d_(e,n),this.stream.Ro(()=>{i(()=>this.listener.Ro())}),this.stream.mo(()=>{i(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(r=>{i(()=>this.E_(r))}),this.stream.onMessage(r=>{i(()=>++this.n_==1?this.A_(r):this.onNext(r))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return X("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return n=>{this.li.enqueueAndForget(()=>this.Xo===e?n():(X("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Kj extends Wj{constructor(e,n,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s}d_(e,n){return this.connection.qo("Listen",e,n)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const n=oj(this.serializer,e),i=function(s){if(!("targetChange"in s))return oe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?oe.min():o.readTime?Ho(o.readTime):oe.min()}(e);return this.listener.R_(n,i)}V_(e){const n={};n.database=i_(this.serializer),n.addTarget=function(s,o){let a;const c=o.target;if(a=sv(c)?{documents:aj(s,c)}:{query:cj(s,c).ct},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=ij(s,o.resumeToken);const l=lv(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(oe.min())>0){a.readTime=nj(s,o.snapshotVersion.toTimestamp());const l=lv(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);const i=uj(this.serializer,e);i&&(n.labels=i),this.c_(n)}m_(e){const n={};n.database=i_(this.serializer),n.removeTarget=e,this.c_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj extends class{}{constructor(e,n,i,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.S_=!1}b_(){if(this.S_)throw new te(J.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,n,i,r){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Oo(e,uv(n,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new te(J.UNKNOWN,s.toString())})}ko(e,n,i,r,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.ko(e,uv(n,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(J.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class Qj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(er(n),this.C_=!1):X("OnlineStateTracker",n)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e,n,i,r,s){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=s,this.Q_.uo(o=>{i.enqueueAndForget(async()=>{Bl(this)&&(X("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=Te(c);l.k_.add(4),await $l(l),l.K_.set("Unknown"),l.k_.delete(4),await If(l)}(this))})}),this.K_=new Qj(i,r)}}async function If(t){if(Bl(t))for(const e of t.q_)await e(!0)}async function $l(t){for(const e of t.q_)await e(!1)}function aR(t,e){const n=Te(t);n.B_.has(e.targetId)||(n.B_.set(e.targetId,e),q0(n)?z0(n):xa(n).s_()&&B0(n,e))}function $0(t,e){const n=Te(t),i=xa(n);n.B_.delete(e),i.s_()&&cR(n,e),n.B_.size===0&&(i.s_()?i.a_():Bl(n)&&n.K_.set("Unknown"))}function B0(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(oe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}xa(t).V_(e)}function cR(t,e){t.U_.xe(e),xa(t).m_(e)}function z0(t){t.U_=new YV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),xa(t).start(),t.K_.F_()}function q0(t){return Bl(t)&&!xa(t).i_()&&t.B_.size>0}function Bl(t){return Te(t).k_.size===0}function lR(t){t.U_=void 0}async function Yj(t){t.K_.set("Online")}async function Xj(t){t.B_.forEach((e,n)=>{B0(t,e)})}async function Zj(t,e){lR(t),q0(t)?(t.K_.O_(e),z0(t)):t.K_.set("Unknown")}async function e6(t,e,n){if(t.K_.set("Online"),e instanceof QP&&e.state===2&&e.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.B_.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.B_.delete(a),r.U_.removeTarget(a))}(t,e)}catch(i){X("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await l_(t,i)}else if(e instanceof md?t.U_.$e(e):e instanceof GP?t.U_.Je(e):t.U_.Ge(e),!n.isEqual(oe.min()))try{const i=await rR(t.localStore);n.compareTo(i)>=0&&await function(s,o){const a=s.U_.it(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.B_.get(l);u&&s.B_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{const u=s.B_.get(c);if(!u)return;s.B_.set(c,u.withResumeToken(Pt.EMPTY_BYTE_STRING,u.snapshotVersion)),cR(s,c);const h=new Ar(u.target,c,l,u.sequenceNumber);B0(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(i){X("RemoteStore","Failed to raise snapshot:",i),await l_(t,i)}}async function l_(t,e,n){if(!Ra(e))throw e;t.k_.add(1),await $l(t),t.K_.set("Offline"),n||(n=()=>rR(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{X("RemoteStore","Retrying IndexedDB access"),await n(),t.k_.delete(1),await If(t)})}async function u_(t,e){const n=Te(t);n.asyncQueue.verifyOperationInProgress(),X("RemoteStore","RemoteStore received new credentials");const i=Bl(n);n.k_.add(3),await $l(n),i&&n.K_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.k_.delete(3),await If(n)}async function t6(t,e){const n=Te(t);e?(n.k_.delete(2),await If(n)):e||(n.k_.add(2),await $l(n),n.K_.set("Unknown"))}function xa(t){return t.W_||(t.W_=function(n,i,r){const s=Te(n);return s.b_(),new Kj(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{Ro:Yj.bind(null,t),mo:Xj.bind(null,t),po:Zj.bind(null,t),R_:e6.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),q0(t)?z0(t):t.K_.set("Unknown")):(await t.W_.stop(),lR(t))})),t.W_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e,n,i,r,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,r,s){const o=Date.now()+i,a=new H0(e,n,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uR(t,e){if(er("AsyncQueue",`${e}: ${t}`),Ra(t))return new te(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{static emptySet(e){return new Wo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||ie.comparator(n.key,i.key):(n,i)=>ie.comparator(n.key,i.key),this.keyedMap=vc(),this.sortedSet=new st(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,i)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Wo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Wo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(){this.z_=new st(ie.comparator)}track(e){const n=e.doc.key,i=this.z_.get(n);i?e.type!==0&&i.type===3?this.z_=this.z_.insert(n,e):e.type===3&&i.type!==1?this.z_=this.z_.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.z_=this.z_.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.z_=this.z_.remove(n):e.type===1&&i.type===2?this.z_=this.z_.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):ce():this.z_=this.z_.insert(n,e)}j_(){const e=[];return this.z_.inorderTraversal((n,i)=>{e.push(i)}),e}}class ga{constructor(e,n,i,r,s,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,i,r,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ga(e,n,Wo.emptySet(n),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class i6{constructor(){this.queries=h_(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(n,i){const r=Te(n),s=r.queries;r.queries=h_(),s.forEach((o,a)=>{for(const c of a.J_)c.onError(i)})})(this,new te(J.ABORTED,"Firestore shutting down"))}}function h_(){return new no(t=>FP(t),wf)}async function r6(t,e){const n=Te(t);let i=3;const r=e.query;let s=n.queries.get(r);s?!s.Y_()&&e.Z_()&&(i=2):(s=new n6,i=e.Z_()?0:1);try{switch(i){case 0:s.H_=await n.onListen(r,!0);break;case 1:s.H_=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=uR(o,`Initialization of query '${vo(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.J_.push(e),e.ea(n.onlineState),s.H_&&e.ta(s.H_)&&W0(n)}async function s6(t,e){const n=Te(t),i=e.query;let r=3;const s=n.queries.get(i);if(s){const o=s.J_.indexOf(e);o>=0&&(s.J_.splice(o,1),s.J_.length===0?r=e.Z_()?0:1:!s.Y_()&&e.Z_()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function o6(t,e){const n=Te(t);let i=!1;for(const r of e){const s=r.query,o=n.queries.get(s);if(o){for(const a of o.J_)a.ta(r)&&(i=!0);o.H_=r}}i&&W0(n)}function a6(t,e,n){const i=Te(t),r=i.queries.get(e);if(r)for(const s of r.J_)s.onError(n);i.queries.delete(e)}function W0(t){t.X_.forEach(e=>{e.next()})}var hv,f_;(f_=hv||(hv={})).na="default",f_.Cache="cache";class c6{constructor(e,n,i){this.query=e,this.ra=n,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=i||{}}ta(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new ga(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ia?this.oa(e)&&(this.ra.next(e),n=!0):this._a(e,this.onlineState)&&(this.aa(e),n=!0),this.sa=e,n}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let n=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),n=!0),n}_a(e,n){if(!e.fromCache||!this.Z_())return!0;const i=n!=="Offline";return(!this.options.ua||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const n=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}aa(e){e=ga.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==hv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e){this.key=e}}class hR{constructor(e){this.key=e}}class l6{constructor(e,n){this.query=e,this.da=n,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=we(),this.mutatedKeys=we(),this.Va=VP(e),this.ma=new Wo(this.Va)}get fa(){return this.da}ga(e,n){const i=n?n.pa:new d_,r=n?n.ma:this.ma;let s=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const f=r.get(u),g=_f(this.query,h)?h:null,b=!!f&&this.mutatedKeys.has(f.key),y=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let T=!1;f&&g?f.data.isEqual(g.data)?b!==y&&(i.track({type:3,doc:g}),T=!0):this.ya(f,g)||(i.track({type:2,doc:g}),T=!0,(c&&this.Va(g,c)>0||l&&this.Va(g,l)<0)&&(a=!0)):!f&&g?(i.track({type:0,doc:g}),T=!0):f&&!g&&(i.track({type:1,doc:f}),T=!0,(c||l)&&(a=!0)),T&&(g?(o=o.add(g),s=y?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{ma:o,pa:i,ss:a,mutatedKeys:s}}ya(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,r){const s=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((u,h)=>function(g,b){const y=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce()}};return y(g)-y(b)}(u.type,h.type)||this.Va(u.doc,h.doc)),this.wa(i),r=r!=null&&r;const a=n&&!r?this.Sa():[],c=this.Ra.size===0&&this.current&&!r?1:0,l=c!==this.Aa;return this.Aa=c,o.length!==0||l?{snapshot:new ga(this.query,e.ma,s,o,e.mutatedKeys,c===0,l,!1,!!i&&i.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new d_,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(n=>this.da=this.da.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.da=this.da.delete(n)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=we(),this.ma.forEach(i=>{this.Da(i.key)&&(this.Ra=this.Ra.add(i.key))});const n=[];return e.forEach(i=>{this.Ra.has(i)||n.push(new hR(i))}),this.Ra.forEach(i=>{e.has(i)||n.push(new dR(i))}),n}va(e){this.da=e.ds,this.Ra=we();const n=this.ga(e.documents);return this.applyChanges(n,!0)}Ca(){return ga.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class u6{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class d6{constructor(e){this.key=e,this.Fa=!1}}class h6{constructor(e,n,i,r,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new no(a=>FP(a),wf),this.Oa=new Map,this.Na=new Set,this.La=new st(ie.comparator),this.Ba=new Map,this.ka=new F0,this.qa={},this.Qa=new Map,this.Ka=ma.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function f6(t,e,n=!0){const i=vR(t);let r;const s=i.xa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Ca()):r=await fR(i,e,n,!0),r}async function p6(t,e){const n=vR(t);await fR(n,e,!0,!1)}async function fR(t,e,n,i){const r=await Vj(t.localStore,_i(e)),s=r.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return i&&(a=await m6(t,e,s,o==="current",r.resumeToken)),t.isPrimaryClient&&n&&aR(t.remoteStore,r),a}async function m6(t,e,n,i,r){t.Ua=(h,f,g)=>async function(y,T,v,w){let S=T.view.ga(v);S.ss&&(S=await o_(y.localStore,T.query,!1).then(({documents:E})=>T.view.ga(E,S)));const P=w&&w.targetChanges.get(T.targetId),R=w&&w.targetMismatches.get(T.targetId)!=null,O=T.view.applyChanges(S,y.isPrimaryClient,P,R);return m_(y,T.targetId,O.ba),O.snapshot}(t,h,f,g);const s=await o_(t.localStore,e,!0),o=new l6(e,s.ds),a=o.ga(s.documents),c=jl.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",r),l=o.applyChanges(a,t.isPrimaryClient,c);m_(t,n,l.ba);const u=new u6(e,n,o);return t.xa.set(e,u),t.Oa.has(n)?t.Oa.get(n).push(e):t.Oa.set(n,[e]),l.snapshot}async function g6(t,e,n){const i=Te(t),r=i.xa.get(e),s=i.Oa.get(r.targetId);if(s.length>1)return i.Oa.set(r.targetId,s.filter(o=>!wf(o,e))),void i.xa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await dv(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&$0(i.remoteStore,r.targetId),fv(i,r.targetId)}).catch(vf)):(fv(i,r.targetId),await dv(i.localStore,r.targetId,!0))}async function v6(t,e){const n=Te(t),i=n.xa.get(e),r=n.Oa.get(i.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),$0(n.remoteStore,i.targetId))}async function pR(t,e){const n=Te(t);try{const i=await Uj(n.localStore,e);e.targetChanges.forEach((r,s)=>{const o=n.Ba.get(s);o&&(Ge(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Fa=!0:r.modifiedDocuments.size>0?Ge(o.Fa):r.removedDocuments.size>0&&(Ge(o.Fa),o.Fa=!1))}),await gR(n,i,e)}catch(i){await vf(i)}}function p_(t,e,n){const i=Te(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.xa.forEach((s,o)=>{const a=o.view.ea(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const c=Te(o);c.onlineState=a;let l=!1;c.queries.forEach((u,h)=>{for(const f of h.J_)f.ea(a)&&(l=!0)}),l&&W0(c)}(i.eventManager,e),r.length&&i.Ma.R_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function y6(t,e,n){const i=Te(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.Ba.get(e),s=r&&r.key;if(s){let o=new st(ie.comparator);o=o.insert(s,Vt.newNoDocument(s,oe.min()));const a=we().add(s),c=new Cf(oe.min(),new Map,new st(be),o,a);await pR(i,c),i.La=i.La.remove(s),i.Ba.delete(e),K0(i)}else await dv(i.localStore,e,!1).then(()=>fv(i,e,n)).catch(vf)}function fv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Oa.get(e))t.xa.delete(i),n&&t.Ma.Wa(i,n);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(i=>{t.ka.containsKey(i)||mR(t,i)})}function mR(t,e){t.Na.delete(e.path.canonicalString());const n=t.La.get(e);n!==null&&($0(t.remoteStore,n),t.La=t.La.remove(e),t.Ba.delete(n),K0(t))}function m_(t,e,n){for(const i of n)i instanceof dR?(t.ka.addReference(i.key,e),b6(t,i)):i instanceof hR?(X("SyncEngine","Document no longer in limbo: "+i.key),t.ka.removeReference(i.key,e),t.ka.containsKey(i.key)||mR(t,i.key)):ce()}function b6(t,e){const n=e.key,i=n.path.canonicalString();t.La.get(n)||t.Na.has(i)||(X("SyncEngine","New document in limbo: "+n),t.Na.add(i),K0(t))}function K0(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const n=new ie(et.fromString(e)),i=t.Ka.next();t.Ba.set(i,new d6(n)),t.La=t.La.insert(n,i),aR(t.remoteStore,new Ar(_i(UP(n.path)),i,"TargetPurposeLimboResolution",yf.oe))}}async function gR(t,e,n){const i=Te(t),r=[],s=[],o=[];i.xa.isEmpty()||(i.xa.forEach((a,c)=>{o.push(i.Ua(c,e,n).then(l=>{var u;if((l||n)&&i.isPrimaryClient){const h=l?!l.fromCache:(u=n==null?void 0:n.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;i.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){r.push(l);const h=j0.zi(c.targetId,l);s.push(h)}}))}),await Promise.all(o),i.Ma.R_(r),await async function(c,l){const u=Te(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>q.forEach(l,f=>q.forEach(f.Wi,g=>u.persistence.referenceDelegate.addReference(h,f.targetId,g)).next(()=>q.forEach(f.Gi,g=>u.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))}catch(h){if(!Ra(h))throw h;X("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const f=h.targetId;if(!h.fromCache){const g=u.us.get(f),b=g.snapshotVersion,y=g.withLastLimboFreeSnapshotVersion(b);u.us=u.us.insert(f,y)}}}(i.localStore,s))}async function T6(t,e){const n=Te(t);if(!n.currentUser.isEqual(e)){X("SyncEngine","User change. New user:",e.toKey());const i=await iR(n.localStore,e);n.currentUser=e,function(s,o){s.Qa.forEach(a=>{a.forEach(c=>{c.reject(new te(J.CANCELLED,o))})}),s.Qa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await gR(n,i.Ts)}}function k6(t,e){const n=Te(t),i=n.Ba.get(e);if(i&&i.Fa)return we().add(i.key);{let r=we();const s=n.Oa.get(e);if(!s)return r;for(const o of s){const a=n.xa.get(o);r=r.unionWith(a.view.fa)}return r}}function vR(t){const e=Te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=pR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=k6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=y6.bind(null,e),e.Ma.R_=o6.bind(null,e.eventManager),e.Ma.Wa=a6.bind(null,e.eventManager),e}class _h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sR(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,n){return null}Ya(e,n){return null}Ha(e){return Mj(this.persistence,new Dj,e.initialUser,this.serializer)}ja(e){return new nR(V0.ei,this.serializer)}za(e){return new $j}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_h.provider={build:()=>new _h};class w6 extends _h{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,n){Ge(this.persistence.referenceDelegate instanceof wh);const i=this.persistence.referenceDelegate.garbageCollector;return new bj(i,e.asyncQueue,n)}ja(e){const n=this.cacheSizeBytes!==void 0?Zt.withCacheSize(this.cacheSizeBytes):Zt.DEFAULT;return new nR(i=>wh.ei(i,n),this.serializer)}}class pv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>p_(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=T6.bind(null,this.syncEngine),await t6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new i6}()}createDatastore(e){const n=sR(e.databaseInfo.databaseId),i=function(s){return new Hj(s)}(e.databaseInfo);return function(s,o,a,c){return new Gj(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return function(i,r,s,o,a){return new Jj(i,r,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>p_(this.syncEngine,n,0),function(){return c_.p()?new c_:new Bj}())}createSyncEngine(e,n){return function(r,s,o,a,c,l,u){const h=new h6(r,s,o,a,c,l);return u&&(h.$a=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const s=Te(r);X("RemoteStore","RemoteStore shutting down."),s.k_.add(5),await $l(s),s.Q_.shutdown(),s.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}pv.provider={build:()=>new pv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):er("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e,n,i,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=r,this.user=Ut.UNAUTHENTICATED,this.clientId=iV.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async o=>{X("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(X("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=uR(n,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function mm(t,e){t.asyncQueue.verifyOperationInProgress(),X("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(async r=>{i.isEqual(r)||(await iR(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function g_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await E6(t);X("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(i=>u_(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,r)=>u_(e.remoteStore,r)),t._onlineComponents=e}async function E6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){X("FirestoreClient","Using user provided OfflineComponentProvider");try{await mm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===J.FAILED_PRECONDITION||r.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;da("Error using user provided cache. Falling back to memory cache: "+n),await mm(t,new _h)}}else X("FirestoreClient","Using default OfflineComponentProvider"),await mm(t,new w6(void 0));return t._offlineComponents}async function C6(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(X("FirestoreClient","Using user provided OnlineComponentProvider"),await g_(t,t._uninitializedComponentsProvider._online)):(X("FirestoreClient","Using default OnlineComponentProvider"),await g_(t,new pv))),t._onlineComponents}async function I6(t){const e=await C6(t),n=e.eventManager;return n.onListen=f6.bind(null,e.syncEngine),n.onUnlisten=g6.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=p6.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=v6.bind(null,e.syncEngine),n}function P6(t,e,n={}){const i=new Ns;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,c,l){const u=new _6({next:f=>{u.eu(),o.enqueueAndForget(()=>s6(s,h)),f.fromCache&&c.source==="server"?l.reject(new te(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(f)},error:f=>l.reject(f)}),h=new c6(a,u,{includeMetadataChanges:!0,ua:!0});return r6(s,h)}(await I6(t),t.asyncQueue,e,n,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_=new Map;function R6(t,e,n,i){if(e===!0&&i===!0)throw new te(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function y_(t){if(ie.isDocumentKey(t))throw new te(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function x6(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ce()}function mv(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=x6(t);throw new te(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e){var n,i;if(e.host===void 0){if(e.ssl!==void 0)throw new te(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}R6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yR((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new te(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new te(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new te(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class G0{constructor(e,n,i,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b_(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new QF;switch(i.type){case"firstParty":return new ZF(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new te(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=v_.get(n);i&&(X("ComponentProvider","Removing Datastore"),v_.delete(n),i.terminate())}(this),Promise.resolve()}}function A6(t,e,n,i={}){var r;const s=(t=mv(t,G0))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&da("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if(typeof i.mockUserToken=="string")a=i.mockUserToken,c=Ut.MOCK_USER;else{a=s5(i.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new te(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ut(l)}t._authCredentials=new JF(new RP(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pf(this.firestore,e,this._query)}}class Aa{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ko(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Aa(this.firestore,e,this._key)}}class Ko extends Pf{constructor(e,n,i){super(e,n,UP(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Aa(this.firestore,null,new ie(e))}withConverter(e){return new Ko(this.firestore,e,this._path)}}function N6(t,e,...n){if(t=oi(t),t instanceof G0){const i=et.fromString(e,...n);return y_(i),new Ko(t,null,i)}{if(!(t instanceof Aa||t instanceof Ko))throw new te(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(et.fromString(e,...n));return y_(i),new Ko(t.firestore,null,i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new oR(this,"async_queue_retry"),this.fu=()=>{const i=pm();i&&X("AsyncQueue","Visibility state changed to "+i.visibilityState),this.r_.Jo()},this.gu=e;const n=pm();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const n=pm();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const n=new Ns;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!Ra(e))throw e;X("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const n=this.gu.then(()=>(this.Ru=!0,e().catch(i=>{this.Au=i,this.Ru=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw er("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Ru=!1,i))));return this.gu=n,n}enqueueAfterDelay(e,n,i){this.pu(),this.mu.indexOf(e)>-1&&(n=0);const r=H0.createAndSchedule(this,e,n,i,s=>this.Su(s));return this.du.push(r),r}pu(){this.Au&&ce()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const n of this.du)if(n.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.du)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const n=this.du.indexOf(e);this.du.splice(n,1)}}class bR extends G0{constructor(e,n,i,r){super(e,n,i,r),this.type="firestore",this._queue=new T_,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new T_(e),this._firestoreClient=void 0,await e}}}function O6(t,e){const n=typeof t=="object"?t:df(),i=typeof t=="string"?t:"(default)",r=ls(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=hI("firestore");s&&A6(r,...s)}return r}function D6(t){if(t._terminated)throw new te(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||L6(t),t._firestoreClient}function L6(t){var e,n,i;const r=t._freezeSettings(),s=function(a,c,l,u){return new mV(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,yR(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._componentsProvider||!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),t._firestoreClient=new S6(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Sh(Pt.fromBase64String(e))}catch(n){throw new te(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Sh(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U6{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}}const F6=new RegExp("[~\\*/\\[\\]]");function V6(t,e,n){if(e.search(F6)>=0)throw k_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new TR(...e.split("."))._internalPath}catch{throw k_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function k_(t,e,n,i,r){let s=`Function ${e}() called with invalid data`;s+=". ";let o="";return new te(J.INVALID_ARGUMENT,s+t+o)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,n,i,r,s){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Aa(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new j6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(wR("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class j6 extends kR{data(){return super.data()}}function wR(t,e){return typeof e=="string"?V6(t,e):e instanceof TR?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class B6{convertValue(e,n="none"){switch(Yr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Jr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ce()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Vl(e,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertVectorValue(e){var n,i,r;const s=(r=(i=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>nt(o.doubleValue));return new U6(s)}convertGeoPoint(e){return new M6(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Tf(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(fl(e));default:return null}}convertTimestamp(e){const n=Qr(e);return new wi(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=et.fromString(e);Ge(tR(i));const r=new pl(i.get(1),i.get(3)),s=new ie(i.popFirst(5));return r.isEqual(n)||er(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class z6 extends kR{constructor(e,n,i,r,s,o){super(e,n,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new gd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(wR("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class gd extends z6{data(e={}){return super.data(e)}}class q6{constructor(e,n,i,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new $u(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(i=>{e.call(n,new gd(this._firestore,this._userDataWriter,i.key,i,new $u(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const c=new gd(r._firestore,r._userDataWriter,a.doc.key,a.doc,new $u(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const c=new gd(r._firestore,r._userDataWriter,a.doc.key,a.doc,new $u(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:H6(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function H6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce()}}class W6 extends B6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sh(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Aa(this.firestore,null,n)}}function K6(t){t=mv(t,Pf);const e=mv(t.firestore,bR),n=D6(e),i=new W6(e);return $6(t._query),P6(n,t._query).then(r=>new q6(e,i,t,r))}(function(e,n=!0){(function(r){Pa=r})(Ca),ei(new Mn("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new bR(new YF(i.getProvider("auth-internal")),new tV(i.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new te(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pl(l.options.projectId,u)}(o,r),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ln(Uw,"4.7.5",e),ln(Uw,"4.7.5","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(e,n,i){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||n.get().then(r=>this.messaging=r,()=>{}),this.appCheck||i.get().then(r=>this.appCheck=r,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),i=await this.getMessagingToken(),r=await this.getAppCheckToken(e);return{authToken:n,messagingToken:i,appCheckToken:r}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv="us-central1";class Q6{constructor(e,n,i,r,s=gv,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new G6(n,i,r),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(s);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=gv}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function J6(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const w_="@firebase/functions",__="0.12.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6="auth-internal",X6="app-check-internal",Z6="messaging-internal";function e9(t){const e=(n,{instanceIdentifier:i})=>{const r=n.getProvider("app").getImmediate(),s=n.getProvider(Y6),o=n.getProvider(Z6),a=n.getProvider(X6);return new Q6(r,s,o,a,i)};ei(new Mn(_R,e,"PUBLIC").setMultipleInstances(!0)),ln(w_,__,t),ln(w_,__,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t9(t=df(),e=gv){const i=ls(oi(t),_R).getImmediate({identifier:e}),r=hI("functions");return r&&n9(i,...r),i}function n9(t,e,n){J6(oi(t),e,n)}e9();const i9={apiKey:"AIzaSyB4KqBBfiRISzURE42wP8j8ej9nkVaLGVc",authDomain:"meetingsummary-76642.firebaseapp.com",databaseURL:"https://meetingsummary-76642-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"meetingsummary-76642",storageBucket:"meetingsummary-76642.firebasestorage.app",messagingSenderId:"718986171927",appId:"1:718986171927:web:6e090a5b342fa395476e52",measurementId:"G-PZ2JG0Y4Y5"},Rf=kI(i9);zF(Rf);const r9=C3(Rf),s9=new Fi,o9=O6(Rf);t9(Rf);const SR=()=>{const t=as(),{setGoogleUser:e}=cs(),{t:n}=Ri(),i=async()=>{try{const s=(await LU(r9,s9)).user;console.log("User Info:",s),e(s),t("/dashboard")}catch(r){console.error("Error during Google sign-in:",r)}};return I.jsx("div",{className:"flex justify-center",children:I.jsx("button",{onClick:i,className:"w-auto px-4 py-2 bg-blue-500 text-white font-semibold text-sm rounded-lg shadow-md hover:bg-blue-600 transition-colors",children:I.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[I.jsx("img",{src:"https://i.imgur.com/e4N5CDJ.png",alt:"Google logo",className:"w-5 h-5"}),I.jsx("span",{children:n("googleLogin")})]})})})};function a9(){const{t,i18n:e}=Ri(),[n,i]=m.useState(localStorage.getItem("language")||"en"),r=as(),[s,o]=m.useState(!1),{user:a,logout:c}=cs(),l=u=>{i(u),e.changeLanguage(u),localStorage.setItem("language",u),o(!1)};return I.jsxs("div",{className:"min-h-screen",children:[I.jsx("nav",{className:"fixed top-0 left-0 right-0 bg-white/90 backdrop-blur-md z-50",children:I.jsx("div",{className:"container mx-auto px-4",children:I.jsxs("div",{className:"flex items-center justify-between h-16",children:[I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx(ch,{className:"w-6 h-6 text-indigo-600"}),I.jsx("span",{className:"text-xl font-semibold text-gray-900",children:"MeetingMind"})]}),I.jsxs("div",{className:"flex items-center space-x-4",children:[a?I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsxs("span",{className:"text-gray-700",children:[t("HELLO"),", ",a.name]}),I.jsx("button",{onClick:()=>r("/dashboard"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 transition-colors",children:t("startDashboard")}),I.jsx("button",{onClick:c,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 transition-colors",children:t("logout")})]}):I.jsx(SR,{}),I.jsxs("div",{className:"relative",children:[I.jsxs("button",{className:"px-4 py-2 text-gray-700 hover:text-indigo-600 font-medium transition-colors flex items-center",onClick:()=>o(!s),children:[I.jsx(ah,{className:"w-6 h-6 mr-2"}),e.language==="zh"?"中文":"English",I.jsx(uM,{className:"ml-2 w-4 h-4"})]}),I.jsxs("div",{className:`absolute right-0 mt-2 bg-white shadow-lg rounded-md w-32 ${s?"block":"hidden"} transition-all`,children:[I.jsx("button",{onClick:()=>l("zh"),className:"block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-200",children:"中文"}),I.jsx("button",{onClick:()=>l("en"),className:"block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-200",children:"English"})]})]})]})]})})}),I.jsxs("div",{className:"relative h-screen flex items-center justify-center",children:[I.jsx("div",{className:"absolute inset-0",children:I.jsx(BM,{})}),I.jsxs("div",{className:"relative z-10 text-center px-4 max-w-4xl mx-auto",children:[I.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-6",children:t("title")}),I.jsx("p",{className:"text-xl text-gray-200 mb-8",children:t("description")}),I.jsxs("button",{onClick:()=>r("/login"),className:"px-8 py-4 bg-indigo-600 text-white rounded-full text-lg font-medium hover:bg-indigo-500 transition-colors inline-flex items-center",children:[t("freeStart"),I.jsx(sM,{className:"ml-2 w-5 h-5"})]})]})]}),I.jsx("div",{className:"bg-white py-24 px-4",children:I.jsxs("div",{className:"max-w-7xl mx-auto",children:[I.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-16",children:t("whyChoose")}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12",children:[I.jsx(Du,{icon:I.jsx(ch,{className:"w-8 h-8"}),title:t("feature1"),description:t("feature1Desc")}),I.jsx(Du,{icon:I.jsx(SM,{className:"w-8 h-8"}),title:t("feature2"),description:t("feature2Desc")}),I.jsx(Du,{icon:I.jsx(wM,{className:"w-8 h-8"}),title:t("feature3"),description:t("feature3Desc")}),I.jsx(Du,{icon:I.jsx(ah,{className:"w-8 h-8"}),title:t("feature4"),description:t("feature4Desc")})]})]})}),I.jsx("div",{className:"bg-gray-50 py-24 px-4",children:I.jsxs("div",{className:"max-w-7xl mx-auto",children:[I.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-16",children:t("howItWorks")}),I.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12",children:[I.jsx(em,{number:"1",title:t("uploadRecording"),description:t("uploadDescription")}),I.jsx(em,{number:"2",title:t("aiProcessing"),description:t("aiProcessingDescription")}),I.jsx(em,{number:"3",title:t("shareCollaborate"),description:t("shareCollaborateDescription")})]})]})}),I.jsx(JM,{})]})}function c9({onSearch:t}){const[e,n]=m.useState(""),[i,r]=m.useState(""),s=o=>{o.preventDefault(),e&&i&&t(e,i)};return I.jsxs("form",{onSubmit:s,className:"flex items-center gap-2 text-sm",children:[I.jsxs("div",{className:"relative",children:[I.jsx(Vg,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),I.jsx("input",{type:"date",value:e,onChange:o=>n(o.target.value),className:"pl-8 pr-2 py-1.5 border border-gray-300 rounded-md text-sm w-36"})]}),I.jsx("span",{className:"text-gray-500",children:"to"}),I.jsxs("div",{className:"relative",children:[I.jsx(Vg,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),I.jsx("input",{type:"date",value:i,onChange:o=>r(o.target.value),className:"pl-8 pr-2 py-1.5 border border-gray-300 rounded-md text-sm w-36"})]}),I.jsx("button",{type:"submit",className:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-sm rounded-md text-gray-700 bg-white hover:bg-gray-50",children:I.jsx(TM,{className:"w-4 h-4"})})]})}function l9({thumbnailUrl:t,duration:e}){return I.jsxs("div",{className:"relative aspect-video bg-gray-100 rounded-t-lg overflow-hidden",children:[t?I.jsx("img",{src:t,alt:"Meeting thumbnail",className:"w-full h-full object-cover"}):I.jsx("div",{className:"flex items-center justify-center h-full",children:I.jsx(bM,{className:"w-12 h-12 text-gray-400"})}),e&&I.jsx("div",{className:"absolute bottom-2 right-2 bg-black/75 text-white text-xs px-2 py-1 rounded",children:u9(e)})]})}function u9(t){const e=Math.floor(t),n=Math.floor(e/60),i=e%60;return`${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}`}function d9({meetingSummary:t,onClick:e,isSelected:n,toggleSelection:i,showCheckbox:r}){const s=o=>{o.stopPropagation(),i()};return I.jsxs("div",{onClick:e,className:`relative bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden cursor-pointer ${n?"ring-2 ring-indigo-500":""}`,children:[I.jsx(l9,{thumbnailUrl:t.thumbnailUrl,duration:t.transcription.duration}),I.jsxs("div",{className:"p-4",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:t.summary.title}),I.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:t.summary.tags.map(o=>I.jsx("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full text-sm font-medium",children:o},o))}),I.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[I.jsx(Vg,{className:"w-4 h-4 mr-1"}),I.jsx("time",{children:new Date(t.date).toLocaleDateString()})]})]}),r&&I.jsx("div",{className:"absolute top-2 right-2 p-2 rounded-full bg-white/90 shadow-sm",onClick:s,children:I.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center ${n?"border-indigo-500 bg-indigo-500":"border-gray-300"}`,children:n&&I.jsx(cM,{className:"w-4 h-4 text-white"})})})]})}function h9({onSort:t,onSelectMode:e,selectedTags:n,availableTags:i,onTagsChange:r}){const{t:s}=Ri(),[o,a]=m.useState("desc"),[c,l]=m.useState(!1),[u,h]=m.useState(!1),f=m.useRef(null);m.useEffect(()=>{const v=w=>{f.current&&!f.current.contains(w.target)&&h(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const g=()=>{const v=o==="desc"?"asc":"desc";a(v),t(v)},b=()=>{l(!c),e(!c)},y=v=>{const w=n.includes(v)?n.filter(S=>S!==v):[...n,v];r(w)},T=()=>{r([])};return I.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[I.jsx("button",{onClick:g,className:"inline-flex items-center px-2.5 py-1.5 bg-white hover:bg-gray-50 text-gray-700 rounded-md border border-gray-300 shadow-sm",title:s(o==="desc"?"newestFirst":"oldestFirst"),children:o==="desc"?I.jsx(iM,{className:"w-4 h-4"}):I.jsx(oM,{className:"w-4 h-4"})}),I.jsx("button",{onClick:b,className:`inline-flex items-center px-2.5 py-1.5 rounded-md border shadow-sm ${c?"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,title:s("selectMeetings"),children:I.jsx(lM,{className:"w-4 h-4"})}),I.jsxs("div",{className:"relative",ref:f,children:[I.jsxs("button",{onClick:()=>h(!u),className:`inline-flex items-center px-2.5 py-1.5 rounded-md border shadow-sm ${n.length>0?"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,title:s("filterByTags"),children:[I.jsx(pM,{className:"w-4 h-4"}),n.length>0&&I.jsx("span",{className:"ml-1 text-xs",children:n.length})]}),u&&I.jsxs("div",{className:"absolute top-full right-0 mt-1 w-56 max-h-64 bg-white rounded-md shadow-lg border border-gray-200 overflow-hidden z-10",children:[I.jsxs("div",{className:"p-2 border-b border-gray-100 flex justify-between items-center",children:[I.jsx("span",{className:"text-sm font-medium text-gray-700",children:s("filterByTags")}),n.length>0&&I.jsx("button",{onClick:T,className:"text-xs text-gray-500 hover:text-gray-700",children:s("clearAll")})]}),I.jsx("div",{className:"overflow-y-auto max-h-48 p-2",children:I.jsx("div",{className:"space-y-1",children:i.map(v=>I.jsxs("label",{className:"flex items-center px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[I.jsx("input",{type:"checkbox",checked:n.includes(v),onChange:()=>y(v),className:"w-3.5 h-3.5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),I.jsx("span",{className:"ml-2 text-sm text-gray-600",children:v})]},v))})})]})]})]})}const f9=m.createContext(null);function p9({children:t}){const[e,n]=m.useState(!1),[i,r]=m.useState([]),s=()=>{n(c=>!c),e&&r([])},o=c=>{r(l=>l.includes(c)?l.filter(u=>u!==c):[...l,c])},a=()=>{r([])};return I.jsx(f9.Provider,{value:{isSelectMode:e,selectedMeetings:i,toggleSelectMode:s,toggleMeetingSelection:o,clearSelection:a},children:t})}class m9{async fetchMeetingSummariesData(e){try{const n=await K6(N6(o9,"user",e,"summaries")),i=[];return n.forEach(r=>{const s=r.data();i.push(s)}),i}catch(n){throw console.error("Error fetching data: ",n),n}}}const g9=new m9;function ER(t,e){return function(){return t.apply(e,arguments)}}const{toString:v9}=Object.prototype,{getPrototypeOf:Q0}=Object,xf=(t=>e=>{const n=v9.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ai=t=>(t=t.toLowerCase(),e=>xf(e)===t),Af=t=>e=>typeof e===t,{isArray:Na}=Array,gl=Af("undefined");function y9(t){return t!==null&&!gl(t)&&t.constructor!==null&&!gl(t.constructor)&&wn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const CR=ai("ArrayBuffer");function b9(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&CR(t.buffer),e}const T9=Af("string"),wn=Af("function"),IR=Af("number"),Nf=t=>t!==null&&typeof t=="object",k9=t=>t===!0||t===!1,vd=t=>{if(xf(t)!=="object")return!1;const e=Q0(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},w9=ai("Date"),_9=ai("File"),S9=ai("Blob"),E9=ai("FileList"),C9=t=>Nf(t)&&wn(t.pipe),I9=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||wn(t.append)&&((e=xf(t))==="formdata"||e==="object"&&wn(t.toString)&&t.toString()==="[object FormData]"))},P9=ai("URLSearchParams"),[R9,x9,A9,N9]=["ReadableStream","Request","Response","Headers"].map(ai),O9=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function zl(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let i,r;if(typeof t!="object"&&(t=[t]),Na(t))for(i=0,r=t.length;i<r;i++)e.call(null,t[i],i,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(i=0;i<o;i++)a=s[i],e.call(null,t[a],a,t)}}function PR(t,e){e=e.toLowerCase();const n=Object.keys(t);let i=n.length,r;for(;i-- >0;)if(r=n[i],e===r.toLowerCase())return r;return null}const Ss=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,RR=t=>!gl(t)&&t!==Ss;function vv(){const{caseless:t}=RR(this)&&this||{},e={},n=(i,r)=>{const s=t&&PR(e,r)||r;vd(e[s])&&vd(i)?e[s]=vv(e[s],i):vd(i)?e[s]=vv({},i):Na(i)?e[s]=i.slice():e[s]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&zl(arguments[i],n);return e}const D9=(t,e,n,{allOwnKeys:i}={})=>(zl(e,(r,s)=>{n&&wn(r)?t[s]=ER(r,n):t[s]=r},{allOwnKeys:i}),t),L9=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),M9=(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},U9=(t,e,n,i)=>{let r,s,o;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)o=r[s],(!i||i(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&Q0(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},F9=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return i!==-1&&i===n},V9=t=>{if(!t)return null;if(Na(t))return t;let e=t.length;if(!IR(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},j9=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Q0(Uint8Array)),$9=(t,e)=>{const i=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(t,s[0],s[1])}},B9=(t,e)=>{let n;const i=[];for(;(n=t.exec(e))!==null;)i.push(n);return i},z9=ai("HTMLFormElement"),q9=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,r){return i.toUpperCase()+r}),S_=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),H9=ai("RegExp"),xR=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};zl(n,(r,s)=>{let o;(o=e(r,s,t))!==!1&&(i[s]=o||r)}),Object.defineProperties(t,i)},W9=t=>{xR(t,(e,n)=>{if(wn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=t[n];if(wn(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},K9=(t,e)=>{const n={},i=r=>{r.forEach(s=>{n[s]=!0})};return Na(t)?i(t):i(String(t).split(e)),n},G9=()=>{},Q9=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,gm="abcdefghijklmnopqrstuvwxyz",E_="0123456789",AR={DIGIT:E_,ALPHA:gm,ALPHA_DIGIT:gm+gm.toUpperCase()+E_},J9=(t=16,e=AR.ALPHA_DIGIT)=>{let n="";const{length:i}=e;for(;t--;)n+=e[Math.random()*i|0];return n};function Y9(t){return!!(t&&wn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const X9=t=>{const e=new Array(10),n=(i,r)=>{if(Nf(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[r]=i;const s=Na(i)?[]:{};return zl(i,(o,a)=>{const c=n(o,r+1);!gl(c)&&(s[a]=c)}),e[r]=void 0,s}}return i};return n(t,0)},Z9=ai("AsyncFunction"),e$=t=>t&&(Nf(t)||wn(t))&&wn(t.then)&&wn(t.catch),NR=((t,e)=>t?setImmediate:e?((n,i)=>(Ss.addEventListener("message",({source:r,data:s})=>{r===Ss&&s===n&&i.length&&i.shift()()},!1),r=>{i.push(r),Ss.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",wn(Ss.postMessage)),t$=typeof queueMicrotask<"u"?queueMicrotask.bind(Ss):typeof process<"u"&&process.nextTick||NR,z={isArray:Na,isArrayBuffer:CR,isBuffer:y9,isFormData:I9,isArrayBufferView:b9,isString:T9,isNumber:IR,isBoolean:k9,isObject:Nf,isPlainObject:vd,isReadableStream:R9,isRequest:x9,isResponse:A9,isHeaders:N9,isUndefined:gl,isDate:w9,isFile:_9,isBlob:S9,isRegExp:H9,isFunction:wn,isStream:C9,isURLSearchParams:P9,isTypedArray:j9,isFileList:E9,forEach:zl,merge:vv,extend:D9,trim:O9,stripBOM:L9,inherits:M9,toFlatObject:U9,kindOf:xf,kindOfTest:ai,endsWith:F9,toArray:V9,forEachEntry:$9,matchAll:B9,isHTMLForm:z9,hasOwnProperty:S_,hasOwnProp:S_,reduceDescriptors:xR,freezeMethods:W9,toObjectSet:K9,toCamelCase:q9,noop:G9,toFiniteNumber:Q9,findKey:PR,global:Ss,isContextDefined:RR,ALPHABET:AR,generateString:J9,isSpecCompliantForm:Y9,toJSONObject:X9,isAsyncFn:Z9,isThenable:e$,setImmediate:NR,asap:t$};function ae(t,e,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}z.inherits(ae,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:z.toJSONObject(this.config),code:this.code,status:this.status}}});const OR=ae.prototype,DR={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{DR[t]={value:t}});Object.defineProperties(ae,DR);Object.defineProperty(OR,"isAxiosError",{value:!0});ae.from=(t,e,n,i,r,s)=>{const o=Object.create(OR);return z.toFlatObject(t,o,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),ae.call(o,t.message,e,n,i,r),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const n$=null;function yv(t){return z.isPlainObject(t)||z.isArray(t)}function LR(t){return z.endsWith(t,"[]")?t.slice(0,-2):t}function C_(t,e,n){return t?t.concat(e).map(function(r,s){return r=LR(r),!n&&s?"["+r+"]":r}).join(n?".":""):e}function i$(t){return z.isArray(t)&&!t.some(yv)}const r$=z.toFlatObject(z,{},null,function(e){return/^is[A-Z]/.test(e)});function Of(t,e,n){if(!z.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=z.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,T){return!z.isUndefined(T[y])});const i=n.metaTokens,r=n.visitor||u,s=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&z.isSpecCompliantForm(e);if(!z.isFunction(r))throw new TypeError("visitor must be a function");function l(b){if(b===null)return"";if(z.isDate(b))return b.toISOString();if(!c&&z.isBlob(b))throw new ae("Blob is not supported. Use a Buffer instead.");return z.isArrayBuffer(b)||z.isTypedArray(b)?c&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function u(b,y,T){let v=b;if(b&&!T&&typeof b=="object"){if(z.endsWith(y,"{}"))y=i?y:y.slice(0,-2),b=JSON.stringify(b);else if(z.isArray(b)&&i$(b)||(z.isFileList(b)||z.endsWith(y,"[]"))&&(v=z.toArray(b)))return y=LR(y),v.forEach(function(S,P){!(z.isUndefined(S)||S===null)&&e.append(o===!0?C_([y],P,s):o===null?y:y+"[]",l(S))}),!1}return yv(b)?!0:(e.append(C_(T,y,s),l(b)),!1)}const h=[],f=Object.assign(r$,{defaultVisitor:u,convertValue:l,isVisitable:yv});function g(b,y){if(!z.isUndefined(b)){if(h.indexOf(b)!==-1)throw Error("Circular reference detected in "+y.join("."));h.push(b),z.forEach(b,function(v,w){(!(z.isUndefined(v)||v===null)&&r.call(e,v,z.isString(w)?w.trim():w,y,f))===!0&&g(v,y?y.concat(w):[w])}),h.pop()}}if(!z.isObject(t))throw new TypeError("data must be an object");return g(t),e}function I_(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function J0(t,e){this._pairs=[],t&&Of(t,this,e)}const MR=J0.prototype;MR.append=function(e,n){this._pairs.push([e,n])};MR.toString=function(e){const n=e?function(i){return e.call(this,i,I_)}:I_;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function s$(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function UR(t,e,n){if(!e)return t;const i=n&&n.encode||s$;z.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(r?s=r(e,n):s=z.isURLSearchParams(e)?e.toString():new J0(e,n).toString(i),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class P_{constructor(){this.handlers=[]}use(e,n,i){return this.handlers.push({fulfilled:e,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){z.forEach(this.handlers,function(i){i!==null&&e(i)})}}const FR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},o$=typeof URLSearchParams<"u"?URLSearchParams:J0,a$=typeof FormData<"u"?FormData:null,c$=typeof Blob<"u"?Blob:null,l$={isBrowser:!0,classes:{URLSearchParams:o$,FormData:a$,Blob:c$},protocols:["http","https","file","blob","url","data"]},Y0=typeof window<"u"&&typeof document<"u",bv=typeof navigator=="object"&&navigator||void 0,u$=Y0&&(!bv||["ReactNative","NativeScript","NS"].indexOf(bv.product)<0),d$=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",h$=Y0&&window.location.href||"http://localhost",f$=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Y0,hasStandardBrowserEnv:u$,hasStandardBrowserWebWorkerEnv:d$,navigator:bv,origin:h$},Symbol.toStringTag,{value:"Module"})),jt={...f$,...l$};function p$(t,e){return Of(t,new jt.classes.URLSearchParams,Object.assign({visitor:function(n,i,r,s){return jt.isNode&&z.isBuffer(n)?(this.append(i,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function m$(t){return z.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function g$(t){const e={},n=Object.keys(t);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],e[s]=t[s];return e}function VR(t){function e(n,i,r,s){let o=n[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),c=s>=n.length;return o=!o&&z.isArray(r)?r.length:o,c?(z.hasOwnProp(r,o)?r[o]=[r[o],i]:r[o]=i,!a):((!r[o]||!z.isObject(r[o]))&&(r[o]=[]),e(n,i,r[o],s)&&z.isArray(r[o])&&(r[o]=g$(r[o])),!a)}if(z.isFormData(t)&&z.isFunction(t.entries)){const n={};return z.forEachEntry(t,(i,r)=>{e(m$(i),r,n,0)}),n}return null}function v$(t,e,n){if(z.isString(t))try{return(e||JSON.parse)(t),z.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(0,JSON.stringify)(t)}const ql={transitional:FR,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const i=n.getContentType()||"",r=i.indexOf("application/json")>-1,s=z.isObject(e);if(s&&z.isHTMLForm(e)&&(e=new FormData(e)),z.isFormData(e))return r?JSON.stringify(VR(e)):e;if(z.isArrayBuffer(e)||z.isBuffer(e)||z.isStream(e)||z.isFile(e)||z.isBlob(e)||z.isReadableStream(e))return e;if(z.isArrayBufferView(e))return e.buffer;if(z.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return p$(e,this.formSerializer).toString();if((a=z.isFileList(e))||i.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Of(a?{"files[]":e}:e,c&&new c,this.formSerializer)}}return s||r?(n.setContentType("application/json",!1),v$(e)):e}],transformResponse:[function(e){const n=this.transitional||ql.transitional,i=n&&n.forcedJSONParsing,r=this.responseType==="json";if(z.isResponse(e)||z.isReadableStream(e))return e;if(e&&z.isString(e)&&(i&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?ae.from(a,ae.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jt.classes.FormData,Blob:jt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};z.forEach(["delete","get","head","post","put","patch"],t=>{ql.headers[t]={}});const y$=z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),b$=t=>{const e={};let n,i,r;return t&&t.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),i=o.substring(r+1).trim(),!(!n||e[n]&&y$[n])&&(n==="set-cookie"?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)}),e},R_=Symbol("internals");function sc(t){return t&&String(t).trim().toLowerCase()}function yd(t){return t===!1||t==null?t:z.isArray(t)?t.map(yd):String(t)}function T$(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}const k$=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function vm(t,e,n,i,r){if(z.isFunction(i))return i.call(this,e,n);if(r&&(e=n),!!z.isString(e)){if(z.isString(i))return e.indexOf(i)!==-1;if(z.isRegExp(i))return i.test(e)}}function w$(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,i)=>n.toUpperCase()+i)}function _$(t,e){const n=z.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+n,{value:function(r,s,o){return this[i].call(this,e,r,s,o)},configurable:!0})})}class dn{constructor(e){e&&this.set(e)}set(e,n,i){const r=this;function s(a,c,l){const u=sc(c);if(!u)throw new Error("header name must be a non-empty string");const h=z.findKey(r,u);(!h||r[h]===void 0||l===!0||l===void 0&&r[h]!==!1)&&(r[h||c]=yd(a))}const o=(a,c)=>z.forEach(a,(l,u)=>s(l,u,c));if(z.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(z.isString(e)&&(e=e.trim())&&!k$(e))o(b$(e),n);else if(z.isHeaders(e))for(const[a,c]of e.entries())s(c,a,i);else e!=null&&s(n,e,i);return this}get(e,n){if(e=sc(e),e){const i=z.findKey(this,e);if(i){const r=this[i];if(!n)return r;if(n===!0)return T$(r);if(z.isFunction(n))return n.call(this,r,i);if(z.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=sc(e),e){const i=z.findKey(this,e);return!!(i&&this[i]!==void 0&&(!n||vm(this,this[i],i,n)))}return!1}delete(e,n){const i=this;let r=!1;function s(o){if(o=sc(o),o){const a=z.findKey(i,o);a&&(!n||vm(i,i[a],a,n))&&(delete i[a],r=!0)}}return z.isArray(e)?e.forEach(s):s(e),r}clear(e){const n=Object.keys(this);let i=n.length,r=!1;for(;i--;){const s=n[i];(!e||vm(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const n=this,i={};return z.forEach(this,(r,s)=>{const o=z.findKey(i,s);if(o){n[o]=yd(r),delete n[s];return}const a=e?w$(s):String(s).trim();a!==s&&delete n[s],n[a]=yd(r),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return z.forEach(this,(i,r)=>{i!=null&&i!==!1&&(n[r]=e&&z.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const i=new this(e);return n.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[R_]=this[R_]={accessors:{}}).accessors,r=this.prototype;function s(o){const a=sc(o);i[a]||(_$(r,o),i[a]=!0)}return z.isArray(e)?e.forEach(s):s(e),this}}dn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);z.reduceDescriptors(dn.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(i){this[n]=i}}});z.freezeMethods(dn);function ym(t,e){const n=this||ql,i=e||n,r=dn.from(i.headers);let s=i.data;return z.forEach(t,function(a){s=a.call(n,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function jR(t){return!!(t&&t.__CANCEL__)}function Oa(t,e,n){ae.call(this,t??"canceled",ae.ERR_CANCELED,e,n),this.name="CanceledError"}z.inherits(Oa,ae,{__CANCEL__:!0});function $R(t,e,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):e(new ae("Request failed with status code "+n.status,[ae.ERR_BAD_REQUEST,ae.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function S$(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function E$(t,e){t=t||10;const n=new Array(t),i=new Array(t);let r=0,s=0,o;return e=e!==void 0?e:1e3,function(c){const l=Date.now(),u=i[s];o||(o=l),n[r]=c,i[r]=l;let h=s,f=0;for(;h!==r;)f+=n[h++],h=h%t;if(r=(r+1)%t,r===s&&(s=(s+1)%t),l-o<e)return;const g=u&&l-u;return g?Math.round(f*1e3/g):void 0}}function C$(t,e){let n=0,i=1e3/e,r,s;const o=(l,u=Date.now())=>{n=u,r=null,s&&(clearTimeout(s),s=null),t.apply(null,l)};return[(...l)=>{const u=Date.now(),h=u-n;h>=i?o(l,u):(r=l,s||(s=setTimeout(()=>{s=null,o(r)},i-h)))},()=>r&&o(r)]}const Eh=(t,e,n=3)=>{let i=0;const r=E$(50,250);return C$(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,c=o-i,l=r(c),u=o<=a;i=o;const h={loaded:o,total:a,progress:a?o/a:void 0,bytes:c,rate:l||void 0,estimated:l&&a&&u?(a-o)/l:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(h)},n)},x_=(t,e)=>{const n=t!=null;return[i=>e[0]({lengthComputable:n,total:t,loaded:i}),e[1]]},A_=t=>(...e)=>z.asap(()=>t(...e)),I$=jt.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,jt.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(jt.origin),jt.navigator&&/(msie|trident)/i.test(jt.navigator.userAgent)):()=>!0,P$=jt.hasStandardBrowserEnv?{write(t,e,n,i,r,s){const o=[t+"="+encodeURIComponent(e)];z.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),z.isString(i)&&o.push("path="+i),z.isString(r)&&o.push("domain="+r),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function R$(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function x$(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function BR(t,e){return t&&!R$(e)?x$(t,e):e}const N_=t=>t instanceof dn?{...t}:t;function Gs(t,e){e=e||{};const n={};function i(l,u,h,f){return z.isPlainObject(l)&&z.isPlainObject(u)?z.merge.call({caseless:f},l,u):z.isPlainObject(u)?z.merge({},u):z.isArray(u)?u.slice():u}function r(l,u,h,f){if(z.isUndefined(u)){if(!z.isUndefined(l))return i(void 0,l,h,f)}else return i(l,u,h,f)}function s(l,u){if(!z.isUndefined(u))return i(void 0,u)}function o(l,u){if(z.isUndefined(u)){if(!z.isUndefined(l))return i(void 0,l)}else return i(void 0,u)}function a(l,u,h){if(h in e)return i(l,u);if(h in t)return i(void 0,l)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(l,u,h)=>r(N_(l),N_(u),h,!0)};return z.forEach(Object.keys(Object.assign({},t,e)),function(u){const h=c[u]||r,f=h(t[u],e[u],u);z.isUndefined(f)&&h!==a||(n[u]=f)}),n}const zR=t=>{const e=Gs({},t);let{data:n,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:s,headers:o,auth:a}=e;e.headers=o=dn.from(o),e.url=UR(BR(e.baseURL,e.url),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(z.isFormData(n)){if(jt.hasStandardBrowserEnv||jt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[l,...u]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([l||"multipart/form-data",...u].join("; "))}}if(jt.hasStandardBrowserEnv&&(i&&z.isFunction(i)&&(i=i(e)),i||i!==!1&&I$(e.url))){const l=r&&s&&P$.read(s);l&&o.set(r,l)}return e},A$=typeof XMLHttpRequest<"u",N$=A$&&function(t){return new Promise(function(n,i){const r=zR(t);let s=r.data;const o=dn.from(r.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:l}=r,u,h,f,g,b;function y(){g&&g(),b&&b(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let T=new XMLHttpRequest;T.open(r.method.toUpperCase(),r.url,!0),T.timeout=r.timeout;function v(){if(!T)return;const S=dn.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),R={data:!a||a==="text"||a==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:S,config:t,request:T};$R(function(E){n(E),y()},function(E){i(E),y()},R),T=null}"onloadend"in T?T.onloadend=v:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(v)},T.onabort=function(){T&&(i(new ae("Request aborted",ae.ECONNABORTED,t,T)),T=null)},T.onerror=function(){i(new ae("Network Error",ae.ERR_NETWORK,t,T)),T=null},T.ontimeout=function(){let P=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const R=r.transitional||FR;r.timeoutErrorMessage&&(P=r.timeoutErrorMessage),i(new ae(P,R.clarifyTimeoutError?ae.ETIMEDOUT:ae.ECONNABORTED,t,T)),T=null},s===void 0&&o.setContentType(null),"setRequestHeader"in T&&z.forEach(o.toJSON(),function(P,R){T.setRequestHeader(R,P)}),z.isUndefined(r.withCredentials)||(T.withCredentials=!!r.withCredentials),a&&a!=="json"&&(T.responseType=r.responseType),l&&([f,b]=Eh(l,!0),T.addEventListener("progress",f)),c&&T.upload&&([h,g]=Eh(c),T.upload.addEventListener("progress",h),T.upload.addEventListener("loadend",g)),(r.cancelToken||r.signal)&&(u=S=>{T&&(i(!S||S.type?new Oa(null,t,T):S),T.abort(),T=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const w=S$(r.url);if(w&&jt.protocols.indexOf(w)===-1){i(new ae("Unsupported protocol "+w+":",ae.ERR_BAD_REQUEST,t));return}T.send(s||null)})},O$=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let i=new AbortController,r;const s=function(l){if(!r){r=!0,a();const u=l instanceof Error?l:this.reason;i.abort(u instanceof ae?u:new Oa(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,s(new ae(`timeout ${e} of ms exceeded`,ae.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(l=>{l.unsubscribe?l.unsubscribe(s):l.removeEventListener("abort",s)}),t=null)};t.forEach(l=>l.addEventListener("abort",s));const{signal:c}=i;return c.unsubscribe=()=>z.asap(a),c}},D$=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let i=0,r;for(;i<n;)r=i+e,yield t.slice(i,r),i=r},L$=async function*(t,e){for await(const n of M$(t))yield*D$(n,e)},M$=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:i}=await e.read();if(n)break;yield i}}finally{await e.cancel()}},O_=(t,e,n,i)=>{const r=L$(t,e);let s=0,o,a=c=>{o||(o=!0,i&&i(c))};return new ReadableStream({async pull(c){try{const{done:l,value:u}=await r.next();if(l){a(),c.close();return}let h=u.byteLength;if(n){let f=s+=h;n(f)}c.enqueue(new Uint8Array(u))}catch(l){throw a(l),l}},cancel(c){return a(c),r.return()}},{highWaterMark:2})},Df=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",qR=Df&&typeof ReadableStream=="function",U$=Df&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),HR=(t,...e)=>{try{return!!t(...e)}catch{return!1}},F$=qR&&HR(()=>{let t=!1;const e=new Request(jt.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),D_=64*1024,Tv=qR&&HR(()=>z.isReadableStream(new Response("").body)),Ch={stream:Tv&&(t=>t.body)};Df&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ch[e]&&(Ch[e]=z.isFunction(t[e])?n=>n[e]():(n,i)=>{throw new ae(`Response type '${e}' is not supported`,ae.ERR_NOT_SUPPORT,i)})})})(new Response);const V$=async t=>{if(t==null)return 0;if(z.isBlob(t))return t.size;if(z.isSpecCompliantForm(t))return(await new Request(jt.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(z.isArrayBufferView(t)||z.isArrayBuffer(t))return t.byteLength;if(z.isURLSearchParams(t)&&(t=t+""),z.isString(t))return(await U$(t)).byteLength},j$=async(t,e)=>{const n=z.toFiniteNumber(t.getContentLength());return n??V$(e)},$$=Df&&(async t=>{let{url:e,method:n,data:i,signal:r,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:u,withCredentials:h="same-origin",fetchOptions:f}=zR(t);l=l?(l+"").toLowerCase():"text";let g=O$([r,s&&s.toAbortSignal()],o),b;const y=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let T;try{if(c&&F$&&n!=="get"&&n!=="head"&&(T=await j$(u,i))!==0){let R=new Request(e,{method:"POST",body:i,duplex:"half"}),O;if(z.isFormData(i)&&(O=R.headers.get("content-type"))&&u.setContentType(O),R.body){const[E,_]=x_(T,Eh(A_(c)));i=O_(R.body,D_,E,_)}}z.isString(h)||(h=h?"include":"omit");const v="credentials"in Request.prototype;b=new Request(e,{...f,signal:g,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",credentials:v?h:void 0});let w=await fetch(b);const S=Tv&&(l==="stream"||l==="response");if(Tv&&(a||S&&y)){const R={};["status","statusText","headers"].forEach(C=>{R[C]=w[C]});const O=z.toFiniteNumber(w.headers.get("content-length")),[E,_]=a&&x_(O,Eh(A_(a),!0))||[];w=new Response(O_(w.body,D_,E,()=>{_&&_(),y&&y()}),R)}l=l||"text";let P=await Ch[z.findKey(Ch,l)||"text"](w,t);return!S&&y&&y(),await new Promise((R,O)=>{$R(R,O,{data:P,headers:dn.from(w.headers),status:w.status,statusText:w.statusText,config:t,request:b})})}catch(v){throw y&&y(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new ae("Network Error",ae.ERR_NETWORK,t,b),{cause:v.cause||v}):ae.from(v,v&&v.code,t,b)}}),kv={http:n$,xhr:N$,fetch:$$};z.forEach(kv,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const L_=t=>`- ${t}`,B$=t=>z.isFunction(t)||t===null||t===!1,WR={getAdapter:t=>{t=z.isArray(t)?t:[t];const{length:e}=t;let n,i;const r={};for(let s=0;s<e;s++){n=t[s];let o;if(i=n,!B$(n)&&(i=kv[(o=String(n)).toLowerCase()],i===void 0))throw new ae(`Unknown adapter '${o}'`);if(i)break;r[o||"#"+s]=i}if(!i){const s=Object.entries(r).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(L_).join(`
`):" "+L_(s[0]):"as no adapter specified";throw new ae("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:kv};function bm(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Oa(null,t)}function M_(t){return bm(t),t.headers=dn.from(t.headers),t.data=ym.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),WR.getAdapter(t.adapter||ql.adapter)(t).then(function(i){return bm(t),i.data=ym.call(t,t.transformResponse,i),i.headers=dn.from(i.headers),i},function(i){return jR(i)||(bm(t),i&&i.response&&(i.response.data=ym.call(t,t.transformResponse,i.response),i.response.headers=dn.from(i.response.headers))),Promise.reject(i)})}const KR="1.7.9",Lf={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Lf[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});const U_={};Lf.transitional=function(e,n,i){function r(s,o){return"[Axios v"+KR+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,a)=>{if(e===!1)throw new ae(r(o," has been removed"+(n?" in "+n:"")),ae.ERR_DEPRECATED);return n&&!U_[o]&&(U_[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};Lf.spelling=function(e){return(n,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function z$(t,e,n){if(typeof t!="object")throw new ae("options must be an object",ae.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let r=i.length;for(;r-- >0;){const s=i[r],o=e[s];if(o){const a=t[s],c=a===void 0||o(a,s,t);if(c!==!0)throw new ae("option "+s+" must be "+c,ae.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ae("Unknown option "+s,ae.ERR_BAD_OPTION)}}const bd={assertOptions:z$,validators:Lf},ui=bd.validators;class Ds{constructor(e){this.defaults=e,this.interceptors={request:new P_,response:new P_}}async request(e,n){try{return await this._request(e,n)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const s=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Gs(this.defaults,n);const{transitional:i,paramsSerializer:r,headers:s}=n;i!==void 0&&bd.assertOptions(i,{silentJSONParsing:ui.transitional(ui.boolean),forcedJSONParsing:ui.transitional(ui.boolean),clarifyTimeoutError:ui.transitional(ui.boolean)},!1),r!=null&&(z.isFunction(r)?n.paramsSerializer={serialize:r}:bd.assertOptions(r,{encode:ui.function,serialize:ui.function},!0)),bd.assertOptions(n,{baseUrl:ui.spelling("baseURL"),withXsrfToken:ui.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&z.merge(s.common,s[n.method]);s&&z.forEach(["delete","get","head","post","put","patch","common"],b=>{delete s[b]}),n.headers=dn.concat(o,s);const a=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(c=c&&y.synchronous,a.unshift(y.fulfilled,y.rejected))});const l=[];this.interceptors.response.forEach(function(y){l.push(y.fulfilled,y.rejected)});let u,h=0,f;if(!c){const b=[M_.bind(this),void 0];for(b.unshift.apply(b,a),b.push.apply(b,l),f=b.length,u=Promise.resolve(n);h<f;)u=u.then(b[h++],b[h++]);return u}f=a.length;let g=n;for(h=0;h<f;){const b=a[h++],y=a[h++];try{g=b(g)}catch(T){y.call(this,T);break}}try{u=M_.call(this,g)}catch(b){return Promise.reject(b)}for(h=0,f=l.length;h<f;)u=u.then(l[h++],l[h++]);return u}getUri(e){e=Gs(this.defaults,e);const n=BR(e.baseURL,e.url);return UR(n,e.params,e.paramsSerializer)}}z.forEach(["delete","get","head","options"],function(e){Ds.prototype[e]=function(n,i){return this.request(Gs(i||{},{method:e,url:n,data:(i||{}).data}))}});z.forEach(["post","put","patch"],function(e){function n(i){return function(s,o,a){return this.request(Gs(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Ds.prototype[e]=n(),Ds.prototype[e+"Form"]=n(!0)});class X0{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const o=new Promise(a=>{i.subscribe(a),s=a}).then(r);return o.cancel=function(){i.unsubscribe(s)},o},e(function(s,o,a){i.reason||(i.reason=new Oa(s,o,a),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=i=>{e.abort(i)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new X0(function(r){e=r}),cancel:e}}}function q$(t){return function(n){return t.apply(null,n)}}function H$(t){return z.isObject(t)&&t.isAxiosError===!0}const wv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(wv).forEach(([t,e])=>{wv[e]=t});function GR(t){const e=new Ds(t),n=ER(Ds.prototype.request,e);return z.extend(n,Ds.prototype,e,{allOwnKeys:!0}),z.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return GR(Gs(t,r))},n}const lt=GR(ql);lt.Axios=Ds;lt.CanceledError=Oa;lt.CancelToken=X0;lt.isCancel=jR;lt.VERSION=KR;lt.toFormData=Of;lt.AxiosError=ae;lt.Cancel=lt.CanceledError;lt.all=function(e){return Promise.all(e)};lt.spread=q$;lt.isAxiosError=H$;lt.mergeConfig=Gs;lt.AxiosHeaders=dn;lt.formToJSON=t=>VR(z.isHTMLForm(t)?new FormData(t):t);lt.getAdapter=WR.getAdapter;lt.HttpStatusCode=wv;lt.default=lt;const Cr=lt.create({baseURL:"/api/",timeout:3e4,headers:{"Content-Type":"application/json"}});let Tm=null;Cr.interceptors.request.use(t=>(Tm||(Tm=new AbortController),t.signal=Tm.signal,t),t=>Promise.reject(t));Cr.interceptors.response.use(t=>t,async t=>{if(t.config,t.response)switch(t.response.status){}return Promise.reject(t)});class W${summarize(e){return Cr.post("/summarize",e,{headers:{"Content-Type":"multipart/form-data"}})}}const K$=new W$,QR=m.createContext(void 0);function G$({children:t}){const[e,n]=m.useState([]),i=m.useCallback(a=>{n(c=>[...c].sort((l,u)=>{const h=new Date(l.date).getTime(),f=new Date(u.date).getTime();return a==="asc"?h-f:f-h}))},[]),r=m.useCallback(a=>{n(c=>[...c,a])},[]),s=m.useCallback(async(a,c,l)=>{const u=new FormData;u.append("uid",a),c&&u.append("file",c),l&&u.append("s3_file_name",l);try{const h=await K$.summarize(u);return r(h.data.summary),h.data}catch(h){throw console.error("Error uploading file:",h),h}},[]),o=m.useCallback(async a=>{try{const c=await g9.fetchMeetingSummariesData(a);n(c)}catch(c){console.error("Error fetching meeting summaries:",c)}},[]);return I.jsx(QR.Provider,{value:{meetingSummaries:e,addMeetingSummary:r,sortMeetingSummaries:i,summarizeMeeting:s,fetchMeetingSummaries:o},children:t})}const Mf=()=>m.useContext(QR);function Q$(){const t=as(),{user:e}=cs(),{meetingSummaries:n,sortMeetingSummaries:i,fetchMeetingSummaries:r}=Mf(),[s,o]=m.useState([]),[a,c]=m.useState(!1),[l,u]=m.useState([]),{t:h,i18n:f}=Ri();m.useEffect(()=>{(async()=>{if(e)try{await r(e.id)}catch(w){console.error("Error fetching meeting summaries:",w)}})()},[e,r]);const g=v=>{u(w=>w.includes(v)?w.filter(S=>S!==v):[...w,v])},b=m.useMemo(()=>{const v=new Set;return n.forEach(w=>w.summary.tags.forEach(S=>v.add(S))),Array.from(v)},[n]),y=m.useMemo(()=>(console.log(n),s.length===0?n:n.filter(v=>s.some(w=>v.summary.tags.includes(w)))),[n,s]),T=(v,w)=>{const S=new Date(v),P=new Date(w);n.filter(R=>{const O=new Date(R.date);return O>=S&&O<=P})};return I.jsxs("div",{children:[I.jsx("div",{className:"flex flex-col space-y-4 mb-6",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("div",{className:"flex justify-between items-center",children:I.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:h("meeting_notes")})}),I.jsxs("div",{className:"flex items-center justify-start space-x-4",children:[I.jsx(c9,{onSearch:T}),I.jsx(h9,{onSort:v=>i(v),onSelectMode:c,selectedTags:s,availableTags:b,onTagsChange:o})]})]})}),I.jsx(p9,{children:I.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(v=>I.jsx(d9,{meetingSummary:v,onClick:()=>t(`/dashboard/meetingSummary/${v.id}`),isSelected:l.includes(v.id),showCheckbox:a,toggleSelection:()=>g(v.id)},v.id))})})]})}function JR(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=JR(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function zr(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=JR(t))&&(i&&(i+=" "),i+=e);return i}function J$(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}J$(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Hl=t=>typeof t=="number"&&!isNaN(t),Qs=t=>typeof t=="string",tr=t=>typeof t=="function",Y$=t=>Qs(t)||Hl(t),_v=t=>Qs(t)||tr(t)?t:null,X$=(t,e)=>t===!1||Hl(t)&&t>0?t:e,Sv=t=>m.isValidElement(t)||Qs(t)||tr(t)||Hl(t);function Z$(t,e,n=300){let{scrollHeight:i,style:r}=t;requestAnimationFrame(()=>{r.minHeight="initial",r.height=i+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(e,n)})})}function eB({enter:t,exit:e,appendPosition:n=!1,collapse:i=!0,collapseDuration:r=300}){return function({children:s,position:o,preventExitTransition:a,done:c,nodeRef:l,isIn:u,playToast:h}){let f=n?`${t}--${o}`:t,g=n?`${e}--${o}`:e,b=m.useRef(0);return m.useLayoutEffect(()=>{let y=l.current,T=f.split(" "),v=w=>{w.target===l.current&&(h(),y.removeEventListener("animationend",v),y.removeEventListener("animationcancel",v),b.current===0&&w.type!=="animationcancel"&&y.classList.remove(...T))};y.classList.add(...T),y.addEventListener("animationend",v),y.addEventListener("animationcancel",v)},[]),m.useEffect(()=>{let y=l.current,T=()=>{y.removeEventListener("animationend",T),i?Z$(y,c,r):c()};u||(a?T():(b.current=1,y.className+=` ${g}`,y.addEventListener("animationend",T)))},[u]),Le.createElement(Le.Fragment,null,s)}}function F_(t,e){return{content:YR(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function YR(t,e,n=!1){return m.isValidElement(t)&&!Qs(t.type)?m.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):tr(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):t}function tB({closeToast:t,theme:e,ariaLabel:n="close"}){return Le.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:i=>{i.stopPropagation(),t(!0)},"aria-label":n},Le.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Le.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function nB({delay:t,isRunning:e,closeToast:n,type:i="default",hide:r,className:s,controlledProgress:o,progress:a,rtl:c,isIn:l,theme:u}){let h=r||o&&a===0,f={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};o&&(f.transform=`scaleX(${a})`);let g=zr("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":c}),b=tr(s)?s({rtl:c,type:i,defaultClassName:g}):zr(g,s),y={[o&&a>=1?"onTransitionEnd":"onAnimationEnd"]:o&&a<1?null:()=>{l&&n()}};return Le.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},Le.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${i}`}),Le.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:b,style:f,...y}))}var iB=1,XR=()=>`${iB++}`;function rB(t,e,n){let i=1,r=0,s=[],o=[],a=e,c=new Map,l=new Set,u=w=>(l.add(w),()=>l.delete(w)),h=()=>{o=Array.from(c.values()),l.forEach(w=>w())},f=({containerId:w,toastId:S,updateId:P})=>{let R=w?w!==t:t!==1,O=c.has(S)&&P==null;return R||O},g=(w,S)=>{c.forEach(P=>{var R;(S==null||S===P.props.toastId)&&((R=P.toggle)==null||R.call(P,w))})},b=w=>{var S,P;(P=(S=w.props)==null?void 0:S.onClose)==null||P.call(S,w.removalReason),w.isActive=!1},y=w=>{if(w==null)c.forEach(b);else{let S=c.get(w);S&&b(S)}h()},T=()=>{r-=s.length,s=[]},v=w=>{var S,P;let{toastId:R,updateId:O}=w.props,E=O==null;w.staleId&&c.delete(w.staleId),w.isActive=!0,c.set(R,w),h(),n(F_(w,E?"added":"updated")),E&&((P=(S=w.props).onOpen)==null||P.call(S))};return{id:t,props:a,observe:u,toggle:g,removeToast:y,toasts:c,clearQueue:T,buildToast:(w,S)=>{if(f(S))return;let{toastId:P,updateId:R,data:O,staleId:E,delay:_}=S,C=R==null;C&&r++;let x={...a,style:a.toastStyle,key:i++,...Object.fromEntries(Object.entries(S).filter(([L,D])=>D!=null)),toastId:P,updateId:R,data:O,isIn:!1,className:_v(S.className||a.toastClassName),progressClassName:_v(S.progressClassName||a.progressClassName),autoClose:S.isLoading?!1:X$(S.autoClose,a.autoClose),closeToast(L){c.get(P).removalReason=L,y(P)},deleteToast(){let L=c.get(P);if(L!=null){if(n(F_(L,"removed")),c.delete(P),r--,r<0&&(r=0),s.length>0){v(s.shift());return}h()}}};x.closeButton=a.closeButton,S.closeButton===!1||Sv(S.closeButton)?x.closeButton=S.closeButton:S.closeButton===!0&&(x.closeButton=Sv(a.closeButton)?a.closeButton:!0);let A={content:w,props:x,staleId:E};a.limit&&a.limit>0&&r>a.limit&&C?s.push(A):Hl(_)?setTimeout(()=>{v(A)},_):v(A)},setProps(w){a=w},setToggle:(w,S)=>{let P=c.get(w);P&&(P.toggle=S)},isToastActive:w=>{var S;return(S=c.get(w))==null?void 0:S.isActive},getSnapshot:()=>o}}var Qt=new Map,vl=[],Ev=new Set,sB=t=>Ev.forEach(e=>e(t)),ZR=()=>Qt.size>0;function oB(){vl.forEach(t=>tx(t.content,t.options)),vl=[]}var aB=(t,{containerId:e})=>{var n;return(n=Qt.get(e||1))==null?void 0:n.toasts.get(t)};function ex(t,e){var n;if(e)return!!((n=Qt.get(e))!=null&&n.isToastActive(t));let i=!1;return Qt.forEach(r=>{r.isToastActive(t)&&(i=!0)}),i}function cB(t){if(!ZR()){vl=vl.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||Y$(t))Qt.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=Qt.get(t.containerId);e?e.removeToast(t.id):Qt.forEach(n=>{n.removeToast(t.id)})}}var lB=(t={})=>{Qt.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function tx(t,e){Sv(t)&&(ZR()||vl.push({content:t,options:e}),Qt.forEach(n=>{n.buildToast(t,e)}))}function uB(t){var e;(e=Qt.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function nx(t,e){Qt.forEach(n=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===n.id)&&n.toggle(t,e==null?void 0:e.id)})}function dB(t){let e=t.containerId||1;return{subscribe(n){let i=rB(e,t,sB);Qt.set(e,i);let r=i.observe(n);return oB(),()=>{r(),Qt.delete(e)}},setProps(n){var i;(i=Qt.get(e))==null||i.setProps(n)},getSnapshot(){var n;return(n=Qt.get(e))==null?void 0:n.getSnapshot()}}}function hB(t){return Ev.add(t),()=>{Ev.delete(t)}}function fB(t){return t&&(Qs(t.toastId)||Hl(t.toastId))?t.toastId:XR()}function Wl(t,e){return tx(t,e),e.toastId}function Uf(t,e){return{...e,type:e&&e.type||t,toastId:fB(e)}}function Ff(t){return(e,n)=>Wl(e,Uf(t,n))}function Ce(t,e){return Wl(t,Uf("default",e))}Ce.loading=(t,e)=>Wl(t,Uf("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function pB(t,{pending:e,error:n,success:i},r){let s;e&&(s=Qs(e)?Ce.loading(e,r):Ce.loading(e.render,{...r,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=(l,u,h)=>{if(u==null){Ce.dismiss(s);return}let f={type:l,...o,...r,data:h},g=Qs(u)?{render:u}:u;return s?Ce.update(s,{...f,...g}):Ce(g.render,{...f,...g}),h},c=tr(t)?t():t;return c.then(l=>a("success",i,l)).catch(l=>a("error",n,l)),c}Ce.promise=pB;Ce.success=Ff("success");Ce.info=Ff("info");Ce.error=Ff("error");Ce.warning=Ff("warning");Ce.warn=Ce.warning;Ce.dark=(t,e)=>Wl(t,Uf("default",{theme:"dark",...e}));function mB(t){cB(t)}Ce.dismiss=mB;Ce.clearWaitingQueue=lB;Ce.isActive=ex;Ce.update=(t,e={})=>{let n=aB(t,e);if(n){let{props:i,content:r}=n,s={delay:100,...i,...e,toastId:e.toastId||t,updateId:XR()};s.toastId!==t&&(s.staleId=t);let o=s.render||r;delete s.render,Wl(o,s)}};Ce.done=t=>{Ce.update(t,{progress:1})};Ce.onChange=hB;Ce.play=t=>nx(!0,t);Ce.pause=t=>nx(!1,t);function gB(t){var e;let{subscribe:n,getSnapshot:i,setProps:r}=m.useRef(dB(t)).current;r(t);let s=(e=m.useSyncExternalStore(n,i,i))==null?void 0:e.slice();function o(a){if(!s)return[];let c=new Map;return t.newestOnTop&&s.reverse(),s.forEach(l=>{let{position:u}=l.props;c.has(u)||c.set(u,[]),c.get(u).push(l)}),Array.from(c,l=>a(l[0],l[1]))}return{getToastToRender:o,isToastActive:ex,count:s==null?void 0:s.length}}function vB(t){let[e,n]=m.useState(!1),[i,r]=m.useState(!1),s=m.useRef(null),o=m.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:c,closeToast:l,onClick:u,closeOnClick:h}=t;uB({id:t.toastId,containerId:t.containerId,fn:n}),m.useEffect(()=>{if(t.pauseOnFocusLoss)return f(),()=>{g()}},[t.pauseOnFocusLoss]);function f(){document.hasFocus()||v(),window.addEventListener("focus",T),window.addEventListener("blur",v)}function g(){window.removeEventListener("focus",T),window.removeEventListener("blur",v)}function b(E){if(t.draggable===!0||t.draggable===E.pointerType){w();let _=s.current;o.canCloseOnClick=!0,o.canDrag=!0,_.style.transition="none",t.draggableDirection==="x"?(o.start=E.clientX,o.removalDistance=_.offsetWidth*(t.draggablePercent/100)):(o.start=E.clientY,o.removalDistance=_.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function y(E){let{top:_,bottom:C,left:x,right:A}=s.current.getBoundingClientRect();E.nativeEvent.type!=="touchend"&&t.pauseOnHover&&E.clientX>=x&&E.clientX<=A&&E.clientY>=_&&E.clientY<=C?v():T()}function T(){n(!0)}function v(){n(!1)}function w(){o.didMove=!1,document.addEventListener("pointermove",P),document.addEventListener("pointerup",R)}function S(){document.removeEventListener("pointermove",P),document.removeEventListener("pointerup",R)}function P(E){let _=s.current;if(o.canDrag&&_){o.didMove=!0,e&&v(),t.draggableDirection==="x"?o.delta=E.clientX-o.start:o.delta=E.clientY-o.start,o.start!==E.clientX&&(o.canCloseOnClick=!1);let C=t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;_.style.transform=`translate3d(${C},0)`,_.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function R(){S();let E=s.current;if(o.canDrag&&o.didMove&&E){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){r(!0),t.closeToast(!0),t.collapseAll();return}E.style.transition="transform 0.2s, opacity 0.2s",E.style.removeProperty("transform"),E.style.removeProperty("opacity")}}let O={onPointerDown:b,onPointerUp:y};return a&&c&&(O.onMouseEnter=v,t.stacked||(O.onMouseLeave=T)),h&&(O.onClick=E=>{u&&u(E),o.canCloseOnClick&&l(!0)}),{playToast:T,pauseToast:v,isRunning:e,preventExitTransition:i,toastRef:s,eventHandlers:O}}var yB=typeof window<"u"?m.useLayoutEffect:m.useEffect,Vf=({theme:t,type:e,isLoading:n,...i})=>Le.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...i});function bB(t){return Le.createElement(Vf,{...t},Le.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function TB(t){return Le.createElement(Vf,{...t},Le.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function kB(t){return Le.createElement(Vf,{...t},Le.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function wB(t){return Le.createElement(Vf,{...t},Le.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function _B(){return Le.createElement("div",{className:"Toastify__spinner"})}var Cv={info:TB,warning:bB,success:kB,error:wB,spinner:_B},SB=t=>t in Cv;function EB({theme:t,type:e,isLoading:n,icon:i}){let r=null,s={theme:t,type:e};return i===!1||(tr(i)?r=i({...s,isLoading:n}):m.isValidElement(i)?r=m.cloneElement(i,s):n?r=Cv.spinner():SB(e)&&(r=Cv[e](s))),r}var CB=t=>{let{isRunning:e,preventExitTransition:n,toastRef:i,eventHandlers:r,playToast:s}=vB(t),{closeButton:o,children:a,autoClose:c,onClick:l,type:u,hideProgressBar:h,closeToast:f,transition:g,position:b,className:y,style:T,progressClassName:v,updateId:w,role:S,progress:P,rtl:R,toastId:O,deleteToast:E,isIn:_,isLoading:C,closeOnClick:x,theme:A,ariaLabel:L}=t,D=zr("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":R},{"Toastify__toast--close-on-click":x}),le=tr(y)?y({rtl:R,position:b,type:u,defaultClassName:D}):zr(D,y),ge=EB(t),$e=!!P||!c,fe={closeToast:f,type:u,theme:A},W=null;return o===!1||(tr(o)?W=o(fe):m.isValidElement(o)?W=m.cloneElement(o,fe):W=tB(fe)),Le.createElement(g,{isIn:_,done:E,position:b,preventExitTransition:n,nodeRef:i,playToast:s},Le.createElement("div",{id:O,tabIndex:0,onClick:l,"data-in":_,className:le,...r,style:T,ref:i,..._&&{role:S,"aria-label":L}},ge!=null&&Le.createElement("div",{className:zr("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!C})},ge),YR(a,t,!e),W,!t.customProgressBar&&Le.createElement(nB,{...w&&!$e?{key:`p-${w}`}:{},rtl:R,theme:A,delay:c,isRunning:e,isIn:_,closeToast:f,hide:h,type:u,className:v,controlledProgress:$e,progress:P||0})))},IB=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),PB=eB(IB("bounce",!0)),RB={position:"top-right",transition:PB,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function xB(t){let e={...RB,...t},n=t.stacked,[i,r]=m.useState(!0),s=m.useRef(null),{getToastToRender:o,isToastActive:a,count:c}=gB(e),{className:l,style:u,rtl:h,containerId:f,hotKeys:g}=e;function b(T){let v=zr("Toastify__toast-container",`Toastify__toast-container--${T}`,{"Toastify__toast-container--rtl":h});return tr(l)?l({position:T,rtl:h,defaultClassName:v}):zr(v,_v(l))}function y(){n&&(r(!0),Ce.play())}return yB(()=>{var T;if(n){let v=s.current.querySelectorAll('[data-in="true"]'),w=12,S=(T=e.position)==null?void 0:T.includes("top"),P=0,R=0;Array.from(v).reverse().forEach((O,E)=>{let _=O;_.classList.add("Toastify__toast--stacked"),E>0&&(_.dataset.collapsed=`${i}`),_.dataset.pos||(_.dataset.pos=S?"top":"bot");let C=P*(i?.2:1)+(i?0:w*E);_.style.setProperty("--y",`${S?C:C*-1}px`),_.style.setProperty("--g",`${w}`),_.style.setProperty("--s",`${1-(i?R:0)}`),P+=_.offsetHeight,R+=.025})}},[i,c,n]),m.useEffect(()=>{function T(v){var w;let S=s.current;g(v)&&((w=S.querySelector('[tabIndex="0"]'))==null||w.focus(),r(!1),Ce.pause()),v.key==="Escape"&&(document.activeElement===S||S!=null&&S.contains(document.activeElement))&&(r(!0),Ce.play())}return document.addEventListener("keydown",T),()=>{document.removeEventListener("keydown",T)}},[g]),Le.createElement("section",{ref:s,className:"Toastify",id:f,onMouseEnter:()=>{n&&(r(!1),Ce.pause())},onMouseLeave:y,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((T,v)=>{let w=v.length?{...u}:{...u,pointerEvents:"none"};return Le.createElement("div",{tabIndex:-1,className:b(T),"data-stacked":n,style:w,key:`c-${T}`},v.map(({content:S,props:P})=>Le.createElement(CB,{...P,stacked:n,collapseAll:y,isIn:a(P.toastId,P.containerId),key:`t-${P.key}`},S)))}))}const AB=({isVisible:t,message:e})=>t?Z2.createPortal(I.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:I.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg flex flex-col items-center space-y-4",children:[I.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin"}),I.jsx("p",{className:"text-gray-700",children:e||"Loading..."})]})}),document.body):null;function NB(){const{t}=Ri(),e=()=>{Ce.success(t("upload_meeting_Btn.successNotification"),{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},n=()=>{Ce.error(t("upload_meeting_Btn.errorNotification"),{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},i=as(),{user:r}=cs(),{summarizeMeeting:s}=Mf(),[o,a]=m.useState(!1),[c,l]=m.useState(!1),[u,h]=m.useState(null),f=v=>{v.preventDefault(),l(!0)},g=()=>{l(!1)},b=v=>{v.preventDefault(),l(!1);const w=v.dataTransfer.files[0];w!=null&&w.type.startsWith("video/")&&h(w)},y=v=>{var S;const w=(S=v.target.files)==null?void 0:S[0];w&&h(w)},T=async()=>{if(a(!0),u&&r)try{const v=await s(r.id,u,void 0);e(),a(!1),i(`/dashboard/meetingSummary/${v.summary.id}`)}catch(v){a(!1),n(),console.error("Failed to upload the file:",v)}};return I.jsxs("div",{className:"max-w-2xl mx-auto",children:[I.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:t("upload_meeting_Btn.uploadMeetingRecording")}),I.jsxs("label",{onDragOver:f,onDragLeave:g,onDrop:b,className:`
          border-2 border-dashed rounded-lg p-12
          flex flex-col items-center justify-center
          ${c?"border-indigo-500 bg-indigo-50":"border-gray-300"}
          transition-colors
          hover:text-indigo-500 cursor-pointer
        `,children:[I.jsx(jg,{className:"w-12 h-12 text-gray-400 mb-4"}),I.jsxs("div",{className:"text-gray-600 text-center mb-4",children:[t("upload_meeting_Btn.dragAndDrop"),I.jsx("div",{className:"text-indigo-600 hover:text-indigo-500 cursor-pointer",children:t("upload_meeting_Btn.browse")})]}),u&&I.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[I.jsx(fM,{className:"w-4 h-4"}),I.jsx("span",{children:u.name})]}),I.jsx("input",{type:"file",accept:"video/audio/*",onChange:y,className:"hidden"})]}),I.jsxs("button",{onClick:T,disabled:!u,className:`
          mt-6 w-full py-3 px-4 rounded-lg
          flex items-center justify-center space-x-2
          ${u?"bg-indigo-600 hover:bg-indigo-500 text-white":"bg-gray-100 text-gray-400 cursor-not-allowed"}
          transition-colors
        `,children:[I.jsx(jg,{className:"w-5 h-5"}),I.jsx("span",{children:t("upload_meeting_Btn.uploadRecording")})]}),I.jsx(AB,{isVisible:o})]})}const OB=({src:t})=>{const e=m.useRef(null),[n,i]=m.useState(!1),[r,s]=m.useState(0),[o,a]=m.useState(0),c=()=>{e.current&&(n?e.current.pause():e.current.play(),i(!n))},l=()=>{e.current&&s(e.current.currentTime)},u=()=>{e.current&&a(e.current.duration)};return I.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow-md",children:[I.jsx("audio",{ref:e,src:t,onTimeUpdate:l,onLoadedMetadata:u}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("button",{onClick:c,className:"text-gray-700",children:n?I.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})}):I.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11.25l-6-4.5v9l6-4.5z"}),I.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"currentColor",strokeWidth:"2"})]})}),I.jsx("div",{className:"flex-grow mx-4",children:I.jsx("input",{type:"range",min:"0",max:o,value:r,className:"w-full h-2 bg-gray-200 rounded-full appearance-none focus:outline-none",onChange:h=>{e.current&&(e.current.currentTime=Number(h.target.value),s(Number(h.target.value)))}})}),I.jsxs("span",{className:"text-gray-700 text-sm",children:[new Date(r*1e3).toISOString().substr(14,5)," / ",new Date(o*1e3).toISOString().substr(14,5)]})]})]})};function DB({segments:t,onSegmentClick:e}){return I.jsx("div",{className:"space-y-4",children:t.map((n,i)=>I.jsxs("div",{onClick:()=>e==null?void 0:e(n.startTime),className:"p-3 hover:bg-gray-50 rounded cursor-pointer",children:[I.jsxs("div",{className:"text-sm text-gray-500 mb-1",children:[V_(n.startTime)," - ",V_(n.endTime)]}),I.jsx("p",{className:"text-gray-700",children:n.text})]},i))})}function V_(t){const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`}function LB(){const{id:t}=RL(),e=m.useRef(null),{meetingSummaries:n}=Mf(),[i,r]=m.useState(null),{t:s}=Ri();if(m.useEffect(()=>{console.log(t),console.log(n);const a=n.find(c=>c.id===t);if(a)r(a);else{const c=setInterval(()=>{const l=n.find(u=>u.id===t);l&&(r(l),clearInterval(c))},500)}},[t,n]),!i)return I.jsx("div",{children:"Loading..."});const o=a=>{e.current&&(e.current.currentTime=a,e.current.play())};return I.jsx("div",{className:"relative",children:I.jsxs("div",{className:"max-w-4xl mx-auto",children:[I.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:i.summary.title}),I.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[I.jsxs("div",{className:"flex items-center text-gray-600",children:[I.jsx(dM,{className:"w-4 h-4 mr-1"}),I.jsx("span",{children:new Date(i.date).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),I.jsxs("div",{className:"flex items-center space-x-2",children:[I.jsx(_M,{className:"w-4 h-4 text-gray-600"}),I.jsx("div",{className:"flex gap-2",children:i.summary.tags.map(a=>I.jsx("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full text-sm",children:a},a))})]})]}),I.jsxs("div",{className:"space-y-8",children:[I.jsxs("section",{children:[I.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:s("Summary")}),I.jsx("p",{className:"text-gray-600 bg-gray-50 p-4 rounded-lg",children:i.summary.content})]}),I.jsxs("section",{children:[I.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:s("Transcript")}),I.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:I.jsx(DB,{segments:i.transcription.segments,onSegmentClick:o})})]})]}),I.jsx("div",{className:"bottom-0 w-full left-0 mt-8",children:I.jsx(OB,{src:"../../sample_01.mp3"})})]})})}function MB({user:t,onEdit:e}){return I.jsxs("div",{className:"flex items-center justify-between mb-8",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsx("div",{className:"relative",children:I.jsx("img",{src:t.avatarUrl||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:t.name,className:"w-16 h-16 rounded-full object-cover"})}),I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.name}),I.jsx("p",{className:"text-gray-500",children:t.email})]})]}),I.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100 transition-colors",children:I.jsx(yM,{className:"w-5 h-5 text-gray-600"})})]})}function UB({user:t,onUpdatePreferences:e}){const{t:n}=Ri(),{isDarkMode:i,toggleDarkMode:r}=XL(),s=o=>{o==="darkMode"&&r(),e({...t.preferences,[o]:!t.preferences[o]})};return I.jsxs("div",{className:"space-y-6",children:[I.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:n("profile_settingsTitle")}),I.jsxs("div",{className:"space-y-4",children:[I.jsx(km,{icon:I.jsx(aM,{className:"w-5 h-5"}),label:n("profile_settings.emailNotifications"),description:n("profile_settings.emailNotificationsDesc"),checked:t.preferences.emailNotifications,onChange:()=>s("emailNotifications")}),I.jsx(km,{icon:I.jsx(ah,{className:"w-5 h-5"}),label:n("profile_settings.systemAlerts"),description:n("profile_settings.systemAlertsDesc"),checked:t.preferences.systemAlerts,onChange:()=>s("systemAlerts")}),I.jsx(km,{icon:I.jsx(vM,{className:"w-5 h-5"}),label:n("profile_settings.darkMode"),description:n("profile_settings.darkModeDesc"),checked:i,onChange:()=>s("darkMode")})]})]})}function km({icon:t,label:e,description:n,checked:i,onChange:r}){return I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-start space-x-3",children:[I.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:t}),I.jsxs("div",{children:[I.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e}),I.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n})]})]}),I.jsx("div",{className:"relative",children:I.jsx("button",{onClick:r,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${i?"bg-indigo-600":"bg-gray-200 dark:bg-gray-700"}`,children:I.jsx("span",{className:`absolute inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i?"translate-x-6":"translate-x-1"}`})})})]})}class FB{async updateUserProfile(e,n){return await new Promise(i=>setTimeout(i,1e3)),{...e,...n}}}const VB=new FB;function jB(t){const[e,n]=m.useState(t),[i,r]=m.useState(!1),[s,o]=m.useState(null);return{user:e,isLoading:i,error:s,updateUser:async c=>{console.log(c),r(!0),o(null);try{const l=await VB.updateUserProfile(e,c);return console.log(l),n(l),!0}catch(l){return o(l instanceof Error?l.message:"更新失敗"),!1}finally{r(!1)}}}}function $B(){const{user:t}=cs(),{user:e,isLoading:n,error:i,updateUser:r}=jB(t),[s,o]=m.useState(!1),a=()=>{o(!0)},c=l=>{r({preferences:l})};return I.jsxs("div",{className:"max-w-4xl mx-auto",children:[I.jsx(MB,{user:e,onEdit:a}),I.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:I.jsx("div",{className:"lg:col-span-1",children:I.jsx(UB,{user:e,onUpdatePreferences:c})})})]})}function BB(){const[t]=m.useState(""),{t:e,i18n:n}=Ri(),i=s=>{n.changeLanguage(s)},r=s=>{s.preventDefault()};return I.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:I.jsxs("div",{className:"max-w-md w-full space-y-8 p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"flex justify-center",children:I.jsx(mM,{className:"h-12 w-12 text-indigo-600"})}),I.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900 dark:text-white",children:e("welcome_back")}),I.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:e("please_sign_in")})]}),I.jsxs("div",{className:"absolute top-4 right-4 flex items-center space-x-2",children:[I.jsx("button",{onClick:()=>i("en"),className:"text-gray-600 dark:text-gray-400",children:I.jsx(ah,{className:"h-6 w-6"})}),I.jsxs("select",{onChange:s=>i(s.target.value),className:"mt-2 text-gray-600 dark:text-gray-400 bg-transparent border-none outline-none","aria-label":"Language selector",children:[I.jsx("option",{value:"en",children:"English"}),I.jsx("option",{value:"zh",children:"中文"})]})]}),I.jsxs("form",{className:"mt-8 space-y-6",onSubmit:r,children:[t&&I.jsx("div",{className:"bg-red-50 dark:bg-red-900/50 text-red-500 dark:text-red-400 p-3 rounded-md text-sm text-center",children:t}),I.jsx("div",{className:"flex justify-center",children:I.jsx(SR,{})})]})]})})}var j_={};function zB(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(i){if(i!=="default"&&!(i in t)){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}})}),Object.freeze(t)}var qB=Object.defineProperty,HB=(t,e,n)=>e in t?qB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$_=(t,e,n)=>HB(t,typeof e!="symbol"?e+"":e,n);let rn=class{constructor(){$_(this,"_locking"),$_(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(r=>e=()=>{this._locks-=1,r()}),i=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),i}};function tt(t,e){if(!t)throw new Error(e)}const WB=34028234663852886e22,KB=-34028234663852886e22,GB=4294967295,QB=2147483647,JB=-2147483648;function Td(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>QB||t<JB)throw new Error("invalid int 32: "+t)}function Iv(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>GB||t<0)throw new Error("invalid uint 32: "+t)}function ix(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>WB||t<KB))throw new Error("invalid float 32: "+t)}const rx=Symbol("@bufbuild/protobuf/enum-type");function YB(t){const e=t[rx];return tt(e,"missing enum type on enum object"),e}function sx(t,e,n,i){t[rx]=ox(e,n.map(r=>({no:r.no,name:r.name,localName:t[r.no]})))}function ox(t,e,n){const i=Object.create(null),r=Object.create(null),s=[];for(const o of e){const a=ax(o);s.push(a),i[o.name]=a,r[o.no]=a}return{typeName:t,values:s,findName(o){return i[o]},findNumber(o){return r[o]}}}function XB(t,e,n){const i={};for(const r of e){const s=ax(r);i[s.localName]=s.no,i[s.no]=s.localName}return sx(i,t,e),i}function ax(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class Z0{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const i=this.getType(),r=i.runtime.bin,s=r.makeReadOptions(n);return r.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,n){const i=this.getType(),r=i.runtime.json,s=r.makeReadOptions(n);return r.readMessage(i,e,s,this),this}fromJsonString(e,n){let i;try{i=JSON.parse(e)}catch(r){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(r instanceof Error?r.message:String(r)))}return this.fromJson(i,n)}toBinary(e){const n=this.getType(),i=n.runtime.bin,r=i.makeWriteOptions(e),s=r.writerFactory();return i.writeMessage(this,s,r),s.finish()}toJson(e){const n=this.getType(),i=n.runtime.json,r=i.makeWriteOptions(e);return i.writeMessage(this,r)}toJsonString(e){var n;const i=this.toJson(e);return JSON.stringify(i,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function ZB(t,e,n,i){var r;const s=(r=i==null?void 0:i.localName)!==null&&r!==void 0?r:e.substring(e.lastIndexOf(".")+1),o={[s]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[s];return Object.setPrototypeOf(o.prototype,new Z0),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,c){return new o().fromBinary(a,c)},fromJson(a,c){return new o().fromJson(a,c)},fromJsonString(a,c){return new o().fromJsonString(a,c)},equals(a,c){return t.util.equals(o,a,c)}}),o}function e7(){let t=0,e=0;for(let i=0;i<28;i+=7){let r=this.buf[this.pos++];if(t|=(r&127)<<i,!(r&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let i=3;i<=31;i+=7){let r=this.buf[this.pos++];if(e|=(r&127)<<i,!(r&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function wm(t,e,n){for(let s=0;s<28;s=s+7){const o=t>>>s,a=!(!(o>>>7)&&e==0),c=(a?o|128:o)&255;if(n.push(c),!a)return}const i=t>>>28&15|(e&7)<<4,r=!!(e>>3);if(n.push((r?i|128:i)&255),!!r){for(let s=3;s<31;s=s+7){const o=e>>>s,a=!!(o>>>7),c=(a?o|128:o)&255;if(n.push(c),!a)return}n.push(e>>>31&1)}}const kd=4294967296;function B_(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let i=0,r=0;function s(o,a){const c=Number(t.slice(o,a));r*=n,i=i*n+c,i>=kd&&(r=r+(i/kd|0),i=i%kd)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?lx(i,r):eb(i,r)}function t7(t,e){let n=eb(t,e);const i=n.hi&2147483648;i&&(n=lx(n.lo,n.hi));const r=cx(n.lo,n.hi);return i?"-"+r:r}function cx(t,e){if({lo:t,hi:e}=n7(t,e),e<=2097151)return String(kd*e+t);const n=t&16777215,i=(t>>>24|e<<8)&16777215,r=e>>16&65535;let s=n+i*6777216+r*6710656,o=i+r*8147497,a=r*2;const c=1e7;return s>=c&&(o+=Math.floor(s/c),s%=c),o>=c&&(a+=Math.floor(o/c),o%=c),a.toString()+z_(o)+z_(s)}function n7(t,e){return{lo:t>>>0,hi:e>>>0}}function eb(t,e){return{lo:t|0,hi:e|0}}function lx(t,e){return e=~e,t?t=~t+1:e+=1,eb(t,e)}const z_=t=>{const e=String(t);return"0000000".slice(e.length)+e};function q_(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function i7(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function r7(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof j_!="object"||j_.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>s||l<r)throw new Error("int64 invalid: ".concat(c));return l},uParse(c){const l=typeof c=="bigint"?c:BigInt(c);if(l>a||l<o)throw new Error("uint64 invalid: ".concat(c));return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}const n=r=>tt(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),i=r=>tt(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),i(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),n(r),B_(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),i(r),B_(r)},dec(r,s){return t7(r,s)},uDec(r,s){return cx(r,s)}}}const qe=r7();var H;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(H||(H={}));var Zr;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Zr||(Zr={}));function mr(t,e,n){if(e===n)return!0;if(t==H.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}switch(t){case H.UINT64:case H.FIXED64:case H.INT64:case H.SFIXED64:case H.SINT64:return e==n}return!1}function va(t,e){switch(t){case H.BOOL:return!1;case H.UINT64:case H.FIXED64:case H.INT64:case H.SFIXED64:case H.SINT64:return e==0?qe.zero:"0";case H.DOUBLE:case H.FLOAT:return 0;case H.BYTES:return new Uint8Array(0);case H.STRING:return"";default:return 0}}function ux(t,e){switch(t){case H.BOOL:return e===!1;case H.STRING:return e==="";case H.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var rt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(rt||(rt={}));class s7{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let r=0;r<this.chunks.length;r++)e+=this.chunks[r].length;let n=new Uint8Array(e),i=0;for(let r=0;r<this.chunks.length;r++)n.set(this.chunks[r],i),i+=this.chunks[r].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Iv(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Td(e),q_(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){ix(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Iv(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Td(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Td(e),e=(e<<1^e>>31)>>>0,q_(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),r=qe.enc(e);return i.setInt32(0,r.lo,!0),i.setInt32(4,r.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),r=qe.uEnc(e);return i.setInt32(0,r.lo,!0),i.setInt32(4,r.hi,!0),this.raw(n)}int64(e){let n=qe.enc(e);return wm(n.lo,n.hi,this.buf),this}sint64(e){let n=qe.enc(e),i=n.hi>>31,r=n.lo<<1^i,s=(n.hi<<1|n.lo>>>31)^i;return wm(r,s,this.buf),this}uint64(e){let n=qe.uEnc(e);return wm(n.lo,n.hi,this.buf),this}}class o7{constructor(e,n){this.varint64=e7,this.uint32=i7,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,i=e&7;if(n<=0||i<0||i>5)throw new Error("illegal tag: field no "+n+" wire type "+i);return[n,i]}skip(e,n){let i=this.pos;switch(e){case rt.Varint:for(;this.buf[this.pos++]&128;);break;case rt.Bit64:this.pos+=4;case rt.Bit32:this.pos+=4;break;case rt.LengthDelimited:let r=this.uint32();this.pos+=r;break;case rt.StartGroup:for(;;){const[s,o]=this.tag();if(o===rt.EndGroup){if(n!==void 0&&s!==n)throw new Error("invalid end group tag");break}this.skip(o,s)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(i,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return qe.dec(...this.varint64())}uint64(){return qe.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),i=-(e&1);return e=(e>>>1|(n&1)<<31)^i,n=n>>>1^i,qe.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return qe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return qe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function a7(t,e,n,i){let r;return{typeName:e,extendee:n,get field(){if(!r){const s=typeof i=="function"?i():i;s.name=e.split(".").pop(),s.jsonName="[".concat(e,"]"),r=t.util.newFieldList([s]).list()[0]}return r},runtime:t}}function dx(t){const e=t.field.localName,n=Object.create(null);return n[e]=c7(t),[n,()=>n[e]]}function c7(t){const e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return va(e.T,e.L);case"message":const n=e.T,i=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(i):i;case"map":throw"map fields are not allowed to be extensions"}}function l7(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}let Vi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),jf=[];for(let t=0;t<Vi.length;t++)jf[Vi[t].charCodeAt(0)]=t;jf[45]=Vi.indexOf("+");jf[95]=Vi.indexOf("/");const hx={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),i=0,r=0,s,o=0;for(let a=0;a<t.length;a++){if(s=jf[t.charCodeAt(a)],s===void 0)switch(t[a]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:o=s,r=1;break;case 1:n[i++]=o<<2|(s&48)>>4,o=s,r=2;break;case 2:n[i++]=(o&15)<<4|(s&60)>>2,o=s,r=3;break;case 3:n[i++]=(o&3)<<6|s,r=0;break}}if(r==1)throw Error("invalid base64 string.");return n.subarray(0,i)},enc(t){let e="",n=0,i,r=0;for(let s=0;s<t.length;s++)switch(i=t[s],n){case 0:e+=Vi[i>>2],r=(i&3)<<4,n=1;break;case 1:e+=Vi[r|i>>4],r=(i&15)<<2,n=2;break;case 2:e+=Vi[r|i>>6],e+=Vi[i&63],n=0;break}return n&&(e+=Vi[r],e+="=",n==1&&(e+="=")),e}};function u7(t,e,n){px(e,t);const i=e.runtime.bin.makeReadOptions(n),r=l7(t.getType().runtime.bin.listUnknownFields(t),e.field),[s,o]=dx(e);for(const a of r)e.runtime.bin.readField(s,i.readerFactory(a.data),e.field,a.wireType,i);return o()}function d7(t,e,n,i){px(e,t);const r=e.runtime.bin.makeReadOptions(i),s=e.runtime.bin.makeWriteOptions(i);if(fx(t,e)){const l=t.getType().runtime.bin.listUnknownFields(t).filter(u=>u.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(const u of l)t.getType().runtime.bin.onUnknownField(t,u.no,u.wireType,u.data)}const o=s.writerFactory();let a=e.field;!a.opt&&!a.repeated&&(a.kind=="enum"||a.kind=="scalar")&&(a=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(a,n,o,s);const c=r.readerFactory(o.finish());for(;c.pos<c.len;){const[l,u]=c.tag(),h=c.skip(u,l);t.getType().runtime.bin.onUnknownField(t,l,u,h)}}function fx(t,e){const n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(i=>i.no==e.field.no)}function px(t,e){tt(t.extendee.typeName==e.getType().typeName,"extension ".concat(t.typeName," can only be applied to message ").concat(t.extendee.typeName))}function mx(t,e){const n=t.localName;if(t.repeated)return e[n].length>0;if(t.oneof)return e[t.oneof.localName].case===n;switch(t.kind){case"enum":case"scalar":return t.opt||t.req?e[n]!==void 0:t.kind=="enum"?e[n]!==t.T.values[0].no:!ux(t.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function H_(t,e){const n=t.localName,i=!t.opt&&!t.req;if(t.repeated)e[n]=[];else if(t.oneof)e[t.oneof.localName]={case:void 0};else switch(t.kind){case"map":e[n]={};break;case"enum":e[n]=i?t.T.values[0].no:void 0;break;case"scalar":e[n]=i?va(t.T,t.L):void 0;break;case"message":e[n]=void 0;break}}function Ls(t,e){if(t===null||typeof t!="object"||!Object.getOwnPropertyNames(Z0.prototype).every(i=>i in t&&typeof t[i]=="function"))return!1;const n=t.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function gx(t,e){return Ls(e)||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}H.DOUBLE,H.FLOAT,H.INT64,H.UINT64,H.INT32,H.UINT32,H.BOOL,H.STRING,H.BYTES;const W_={ignoreUnknownFields:!1},K_={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function h7(t){return t?Object.assign(Object.assign({},W_),t):W_}function f7(t){return t?Object.assign(Object.assign({},K_),t):K_}const Ih=Symbol(),wd=Symbol();function p7(){return{makeReadOptions:h7,makeWriteOptions:f7,readMessage(t,e,n,i){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(pi(e)));i=i??new t;const r=new Map,s=n.typeRegistry;for(const[o,a]of Object.entries(e)){const c=t.fields.findJsonName(o);if(c){if(c.oneof){if(a===null&&c.kind=="scalar")continue;const l=r.get(c.oneof);if(l!==void 0)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(l,'", "').concat(o,'"'));r.set(c.oneof,o)}G_(i,a,c,n,t)}else{let l=!1;if(s!=null&&s.findExtension&&o.startsWith("[")&&o.endsWith("]")){const u=s.findExtension(o.substring(1,o.length-1));if(u&&u.extendee.typeName==t.typeName){l=!0;const[h,f]=dx(u);G_(h,a,u.field,n,u),d7(i,u,f(),n)}}if(!l&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(o,'" is unknown'))}}return i},writeMessage(t,e){const n=t.getType(),i={};let r;try{for(r of n.fields.byNumber()){if(!mx(r,t)){if(r.req)throw"required field not set";if(!e.emitDefaultValues||!g7(r))continue}const o=r.oneof?t[r.oneof.localName].value:t[r.localName],a=Q_(r,o,e);a!==void 0&&(i[e.useProtoFieldName?r.name:r.jsonName]=a)}const s=e.typeRegistry;if(s!=null&&s.findExtensionFor)for(const o of n.runtime.bin.listUnknownFields(t)){const a=s.findExtensionFor(n.typeName,o.no);if(a&&fx(t,a)){const c=u7(t,a,e),l=Q_(a.field,c,e);l!==void 0&&(i[a.field.jsonName]=l)}}}catch(s){const o=r?"cannot encode field ".concat(n.typeName,".").concat(r.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),a=s instanceof Error?s.message:String(s);throw new Error(o+(a.length>0?": ".concat(a):""))}return i},readScalar(t,e,n){return Mc(t,e,n??Zr.BIGINT,!0)},writeScalar(t,e,n){if(e!==void 0&&(n||ux(t,e)))return _d(t,e)},debug:pi}}function pi(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function G_(t,e,n,i,r){let s=n.localName;if(n.repeated){if(tt(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(pi(e)));const o=t[s];for(const a of e){if(a===null)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(pi(a)));switch(n.kind){case"message":o.push(n.T.fromJson(a,i));break;case"enum":const c=_m(n.T,a,i.ignoreUnknownFields,!0);c!==wd&&o.push(c);break;case"scalar":try{o.push(Mc(n.T,a,n.L,!0))}catch(l){let u="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(pi(a));throw l instanceof Error&&l.message.length>0&&(u+=": ".concat(l.message)),new Error(u)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(pi(e)));const o=t[s];for(const[a,c]of Object.entries(e)){if(c===null)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: map value null"));let l;try{l=m7(n.K,a)}catch(u){let h="cannot decode map key for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(pi(e));throw u instanceof Error&&u.message.length>0&&(h+=": ".concat(u.message)),new Error(h)}switch(n.V.kind){case"message":o[l]=n.V.T.fromJson(c,i);break;case"enum":const u=_m(n.V.T,c,i.ignoreUnknownFields,!0);u!==wd&&(o[l]=u);break;case"scalar":try{o[l]=Mc(n.V.T,c,Zr.BIGINT,!0)}catch(h){let f="cannot decode map value for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(pi(e));throw h instanceof Error&&h.message.length>0&&(f+=": ".concat(h.message)),new Error(f)}break}}}else switch(n.oneof&&(t=t[n.oneof.localName]={case:s},s="value"),n.kind){case"message":const o=n.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let a=t[s];Ls(a)?a.fromJson(e,i):(t[s]=a=o.fromJson(e,i),o.fieldWrapper&&!n.oneof&&(t[s]=o.fieldWrapper.unwrapField(a)));break;case"enum":const c=_m(n.T,e,i.ignoreUnknownFields,!1);switch(c){case Ih:H_(n,t);break;case wd:break;default:t[s]=c;break}break;case"scalar":try{const l=Mc(n.T,e,n.L,!1);switch(l){case Ih:H_(n,t);break;default:t[s]=l;break}}catch(l){let u="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(pi(e));throw l instanceof Error&&l.message.length>0&&(u+=": ".concat(l.message)),new Error(u)}break}}function m7(t,e){if(t===H.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Mc(t,e,Zr.BIGINT,!0).toString()}function Mc(t,e,n,i){if(e===null)return i?va(t,n):Ih;switch(t){case H.DOUBLE:case H.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==H.FLOAT&&ix(r),r;case H.INT32:case H.FIXED32:case H.SFIXED32:case H.SINT32:case H.UINT32:let s;if(typeof e=="number"?s=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(s=Number(e)),s===void 0)break;return t==H.UINT32||t==H.FIXED32?Iv(s):Td(s),s;case H.INT64:case H.SFIXED64:case H.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=qe.parse(e);return n?o.toString():o;case H.FIXED64:case H.UINT64:if(typeof e!="number"&&typeof e!="string")break;const a=qe.uParse(e);return n?a.toString():a;case H.BOOL:if(typeof e!="boolean")break;return e;case H.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case H.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return hx.dec(e)}throw new Error}function _m(t,e,n,i){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:i?t.values[0].no:Ih;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const r=t.findName(e);if(r!==void 0)return r.no;if(n)return wd;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(pi(e)))}function g7(t){return t.repeated||t.kind=="map"?!0:!(t.oneof||t.kind=="message"||t.opt||t.req)}function Q_(t,e,n){if(t.kind=="map"){tt(typeof e=="object"&&e!=null);const i={},r=Object.entries(e);switch(t.V.kind){case"scalar":for(const[o,a]of r)i[o.toString()]=_d(t.V.T,a);break;case"message":for(const[o,a]of r)i[o.toString()]=a.toJson(n);break;case"enum":const s=t.V.T;for(const[o,a]of r)i[o.toString()]=Sm(s,a,n.enumAsInteger);break}return n.emitDefaultValues||r.length>0?i:void 0}if(t.repeated){tt(Array.isArray(e));const i=[];switch(t.kind){case"scalar":for(let r=0;r<e.length;r++)i.push(_d(t.T,e[r]));break;case"enum":for(let r=0;r<e.length;r++)i.push(Sm(t.T,e[r],n.enumAsInteger));break;case"message":for(let r=0;r<e.length;r++)i.push(e[r].toJson(n));break}return n.emitDefaultValues||i.length>0?i:void 0}switch(t.kind){case"scalar":return _d(t.T,e);case"enum":return Sm(t.T,e,n.enumAsInteger);case"message":return gx(t.T,e).toJson(n)}}function Sm(t,e,n){var i;if(tt(typeof e=="number"),t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const r=t.findNumber(e);return(i=r==null?void 0:r.name)!==null&&i!==void 0?i:e}function _d(t,e){switch(t){case H.INT32:case H.SFIXED32:case H.SINT32:case H.FIXED32:case H.UINT32:return tt(typeof e=="number"),e;case H.FLOAT:case H.DOUBLE:return tt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case H.STRING:return tt(typeof e=="string"),e;case H.BOOL:return tt(typeof e=="boolean"),e;case H.UINT64:case H.FIXED64:case H.INT64:case H.SFIXED64:case H.SINT64:return tt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case H.BYTES:return tt(e instanceof Uint8Array),hx.enc(e)}}const uo=Symbol("@bufbuild/protobuf/unknown-fields"),J_={readUnknownFields:!0,readerFactory:t=>new o7(t)},Y_={writeUnknownFields:!0,writerFactory:()=>new s7};function v7(t){return t?Object.assign(Object.assign({},J_),t):J_}function y7(t){return t?Object.assign(Object.assign({},Y_),t):Y_}function b7(){return{makeReadOptions:v7,makeWriteOptions:y7,listUnknownFields(t){var e;return(e=t[uo])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[uo]},writeUnknownFields(t,e){const i=t[uo];if(i)for(const r of i)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(t,e,n,i){const r=t;Array.isArray(r[uo])||(r[uo]=[]),r[uo].push({no:e,wireType:n,data:i})},readMessage(t,e,n,i,r){const s=t.getType(),o=r?e.len:e.pos+n;let a,c;for(;e.pos<o&&([a,c]=e.tag(),!(r===!0&&c==rt.EndGroup));){const l=s.fields.find(a);if(!l){const u=e.skip(c,a);i.readUnknownFields&&this.onUnknownField(t,a,c,u);continue}X_(t,e,l,c,i)}if(r&&(c!=rt.EndGroup||a!==n))throw new Error("invalid end group tag")},readField:X_,writeMessage(t,e,n){const i=t.getType();for(const r of i.fields.byNumber()){if(!mx(r,t)){if(r.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(r.name," to binary: required field not set"));continue}const s=r.oneof?t[r.oneof.localName].value:t[r.localName];Z_(r,s,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e},writeField(t,e,n,i){e!==void 0&&Z_(t,e,n,i)}}}function X_(t,e,n,i,r){let{repeated:s,localName:o}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=o&&delete t.value,t.case=o,o="value"),n.kind){case"scalar":case"enum":const a=n.kind=="enum"?H.INT32:n.T;let c=Ph;if(n.kind=="scalar"&&n.L>0&&(c=k7),s){let f=t[o];if(i==rt.LengthDelimited&&a!=H.STRING&&a!=H.BYTES){let b=e.uint32()+e.pos;for(;e.pos<b;)f.push(c(e,a))}else f.push(c(e,a))}else t[o]=c(e,a);break;case"message":const l=n.T;s?t[o].push(Sd(e,new l,r,n)):Ls(t[o])?Sd(e,t[o],r,n):(t[o]=Sd(e,new l,r,n),l.fieldWrapper&&!n.oneof&&!n.repeated&&(t[o]=l.fieldWrapper.unwrapField(t[o])));break;case"map":let[u,h]=T7(n,e,r);t[o][u]=h;break}}function Sd(t,e,n,i){const r=e.getType().runtime.bin,s=i==null?void 0:i.delimited;return r.readMessage(e,t,s?i.no:t.uint32(),n,s),e}function T7(t,e,n){const i=e.uint32(),r=e.pos+i;let s,o;for(;e.pos<r;){const[a]=e.tag();switch(a){case 1:s=Ph(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=Ph(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=Sd(e,new t.V.T,n,void 0);break}break}}if(s===void 0&&(s=va(t.K,Zr.BIGINT)),typeof s!="string"&&typeof s!="number"&&(s=s.toString()),o===void 0)switch(t.V.kind){case"scalar":o=va(t.V.T,Zr.BIGINT);break;case"enum":o=t.V.T.values[0].no;break;case"message":o=new t.V.T;break}return[s,o]}function k7(t,e){const n=Ph(t,e);return typeof n=="bigint"?n.toString():n}function Ph(t,e){switch(e){case H.STRING:return t.string();case H.BOOL:return t.bool();case H.DOUBLE:return t.double();case H.FLOAT:return t.float();case H.INT32:return t.int32();case H.INT64:return t.int64();case H.UINT64:return t.uint64();case H.FIXED64:return t.fixed64();case H.BYTES:return t.bytes();case H.FIXED32:return t.fixed32();case H.SFIXED32:return t.sfixed32();case H.SFIXED64:return t.sfixed64();case H.SINT64:return t.sint64();case H.UINT32:return t.uint32();case H.SINT32:return t.sint32()}}function Z_(t,e,n,i){tt(e!==void 0);const r=t.repeated;switch(t.kind){case"scalar":case"enum":let s=t.kind=="enum"?H.INT32:t.T;if(r)if(tt(Array.isArray(e)),t.packed)_7(n,s,t.no,e);else for(const o of e)Uc(n,s,t.no,o);else Uc(n,s,t.no,e);break;case"message":if(r){tt(Array.isArray(e));for(const o of e)eS(n,i,t,o)}else eS(n,i,t,e);break;case"map":tt(typeof e=="object"&&e!=null);for(const[o,a]of Object.entries(e))w7(n,i,t,o,a);break}}function w7(t,e,n,i,r){t.tag(n.no,rt.LengthDelimited),t.fork();let s=i;switch(n.K){case H.INT32:case H.FIXED32:case H.UINT32:case H.SFIXED32:case H.SINT32:s=Number.parseInt(i);break;case H.BOOL:tt(i=="true"||i=="false"),s=i=="true";break}switch(Uc(t,n.K,1,s),n.V.kind){case"scalar":Uc(t,n.V.T,2,r);break;case"enum":Uc(t,H.INT32,2,r);break;case"message":tt(r!==void 0),t.tag(2,rt.LengthDelimited).bytes(r.toBinary(e));break}t.join()}function eS(t,e,n,i){const r=gx(n.T,i);n.delimited?t.tag(n.no,rt.StartGroup).raw(r.toBinary(e)).tag(n.no,rt.EndGroup):t.tag(n.no,rt.LengthDelimited).bytes(r.toBinary(e))}function Uc(t,e,n,i){tt(i!==void 0);let[r,s]=vx(e);t.tag(n,r)[s](i)}function _7(t,e,n,i){if(!i.length)return;t.tag(n,rt.LengthDelimited).fork();let[,r]=vx(e);for(let s=0;s<i.length;s++)t[r](i[s]);t.join()}function vx(t){let e=rt.Varint;switch(t){case H.BYTES:case H.STRING:e=rt.LengthDelimited;break;case H.DOUBLE:case H.FIXED64:case H.SFIXED64:e=rt.Bit64;break;case H.FIXED32:case H.SFIXED32:case H.FLOAT:e=rt.Bit32;break}const n=H[t].toLowerCase();return[e,n]}function S7(){return{setEnumType:sx,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const i of n.fields.byMember()){const r=i.localName,s=e,o=t;if(o[r]!=null)switch(i.kind){case"oneof":const a=o[r].case;if(a===void 0)continue;const c=i.findField(a);let l=o[r].value;c&&c.kind=="message"&&!Ls(l,c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===H.BYTES&&(l=oc(l)),s[r]={case:a,value:l};break;case"scalar":case"enum":let u=o[r];i.T===H.BYTES&&(u=i.repeated?u.map(oc):oc(u)),s[r]=u;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===H.BYTES)for(const[g,b]of Object.entries(o[r]))s[r][g]=oc(b);else Object.assign(s[r],o[r]);break;case"message":const f=i.V.T;for(const g of Object.keys(o[r])){let b=o[r][g];f.fieldWrapper||(b=new f(b)),s[r][g]=b}break}break;case"message":const h=i.T;if(i.repeated)s[r]=o[r].map(f=>Ls(f,h)?f:new h(f));else{const f=o[r];h.fieldWrapper?h.typeName==="google.protobuf.BytesValue"?s[r]=oc(f):s[r]=f:s[r]=Ls(f,h)?f:new h(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(i=>{const r=e[i.localName],s=n[i.localName];if(i.repeated){if(r.length!==s.length)return!1;switch(i.kind){case"message":return r.every((o,a)=>i.T.equals(o,s[a]));case"scalar":return r.every((o,a)=>mr(i.T,o,s[a]));case"enum":return r.every((o,a)=>mr(H.INT32,o,s[a]))}throw new Error("repeated cannot contain ".concat(i.kind))}switch(i.kind){case"message":return i.T.equals(r,s);case"enum":return mr(H.INT32,r,s);case"scalar":return mr(i.T,r,s);case"oneof":if(r.case!==s.case)return!1;const o=i.findField(r.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(r.value,s.value);case"enum":return mr(H.INT32,r.value,s.value);case"scalar":return mr(o.T,r.value,s.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(r).concat(Object.keys(s));switch(i.V.kind){case"message":const c=i.V.T;return a.every(u=>c.equals(r[u],s[u]));case"enum":return a.every(u=>mr(H.INT32,r[u],s[u]));case"scalar":const l=i.V.T;return a.every(u=>mr(l,r[u],s[u]))}break}})},clone(t){const e=t.getType(),n=new e,i=n;for(const r of e.fields.byMember()){const s=t[r.localName];let o;if(r.repeated)o=s.map(Bu);else if(r.kind=="map"){o=i[r.localName];for(const[a,c]of Object.entries(s))o[a]=Bu(c)}else r.kind=="oneof"?o=r.findField(s.case)?{case:s.case,value:Bu(s.value)}:{case:void 0}:o=Bu(s);i[r.localName]=o}for(const r of e.runtime.bin.listUnknownFields(t))e.runtime.bin.onUnknownField(i,r.no,r.wireType,r.data);return n}}}function Bu(t){if(t===void 0)return t;if(Ls(t))return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function oc(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function E7(t,e,n){return{syntax:t,json:p7(),bin:b7(),util:Object.assign(Object.assign({},S7()),{newFieldList:e,initFields:n}),makeMessageType(i,r,s){return ZB(this,i,r,s)},makeEnum:XB,makeEnumType:ox,getEnumType:YB,makeExtension(i,r,s){return a7(this,i,r,s)}}}class C7{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const i of this.list())n[i.jsonName]=n[i.name]=i;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const i of this.list())n[i.no]=i;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const i of this.list())i.oneof?i.oneof!==n&&(n=i.oneof,e.push(n)):e.push(i)}return this.members}}function yx(t,e){const n=bx(t);return e?n:N7(A7(n))}function I7(t){return yx(t,!1)}const P7=bx;function bx(t){let e=!1;const n=[];for(let i=0;i<t.length;i++){let r=t.charAt(i);switch(r){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),e=!1;break;default:e&&(e=!1,r=r.toUpperCase()),n.push(r);break}}return n.join("")}const R7=new Set(["constructor","toString","toJSON","valueOf"]),x7=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Tx=t=>"".concat(t,"$"),A7=t=>x7.has(t)?Tx(t):t,N7=t=>R7.has(t)?Tx(t):t;class O7{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=I7(e)}addField(e){tt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function D7(t,e){var n,i,r,s,o,a;const c=[];let l;for(const u of typeof t=="function"?t():t){const h=u;if(h.localName=yx(u.name,u.oneof!==void 0),h.jsonName=(n=u.jsonName)!==null&&n!==void 0?n:P7(u.name),h.repeated=(i=u.repeated)!==null&&i!==void 0?i:!1,u.kind=="scalar"&&(h.L=(r=u.L)!==null&&r!==void 0?r:Zr.BIGINT),h.delimited=(s=u.delimited)!==null&&s!==void 0?s:!1,h.req=(o=u.req)!==null&&o!==void 0?o:!1,h.opt=(a=u.opt)!==null&&a!==void 0?a:!1,u.packed===void 0&&(h.packed=u.kind=="enum"||u.kind=="scalar"&&u.T!=H.BYTES&&u.T!=H.STRING),u.oneof!==void 0){const f=typeof u.oneof=="string"?u.oneof:u.oneof.name;(!l||l.name!=f)&&(l=new O7(f)),h.oneof=l,l.addField(h)}c.push(h)}return c}const B=E7("proto3",t=>new C7(t,e=>D7(e)),t=>{for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,i=t;if(e.repeated){i[n]=[];continue}switch(e.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=va(e.T,e.L);break}}});class tn extends Z0{constructor(e){super(),this.seconds=qe.zero,this.nanos=0,B.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(B.json.debug(e)));const i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const r=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=qe.parse(r/1e3),this.nanos=0,i[7]&&(this.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let i="Z";if(this.nanos>0){const r=(this.nanos+1e9).toString().substring(1);r.substring(3)==="000000"?i="."+r.substring(0,3)+"Z":r.substring(6)==="000"?i="."+r.substring(0,6)+"Z":i="."+r+"Z"}return new Date(n).toISOString().replace(".000Z",i)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return tn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new tn({seconds:qe.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new tn().fromBinary(e,n)}static fromJson(e,n){return new tn().fromJson(e,n)}static fromJsonString(e,n){return new tn().fromJsonString(e,n)}static equals(e,n){return B.util.equals(tn,e,n)}}tn.runtime=B;tn.typeName="google.protobuf.Timestamp";tn.fields=B.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const L7=B.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:tn},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:M7,repeated:!0},{no:5,name:"events",kind:"message",T:F7,repeated:!0}]),M7=B.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:U7,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),U7=B.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:tn},{no:3,name:"value",kind:"scalar",T:2}]),F7=B.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:tn},{no:7,name:"normalized_end_timestamp",kind:"message",T:tn,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),Wn=B.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Mt=B.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),tb=B.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),bc=B.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),yl=B.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Gn=B.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),ho=B.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),V7=B.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),mi=B.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),nb=B.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Rh,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:Nx}]),Rh=B.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),j7=B.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:B.getEnumType(Mt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),bl=B.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:B.getEnumType(Pv)},{no:4,name:"tracks",kind:"message",T:Do,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:j7},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:B.getEnumType(xh)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:B.getEnumType(Gn)}]),Pv=B.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),xh=B.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),yn=B.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),$7=B.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Ms,repeated:!0}]),Do=B.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:B.getEnumType(Wn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:B.getEnumType(Mt)},{no:10,name:"layers",kind:"message",T:Ms,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:$7,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:B.getEnumType(yn)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:Nx},{no:19,name:"audio_features",kind:"enum",T:B.getEnumType(mi),repeated:!0}]),Ms=B.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:B.getEnumType(tb)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),gr=B.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:B.getEnumType(Ve)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:wx,oneof:"value"},{no:3,name:"speaker",kind:"message",T:B7,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:_x,oneof:"value"},{no:7,name:"transcription",kind:"message",T:z7,oneof:"value"},{no:8,name:"metrics",kind:"message",T:L7,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Rv,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:Sx,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:Ex,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:Cx,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:Y7,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:X7,oneof:"value"}]),Ve=B.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),B7=B.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:kx,repeated:!0}]),kx=B.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),wx=B.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0}]),_x=B.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),z7=B.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:q7,repeated:!0}]),q7=B.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Rv=B.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),Sx=B.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),Ex=B.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),Cx=B.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Ix,oneof:"value"}]),Ix=B.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Px=B.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),H7=B.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:B.getEnumType(Rx)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Rx=B.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),W7=B.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:B.getEnumType(xx)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),xx=B.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),Ax=B.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:tS},{no:2,name:"screen",kind:"message",T:tS},{no:3,name:"resume_connection",kind:"enum",T:B.getEnumType(yl)},{no:4,name:"disabled_codecs",kind:"message",T:K7},{no:5,name:"force_relay",kind:"enum",T:B.getEnumType(yl)}]),tS=B.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:B.getEnumType(yl)}]),K7=B.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Rh,repeated:!0},{no:2,name:"publish",kind:"message",T:Rh,repeated:!0}]),Nx=B.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),G7=B.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),Q7=B.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:B.getEnumType(G7)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),J7=B.makeMessageType("livekit.DataStream.FileHeader",()=>[{no:1,name:"file_name",kind:"scalar",T:9}],{localName:"DataStream_FileHeader"}),Y7=B.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:B.getEnumType(yn)},{no:8,name:"extensions",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:Q7,oneof:"content_header"},{no:10,name:"file_header",kind:"message",T:J7,oneof:"content_header"}],{localName:"DataStream_Header"}),X7=B.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"complete",kind:"scalar",T:8},{no:5,name:"version",kind:"scalar",T:5},{no:6,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),Kn=B.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),xv=B.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),Z7=B.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),e8=B.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Js,oneof:"message"},{no:2,name:"answer",kind:"message",T:Js,oneof:"message"},{no:3,name:"trickle",kind:"message",T:ib,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Nv,oneof:"message"},{no:5,name:"mute",kind:"message",T:rb,oneof:"message"},{no:6,name:"subscription",kind:"message",T:$f,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Ox,oneof:"message"},{no:8,name:"leave",kind:"message",T:Bf,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Lx,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Vx,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:jx,oneof:"message"},{no:13,name:"simulate",kind:"message",T:hi,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:Mx,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Bx,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:Dx,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:s8,oneof:"message"}]),nS=B.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:t8,oneof:"message"},{no:2,name:"answer",kind:"message",T:Js,oneof:"message"},{no:3,name:"offer",kind:"message",T:Js,oneof:"message"},{no:4,name:"trickle",kind:"message",T:ib,oneof:"message"},{no:5,name:"update",kind:"message",T:r8,oneof:"message"},{no:6,name:"track_published",kind:"message",T:sb,oneof:"message"},{no:8,name:"leave",kind:"message",T:Bf,oneof:"message"},{no:9,name:"mute",kind:"message",T:rb,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:o8,oneof:"message"},{no:11,name:"room_update",kind:"message",T:a8,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:l8,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:d8,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:f8,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:p8,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:i8,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:n8,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:m8,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:y8,oneof:"message"},{no:22,name:"request_response",kind:"message",T:b8,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:T8,oneof:"message"}]),Av=B.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),Nv=B.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:B.getEnumType(Wn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:B.getEnumType(Mt)},{no:9,name:"layers",kind:"message",T:Ms,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Av,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:B.getEnumType(yn)},{no:15,name:"stream",kind:"scalar",T:9}]),ib=B.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:B.getEnumType(Kn)},{no:3,name:"final",kind:"scalar",T:8}]),rb=B.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),t8=B.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:nb},{no:2,name:"participant",kind:"message",T:bl},{no:3,name:"other_participants",kind:"message",T:bl,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Ux,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Ax},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:H7},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Rh,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),n8=B.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:Ux,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Ax}]),sb=B.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Do}]),i8=B.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Js=B.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),r8=B.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:bl,repeated:!0}]),$f=B.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Px,repeated:!0}]),Ox=B.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:B.getEnumType(tb)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),Dx=B.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:B.getEnumType(mi),repeated:!0}]),s8=B.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Bf=B.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:B.getEnumType(Gn)},{no:3,name:"action",kind:"enum",T:B.getEnumType(Go)},{no:4,name:"regions",kind:"message",T:g8}]),Go=B.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),Lx=B.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Ms,repeated:!0}]),Mx=B.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),Ux=B.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),o8=B.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:kx,repeated:!0}]),a8=B.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:nb}]),c8=B.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:B.getEnumType(bc)},{no:3,name:"score",kind:"scalar",T:2}]),l8=B.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:c8,repeated:!0}]),u8=B.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:B.getEnumType(xv)}]),d8=B.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:u8,repeated:!0}]),ob=B.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:B.getEnumType(tb)},{no:2,name:"enabled",kind:"scalar",T:8}]),h8=B.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:ob,repeated:!0}]),f8=B.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:ob,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:h8,repeated:!0}]),Fx=B.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),Vx=B.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Fx,repeated:!0}]),p8=B.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),jx=B.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Js},{no:2,name:"subscription",kind:"message",T:$f},{no:3,name:"publish_tracks",kind:"message",T:sb,repeated:!0},{no:4,name:"data_channels",kind:"message",T:$x,repeated:!0},{no:5,name:"offer",kind:"message",T:Js},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),$x=B.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:B.getEnumType(Kn)}]),hi=B.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:B.getEnumType(Z7),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Bx=B.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),m8=B.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),g8=B.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:v8,repeated:!0}]),v8=B.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),y8=B.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:B.getEnumType(V7)}]),b8=B.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:B.getEnumType(zx)},{no:3,name:"message",kind:"scalar",T:9}]),zx=B.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),T8=B.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function k8(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ed={exports:{}},w8=Ed.exports,iS;function _8(){return iS||(iS=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(w8,function(){var e=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],s={},o=null;function a(y,T){var v=y[T];if(typeof v.bind=="function")return v.bind(y);try{return Function.prototype.bind.call(v,y)}catch{return function(){return Function.prototype.apply.apply(v,[y,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(y){return y==="debug"&&(y="log"),typeof console===n?!1:y==="trace"&&i?c:console[y]!==void 0?a(console,y):console.log!==void 0?a(console,"log"):e}function u(){for(var y=this.getLevel(),T=0;T<r.length;T++){var v=r[T];this[v]=T<y?e:this.methodFactory(v,y,this.name)}if(this.log=this.debug,typeof console===n&&y<this.levels.SILENT)return"No console available for logging"}function h(y){return function(){typeof console!==n&&(u.call(this),this[y].apply(this,arguments))}}function f(y,T,v){return l(y)||h.apply(this,arguments)}function g(y,T){var v=this,w,S,P,R="loglevel";typeof y=="string"?R+=":"+y:typeof y=="symbol"&&(R=void 0);function O(A){var L=(r[A]||"silent").toUpperCase();if(!(typeof window===n||!R)){try{window.localStorage[R]=L;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+L+";"}catch{}}}function E(){var A;if(!(typeof window===n||!R)){try{A=window.localStorage[R]}catch{}if(typeof A===n)try{var L=window.document.cookie,D=encodeURIComponent(R),le=L.indexOf(D+"=");le!==-1&&(A=/^([^;]+)/.exec(L.slice(le+D.length+1))[1])}catch{}return v.levels[A]===void 0&&(A=void 0),A}}function _(){if(!(typeof window===n||!R)){try{window.localStorage.removeItem(R)}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function C(A){var L=A;if(typeof L=="string"&&v.levels[L.toUpperCase()]!==void 0&&(L=v.levels[L.toUpperCase()]),typeof L=="number"&&L>=0&&L<=v.levels.SILENT)return L;throw new TypeError("log.setLevel() called with invalid level: "+A)}v.name=y,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=T||f,v.getLevel=function(){return P??S??w},v.setLevel=function(A,L){return P=C(A),L!==!1&&O(P),u.call(v)},v.setDefaultLevel=function(A){S=C(A),E()||v.setLevel(A,!1)},v.resetLevel=function(){P=null,_(),u.call(v)},v.enableAll=function(A){v.setLevel(v.levels.TRACE,A)},v.disableAll=function(A){v.setLevel(v.levels.SILENT,A)},v.rebuild=function(){if(o!==v&&(w=C(o.getLevel())),u.call(v),o===v)for(var A in s)s[A].rebuild()},w=C(o?o.getLevel():"WARN");var x=E();x!=null&&(P=C(x)),u.call(v)}o=new g,o.getLogger=function(T){if(typeof T!="symbol"&&typeof T!="string"||T==="")throw new TypeError("You must supply a name when creating a logger.");var v=s[T];return v||(v=s[T]=new g(T,o.methodFactory)),v};var b=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=b),o},o.getLoggers=function(){return s},o.default=o,o})}(Ed)),Ed.exports}var zf=_8(),Ov;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(Ov||(Ov={}));var ti;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(ti||(ti={}));let ue=zf.getLogger("livekit");Object.values(ti).map(t=>zf.getLogger(t));ue.setDefaultLevel(Ov.info);function nr(t){const e=zf.getLogger(t);return e.setDefaultLevel(ue.getLevel()),e}const S8=zf.getLogger("lk-e2ee"),ac=7e3,E8=[0,300,2*2*300,3*3*300,4*4*300,ac,ac,ac,ac,ac];class C8{constructor(e){this._retryDelays=e!==void 0?[...e]:E8}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function M(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})}function rS(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function To(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof rS=="function"?rS(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var zu={exports:{}},sS;function I8(){if(sS)return zu.exports;sS=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(R,O,E){return Function.prototype.apply.call(R,O,E)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(R){return Object.getOwnPropertyNames(R).concat(Object.getOwnPropertySymbols(R))}:n=function(R){return Object.getOwnPropertyNames(R)};function i(P){console&&console.warn&&console.warn(P)}var r=Number.isNaN||function(R){return R!==R};function s(){s.init.call(this)}zu.exports=s,zu.exports.once=v,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(P){if(typeof P!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof P)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(P){if(typeof P!="number"||P<0||r(P))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+P+".");o=P}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(R){if(typeof R!="number"||R<0||r(R))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+R+".");return this._maxListeners=R,this};function c(P){return P._maxListeners===void 0?s.defaultMaxListeners:P._maxListeners}s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(R){for(var O=[],E=1;E<arguments.length;E++)O.push(arguments[E]);var _=R==="error",C=this._events;if(C!==void 0)_=_&&C.error===void 0;else if(!_)return!1;if(_){var x;if(O.length>0&&(x=O[0]),x instanceof Error)throw x;var A=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw A.context=x,A}var L=C[R];if(L===void 0)return!1;if(typeof L=="function")e(L,this,O);else for(var D=L.length,le=b(L,D),E=0;E<D;++E)e(le[E],this,O);return!0};function l(P,R,O,E){var _,C,x;if(a(O),C=P._events,C===void 0?(C=P._events=Object.create(null),P._eventsCount=0):(C.newListener!==void 0&&(P.emit("newListener",R,O.listener?O.listener:O),C=P._events),x=C[R]),x===void 0)x=C[R]=O,++P._eventsCount;else if(typeof x=="function"?x=C[R]=E?[O,x]:[x,O]:E?x.unshift(O):x.push(O),_=c(P),_>0&&x.length>_&&!x.warned){x.warned=!0;var A=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(R)+" listeners added. Use emitter.setMaxListeners() to increase limit");A.name="MaxListenersExceededWarning",A.emitter=P,A.type=R,A.count=x.length,i(A)}return P}s.prototype.addListener=function(R,O){return l(this,R,O,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(R,O){return l(this,R,O,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(P,R,O){var E={fired:!1,wrapFn:void 0,target:P,type:R,listener:O},_=u.bind(E);return _.listener=O,E.wrapFn=_,_}s.prototype.once=function(R,O){return a(O),this.on(R,h(this,R,O)),this},s.prototype.prependOnceListener=function(R,O){return a(O),this.prependListener(R,h(this,R,O)),this},s.prototype.removeListener=function(R,O){var E,_,C,x,A;if(a(O),_=this._events,_===void 0)return this;if(E=_[R],E===void 0)return this;if(E===O||E.listener===O)--this._eventsCount===0?this._events=Object.create(null):(delete _[R],_.removeListener&&this.emit("removeListener",R,E.listener||O));else if(typeof E!="function"){for(C=-1,x=E.length-1;x>=0;x--)if(E[x]===O||E[x].listener===O){A=E[x].listener,C=x;break}if(C<0)return this;C===0?E.shift():y(E,C),E.length===1&&(_[R]=E[0]),_.removeListener!==void 0&&this.emit("removeListener",R,A||O)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(R){var O,E,_;if(E=this._events,E===void 0)return this;if(E.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):E[R]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete E[R]),this;if(arguments.length===0){var C=Object.keys(E),x;for(_=0;_<C.length;++_)x=C[_],x!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=E[R],typeof O=="function")this.removeListener(R,O);else if(O!==void 0)for(_=O.length-1;_>=0;_--)this.removeListener(R,O[_]);return this};function f(P,R,O){var E=P._events;if(E===void 0)return[];var _=E[R];return _===void 0?[]:typeof _=="function"?O?[_.listener||_]:[_]:O?T(_):b(_,_.length)}s.prototype.listeners=function(R){return f(this,R,!0)},s.prototype.rawListeners=function(R){return f(this,R,!1)},s.listenerCount=function(P,R){return typeof P.listenerCount=="function"?P.listenerCount(R):g.call(P,R)},s.prototype.listenerCount=g;function g(P){var R=this._events;if(R!==void 0){var O=R[P];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function b(P,R){for(var O=new Array(R),E=0;E<R;++E)O[E]=P[E];return O}function y(P,R){for(;R+1<P.length;R++)P[R]=P[R+1];P.pop()}function T(P){for(var R=new Array(P.length),O=0;O<R.length;++O)R[O]=P[O].listener||P[O];return R}function v(P,R){return new Promise(function(O,E){function _(x){P.removeListener(R,C),E(x)}function C(){typeof P.removeListener=="function"&&P.removeListener("error",_),O([].slice.call(arguments))}S(P,R,C,{once:!0}),R!=="error"&&w(P,_,{once:!0})})}function w(P,R,O){typeof P.on=="function"&&S(P,"error",R,O)}function S(P,R,O,E){if(typeof P.on=="function")E.once?P.once(R,O):P.on(R,O);else if(typeof P.addEventListener=="function")P.addEventListener(R,function _(C){E.once&&P.removeEventListener(R,_),O(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof P)}return zu.exports}var xi=I8();let qx=!0,Hx=!0;function Cd(t,e,n){const i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}function io(t,e,n){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(o,a){if(o!==e)return r.apply(this,arguments);const c=l=>{const u=n(l);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),r.apply(this,[o,c])};const s=i.removeEventListener;i.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,c])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function P8(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(qx=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function R8(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Hx=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Wx(){if(typeof window=="object"){if(qx)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function ab(t,e){Hx&&console.warn(t+" is deprecated, please use "+e+" instead.")}function x8(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const i=n.userAgentData.brands.find(r=>r.brand==="Chromium");if(i)return{browser:"chrome",version:parseInt(i.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=Cd(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Cd(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Cd(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function oS(t){return Object.prototype.toString.call(t)==="[object Object]"}function Kx(t){return oS(t)?Object.keys(t).reduce(function(e,n){const i=oS(t[n]),r=i?Kx(t[n]):t[n],s=i&&!Object.keys(r).length;return r===void 0||s?e:Object.assign(e,{[n]:r})},{}):t}function Dv(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?Dv(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach(r=>{Dv(t,t.get(r),n)})}))}function aS(t,e,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(e===null)return r;const s=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&s.push(o)}),s.forEach(o=>{t.forEach(a=>{a.type===i&&a.trackId===o.id&&Dv(t,a,r)})}),r}const cS=Wx;function Gx(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const i=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof a[l]=="object"?a[l]:{ideal:a[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const h=function(f,g){return f?f+g.charAt(0).toUpperCase()+g.slice(1):g==="deviceId"?"sourceId":g};if(u.ideal!==void 0){c.optional=c.optional||[];let f={};typeof u.ideal=="number"?(f[h("min",l)]=u.ideal,c.optional.push(f),f={},f[h("max",l)]=u.ideal,c.optional.push(f)):(f[h("",l)]=u.ideal,c.optional.push(f))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[h("",l)]=u.exact):["min","max"].forEach(f=>{u[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[h(f,l)]=u[f])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},r=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(u,h,f){h in u&&!(f in u)&&(u[f]=u[h],delete u[h])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=i(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let h;if(l.exact==="environment"||l.ideal==="environment"?h=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(h=["front"]),h)return n.mediaDevices.enumerateDevices().then(f=>{f=f.filter(b=>b.kind==="videoinput");let g=f.find(b=>h.some(y=>b.label.toLowerCase().includes(y)));return!g&&f.length&&h.includes("back")&&(g=f[f.length-1]),g&&(a.video.deviceId=l.exact?{exact:g.deviceId}:{ideal:g.deviceId}),a.video=i(a.video),cS("chrome: "+JSON.stringify(a)),c(a)})}a.video=i(a.video)}return cS("chrome: "+JSON.stringify(a)),c(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,c,l){r(a,u=>{n.webkitGetUserMedia(u,c,h=>{l&&l(s(h))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return r(c,l=>a(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function Qx(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Jx(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===r.track.id):s={track:r.track};const o=new Event("track");o.track=r.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[i.stream],this.dispatchEvent(o)}),i.stream.getTracks().forEach(r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===r.id):s={track:r};const o=new Event("track");o.track=r,o.receiver=s,o.transceiver={receiver:s},o.streams=[i.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else io(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Yx(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(r,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=r.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:r}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,c){let l=r.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],i.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(c=>c.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Xx(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(o=>o._pc=this),s});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=i.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>aS(o,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(s=>s._pc=this),r}),io(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(s=>aS(s,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let r,s,o;return this.getSenders().forEach(a=>{a.track===i&&(r?o=!0:r=a)}),this.getReceivers().forEach(a=>(a.track===i&&(s?o=!0:s=a),a.track===i)),o||r&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Zx(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(l=>{if(this.getSenders().find(h=>h.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],i.apply(this,arguments)};const r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(o);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),r.apply(this,arguments)}}function eA(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Zx(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(h=>this._reverseStreams[h.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(g=>g.track===h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const h=new t.MediaStream(u.getTracks());this._streams[u.id]=h,this._reverseStreams[h.id]=u,u=h}i.apply(this,[u])};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(y=>y===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(y=>y.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const b=this._streams[h.id];if(b)b.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const y=new t.MediaStream([u]);this._streams[h.id]=y,this._reverseStreams[y.id]=h,this.addStream(y)}return this.getSenders().find(y=>y.track===u)};function s(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const g=l._reverseStreams[f],b=l._streams[g.id];h=h.replace(new RegExp(b.id,"g"),g.id)}),new RTCSessionDescription({type:u.type,sdp:h})}function o(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const g=l._reverseStreams[f],b=l._streams[g.id];h=h.replace(new RegExp(g.id,"g"),b.id)}),new RTCSessionDescription({type:u.type,sdp:h})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],h={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[b=>{const y=s(this,b);f[0].apply(null,[y])},b=>{f[1]&&f[1].apply(null,b)},arguments[2]]):u.apply(this,arguments).then(b=>s(this,b))}};t.RTCPeerConnection.prototype[l]=h[l]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(g=>{this._streams[g].getTracks().find(y=>u.track===y)&&(f=this._streams[g])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Lv(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=t.RTCPeerConnection.prototype[n],r={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=r[n]})}function tA(t,e){io(t,"negotiationneeded",n=>{const i=n.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return n})}var lS=Object.freeze({__proto__:null,fixNegotiationNeeded:tA,shimAddTrackRemoveTrack:eA,shimAddTrackRemoveTrackWithNative:Zx,shimGetSendersWithDtmf:Yx,shimGetUserMedia:Gx,shimMediaStream:Qx,shimOnTrack:Jx,shimPeerConnection:Lv,shimSenderReceiverGetStats:Xx});function nA(t,e){const n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(r,s,o){ab("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(r).then(s,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const r=function(o,a,c){a in o&&!(c in o)&&(o[c]=o[a],delete o[a])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),r(o.audio,"autoGainControl","mozAutoGainControl"),r(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},i&&i.prototype.getSettings){const o=i.prototype.getSettings;i.prototype.getSettings=function(){const a=o.apply(this,arguments);return r(a,"mozAutoGainControl","autoGainControl"),r(a,"mozNoiseSuppression","noiseSuppression"),a}}if(i&&i.prototype.applyConstraints){const o=i.prototype.applyConstraints;i.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),r(a,"autoGainControl","mozAutoGainControl"),r(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function A8(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function iA(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mv(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=t.RTCPeerConnection.prototype[r],o={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=o[r]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return i.apply(this,[s||null]).then(c=>{if(e.version<53&&!o)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,h)=>{c.set(h,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(o,a)}}function rA(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function sA(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i}),io(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function oA(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){ab("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&n.getTracks().includes(i.track)&&this.removeTrack(i)})})}function aA(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function cA(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const r=i.length>0;r&&i.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(r){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=i,o.sendEncodings=i,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function lA(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function uA(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function dA(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var uS=Object.freeze({__proto__:null,shimAddTransceiver:cA,shimCreateAnswer:dA,shimCreateOffer:uA,shimGetDisplayMedia:A8,shimGetParameters:lA,shimGetUserMedia:nA,shimOnTrack:iA,shimPeerConnection:Mv,shimRTCDataChannel:aA,shimReceiverGetStats:sA,shimRemoveStream:oA,shimSenderGetStats:rA});function hA(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(r=>e.call(this,r,i)),i.getVideoTracks().forEach(r=>e.call(this,r,i))},t.RTCPeerConnection.prototype.addTrack=function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(n);if(i===-1)return;this._localStreams.splice(i,1);const r=n.getTracks();this.getSenders().forEach(s=>{r.includes(s.track)&&this.removeTrack(s)})})}}function fA(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(r=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(r))return;this._remoteStreams.push(r);const s=new Event("addstream");s.stream=r,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(s=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(s)>=0)return;i._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,i.dispatchEvent(o)})}),e.apply(i,arguments)}}}function pA(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],f=n.apply(this,[h]);return u?(f.then(l,u),Promise.resolve()):f},e.createAnswer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],f=i.apply(this,[h]);return u?(f.then(l,u),Promise.resolve()):f};let a=function(c,l,u){const h=r.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h};e.setLocalDescription=a,a=function(c,l,u){const h=s.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.setRemoteDescription=a,a=function(c,l,u){const h=o.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.addIceCandidate=a}function mA(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=r=>i(gA(r))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,r,s){e.mediaDevices.getUserMedia(i).then(r,s)}).bind(e))}function gA(t){return t&&t.video!==void 0?Object.assign({},t,{video:Kx(t.video)}):t}function vA(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,r){if(i&&i.iceServers){const s=[];for(let o=0;o<i.iceServers.length;o++){let a=i.iceServers[o];a.urls===void 0&&a.url?(ab("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(i.iceServers[o])}i.iceServers=s}return new e(i,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function yA(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function bA(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const r=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):i.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):i.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function TA(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var dS=Object.freeze({__proto__:null,shimAudioContext:TA,shimCallbacksAPI:pA,shimConstraints:gA,shimCreateOfferLegacy:bA,shimGetUserMedia:mA,shimLocalStreamsAPI:hA,shimRTCIceServerUrls:vA,shimRemoteStreamsAPI:fA,shimTrackEventTransceiver:yA}),Em={exports:{}},hS;function N8(){return hS||(hS=1,function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,s)=>(s>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const i=e.splitSections(n);return i&&i[0]},e.getMediaSections=function(n){const i=e.splitSections(n);return i.shift(),i},e.matchPrefix=function(n,i){return e.splitLines(n).filter(r=>r.indexOf(i)===0)},e.parseCandidate=function(n){let i;n.indexOf("a=candidate:")===0?i=n.substring(12).split(" "):i=n.substring(10).split(" ");const r={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let s=8;s<i.length;s+=2)switch(i[s]){case"raddr":r.relatedAddress=i[s+1];break;case"rport":r.relatedPort=parseInt(i[s+1],10);break;case"tcptype":r.tcpType=i[s+1];break;case"ufrag":r.ufrag=i[s+1],r.usernameFragment=i[s+1];break;default:r[i[s]]===void 0&&(r[i[s]]=i[s+1]);break}return r},e.writeCandidate=function(n){const i=[];i.push(n.foundation);const r=n.component;r==="rtp"?i.push(1):r==="rtcp"?i.push(2):i.push(r),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const s=n.type;return i.push("typ"),i.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let i=n.substring(9).split(" ");const r={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),r.name=i[0],r.clockRate=parseInt(i[1],10),r.channels=i.length===3?parseInt(i[2],10):1,r.numChannels=r.channels,r},e.writeRtpMap=function(n){let i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);const r=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(r!==1?"/"+r:"")+`\r
`},e.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const i={};let r;const s=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)r=s[o].trim().split("="),i[r[0].trim()]=r[1];return i},e.writeFmtp=function(n){let i="",r=n.payloadType;if(n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?s.push(o+"="+n.parameters[o]):s.push(o)}),i+="a=fmtp:"+r+" "+s.join(";")+`\r
`}return i},e.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(n){let i="",r=n.payloadType;return n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{i+="a=rtcp-fb:"+r+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(n){const i=n.indexOf(" "),r={ssrc:parseInt(n.substring(7,i),10)},s=n.indexOf(":",i);return s>-1?(r.attribute=n.substring(i+1,s),r.value=n.substring(s+1)):r.attribute=n.substring(i+1),r},e.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(r=>parseInt(r,10))}},e.getMid=function(n){const i=e.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:e.matchPrefix(n+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,i){let r="a=setup:"+i+`\r
`;return n.fingerprints.forEach(s=>{r+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),r},e.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,i){return e.matchPrefix(n+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,i){const r=e.matchPrefix(n+i,"a=ice-ufrag:")[0],s=e.matchPrefix(n+i,"a=ice-pwd:")[0];return r&&s?{usernameFragment:r.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");i.profile=s[2];for(let a=3;a<s.length;a++){const c=s[a],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),h=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=h.length?e.parseFmtp(h[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),i.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{i.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(a=>{o.forEach(c=>{a.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),i},e.writeRtpDescription=function(n,i){let r="";r+="m="+n+" ",r+=i.codecs.length>0?"9":"0",r+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=i.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(o=>{r+=e.writeRtpMap(o),r+=e.writeFmtp(o),r+=e.writeRtcpFb(o)});let s=0;return i.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(r+="a=maxptime:"+s+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(o=>{r+=e.writeExtmap(o)}),r},e.parseRtpEncodingParameters=function(n){const i=[],r=e.parseRtpParameters(n),s=r.fecMechanisms.indexOf("RED")!==-1,o=r.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(b=>parseInt(b,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),r.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let g={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(g.rtx={ssrc:l}),i.push(g),s&&(g=JSON.parse(JSON.stringify(g)),g.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},i.push(g))}}),i.length===0&&c&&i.push({ssrc:c});let h=e.matchPrefix(n,"b=");return h.length&&(h[0].indexOf("b=TIAS:")===0?h=parseInt(h[0].substring(7),10):h[0].indexOf("b=AS:")===0?h=parseInt(h[0].substring(5),10)*1e3*.95-50*40*8:h=void 0,i.forEach(f=>{f.maxBitrate=h})),i},e.parseRtcpParameters=function(n){const i={},r=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];r&&(i.cname=r.value,i.ssrc=r.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=s.length>0,i.compound=s.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return i.mux=o.length>0,i},e.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+=`a=rtcp-rsize\r
`),n.mux&&(i+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),i},e.parseMsid=function(n){let i;const r=e.matchPrefix(n,"a=msid:");if(r.length===1)return i=r[0].substring(7).split(" "),{stream:i[0],track:i[1]};const s=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return i=s[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(n){const i=e.parseMLine(n),r=e.matchPrefix(n,"a=max-message-size:");let s;r.length>0&&(s=parseInt(r[0].substring(19),10)),isNaN(s)&&(s=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:i.fmt,maxMessageSize:s};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,i){let r=[];return n.protocol!=="DTLS/SCTP"?r=["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:r=["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&r.push("a=max-message-size:"+i.maxMessageSize+`\r
`),r.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,i,r){let s;const o=i!==void 0?i:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,i){const r=e.splitLines(n);for(let s=0;s<r.length;s++)switch(r[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[s].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const i=e.splitLines(n);for(let r=0;r<i.length;r++)if(i[r].length<2||i[r].charAt(1)!=="=")return!1;return!0},t.exports=e}(Em)),Em.exports}var kA=N8(),Qo=k8(kA),O8=zB({__proto__:null,default:Qo},[kA]);function Id(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const r=new e(i),s=Qo.parseCandidate(i.candidate);for(const o in s)o in r||Object.defineProperty(r,o,{value:s[o]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,io(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Uv(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||io(t,"icecandidate",e=>{if(e.candidate){const n=Qo.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Pd(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const c=Qo.splitSections(a.sdp);return c.shift(),c.some(l=>{const u=Qo.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},i=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},r=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=Qo.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=i(arguments[0]),l=r(c),u=s(arguments[0],c);let h;l===0&&u===0?h=Number.POSITIVE_INFINITY:l===0||u===0?h=Math.max(l,u):h=Math.min(l,u);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return h}}),this._sctp=f}return o.apply(this,arguments)}}function Rd(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,r){const s=i.send;i.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(i.readyState==="open"&&r.sctp&&c>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return s.apply(i,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},io(t,"datachannel",i=>(e(i.channel,i.target),i))}function Fv(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const s=r.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",r);s.dispatchEvent(o)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function Vv(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=r.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:s}):r.sdp=s}return n.apply(this,arguments)}}function xd(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ad(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}var D8=Object.freeze({__proto__:null,removeExtmapAllowMixed:Vv,shimAddIceCandidateNullOrEmpty:xd,shimConnectionState:Fv,shimMaxMessageSize:Pd,shimParameterlessSetLocalDescription:Ad,shimRTCIceCandidate:Id,shimRTCIceCandidateRelayProtocol:Uv,shimSendThrowTypeError:Rd});function L8(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Wx,i=x8(t),r={browserDetails:i,commonShim:D8,extractVersion:Cd,disableLog:P8,disableWarnings:R8,sdp:O8};switch(i.browser){case"chrome":if(!lS||!Lv||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=lS,xd(t,i),Ad(t),Gx(t,i),Qx(t),Lv(t,i),Jx(t),eA(t,i),Yx(t),Xx(t),tA(t,i),Id(t),Uv(t),Fv(t),Pd(t,i),Rd(t),Vv(t,i);break;case"firefox":if(!uS||!Mv||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=uS,xd(t,i),Ad(t),nA(t,i),Mv(t,i),iA(t),oA(t),rA(t),sA(t),aA(t),cA(t),lA(t),uA(t),dA(t),Id(t),Fv(t),Pd(t,i),Rd(t);break;case"safari":if(!dS||!e.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=dS,xd(t,i),Ad(t),vA(t),bA(t),pA(t),hA(t),fA(t),yA(t),mA(t),TA(t),Id(t),Uv(t),Pd(t,i),Rd(t),Vv(t,i);break;default:n("Unsupported browser!");break}return r}L8({window:typeof window>"u"?void 0:window});const M8=10,qu="lk_e2ee",U8="LKFrameEncryptionKey",F8={sharedKey:!1,ratchetSalt:U8,ratchetWindowSize:8,failureTolerance:M8,keyringSize:16};var qr;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(qr||(qr={}));var fS;(function(t){t.KeyRatcheted="keyRatcheted"})(fS||(fS={}));var Nr;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Nr||(Nr={}));var pS;(function(t){t.Error="cryptorError"})(pS||(pS={}));function V8(){return j8()||jv()}function jv(){return typeof window.RTCRtpScriptTransform<"u"}function j8(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class XQ extends xi.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,i)=>{ue.debug("key ratcheted event received",{material:n,keyIndex:i})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},F8),e),this.on(qr.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,i){const r={key:e,participantIdentity:n,keyIndex:i};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(i??0),r),this.emit(qr.SetKey,r)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(qr.RatchetRequest,e,n)}}class ro extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}var ke;(function(t){t[t.NotAllowed=0]="NotAllowed",t[t.ServerUnreachable=1]="ServerUnreachable",t[t.InternalError=2]="InternalError",t[t.Cancelled=3]="Cancelled",t[t.LeaveRequest=4]="LeaveRequest"})(ke||(ke={}));class Ne extends ro{constructor(e,n,i,r){super(1,e),this.status=i,this.reason=n,this.context=r}}class cb extends ro{constructor(e){super(21,e??"device is unsupported")}}class ji extends ro{constructor(e){super(20,e??"track is invalid")}}class $8 extends ro{constructor(e){super(10,e??"unsupported server")}}class dt extends ro{constructor(e){super(12,e??"unexpected connection state")}}class $v extends ro{constructor(e){super(13,e??"unable to negotiate")}}class mS extends ro{constructor(e,n){super(15,e),this.reason=n}}var Tl;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(Tl||(Tl={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(Tl||(Tl={}));var gS;(function(t){t[t.InvalidKey=0]="InvalidKey",t[t.MissingKey=1]="MissingKey",t[t.InternalError=2]="InternalError"})(gS||(gS={}));var F;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.ParticipantAttributesChanged="participantAttributesChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged",t.ChatMessage="chatMessage",t.LocalTrackSubscribed="localTrackSubscribed",t.MetricsReceived="metricsReceived"})(F||(F={}));var V;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded",t.AttributesChanged="attributesChanged",t.LocalTrackSubscribed="localTrackSubscribed",t.ChatMessage="chatMessage"})(V||(V={}));var Y;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackSubscribed="localTrackSubscribed",t.Offline="offline",t.SignalRequestResponse="signalRequestResponse"})(Y||(Y={}));var G;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed",t.TrackProcessorUpdate="trackProcessorUpdate",t.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",t.TranscriptionReceived="transcriptionReceived",t.TimeSyncUpdate="timeSyncUpdate"})(G||(G={}));function lb(t,e,n){var i,r,s;e===void 0&&(e=50),n===void 0&&(n={});var o=(i=n.isImmediate)!=null&&i,a=(r=n.callback)!=null&&r,c=n.maxWait,l=Date.now(),u=[];function h(){if(c!==void 0){var g=Date.now()-l;if(g+e>=c)return c-g}return e}var f=function(){var g=[].slice.call(arguments),b=this;return new Promise(function(y,T){var v=o&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,l=Date.now(),!o){var S=t.apply(b,g);a&&a(S),u.forEach(function(P){return(0,P.resolve)(S)}),u=[]}},h()),v){var w=t.apply(b,g);return a&&a(w),y(w)}u.push({resolve:y,reject:T})})};return f.cancel=function(g){s!==void 0&&clearTimeout(s),u.forEach(function(b){return(0,b.reject)(g)}),u=[]},f}const B8=/version\/(\d+(\.?_?\d+)+)/i;let Cm;function Ii(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Cm===void 0||e){const i=z8.find(r=>{let{test:s}=r;return s.test(n)});Cm=i==null?void 0:i.describe(n)}return Cm}const z8=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Nd(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:Im(t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Nd(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0,osVersion:Im(t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Nd(B8,t),os:t.includes("mobile/")?"iOS":"macOS",osVersion:Im(t)}}}];function Nd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=e.match(t);return i&&i.length>=n&&i[n]||""}function Im(t){return t.includes("mac os")?Nd(/\(.+?(\d+_\d+(:?_\d+)?)/,t,1).replace(/_/g,"."):void 0}var q8="2.8.0";const H8=q8,W8=15;class Et{}Et.setTimeout=function(){return setTimeout(...arguments)};Et.setInterval=function(){return setInterval(...arguments)};Et.clearTimeout=function(){return clearTimeout(...arguments)};Et.clearInterval=function(){return clearInterval(...arguments)};class Re{constructor(e,n,i,r,s){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&i!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:i,maxFramerate:r,priority:s};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const K8=["vp8","h264"],G8=["vp8","h264","vp9","av1"];function Q8(t){return!!K8.find(e=>e===t)}var Bv;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:24e3},t.music={maxBitrate:48e3},t.musicStereo={maxBitrate:64e3},t.musicHighQuality={maxBitrate:96e3},t.musicHighQualityStereo={maxBitrate:128e3}})(Bv||(Bv={}));const kl={h90:new Re(160,90,9e4,20),h180:new Re(320,180,16e4,20),h216:new Re(384,216,18e4,20),h360:new Re(640,360,45e4,20),h540:new Re(960,540,8e5,25),h720:new Re(1280,720,17e5,30),h1080:new Re(1920,1080,3e6,30),h1440:new Re(2560,1440,5e6,30),h2160:new Re(3840,2160,8e6,30)},zv={h120:new Re(160,120,7e4,20),h180:new Re(240,180,125e3,20),h240:new Re(320,240,14e4,20),h360:new Re(480,360,33e4,20),h480:new Re(640,480,5e5,20),h540:new Re(720,540,6e5,25),h720:new Re(960,720,13e5,30),h1080:new Re(1440,1080,23e5,30),h1440:new Re(1920,1440,38e5,30)},ub={h360fps3:new Re(640,360,2e5,3,"medium"),h360fps15:new Re(640,360,4e5,15,"medium"),h720fps5:new Re(1280,720,8e5,5,"medium"),h720fps15:new Re(1280,720,15e5,15,"medium"),h720fps30:new Re(1280,720,2e6,30,"medium"),h1080fps15:new Re(1920,1080,25e5,15,"medium"),h1080fps30:new Re(1920,1080,5e6,30,"medium"),original:new Re(0,0,7e6,30,"medium")};function J8(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const Y8=5e3,cc=[];var Nn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH"})(Nn||(Nn={}));class j extends xi.EventEmitter{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var r;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=j.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=ue,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),Y8):this.handleAppVisibilityChanged()},this.log=nr((r=i.loggerName)!==null&&r!==void 0?r:ti.Track),this.loggerContextCb=i.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=j.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ae(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===j.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===j.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(cc.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&cc.splice(cc.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Lo(this.mediaStreamTrack,e);const i=e.srcObject.getTracks(),r=i.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(r?G.AudioPlaybackStarted:G.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(r?G.AudioPlaybackFailed:G.VideoPlaybackFailed,s):s.name==="AbortError"?ue.debug("".concat(r?"audio":"video"," playback aborted, likely due to new play request")):ue.warn("could not playback ".concat(r?"audio":"video"),s),r&&e&&i.some(o=>o.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(G.ElementAttached,e),e}detach(e){try{if(e){Jo(this.mediaStreamTrack,e);const i=this.attachedElements.indexOf(e);return i>=0&&(this.attachedElements.splice(i,1),this.recycleElement(e),this.emit(G.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(i=>{Jo(this.mediaStreamTrack,i),n.push(i),this.recycleElement(i),this.emit(G.ElementDetached,i)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=nr(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),cc.forEach(i=>{i.parentElement||(n=!1)}),n&&cc.push(e)}}handleAppVisibilityChanged(){return M(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===j.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){sn()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){sn()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Lo(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let i;t.kind==="audio"?i=n.getAudioTracks():i=n.getVideoTracks(),i.includes(t)||(i.forEach(r=>{n.removeTrack(r)}),n.addTrack(t)),(!es()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(es()||ya())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function Jo(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(l){l.Audio="audio",l.Video="video",l.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(l){l.Camera="camera",l.Microphone="microphone",l.ScreenShare="screen_share",l.ScreenShareAudio="screen_share_audio",l.Unknown="unknown"})(n=t.Source||(t.Source={}));let i;(function(l){l.Active="active",l.Paused="paused",l.Unknown="unknown"})(i=t.StreamState||(t.StreamState={}));function r(l){switch(l){case e.Audio:return Wn.AUDIO;case e.Video:return Wn.VIDEO;default:return Wn.DATA}}t.kindToProto=r;function s(l){switch(l){case Wn.AUDIO:return e.Audio;case Wn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=s;function o(l){switch(l){case n.Camera:return Mt.CAMERA;case n.Microphone:return Mt.MICROPHONE;case n.ScreenShare:return Mt.SCREEN_SHARE;case n.ScreenShareAudio:return Mt.SCREEN_SHARE_AUDIO;default:return Mt.UNKNOWN}}t.sourceToProto=o;function a(l){switch(l){case Mt.CAMERA:return n.Camera;case Mt.MICROPHONE:return n.Microphone;case Mt.SCREEN_SHARE:return n.ScreenShare;case Mt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function c(l){switch(l){case xv.ACTIVE:return i.Active;case xv.PAUSED:return i.Paused;default:return i.Unknown}}t.streamStateFromProto=c})(j);function wA(t,e,n){var i,r,s,o,a;const{optionsWithoutProcessor:c,audioProcessor:l,videoProcessor:u}=db(t??{}),h=(i=J8(c))!==null&&i!==void 0?i:{};return h.audio===!0&&(h.audio={}),h.video===!0&&(h.video={}),h.audio&&(qv(h.audio,e),(r=(o=h.audio).deviceId)!==null&&r!==void 0||(o.deviceId="default"),l&&(h.audio.processor=l)),h.video&&(qv(h.video,n),(s=(a=h.video).deviceId)!==null&&s!==void 0||(a.deviceId="default"),u&&(h.video.processor=u)),h}function qv(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function qf(t){var e,n,i,r;const s={};if(t.video)if(typeof t.video=="object"){const o={},a=o,c=t.video;Object.keys(c).forEach(l=>{switch(l){case"resolution":qv(a,c.resolution);break;default:a[l]=c[l]}}),s.video=o,(e=(i=s.video).deviceId)!==null&&e!==void 0||(i.deviceId="default")}else s.video=t.video?{deviceId:"default"}:!1;else s.video=!1;return t.audio?typeof t.audio=="object"?(s.audio=t.audio,(n=(r=s.audio).deviceId)!==null&&n!==void 0||(r.deviceId="default")):s.audio={deviceId:"default"}:s.audio=!1,s}function X8(t){return M(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const i=_A();if(i){const r=i.createAnalyser();r.fftSize=2048;const s=r.frequencyBinCount,o=new Uint8Array(s);i.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(r),yield Xn(n),r.getByteTimeDomainData(o);const c=o.some(l=>l!==128&&l!==0);return i.close(),!c}return!1}()})}function _A(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function vS(t){return t===j.Source.Microphone?"audioinput":t===j.Source.Camera?"videoinput":void 0}function Z8(t){var e,n;let i=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(i=typeof i=="boolean"?{}:i,es()?i=Object.assign(Object.assign({},i),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):i=Object.assign(Object.assign({},i),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:i,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio,preferCurrentTab:t.preferCurrentTab}}function Od(t){return t.split("/")[1].toLowerCase()}function ez(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new sb({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Ae(t){return t instanceof j?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?Ae(t.track):{})}}function tz(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function nz(t,e){var n;t===void 0&&(t={}),e===void 0&&(e={});const i=[...Object.keys(e),...Object.keys(t)],r={};for(const s of i)t[s]!==e[s]&&(r[s]=(n=e[s])!==null&&n!==void 0?n:"");return r}function db(t){const e=Object.assign({},t);let n,i;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(i=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:i,optionsWithoutProcessor:e}}const iz="|",yS="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function rz(t){const e=t.split(iz);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function Xn(t){return M(this,void 0,void 0,function*(){return new Promise(e=>Et.setTimeout(e,t))})}function Hv(){return"addTransceiver"in RTCPeerConnection.prototype}function Wv(){return"addTrack"in RTCPeerConnection.prototype}function sz(){if(!("getCapabilities"in RTCRtpSender)||es())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function oz(){if(!("getCapabilities"in RTCRtpSender)||ya())return!1;if(es()){const n=Ii();if(n!=null&&n.version&&Ys(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Fc(t){return t==="av1"||t==="vp9"}function Kv(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}function az(){return typeof RTCPeerConnection>"u"?!1:Hv()||Wv()}function ya(){var t;return((t=Ii())===null||t===void 0?void 0:t.name)==="Firefox"}function es(){var t;return((t=Ii())===null||t===void 0?void 0:t.name)==="Safari"}function cz(){const t=Ii();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function SA(){var t,e;return sn()?(e=(t=navigator.userAgentData)===null||t===void 0?void 0:t.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function lz(){const t=Ii(),e="17.2";if(t)return t.name!=="Safari"&&t.os!=="iOS"||t.os==="iOS"&&t.osVersion&&Ys(e,t.osVersion)>=0?!0:t.name==="Safari"&&Ys(e,t.version)>=0}function sn(){return typeof document<"u"}function ir(){return navigator.product=="ReactNative"}function Gv(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function EA(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function CA(){if(!ir())return;let t=EA();if(t)return t.platform}function bS(){if(sn())return window.devicePixelRatio;if(ir()){let t=EA();if(t)return t.devicePixelRatio}return 1}function Ys(t,e){const n=t.split("."),i=e.split("."),r=Math.min(n.length,i.length);for(let s=0;s<r;++s){const o=parseInt(n[s],10),a=parseInt(i[s],10);if(o>a)return 1;if(o<a)return-1;if(s===r-1&&o===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==i.length?0:n.length<i.length?-1:1}function uz(t){for(const e of t)e.target.handleResize(e)}function dz(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Pm=null;const TS=()=>(Pm||(Pm=new ResizeObserver(uz)),Pm);let Rm=null;const kS=()=>(Rm||(Rm=new IntersectionObserver(dz,{root:null,rootMargin:"0px"})),Rm);function hz(){var t;const e=new W7({sdk:xx.JS,protocol:W8,version:H8});return ir()&&(e.os=(t=CA())!==null&&t!==void 0?t:""),e}function wS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=document.createElement("canvas");r.width=t,r.height=e;const s=r.getContext("2d");s==null||s.fillRect(0,0,r.width,r.height),i&&s&&(s.beginPath(),s.arc(t/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const o=r.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let lc;function xm(){if(!lc){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const i=t.createMediaStreamDestination();if(e.connect(n),n.connect(i),e.start(),[lc]=i.stream.getAudioTracks(),!lc)throw Error("Could not get empty media stream audio track");lc.enabled=!1}return lc.clone()}class IA{constructor(e,n){this.onFinally=n,this.promise=new Promise((i,r)=>M(this,void 0,void 0,function*(){this.resolve=i,this.reject=r,e&&(yield e(i,r))})).finally(()=>{var i;return(i=this.onFinally)===null||i===void 0?void 0:i.call(this)})}}function fz(t){return G8.includes(t)}function Us(t){if(typeof t=="string"||typeof t=="number")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function pz(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function _S(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}function mz(t,e){return t.segments.map(n=>{let{id:i,text:r,language:s,startTime:o,endTime:a,final:c}=n;var l;const u=(l=e.get(i))!==null&&l!==void 0?l:Date.now(),h=Date.now();return c?e.delete(i):e.set(i,u),{id:i,text:r,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(a.toString()),final:c,language:s,firstReceivedTime:u,lastReceivedTime:h}})}function gz(t){const{id:e,timestamp:n,message:i,editTimestamp:r}=t;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:r?Number.parseInt(r.toString()):void 0,message:i}}function SS(t){switch(t.reason){case ke.LeaveRequest:return t.context;case ke.Cancelled:return Gn.CLIENT_INITIATED;case ke.NotAllowed:return Gn.USER_REJECTED;case ke.ServerUnreachable:return Gn.JOIN_FAILURE;default:return Gn.UNKNOWN_REASON}}const Am="default";class yt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new yt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return M(this,arguments,void 0,function(n){var i=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;if(((s=yt.userMediaPromiseMap)===null||s===void 0?void 0:s.size)>0){ue.debug("awaiting getUserMedia promise");try{n?yield yt.userMediaPromiseMap.get(n):yield Promise.all(yt.userMediaPromiseMap.values())}catch{ue.warn("error waiting for media permissons")}}let o=yield navigator.mediaDevices.enumerateDevices();if(r&&!(es()&&i.hasDeviceInUse(n))&&(o.filter(c=>c.kind===n).length===0||o.some(c=>{const l=c.label==="",u=n?c.kind===n:!0;return l&&u}))){const c={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:"default"}},l=yield navigator.mediaDevices.getUserMedia(c);o=yield navigator.mediaDevices.enumerateDevices(),l.getTracks().forEach(u=>{u.stop()})}return i._previousDevices=o,n&&(o=o.filter(a=>a.kind===n)),o}()})}normalizeDeviceId(e,n,i){return M(this,void 0,void 0,function*(){if(n!==Am)return n;const r=yield this.getDevices(e),s=r.find(a=>a.deviceId===Am);if(!s){ue.warn("could not reliably determine default device");return}const o=r.find(a=>a.deviceId!==Am&&a.groupId===(i??s.groupId));if(!o){ue.warn("could not reliably determine default device");return}return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?yt.userMediaPromiseMap.has(e):yt.userMediaPromiseMap.size>0}}yt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];yt.userMediaPromiseMap=new Map;const vz=1e3;class Fs extends j{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}constructor(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(e,n,s),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=lb(()=>M(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>M(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(G.Ended,this)},this.reacquireTrack=!1,this.providedByUser=r,this.muteLock=new rn,this.pauseUpstreamLock=new rn,this.processorLock=new rn,this.restartLock=new rn,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),i&&(this._constraints=i)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==j.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return M(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(r=>{Jo(this._mediaStreamTrack,r)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let i;if(this.processor&&e){const r=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Lo(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}finally{r()}}this.sender&&(yield this.sender.replaceTrack(i??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(r=>{Lo(i??e,r)}))})}waitForDimensions(){return M(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vz;return function*(){var i;if(e.kind===j.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((i=Ii())===null||i===void 0?void 0:i.os)==="iOS"&&(yield Xn(10));const r=Date.now();for(;Date.now()-r<n;){const s=e.dimensions;if(s)return s;yield Xn(50)}throw new ji("unable to get track dimensions after timeout")}()})}setDeviceId(e){return M(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Us(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Us(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return M(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===j.Source.ScreenShare)return;const{deviceId:i,groupId:r}=e._mediaStreamTrack.getSettings(),s=e.kind===j.Kind.Audio?"audioinput":"videoinput";return n?yt.getInstance().normalizeDeviceId(s,i,r):i}()})}mute(){return M(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return M(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return M(this,void 0,void 0,function*(){if(!this.sender)throw new ji("unable to replace an unpublished track");let i,r;return typeof n=="boolean"?i=n:n!==void 0&&(i=n.userProvidedTrack,r=n.stopProcessor),this.providedByUser=i??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),r&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return M(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.restartLock.lock();try{e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const i={audio:!1,video:!1};this.kind===j.Kind.Video?i.video=e:i.audio=e,this.attachedElements.forEach(o=>{Jo(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const s=(yield navigator.mediaDevices.getUserMedia(i)).getTracks()[0];return s.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(s),this._constraints=e,this.emit(G.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?G.Muted:G.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return M(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),SA()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return M(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(G.UpstreamPaused,this);const n=Ii();if((n==null?void 0:n.name)==="Safari"&&Ys(n.version,"12.0")<0)throw new cb("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return M(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(G.UpstreamResumed,this),yield this.sender.replaceTrack(this.mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){return M(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return M(this,arguments,void 0,function(n){var i=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;const o=yield i.processorLock.lock();try{i.log.debug("setting up processor",i.logContext);const a=document.createElement(i.kind),c={kind:i.kind,track:i._mediaStreamTrack,element:a,audioContext:i.audioContext};if(yield n.init(c),i.log.debug("processor initialized",i.logContext),i.processor&&(yield i.stopProcessor()),i.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Lo(i._mediaStreamTrack,a),a.muted=!0,a.play().catch(l=>i.log.error("failed to play processor element",Object.assign(Object.assign({},i.logContext),{error:l}))),i.processor=n,i.processorElement=a,i.processor.processedTrack){for(const l of i.attachedElements)l!==i.processorElement&&r&&(Jo(i._mediaStreamTrack,l),Lo(i.processor.processedTrack,l));yield(s=i.sender)===null||s===void 0?void 0:s.replaceTrack(i.processor.processedTrack)}i.emit(G.TrackProcessorUpdate,i.processor)}finally{o()}}()})}getProcessor(){return this.processor}stopProcessor(){return M(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var i,r;e.processor&&(e.log.debug("stopping processor",e.logContext),(i=e.processor.processedTrack)===null||i===void 0||i.stop(),yield e.processor.destroy(),e.processor=void 0,n||((r=e.processorElement)===null||r===void 0||r.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(G.TrackProcessorUpdate))}()})}}class yz extends xi.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var i,r;const{kind:s,data:o}=n.data;switch(s){case"error":ue.error(o.error.message),this.emit(Nr.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)}),this.encryptionEnabled!==o.enabled&&o.participantIdentity===((i=this.room)===null||i===void 0?void 0:i.localParticipant.identity))this.emit(Nr.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const a=(r=this.room)===null||r===void 0?void 0:r.getParticipantByIdentity(o.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(Nr.ParticipantEncryptionStatusChanged,o.enabled,a)}break;case"ratchetKey":this.keyProvider.emit(qr.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{ue.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Nr.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!V8())throw new cb("tried to setup end-to-end encryption on an unsupported browser");if(ue.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:S8.getLevel()}};this.worker&&(ue.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){ue.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?ue.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(Y.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(F.TrackPublished,(i,r)=>this.setParticipantCryptorEnabled(i.trackInfo.encryption!==yn.NONE,r.identity)),e.on(F.ConnectionStateChanged,i=>{i===pe.Connected&&e.remoteParticipants.forEach(r=>{r.trackPublications.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==yn.NONE,r.identity)})})}).on(F.TrackUnsubscribed,(i,r,s)=>{var o;const a={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:i.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(a)}).on(F.TrackSubscribed,(i,r,s)=>{this.setupE2EEReceiver(i,s.identity,r.trackInfo)}).on(F.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(i=>{this.postKey(i)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(V.LocalTrackPublished,i=>M(this,void 0,void 0,function*(){this.setupE2EESender(i.track,i.track.sender)})),n.on(qr.SetKey,i=>this.postKey(i)).on(qr.RatchetRequest,(i,r)=>this.postRatchetRequest(i,r))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const i={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(i)}postKey(e){let{key:n,participantIdentity:i,keyIndex:r}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:i,isPublisher:i===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:n,keyIndex:r}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const i={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(i)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const i={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,i){if(e.receiver){if(!(i!=null&&i.mimeType)||i.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?Od(i.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Fs)||!n){n||ue.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,i,r){return M(this,void 0,void 0,function*(){if(this.worker){if(jv()){const s={kind:"decode",participantIdentity:i,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(qu in e&&r){const c={kind:"updateCodec",data:{trackId:n,codec:r,participantIdentity:i}};this.worker.postMessage(c);return}let s=e.writableStream,o=e.readableStream;if(!s||!o){const c=e.createEncodedStreams();e.writableStream=c.writable,s=c.writable,e.readableStream=c.readable,o=c.readable}const a={kind:"decode",data:{readableStream:o,writableStream:s,trackId:n,codec:r,participantIdentity:i}};this.worker.postMessage(a,[o,s])}e[qu]=!0}})}handleSender(e,n,i){var r;if(!(qu in e||!this.worker)){if(!(!((r=this.room)===null||r===void 0)&&r.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(jv()){ue.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{ue.info("initialize encoded streams");const s=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:i,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[s.readable,s.writable])}e[qu]=!0}}}var Vc;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Vc||(Vc={}));class bz{constructor(){this.pendingTasks=new Map,this.taskMutex=new rn,this.nextTaskIndex=0}run(e){return M(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Vc.WAITING};this.pendingTasks.set(n.id,n);const i=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Vc.RUNNING,yield e()}finally{n.status=Vc.COMPLETED,this.pendingTasks.delete(n.id),i()}})}flush(){return M(this,void 0,void 0,function*(){return this.run(()=>M(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const Tz=["syncState","trickle","offer","answer","simulate","leave"];function kz(t){const e=Tz.indexOf(t.case)>=0;return ue.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Be;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Be||(Be={}));class hb{get currentState(){return this.state}get isDisconnected(){return this.state===Be.DISCONNECTING||this.state===Be.DISCONNECTED}get isEstablishingConnection(){return this.state===Be.CONNECTING||this.state===Be.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;this.rtt=0,this.state=Be.DISCONNECTED,this.log=ue,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=nr((i=n.loggerName)!==null&&i!==void 0?i:ti.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new bz,this.queuedRequests=[],this.closingLock=new rn,this.connectionLock=new rn,this.state=Be.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,i,r){return M(this,void 0,void 0,function*(){return this.state=Be.CONNECTING,this.options=i,yield this.connect(e,n,i,r)})}reconnect(e,n,i,r){return M(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Be.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:i,reconnectReason:r}))})}connect(e,n,i,r){this.connectOptions=i,e=pz(e),e=e.replace(/\/$/,""),e+="/rtc";const s=hz(),o=wz(n,s,i);return new Promise((a,c)=>M(this,void 0,void 0,function*(){const l=yield this.connectionLock.lock();try{const u=()=>M(this,void 0,void 0,function*(){this.close(),clearTimeout(h),c(new Ne("room connection has been cancelled (signal)",ke.Cancelled))}),h=setTimeout(()=>{this.close(),c(new Ne("room connection has timed out (signal)",ke.ServerUnreachable))},i.websocketTimeout);r!=null&&r.aborted&&u(),r==null||r.addEventListener("abort",u),this.log.debug("connecting to ".concat(e+o),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(h)},this.ws.onerror=f=>M(this,void 0,void 0,function*(){if(this.state!==Be.CONNECTED){this.state=Be.DISCONNECTED,clearTimeout(h);try{const g=yield fetch("http".concat(e.substring(2),"/validate").concat(o));if(g.status.toFixed(0).startsWith("4")){const b=yield g.text();c(new Ne(b,ke.NotAllowed,g.status))}else c(new Ne("Internal error",ke.InternalError,g.status))}catch{c(new Ne("server was not reachable",ke.ServerUnreachable))}return}this.handleWSError(f)}),this.ws.onmessage=f=>M(this,void 0,void 0,function*(){var g,b,y;let T;if(typeof f.data=="string"){const v=JSON.parse(f.data);T=nS.fromJson(v,{ignoreUnknownFields:!0})}else if(f.data instanceof ArrayBuffer)T=nS.fromBinary(new Uint8Array(f.data));else{this.log.error("could not decode websocket message: ".concat(typeof f.data),this.logContext);return}if(this.state!==Be.CONNECTED){let v=!1;if(((g=T.message)===null||g===void 0?void 0:g.case)==="join"?(this.state=Be.CONNECTED,r==null||r.removeEventListener("abort",u),this.pingTimeoutDuration=T.message.value.pingTimeout,this.pingIntervalDuration=T.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(T.message.value)):this.state===Be.RECONNECTING&&T.message.case!=="leave"?(this.state=Be.CONNECTED,r==null||r.removeEventListener("abort",u),this.startPingInterval(),((b=T.message)===null||b===void 0?void 0:b.case)==="reconnect"?a(T.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),a(void 0),v=!0)):this.isEstablishingConnection&&T.message.case==="leave"?c(new Ne("Received leave request while trying to (re)connect",ke.LeaveRequest,void 0,T.message.value.reason)):i.reconnect||c(new Ne("did not receive join response, got ".concat((y=T.message)===null||y===void 0?void 0:y.case," instead"),ke.InternalError)),!v)return}this.signalLatency&&(yield Xn(this.signalLatency)),this.handleSignalResponse(T)}),this.ws.onclose=f=>{this.isEstablishingConnection&&c(new Ne("Websocket got closed during a (re)connection attempt",ke.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:f.reason,code:f.code,wasClean:f.wasClean,state:this.state})),this.handleOnClose(f.reason)}}finally{l()}}))}close(){return M(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const i=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=Be.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const r=new Promise(s=>{e.ws?e.ws.onclose=()=>{s()}:s()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([r,Xn(250)])),e.ws=void 0}}finally{n&&(e.state=Be.DISCONNECTED),i()}}()})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Ah(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Ah(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new ib({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new rb({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return M(this,arguments,void 0,function(i,r){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const a=s.getNextRequestId();return yield s.sendRequest({case:"updateMetadata",value:new Mx({requestId:a,metadata:i,name:r,attributes:o})}),a}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new Lx({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new Vx({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:qe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Bx({timestamp:qe.parse(Date.now()),rtt:qe.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new Dx({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new Bf({reason:Gn.CLIENT_INITIATED,action:Go.DISCONNECT})})}sendRequest(e){return M(this,arguments,void 0,function(n){var i=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!r&&!kz(n)&&i.state===Be.RECONNECTING){i.queuedRequests.push(()=>M(i,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(r||(yield i.requestQueue.flush()),i.signalLatency&&(yield Xn(i.signalLatency)),!i.ws||i.ws.readyState!==i.ws.OPEN){i.log.error("cannot send signal request before connected, type: ".concat(n==null?void 0:n.case),i.logContext);return}const o=new e8({message:n});try{i.useJSON?i.ws.send(o.toJsonString()):i.ws.send(o.toBinary())}catch(a){i.log.error("error sending signal message",Object.assign(Object.assign({},i.logContext),{error:a}))}}()})}handleSignalResponse(e){var n,i;const r=e.message;if(r==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(r.case==="answer"){const o=ES(r.value);this.onAnswer&&this.onAnswer(o)}else if(r.case==="offer"){const o=ES(r.value);this.onOffer&&this.onOffer(o)}else if(r.case==="trickle"){const o=JSON.parse(r.value.candidateInit);this.onTrickle&&this.onTrickle(o,r.value.target)}else r.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=r.value.participants)!==null&&n!==void 0?n:[]):r.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(r.value):r.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((i=r.value.speakers)!==null&&i!==void 0?i:[]):r.case==="leave"?this.onLeave&&this.onLeave(r.value):r.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(r.value.sid,r.value.muted):r.case==="roomUpdate"?this.onRoomUpdate&&r.value.room&&this.onRoomUpdate(r.value.room):r.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(r.value):r.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(r.value):r.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(r.value):r.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(r.value):r.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(r.value):r.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(r.value):r.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(r.value):r.case==="pong"||(r.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(r.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):r.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(r.value):r.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(r.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:r.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return M(this,void 0,void 0,function*(){if(this.state===Be.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Et.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Et.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Et.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Et.clearInterval(this.pingInterval)}}function ES(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Ah(t){return new Js({sdp:t.sdp,type:t.type})}function wz(t,e,n){var i;const r=new URLSearchParams;return r.set("access_token",t),n.reconnect&&(r.set("reconnect","1"),n.sid&&r.set("sid",n.sid)),r.set("auto_subscribe",n.autoSubscribe?"1":"0"),r.set("sdk",ir()?"reactnative":"js"),r.set("version",e.version),r.set("protocol",e.protocol.toString()),e.deviceModel&&r.set("device_model",e.deviceModel),e.os&&r.set("os",e.os),e.osVersion&&r.set("os_version",e.osVersion),e.browser&&r.set("browser",e.browser),e.browserVersion&&r.set("browser_version",e.browserVersion),n.adaptiveStream&&r.set("adaptive_stream","1"),n.reconnectReason&&r.set("reconnect_reason",n.reconnectReason.toString()),!((i=navigator.connection)===null||i===void 0)&&i.type&&r.set("network",navigator.connection.type),"?".concat(r.toString())}var jn={},Nm={},Om={exports:{}},CS;function fb(){if(CS)return Om.exports;CS=1;var t=Om.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(t).forEach(function(e){var n=t[e];n.forEach(function(i){i.reg||(i.reg=/(.*)/),i.format||(i.format="%s")})}),Om.exports}var IS;function _z(){return IS||(IS=1,function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,c,l,u){if(u&&!l)c[u]=e(a[1]);else for(var h=0;h<l.length;h+=1)a[h+1]!=null&&(c[l[h]]=e(a[h+1]))},i=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var h=a.push?{}:u?c[a.name]:c;n(l.match(a.reg),h,a.names,a.name),a.push&&c[a.push].push(h)},r=fb(),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(h){var f=h[0],g=h.slice(2);f==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var b=0;b<(r[f]||[]).length;b+=1){var y=r[f][b];if(y.reg.test(g))return i(y,u,g)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,h=!1;return l[0]!=="~"?u=e(l):(u=e(l.substring(1,l.length)),h=!0),{scid:u,paused:h}})})}}(Nm)),Nm}var Dm,PS;function Sz(){if(PS)return Dm;PS=1;var t=fb(),e=/%[sdv%]/g,n=function(o){var a=1,c=arguments,l=c.length;return o.replace(e,function(u){if(a>=l)return u;var h=c[a];switch(a+=1,u){case"%%":return"%";case"%s":return String(h);case"%d":return Number(h);case"%v":return""}})},i=function(o,a,c){var l=a.format instanceof Function?a.format(a.push?c:c[a.name]):a.format,u=[o+"="+l];if(a.names)for(var h=0;h<a.names.length;h+=1){var f=a.names[h];a.name?u.push(c[a.name][f]):u.push(c[a.names[h]])}else u.push(c[a.name]);return n.apply(null,u)},r=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];return Dm=function(o,a){a=a||{},o.version==null&&(o.version=0),o.name==null&&(o.name=" "),o.media.forEach(function(h){h.payloads==null&&(h.payloads="")});var c=a.outerOrder||r,l=a.innerOrder||s,u=[];return c.forEach(function(h){t[h].forEach(function(f){f.name in o&&o[f.name]!=null?u.push(i(h,f,o)):f.push in o&&o[f.push]!=null&&o[f.push].forEach(function(g){u.push(i(h,f,g))})})}),o.media.forEach(function(h){u.push(i("m",t.m[0],h)),l.forEach(function(f){t[f].forEach(function(g){g.name in h&&h[g.name]!=null?u.push(i(f,g,h)):g.push in h&&h[g.push]!=null&&h[g.push].forEach(function(b){u.push(i(f,g,b))})})})}),u.join(`\r
`)+`\r
`},Dm}var RS;function Ez(){if(RS)return jn;RS=1;var t=_z(),e=Sz(),n=fb();return jn.grammar=n,jn.write=e,jn.parse=t.parse,jn.parseParams=t.parseParams,jn.parseFmtpConfig=t.parseFmtpConfig,jn.parsePayloads=t.parsePayloads,jn.parseRemoteCandidates=t.parseRemoteCandidates,jn.parseImageAttributes=t.parseImageAttributes,jn.parseSimulcastStreamList=t.parseSimulcastStreamList,jn}var vr=Ez();const Cz=.7,Iz=20,Yo={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class xS extends xi.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;super(),this.log=ue,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=lb(r=>M(this,void 0,void 0,function*(){this.emit(Yo.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(r)r(s);else throw s}}),Iz),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=nr((i=n.loggerName)!==null&&i!==void 0?i:ti.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC()}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var i;n.candidate&&((i=this.onIceCandidate)===null||i===void 0||i.call(this,n.candidate))},e.onicecandidateerror=n=>{var i;(i=this.onIceCandidateError)===null||i===void 0||i.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var i;(i=this.onDataChannel)===null||i===void 0||i.call(this,n)},e.ontrack=n=>{var i;(i=this.onTrack)===null||i===void 0||i.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return M(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return M(this,void 0,void 0,function*(){var n;let i;if(e.type==="offer"){let{stereoMids:r,nackMids:s}=Pz(e);this.remoteStereoMids=r,this.remoteNackMids=s}else if(e.type==="answer"){const r=vr.parse((n=e.sdp)!==null&&n!==void 0?n:"");r.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||s.mid!=o.transceiver.mid)return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0)return!0;let c=!1;for(const l of s.fmtp)if(l.payload===a){l.config=l.config.split(";").filter(u=>!u.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(l.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),c=!0;break}return c||o.maxbr>0&&s.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),i=vr.write(r)}yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(r=>{this.pc.addIceCandidate(r)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Yo.NegotiationComplete),e.sdp&&vr.parse(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(Yo.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){return M(this,void 0,void 0,function*(){var n;if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const i=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:i.sdp},this.logContext));const r=vr.parse((n=i.sdp)!==null&&n!==void 0?n:"");r.media.forEach(s=>{NS(s),s.type==="audio"?AS(s,[],[]):s.type==="video"&&this.trackBitrates.some(o=>{if(!s.msid||!o.cid||!s.msid.includes(o.cid))return!1;let a=0;if(s.rtp.some(l=>l.codec.toUpperCase()===o.codec.toUpperCase()?(a=l.payload,!0):!1),a===0||(Fc(o.codec)&&this.ensureVideoDDExtensionForSVC(s,r),o.codec!=="av1"))return!0;const c=Math.round(o.maxbr*Cz);for(const l of s.fmtp)if(l.payload===a){l.config.includes("x-google-start-bitrate")||(l.config+=";x-google-start-bitrate=".concat(c));break}return!0})}),yield this.setMungedSDP(i,vr.write(r)),this.onOffer(i)})}createAndSetAnswer(){return M(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),i=vr.parse((e=n.sdp)!==null&&e!==void 0?e:"");return i.media.forEach(r=>{NS(r),r.type==="audio"&&AS(r,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,vr.write(i)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new dt("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new dt("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return M(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const i=new Map,r=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),i.set(a.id,a);break;case"remote-candidate":r.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const o=(e=i.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(o!==void 0)return r.get(o)})}setMungedSDP(e,n,i){return M(this,void 0,void 0,function*(){if(n){const r=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(i?"remote":"local"," description"),this.logContext),i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:n})),e.sdp=r}}try{i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(r){let s="unknown error";r instanceof Error?s=r.message:typeof r=="string"&&(s=r);const o={error:s,sdp:e.sdp};throw!i&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new $v(s)}})}ensureVideoDDExtensionForSVC(e,n){var i,r;if(!((i=e.ext)===null||i===void 0?void 0:i.some(o=>o.uri===yS))){if(this.ddExtID===0){let o=0;n.media.forEach(a=>{var c;a.type==="video"&&((c=a.ext)===null||c===void 0||c.forEach(l=>{l.value>o&&(o=l.value)}))}),this.ddExtID=o+1}(r=e.ext)===null||r===void 0||r.push({value:this.ddExtID,uri:yS})}}}function AS(t,e,n){let i=0;t.rtp.some(r=>r.codec==="opus"?(i=r.payload,!0):!1),i>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(r=>r.payload===i&&r.type==="nack")&&t.rtcpFb.push({payload:i,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(r=>r.payload===i?(r.config.includes("stereo=1")||(r.config+=";stereo=1"),!0):!1))}function Pz(t){var e;const n=[],i=[],r=vr.parse((e=t.sdp)!==null&&e!==void 0?e:"");let s=0;return r.media.forEach(o=>{var a;o.type==="audio"&&(o.rtp.some(c=>c.codec==="opus"?(s=c.payload,!0):!1),!((a=o.rtcpFb)===null||a===void 0)&&a.some(c=>c.payload===s&&c.type==="nack")&&i.push(o.mid),o.fmtp.some(c=>c.payload===s?(c.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:i}}function NS(t){if(t.connection){const e=t.connection.ip.indexOf(":")>=0;(t.connection.version===4&&e||t.connection.version===6&&!e)&&(t.connection.ip="0.0.0.0",t.connection.version=4)}}const Qv="vp8",Rz={audioPreset:Bv.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:ub.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Qv,backupCodec:!0},PA={deviceId:"default",autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},RA={deviceId:"default",resolution:kl.h720.resolution},xz={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new C8,disconnectOnPageLeave:!0,webAudioMix:!1},pb={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Xe;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(Xe||(Xe={}));class Az{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,i){var r;this.peerConnectionTimeout=pb.peerConnectionTimeout,this.log=ue,this.updateState=()=>{var s;const o=this.state,a=this.requiredTransports.map(c=>c.getConnectionState());a.every(c=>c==="connected")?this.state=Xe.CONNECTED:a.some(c=>c==="failed")?this.state=Xe.FAILED:a.some(c=>c==="connecting")?this.state=Xe.CONNECTING:a.every(c=>c==="closed")?this.state=Xe.CLOSED:a.some(c=>c==="closed")?this.state=Xe.CLOSING:a.every(c=>c==="new")&&(this.state=Xe.NEW),o!==this.state&&(this.log.debug("pc state change: from ".concat(Xe[o]," to ").concat(Xe[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=nr((r=i.loggerName)!==null&&r!==void 0?r:ti.PCManager),this.loggerOptions=i,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n,this.publisher=new xS(e,i),this.subscriber=new xS(e,i),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,s,Kn.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,s,Kn.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var o;(o=this.onDataChannel)===null||o===void 0||o.call(this,s)},this.subscriber.onTrack=s=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,s)},this.publisher.onOffer=s=>{var o;(o=this.onPublisherOffer)===null||o===void 0||o.call(this,s)},this.state=Xe.NEW,this.connectionLock=new rn,this.remoteOfferLock=new rn}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return M(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(i){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:i}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return M(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return M(this,void 0,void 0,function*(){n===Kn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return M(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const n=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()}finally{n()}})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return M(this,void 0,void 0,function*(){var i;const r=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((i=this.requiredTransports)===null||i===void 0?void 0:i.map(s=>this.ensureTransportConnected(s,e,n)))}finally{r()}})}negotiate(e){return M(this,void 0,void 0,function*(){return new Promise((n,i)=>M(this,void 0,void 0,function*(){const r=setTimeout(()=>{i("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(r),i("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(Yo.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Yo.NegotiationComplete,()=>{clearTimeout(r),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(r),i(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===Kn.PUBLISHER?this.publisher.getConnectedAddress():e===Kn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return M(this,arguments,void 0,function(i,r){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(i.getConnectionState()!=="connected")return new Promise((c,l)=>M(s,void 0,void 0,function*(){const u=()=>{this.log.warn("abort transport connection",this.logContext),Et.clearTimeout(h),l(new Ne("room connection has been cancelled",ke.Cancelled))};r!=null&&r.signal.aborted&&u(),r==null||r.signal.addEventListener("abort",u);const h=Et.setTimeout(()=>{r==null||r.signal.removeEventListener("abort",u),l(new Ne("could not establish pc connection",ke.InternalError))},o);for(;this.state!==Xe.CONNECTED;)if(yield Xn(50),r!=null&&r.signal.aborted){l(new Ne("room connection has been cancelled",ke.Cancelled));return}Et.clearTimeout(h),r==null||r.signal.removeEventListener("abort",u),c()}))}()})}}const mb=2e3;function Hf(t,e){if(!e)return 0;let n,i;return"bytesReceived"in t?(n=t.bytesReceived,i=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,i=e.bytesSent),n===void 0||i===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-i)*8*1e3/(t.timestamp-e.timestamp)}class _t extends Fs{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,j.Kind.Audio,n,i,s),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>M(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}o&&this.prevStats&&(this._currentBitrate=Hf(o,this.prevStats)),this.prevStats=o}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(G.AudioTrackFeatureUpdate,this,mi.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(G.AudioTrackFeatureUpdate,this,mi.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=r,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return M(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===j.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return M(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const i=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Us(this._constraints.deviceId);return this.source===j.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||i)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return M(this,void 0,void 0,function*(){let n;if(e){const i=qf({audio:e});typeof i.audio!="boolean"&&(n=i.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return M(this,void 0,void 0,function*(){const i=yield n.restart.call(this,e);return this.checkForSilence(),i})}startMonitor(){sn()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},mb)))}setProcessor(e){return M(this,void 0,void 0,function*(){var n;const i=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const r={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(r),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(G.TrackProcessorUpdate,this.processor)}finally{i()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return M(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let i;return n.forEach(r=>{r.type==="outbound-rtp"&&(i={type:"audio",streamId:r.id,packetsSent:r.packetsSent,packetsLost:r.packetsLost,bytesSent:r.bytesSent,timestamp:r.timestamp,roundTripTime:r.roundTripTime,jitter:r.jitter})}),i})}checkForSilence(){return M(this,void 0,void 0,function*(){const e=yield X8(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(G.AudioSilenceDetected)),e})}}function xA(t,e,n){switch(t.kind){case"audio":return new _t(t,e,!1,void 0,n);case"video":return new Lt(t,e,!1,n);default:throw new ji("unsupported track type: ".concat(t.kind))}}const Nz=Object.values(kl),Oz=Object.values(zv),Dz=Object.values(ub),Lz=[kl.h180,kl.h360],Mz=[zv.h180,zv.h360],Uz=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var i,r;return new Re(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((i=t.encoding.maxFramerate)!==null&&i!==void 0?i:30)/((r=n.fps)!==null&&r!==void 0?r:30))))),n.fps,t.encoding.priority)}),Jv=["q","h","f"];function Yv(t,e,n,i){var r,s;let o=i==null?void 0:i.videoEncoding;t&&(o=i==null?void 0:i.screenShareEncoding);const a=i==null?void 0:i.simulcast,c=i==null?void 0:i.scalabilityMode,l=i==null?void 0:i.videoCodec;if(!o&&!a&&!c||!e||!n)return[{}];o||(o=Vz(t,e,n,l),ue.debug("using video encoding",o));const u=o.maxFramerate,h=new Re(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&Fc(l)){const b=new AA(c),y=[];if(b.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const T=Ii();if(es()||ir()||(T==null?void 0:T.name)==="Chrome"&&Ys(T==null?void 0:T.version,"113")<0){const v=b.suffix=="h"?2:3;for(let w=0;w<b.spatial;w+=1)y.push({rid:Jv[2-w],maxBitrate:o.maxBitrate/Math.pow(v,w),maxFramerate:h.encoding.maxFramerate});y[0].scalabilityMode=c}else y.push({maxBitrate:o.maxBitrate,maxFramerate:h.encoding.maxFramerate,scalabilityMode:c});return h.encoding.priority&&(y[0].priority=h.encoding.priority,y[0].networkPriority=h.encoding.priority),ue.debug("using svc encoding",{encodings:y}),y}if(!a)return[o];let f=[];t?f=(r=DS(i==null?void 0:i.screenShareSimulcastLayers))!==null&&r!==void 0?r:OS(t,h):f=(s=DS(i==null?void 0:i.videoSimulcastLayers))!==null&&s!==void 0?s:OS(t,h);let g;if(f.length>0){const b=f[0];f.length>1&&([,g]=f);const y=Math.max(e,n);if(y>=960&&g)return Lm(e,n,[b,g,h],u);if(y>=480)return Lm(e,n,[b,h],u)}return Lm(e,n,[h])}function Fz(t,e,n){var i,r,s,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&ue.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),c=(i=a.width)!==null&&i!==void 0?i:(r=t.dimensions)===null||r===void 0?void 0:r.width,l=(s=a.height)!==null&&s!==void 0?s:(o=t.dimensions)===null||o===void 0?void 0:o.height;return Yv(t.source===j.Source.ScreenShare,c,l,n)}function Vz(t,e,n,i){const r=jz(t,e,n);let{encoding:s}=r[0];const o=Math.max(e,n);for(let a=0;a<r.length;a+=1){const c=r[a];if(s=c.encoding,c.width>=o)break}if(i)switch(i){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function jz(t,e,n){if(t)return Dz;const i=e>n?e/n:n/e;return Math.abs(i-16/9)<Math.abs(i-4/3)?Nz:Oz}function OS(t,e){if(t)return Uz(e);const{width:n,height:i}=e,r=n>i?n/i:i/n;return Math.abs(r-16/9)<Math.abs(r-4/3)?Lz:Mz}function Lm(t,e,n,i){const r=[];if(n.forEach((s,o)=>{if(o>=Jv.length)return;const a=Math.min(t,e),l={rid:Jv[o],scaleResolutionDownBy:Math.max(1,a/Math.min(s.width,s.height)),maxBitrate:s.encoding.maxBitrate},u=i&&s.encoding.maxFramerate?Math.min(i,s.encoding.maxFramerate):s.encoding.maxFramerate;u&&(l.maxFramerate=u);const h=ya()||o===0;s.encoding.priority&&h&&(l.priority=s.encoding.priority,l.networkPriority=s.encoding.priority),r.push(l)}),ir()&&CA()==="ios"){let s;r.forEach(a=>{s?a.maxFramerate&&a.maxFramerate>s&&(s=a.maxFramerate):s=a.maxFramerate});let o=!0;r.forEach(a=>{var c;a.maxFramerate!=s&&(o&&(o=!1,ue.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),ue.info('Setting framerate of encoding "'.concat((c=a.rid)!==null&&c!==void 0?c:"",'" to ').concat(s)),a.maxFramerate=s)})}return r}function DS(t){if(t)return t.sort((e,n)=>{const{encoding:i}=e,{encoding:r}=n;return i.maxBitrate>r.maxBitrate?1:i.maxBitrate<r.maxBitrate?-1:i.maxBitrate===r.maxBitrate&&i.maxFramerate&&r.maxFramerate?i.maxFramerate>r.maxFramerate?1:-1:0})}class AA{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function $z(t){return t.source===j.Source.ScreenShare||t.constraints.height&&Us(t.constraints.height)>=1080?"maintain-resolution":"balanced"}const Bz=5e3;class Lt extends Fs{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=arguments.length>3?arguments[3]:void 0;super(e,j.Kind.Video,n,i,r),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>M(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const o=new Map(s.map(a=>[a.rid,a]));if(this.prevStats){let a=0;o.forEach((c,l)=>{var u;const h=(u=this.prevStats)===null||u===void 0?void 0:u.get(l);a+=Hf(c,h)}),this._currentBitrate=a}this.prevStats=o}),this.senderLock=new rn}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!sn())return;const i=(n=this.sender)===null||n===void 0?void 0:n.getParameters();i&&(this.encodings=i.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},mb))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return M(this,void 0,void 0,function*(){var n,i,r,s,o;yield e.pauseUpstream.call(this);try{for(var a=!0,c=To(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0)s=l.value,a=!1,yield(o=s.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(u){i={error:u}}finally{try{!a&&!n&&(r=c.return)&&(yield r.call(c))}finally{if(i)throw i.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return M(this,void 0,void 0,function*(){var n,i,r,s,o;yield e.resumeUpstream.call(this);try{for(var a=!0,c=To(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;yield(o=u.sender)===null||o===void 0?void 0:o.replaceTrack(u.mediaStreamTrack)}}catch(u){i={error:u}}finally{try{!a&&!n&&(r=c.return)&&(yield r.call(c))}finally{if(i)throw i.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return M(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===j.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return M(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===j.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return M(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],i=yield this.sender.getStats();return i.forEach(r=>{var s;if(r.type==="outbound-rtp"){const o={type:"video",streamId:r.id,frameHeight:r.frameHeight,frameWidth:r.frameWidth,framesPerSecond:r.framesPerSecond,framesSent:r.framesSent,firCount:r.firCount,pliCount:r.pliCount,nackCount:r.nackCount,packetsSent:r.packetsSent,bytesSent:r.bytesSent,qualityLimitationReason:r.qualityLimitationReason,qualityLimitationDurations:r.qualityLimitationDurations,qualityLimitationResolutionChanges:r.qualityLimitationResolutionChanges,rid:(s=r.rid)!==null&&s!==void 0?s:r.id,retransmittedPacketsSent:r.retransmittedPacketsSent,targetBitrate:r.targetBitrate,timestamp:r.timestamp},a=i.get(r.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),n.push(o)}}),n.sort((r,s)=>{var o,a;return((o=s.frameWidth)!==null&&o!==void 0?o:0)-((a=r.frameWidth)!==null&&a!==void 0?a:0)}),n})}setPublishingQuality(e){const n=[];for(let i=Nn.LOW;i<=Nn.HIGH;i+=1)n.push(new ob({quality:i,enabled:i<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}restartTrack(e){return M(this,void 0,void 0,function*(){var n,i,r,s;let o;if(e){const u=qf({video:e});typeof u.video!="boolean"&&(o=u.video)}yield this.restart(o);try{for(var a=!0,c=To(this.simulcastCodecs.values()),l;l=yield c.next(),n=l.done,!n;a=!0){s=l.value,a=!1;const u=s;u.sender&&(u.mediaStreamTrack=this.mediaStreamTrack.clone(),yield u.sender.replaceTrack(u.mediaStreamTrack))}}catch(u){i={error:u}}finally{try{!a&&!n&&(r=c.return)&&(yield r.call(c))}finally{if(i)throw i.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return M(this,arguments,void 0,function(i){var r=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o,a,c,l,u,h;if(yield n.setProcessor.call(r,i,s),!((u=r.processor)===null||u===void 0)&&u.processedTrack)try{for(var f=!0,g=To(r.simulcastCodecs.values()),b;b=yield g.next(),o=b.done,!o;f=!0)l=b.value,f=!1,yield(h=l.sender)===null||h===void 0?void 0:h.replaceTrack(r.processor.processedTrack)}catch(y){a={error:y}}finally{try{!f&&!o&&(c=g.return)&&(yield c.call(g))}finally{if(a)throw a.error}}}()})}setDegradationPreference(e){return M(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const i={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,i),i}setSimulcastTrackSender(e,n){const i=this.simulcastCodecs.get(e);i&&(i.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Bz))}setPublishingCodecs(e){return M(this,void 0,void 0,function*(){var n,i,r,s,o,a,c;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const l=[];try{for(n=!0,i=To(e);r=yield i.next(),s=r.done,!s;n=!0){c=r.value,n=!1;const u=c;if(!this.codec||this.codec===u.codec)yield this.setPublishingLayers(u.qualities);else{const h=this.simulcastCodecs.get(u.codec);if(this.log.debug("try setPublishingCodec for ".concat(u.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:h})),!h||!h.sender){for(const f of u.qualities)if(f.enabled){l.push(u.codec);break}}else h.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(u.codec),this.logContext),yield LS(h.sender,h.encodings,u.qualities,this.senderLock,this.log,this.logContext))}}}catch(u){o={error:u}}finally{try{!n&&!s&&(a=i.return)&&(yield a.call(i))}finally{if(o)throw o.error}}return l})}setPublishingLayers(e){return M(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield LS(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return M(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),SA()&&this.isInBackground&&this.source===j.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function LS(t,e,n,i,r,s){return M(this,void 0,void 0,function*(){const o=yield i.lock();r.debug("setPublishingLayersForSender",Object.assign(Object.assign({},s),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:c}=a;if(!c)return;if(c.length!==e.length){r.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},s),{encodings:c,senderEncodings:e}));return}let l=!1;!1&&c[0].scalabilityMode||c.forEach((h,f)=>{var g;let b=(g=h.rid)!==null&&g!==void 0?g:"";b===""&&(b="q");const y=NA(b),T=n.find(v=>v.quality===y);T&&h.active!==T.enabled&&(l=!0,h.active=T.enabled,r.debug("setting layer ".concat(T.quality," to ").concat(h.active?"enabled":"disabled"),s),ya()&&(T.enabled?(h.scaleResolutionDownBy=e[f].scaleResolutionDownBy,h.maxBitrate=e[f].maxBitrate,h.maxFrameRate=e[f].maxFrameRate):(h.scaleResolutionDownBy=4,h.maxBitrate=10,h.maxFrameRate=2)))}),l&&(a.encodings=c,r.debug("setting encodings",Object.assign(Object.assign({},s),{encodings:a.encodings})),yield t.setParameters(a))}finally{o()}})}function NA(t){switch(t){case"f":return Nn.HIGH;case"h":return Nn.MEDIUM;case"q":return Nn.LOW;default:return Nn.HIGH}}function MS(t,e,n,i){if(!n)return[new Ms({quality:Nn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(i){const r=n[0].scalabilityMode,s=new AA(r),o=[],a=s.suffix=="h"?1.5:2,c=s.suffix=="h"?2:3;for(let l=0;l<s.spatial;l+=1)o.push(new Ms({quality:Math.min(Nn.HIGH,s.spatial-1)-l,width:Math.ceil(t/Math.pow(a,l)),height:Math.ceil(e/Math.pow(a,l)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(c,l)):0,ssrc:0}));return o}return n.map(r=>{var s,o,a;const c=(s=r.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let l=NA((o=r.rid)!==null&&o!==void 0?o:"");return new Ms({quality:l,width:Math.ceil(t/c),height:Math.ceil(e/c),bitrate:(a=r.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}const US="_lossy",FS="_reliable",zz=2*1e3,Mm="leave-reconnect";var $n;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})($n||($n={}));class qz extends xi.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=pb.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=$n.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=ue,this.handleDataChannel=i=>M(this,[i],void 0,function(r){var s=this;let{channel:o}=r;return function*(){if(o){if(o.label===FS)s.reliableDCSub=o;else if(o.label===US)s.lossyDCSub=o;else return;s.log.debug("on data channel ".concat(o.id,", ").concat(o.label),s.logContext),o.onmessage=s.handleDataMessage}}()}),this.handleDataMessage=i=>M(this,void 0,void 0,function*(){var r,s;const o=yield this.dataProcessLock.lock();try{let a;if(i.data instanceof ArrayBuffer)a=i.data;else if(i.data instanceof Blob)a=yield i.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:i.data}));return}const c=gr.fromBinary(new Uint8Array(a));((r=c.value)===null||r===void 0?void 0:r.case)==="speaker"?this.emit(Y.ActiveSpeakersUpdate,c.value.value.speakers):(((s=c.value)===null||s===void 0?void 0:s.case)==="user"&&Wz(c,c.value.value),this.emit(Y.DataPacketReceived,c))}finally{o()}}),this.handleDataError=i=>{const s=i.currentTarget.maxRetransmits===0?"lossy":"reliable";if(i instanceof ErrorEvent&&i.error){const{error:o}=i.error;this.log.error("DataChannel error on ".concat(s,": ").concat(i.message),Object.assign(Object.assign({},this.logContext),{error:o}))}else this.log.error("Unknown DataChannel error on ".concat(s),Object.assign(Object.assign({},this.logContext),{event:i}))},this.handleBufferedAmountLow=i=>{const s=i.currentTarget.maxRetransmits===0?Ve.LOSSY:Ve.RELIABLE;this.updateAndEmitDCBufferStatus(s)},this.handleDisconnect=(i,r)=>{if(this._isClosed)return;this.log.warn("".concat(i," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=c=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(c,"ms. giving up"),this.logContext),this.emit(Y.Disconnected),this.close()},o=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:o,retryCount:this.reconnectAttempts});if(a===null){s(o);return}i===Mm&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Et.setTimeout(()=>this.attemptReconnect(r).finally(()=>this.reconnectTimeout=void 0),a)},this.waitForRestarted=()=>new Promise((i,r)=>{this.pcState===$n.Connected&&i();const s=()=>{this.off(Y.Disconnected,o),i()},o=()=>{this.off(Y.Restarted,s),r()};this.once(Y.Restarted,s),this.once(Y.Disconnected,o)}),this.updateAndEmitDCBufferStatus=i=>{const r=this.isBufferStatusLow(i);typeof r<"u"&&r!==this.dcBufferStatus.get(i)&&(this.dcBufferStatus.set(i,r),this.emit(Y.DCBufferStatusChanged,r,i))},this.isBufferStatusLow=i=>{const r=this.dataChannelForKind(i);if(r)return r.bufferedAmount<=r.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Be.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(ho.RR_SIGNAL_DISCONNECTED))},this.log=nr((n=e.loggerName)!==null&&n!==void 0?n:ti.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new hb(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new rn,this.dataProcessLock=new rn,this.dcBufferStatus=new Map([[Ve.LOSSY,!0],[Ve.RELIABLE,!0]]),this.client.onParticipantUpdate=i=>this.emit(Y.ParticipantUpdate,i),this.client.onConnectionQuality=i=>this.emit(Y.ConnectionQualityUpdate,i),this.client.onRoomUpdate=i=>this.emit(Y.RoomUpdate,i),this.client.onSubscriptionError=i=>this.emit(Y.SubscriptionError,i),this.client.onSubscriptionPermissionUpdate=i=>this.emit(Y.SubscriptionPermissionUpdate,i),this.client.onSpeakersChanged=i=>this.emit(Y.SpeakersChanged,i),this.client.onStreamStateUpdate=i=>this.emit(Y.StreamStateChanged,i),this.client.onRequestResponse=i=>this.emit(Y.SignalRequestResponse,i)}get logContext(){var e,n,i,r,s,o,a,c;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(r=(i=this.latestJoinResponse)===null||i===void 0?void 0:i.room)===null||r===void 0?void 0:r.sid,participant:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||o===void 0?void 0:o.identity,pID:(c=(a=this.latestJoinResponse)===null||a===void 0?void 0:a.participant)===null||c===void 0?void 0:c.sid}}join(e,n,i,r){return M(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=i,this.maxJoinAttempts=i.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,n,i,r);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),(!this.subscriberPrimary||s.fastPublish)&&this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof Ne&&s.reason===ke.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,i,r);throw s}})}close(){return M(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(Y.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return M(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=i=>{i&&(i.close(),i.onbufferedamountlow=null,i.onclose=null,i.onclosing=null,i.onerror=null,i.onmessage=null,i.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return M(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ji("a track with the same ID has already been published");return new Promise((n,i)=>{const r=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],i(new Ne("publication of local track timed out, no response from server",ke.InternalError))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(r),n(s)},reject:()=>{clearTimeout(r),i(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return M(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return M(this,void 0,void 0,function*(){var n,i;if(this.pcManager&&this.pcManager.currentState!==Xe.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const r=this.makeRTCConfiguration(e);this.pcManager=new Az(r,e.subscriberPrimary,this.loggerOptions),this.emit(Y.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(s,o)=>{this.client.sendIceCandidate(s,o)},this.pcManager.onPublisherOffer=s=>{this.client.sendOffer(s)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(s,o,a)=>M(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(s),this.logContext),["closed","disconnected","failed"].includes(o)&&(this.publisherConnectionPromise=void 0),s===Xe.CONNECTED){const u=this.pcState===$n.New;this.pcState=$n.Connected,u&&this.emit(Y.Connected,e)}else s===Xe.FAILED&&this.pcState===$n.Connected&&(this.pcState=$n.Disconnected,this.handleDisconnect("peerconnection failed",a==="failed"?ho.RR_SUBSCRIBER_FAILED:ho.RR_PUBLISHER_FAILED));const c=this.client.isDisconnected||this.client.currentState===Be.RECONNECTING,l=[Xe.FAILED,Xe.CLOSING,Xe.CLOSED].includes(s);c&&l&&!this._isClosed&&this.emit(Y.Offline)}),this.pcManager.onTrack=s=>{this.emit(Y.MediaTrackAdded,s.track,s.streams[0],s.receiver)},Hz((i=e.serverInfo)===null||i===void 0?void 0:i.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>M(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>M(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:i}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],i(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Y.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Y.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(Y.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Y.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",ho.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case Go.DISCONNECT:this.emit(Y.Disconnected,e==null?void 0:e.reason),this.close();break;case Go.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Mm);break;case Go.RESUME:this.handleDisconnect(Mm)}}}makeRTCConfiguration(e){var n;const i=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),i.encodedInsertableStreams=!0),e.iceServers&&!i.iceServers){const r=[];e.iceServers.forEach(s=>{const o={urls:s.urls};s.username&&(o.username=s.username),s.credential&&(o.credential=s.credential),r.push(o)}),i.iceServers=r}return e.clientConfiguration&&e.clientConfiguration.forceRelay===yl.ENABLED&&(i.iceTransportPolicy="relay"),i.sdpSemantics="unified-plan",i.continualGatheringPolicy="gather_continually",i}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(US,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(FS,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,i){return M(this,void 0,void 0,function*(){if(Hv())return yield this.createTransceiverRTCRtpSender(e,n,i);if(Wv())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new dt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,i,r){return M(this,void 0,void 0,function*(){if(Hv())return this.createSimulcastTransceiverSender(e,n,i,r);if(Wv())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new dt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,i){return M(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");const r=[];e.mediaStream&&r.push(e.mediaStream),e instanceof Lt&&(e.codec=n.videoCodec);const s={direction:"sendonly",streams:r};return i&&(s.sendEncodings=i),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s)).sender})}createSimulcastTransceiverSender(e,n,i,r){return M(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");const s={direction:"sendonly"};r&&(s.sendEncodings=r);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,s);if(i.videoCodec)return e.setSimulcastTrackSender(i.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return M(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return M(this,void 0,void 0,function*(){var n,i,r;if(!this._isClosed){if(this.attemptingReconnect){ue.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===yl.DISABLED||((r=(i=this.pcManager)===null||i===void 0?void 0:i.currentState)!==null&&r!==void 0?r:Xe.NEW)===Xe.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let o=!0;s instanceof dt?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),o=!1):s instanceof fo||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",ho.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Y.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return M(this,void 0,void 0,function*(){var n,i,r;try{if(!this.url||!this.token)throw new dt("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Y.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new fo;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof Ne&&o.reason===ke.NotAllowed?new dt("could not reconnect, token might be expired"):new fo}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Y.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==Be.CONNECTED)throw new fo("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(Y.Restarted)}catch(s){const o=yield(i=this.regionUrlProvider)===null||i===void 0?void 0:i.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(r=this.regionUrlProvider)===null||r===void 0||r.resetAttempts(),s}})}resumeConnection(e){return M(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new dt("could not reconnect, url or token not saved");if(!this.pcManager)throw new dt("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Y.Resuming);let i;try{this.setupSignalClientCallbacks(),i=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(r){let s="";throw r instanceof Error&&(s=r.message,this.log.error(r.message,Object.assign(Object.assign({},this.logContext),{error:r}))),r instanceof Ne&&r.reason===ke.NotAllowed?new dt("could not reconnect, token might be expired"):r instanceof Ne&&r.reason===ke.LeaveRequest?r:new fo(s)}if(this.emit(Y.SignalResumed),i){const r=this.makeRTCConfiguration(i);this.pcManager.updateConfiguration(r)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Be.CONNECTED)throw new fo("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(Y.Resumed)})}waitForPCInitialConnection(e,n){return M(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return M(this,void 0,void 0,function*(){this.pcState=$n.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Xn(zz),!this.pcManager)throw new dt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=$n.Connected}catch(e){throw this.pcState=$n.Disconnected,new Ne("could not establish PC connection, ".concat(e.message),ke.InternalError)}})}sendDataPacket(e,n){return M(this,void 0,void 0,function*(){const i=e.toBinary();yield this.ensurePublisherConnected(n);const r=this.dataChannelForKind(n);r&&r.send(i),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){return M(this,arguments,void 0,function(n){var i=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var s;if(!i.pcManager)throw new dt("PC manager is closed");const o=r?i.pcManager.subscriber:i.pcManager.publisher,a=r?"Subscriber":"Publisher";if(!o)throw new Ne("".concat(a," connection not set"),ke.InternalError);let c=!1;!r&&!i.dataChannelForKind(n,r)&&(i.createDataChannels(),c=!0),!c&&!r&&!i.pcManager.publisher.isICEConnected&&i.pcManager.publisher.getICEConnectionState()!=="checking"&&(c=!0),c&&i.negotiate();const l=i.dataChannelForKind(n,r);if((l==null?void 0:l.readyState)==="open")return;const u=new Date().getTime()+i.peerConnectionTimeout;for(;new Date().getTime()<u;){if(o.isICEConnected&&((s=i.dataChannelForKind(n,r))===null||s===void 0?void 0:s.readyState)==="open")return;yield Xn(50)}throw new Ne("could not establish ".concat(a," connection, state: ").concat(o.getICEConnectionState()),ke.InternalError)}()})}ensurePublisherConnected(e){return M(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Xe.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return M(this,void 0,void 0,function*(){return new Promise((e,n)=>M(this,void 0,void 0,function*(){if(!this.pcManager){n(new $v("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const i=new AbortController,r=()=>{i.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(Y.Closing,r),this.pcManager.publisher.once(Yo.RTPVideoPayloadTypes,s=>{const o=new Map;s.forEach(a=>{const c=a.codec.toLowerCase();fz(c)&&o.set(a.payload,c)}),this.emit(Y.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(i),e()}catch(s){s instanceof $v&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ho.RR_UNKNOWN),n(s)}finally{this.off(Y.Closing,r)}}))})}dataChannelForKind(e,n){if(n){if(e===Ve.LOSSY)return this.lossyDCSub;if(e===Ve.RELIABLE)return this.reliableDCSub}else{if(e===Ve.LOSSY)return this.lossyDC;if(e===Ve.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var i,r;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const s=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),a=(r=(i=this.signalOpts)===null||i===void 0?void 0:i.autoSubscribe)!==null&&r!==void 0?r:!0,c=new Array,l=new Array;e.forEach(u=>{u.isDesired!==a&&c.push(u.trackSid),u.isEnabled||l.push(u.trackSid)}),this.client.sendSyncState(new jx({answer:s?Ah({sdp:s.sdp,type:s.type}):void 0,offer:o?Ah({sdp:o.sdp,type:o.type}):void 0,subscription:new $f({trackSids:c,subscribe:!a,participantTracks:[]}),publishTracks:ez(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:l}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(i,r)=>{(i==null?void 0:i.id)!==void 0&&i.id!==null&&e.push(new $x({label:i.label,id:i.id,target:r}))};return n(this.dataChannelForKind(Ve.LOSSY),Kn.PUBLISHER),n(this.dataChannelForKind(Ve.RELIABLE),Kn.PUBLISHER),n(this.dataChannelForKind(Ve.LOSSY,!0),Kn.SUBSCRIBER),n(this.dataChannelForKind(Ve.RELIABLE,!0),Kn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Et.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){sn()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){sn()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class fo extends Error{}function Hz(t){return t!==void 0&&t>13}function Wz(t,e){const n=t.participantIdentity?t.participantIdentity:e.participantIdentity;t.participantIdentity=n,e.participantIdentity=n;const i=t.destinationIdentities.length!==0?t.destinationIdentities:e.destinationIdentities;t.destinationIdentities=i,e.destinationIdentities=i}class VS{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Gv(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return M(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(i=>!this.attemptedRegions.find(r=>r.url===i.url));if(n.length>0){const i=n[0];return this.attemptedRegions.push(i),ue.debug("next region: ".concat(i.region)),i.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return M(this,void 0,void 0,function*(){const n=yield fetch("".concat(Kz(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const i=yield n.json();return this.lastUpdateAt=Date.now(),i}else throw new Ne("Could not fetch region settings: ".concat(n.statusText),n.status===401?ke.NotAllowed:ke.InternalError,n.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function Kz(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class Ye extends Error{constructor(e,n,i){super(n),this.code=e,this.message=$S(n,Ye.MAX_MESSAGE_BYTES),this.data=i?$S(i,Ye.MAX_DATA_BYTES):void 0}static fromProto(e){return new Ye(e.code,e.message,e.data)}toProto(){return new Ix({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new Ye(Ye.ErrorCode[e],Ye.ErrorMessage[e],n)}}Ye.MAX_MESSAGE_BYTES=256;Ye.MAX_DATA_BYTES=15360;Ye.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Ye.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const jS=15360;function Xv(t){return new TextEncoder().encode(t).length}function $S(t,e){if(Xv(t)<=e)return t;let n=0,i=t.length;const r=new TextEncoder;for(;n<i;){const s=Math.floor((n+i+1)/2);r.encode(t.slice(0,s)).length<=e?n=s:i=s-1}return t.slice(0,n)}class OA extends j{constructor(e,n,i,r,s){super(e,i,s),this.sid=n,this.receiver=r}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?G.Muted:G.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=i=>{i.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(G.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return M(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),mb)),tz()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const i=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(i){const{timestamp:r,rtpTimestamp:s}=i;s&&this.rtpTimestamp!==s&&(this.emit(G.TimeSyncUpdate,{timestamp:r,rtpTimestamp:s}),this.rtpTimestamp=s)}};e()}}class Xo extends OA{constructor(e,n,i,r,s,o){super(e,n,j.Kind.Audio,i,o),this.monitorReceiver=()=>M(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Hf(a,this.prevStats)),this.prevStats=a}),this.audioContext=r,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var n;for(const i of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):i.volume=e;ir()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(ir())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return M(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(Kv(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Kv(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let i=this.sourceNode;this.webAudioPluginNodes.forEach(r=>{i.connect(r),i=r}),this.gainNode=e.createGain(),i.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(G.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(r=>{this.emit(G.AudioPlaybackFailed,r)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return M(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(i=>{i.type==="inbound-rtp"&&(n={type:"audio",timestamp:i.timestamp,jitter:i.jitter,bytesReceived:i.bytesReceived,concealedSamples:i.concealedSamples,concealmentEvents:i.concealmentEvents,silentConcealedSamples:i.silentConcealedSamples,silentConcealmentEvents:i.silentConcealmentEvents,totalAudioEnergy:i.totalAudioEnergy,totalSamplesDuration:i.totalSamplesDuration})}),n})}}const Um=100;class jc extends OA{constructor(e,n,i,r,s){super(e,n,j.Kind.Video,i,s),this.elementInfos=[],this.monitorReceiver=()=>M(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=Hf(o,this.prevStats)),this.prevStats=o}),this.debouncedHandleResize=lb(()=>{this.updateDimensions()},Um),this.adaptiveStreamSettings=r}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?Jo(this._mediaStreamTrack,n):Lo(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new Gz(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(i=>i===e);for(const i of n)i.stopObserving();this.elementInfos=this.elementInfos.filter(i=>i!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const i of n)this.stopObservingElement(i);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return M(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,i="",r=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(i=s.codecId,n={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&r.set(s.id,s)}),n&&i!==""&&r.get(i)&&(n.mimeType=r.get(i).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(i=>i.element===e);for(const i of n)this.stopObservingElementInfo(i)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return M(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const i=this.elementInfos.reduce((a,c)=>Math.max(a,c.visibilityChangedAt||0),0),r=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,s=this.elementInfos.some(a=>a.pictureInPicture),o=this.elementInfos.some(a=>a.visible)&&!r||s;if(this.lastVisible!==o){if(!o&&Date.now()-i<Um){Et.setTimeout(()=>{this.updateVisibility()},Um);return}this.lastVisible=o,this.emit(G.VisibilityChanged,o,this)}}updateDimensions(){var e,n;let i=0,r=0;const s=this.getPixelDensity();for(const o of this.elementInfos){const a=o.width()*s,c=o.height()*s;a+c>i+r&&(i=a,r=c)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===i&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===r||(this.lastDimensions={width:i,height:r},this.emit(G.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?bS():n||(bS()>2?2:1)}}class Gz{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=i=>{var r;const{target:s,isIntersecting:o}=i;s===this.element&&(this.isIntersecting=o,this.isPiP=uc(this.element),this.visibilityChangedAt=Date.now(),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this))},this.onEnterPiP=()=>{var i,r,s;(r=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP),this.isPiP=uc(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.onLeavePiP=()=>{var i;this.isPiP=uc(this.element),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this)},this.element=e,this.isIntersecting=n??Zv(e),this.isPiP=sn()&&uc(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,i;this.isIntersecting=Zv(this.element),this.isPiP=uc(this.element),this.element.handleResize=()=>{var r;(r=this.handleResize)===null||r===void 0||r.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,kS().observe(this.element),TS().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(i=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,i,r,s;(e=kS())===null||e===void 0||e.unobserve(this.element),(n=TS())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(i=window.documentPictureInPicture)===null||i===void 0||i.removeEventListener("enter",this.onEnterPiP),(s=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||s===void 0||s.removeEventListener("pagehide",this.onLeavePiP)}}function uc(t){var e,n;return document.pictureInPictureElement===t?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Zv(t,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Zv(t,e){const n=e||window;let i=t.offsetTop,r=t.offsetLeft;const s=t.offsetWidth,o=t.offsetHeight,{hidden:a}=t,{display:c}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,i+=t.offsetTop,r+=t.offsetLeft;return i<n.pageYOffset+n.innerHeight&&r<n.pageXOffset+n.innerWidth&&i+o>n.pageYOffset&&r+s>n.pageXOffset&&!a&&c!=="none"}class Tr extends xi.EventEmitter{constructor(e,n,i,r){var s;super(),this.metadataMuted=!1,this.encryption=yn.NONE,this.log=ue,this.handleMuted=()=>{this.emit(G.Muted)},this.handleUnmuted=()=>{this.emit(G.Unmuted)},this.log=nr((s=r==null?void 0:r.loggerName)!==null&&s!==void 0?s:ti.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=i,this.source=j.Source.Unknown}setTrack(e){this.track&&(this.track.off(G.Muted,this.handleMuted),this.track.off(G.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(G.Muted,this.handleMuted),e.on(G.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ae(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==yn.NONE}get audioTrack(){if(this.track instanceof _t||this.track instanceof Xo)return this.track}get videoTrack(){if(this.track instanceof Lt||this.track instanceof jc)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=j.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===j.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(Tr);class wl extends Tr{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,i,r){super(e,n.sid,n.name,r),this.track=void 0,this.handleTrackEnded=()=>{this.emit(G.Ended)},this.updateInfo(n),this.setTrack(i)}setTrack(e){this.track&&this.track.off(G.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(G.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){return M(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return M(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return M(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return M(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(this.track instanceof _t){const n=this.track.getSourceTrackSettings(),i=new Set;return n.autoGainControl&&i.add(mi.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&i.add(mi.TF_ECHO_CANCELLATION),n.noiseSuppression&&i.add(mi.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&i.add(mi.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||i.add(mi.TF_NO_DTX),this.track.enhancedNoiseCancellation&&i.add(mi.TF_ENHANCED_NOISE_CANCELLATION),Array.from(i.values())}else return[]}}var xn;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(xn||(xn={}));function Qz(t){switch(t){case bc.EXCELLENT:return xn.Excellent;case bc.GOOD:return xn.Good;case bc.POOR:return xn.Poor;case bc.LOST:return xn.Lost;default:return xn.Unknown}}class DA extends xi.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===xh.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,i,r,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:xh.STANDARD;var c;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=xn.Unknown,this.log=ue,this.log=nr((c=o==null?void 0:o.loggerName)!==null&&c!==void 0?c:ti.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=i,this.metadata=r,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=a,this._attributes=s??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(j.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(j.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(j.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,i=this.metadata;this.metadata=e,n&&this.emit(V.ParticipantMetadataChanged,i)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(V.ParticipantNameChanged,e)}_setAttributes(e){const n=nz(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(V.AttributesChanged,n)}setPermissions(e){var n,i,r,s,o,a;const c=this.permissions,l=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((i=this.permissions)===null||i===void 0?void 0:i.canSubscribe)||e.canPublishData!==((r=this.permissions)===null||r===void 0?void 0:r.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((u,h)=>{var f;return u!==((f=this.permissions)===null||f===void 0?void 0:f.canPublishSources[h])})||e.canSubscribeMetrics!==((a=this.permissions)===null||a===void 0?void 0:a.canSubscribeMetrics);return this.permissions=e,l&&this.emit(V.ParticipantPermissionsChanged,c),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(V.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=Qz(e),n!==this._connectionQuality&&this.emit(V.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>(n.track instanceof Xo||n.track instanceof _t)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(G.Muted,()=>{this.emit(V.TrackMuted,e)}),e.on(G.Unmuted,()=>{this.emit(V.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case j.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case j.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function Jz(t){var e,n,i;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Fx({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(i=t.allowAll)!==null&&i!==void 0?i:!1,trackSids:t.allowedTrackSids||[]})}class BS extends DA{constructor(e,n,i,r){super(e,n,void 0,void 0,void 0,{loggerName:r.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=yn.NONE,this.enabledPublishVideoCodecs=[],this.rpcHandlers=new Map,this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new IA)},this.handleReconnected=()=>{var s,o;(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||o===void 0||o.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||o===void 0||o.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=s=>{const{requestId:o,reason:a,message:c}=s,l=this.pendingSignalRequests.get(o);l&&(a!==zx.OK&&l.reject(new mS(c,a)),this.pendingSignalRequests.delete(o))},this.handleDataPacket=s=>{switch(s.value.case){case"rpcRequest":let o=s.value.value;this.handleIncomingRpcRequest(s.participantIdentity,o.id,o.method,o.payload,o.responseTimeoutMs,o.version);break;case"rpcResponse":let a=s.value.value,c=null,l=null;a.value.case==="payload"?c=a.value.value:a.value.case==="error"&&(l=Ye.fromProto(a.value.value)),this.handleIncomingRpcResponse(a.requestId,c,l);break;case"rpcAck":let u=s.value.value;this.handleIncomingRpcAck(u.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>Jz(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,o)=>{if(o===void 0&&(o=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Ae(s)));return}this.engine.updateMuteStatus(s.sid,o)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Ae(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Ae(s))),this.onTrackMuted(s,s.isMuted)},this.onTrackFeatureUpdate=s=>{const o=this.audioTrackPublications.get(s.sid);if(!o){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(s.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(o.trackSid,o.getTrackFeatures())},this.handleSubscribedQualityUpdate=s=>M(this,void 0,void 0,function*(){var o,a,c,l,u,h;if(!(!((u=this.roomOptions)===null||u===void 0)&&u.dynacast))return;const f=this.videoTrackPublications.get(s.trackSid);if(!f){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(s.subscribedCodecs.length>0){if(!f.videoTrack)return;const T=yield f.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var g=!0,b=To(T),y;y=yield b.next(),o=y.done,!o;g=!0){l=y.value,g=!1;const v=l;Q8(v)&&(this.log.debug("publish ".concat(v," for ").concat(f.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Ae(f))),yield this.publishAdditionalCodecForTrack(f.videoTrack,v,f.options))}}catch(v){a={error:v}}finally{try{!g&&!o&&(c=b.return)&&(yield c.call(b))}finally{if(a)throw a.error}}}else s.subscribedQualities.length>0&&(yield(h=f.videoTrack)===null||h===void 0?void 0:h.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const o=this.trackPublications.get(s.trackSid);if(!o){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(o.track)},this.handleTrackEnded=s=>M(this,void 0,void 0,function*(){if(s.source===j.Source.ScreenShare||s.source===j.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Ae(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof _t||s instanceof Lt)try{if(sn())try{const o=yield navigator==null?void 0:navigator.permissions.query({name:s.source===j.Source.Camera?"camera":"microphone"});if(o&&o.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),Ae(s))),o.onchange=()=>{o.state!=="denied"&&(s.isMuted||s.restartTrack(),o.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Ae(s))),s instanceof _t?yield s.restartTrack({deviceId:"default"}):yield s.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Ae(s))),yield s.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=i,this.roomOptions=r,this.setupEngine(i),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==yn.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(Y.RemoteMute,(n,i)=>{const r=this.trackPublications.get(n);!r||!r.track||(i?r.mute():r.unmute())}),this.engine.on(Y.Connected,this.handleReconnected).on(Y.SignalRestarted,this.handleReconnected).on(Y.SignalResumed,this.handleReconnected).on(Y.Restarting,this.handleReconnecting).on(Y.Resuming,this.handleReconnecting).on(Y.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Y.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Y.Disconnected,this.handleDisconnected).on(Y.SignalRequestResponse,this.handleSignalRequestResponse).on(Y.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return M(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return M(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return M(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return M(this,arguments,void 0,function(n){var i=this;let{metadata:r,name:s,attributes:o}=n;return function*(){return new Promise((a,c)=>M(i,void 0,void 0,function*(){var l,u;try{let h=!1;const f=yield this.engine.client.sendUpdateLocalMetadata((l=r??this.metadata)!==null&&l!==void 0?l:"",(u=s??this.name)!==null&&u!==void 0?u:"",o),g=performance.now();for(this.pendingSignalRequests.set(f,{resolve:a,reject:b=>{c(b),h=!0},values:{name:s,metadata:r,attributes:o}});performance.now()-g<5e3&&!h;){if((!s||this.name===s)&&(!r||this.metadata===r)&&(!o||Object.entries(o).every(b=>{let[y,T]=b;return this.attributes[y]===T||T===""&&!this.attributes[y]}))){this.pendingSignalRequests.delete(f),a();return}yield Xn(50)}c(new mS("Request to update local metadata timed out","TimeoutError"))}catch(h){h instanceof Error&&c(h)}}))}()})}setCameraEnabled(e,n,i){return this.setTrackEnabled(j.Source.Camera,e,n,i)}setMicrophoneEnabled(e,n,i){return this.setTrackEnabled(j.Source.Microphone,e,n,i)}setScreenShareEnabled(e,n,i){return this.setTrackEnabled(j.Source.ScreenShare,e,n,i)}setPermissions(e){const n=this.permissions,i=super.setPermissions(e);return i&&n&&this.emit(V.ParticipantPermissionsChanged,n),i}setE2EEEnabled(e){return M(this,void 0,void 0,function*(){this.encryptionType=e?yn.GCM:yn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,i,r){return M(this,void 0,void 0,function*(){var s,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let a=this.getTrackPublication(e);if(n)if(a)yield a.unmute();else{let c;if(this.pendingPublishing.has(e)){const l=yield this.waitForPendingPublicationOfSource(e);return l||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield l==null?void 0:l.unmute(),l}this.pendingPublishing.add(e);try{switch(e){case j.Source.Camera:c=yield this.createTracks({video:(s=i)!==null&&s!==void 0?s:!0});break;case j.Source.Microphone:c=yield this.createTracks({audio:(o=i)!==null&&o!==void 0?o:!0});break;case j.Source.ScreenShare:c=yield this.createScreenTracks(Object.assign({},i));break;default:throw new ji(e)}}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l instanceof Error&&this.emit(V.MediaDevicesError,l),l}try{const l=[];for(const h of c)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Ae(h))),l.push(this.publishTrack(h,r));[a]=yield Promise.all(l)}catch(l){throw c==null||c.forEach(u=>{u.stop()}),l}finally{this.pendingPublishing.delete(e)}}else if(!(a!=null&&a.track)&&this.pendingPublishing.has(e)&&(a=yield this.waitForPendingPublicationOfSource(e),a||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),a&&a.track)if(e===j.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const c=this.getTrackPublication(j.Source.ScreenShareAudio);c&&c.track&&this.unpublishTrack(c.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return M(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(j.Source.Camera)||this.pendingPublishing.has(j.Source.Microphone))){this.pendingPublishing.add(j.Source.Camera),this.pendingPublishing.add(j.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(j.Source.Camera),this.pendingPublishing.delete(j.Source.Microphone)}}})}createTracks(e){return M(this,void 0,void 0,function*(){var n,i;e??(e={});const{audioProcessor:r,videoProcessor:s,optionsWithoutProcessor:o}=db(e),a=wA(o,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(i=this.roomOptions)===null||i===void 0?void 0:i.videoCaptureDefaults),c=qf(a);let l;try{l=yield navigator.mediaDevices.getUserMedia(c)}catch(u){throw u instanceof Error&&(c.audio&&(this.microphoneError=u),c.video&&(this.cameraError=u)),u}return c.audio&&(this.microphoneError=void 0,this.emit(V.AudioStreamAcquired)),c.video&&(this.cameraError=void 0),Promise.all(l.getTracks().map(u=>M(this,void 0,void 0,function*(){const h=u.kind==="audio";h?a.audio:a.video;let f;const g=h?c.audio:c.video;typeof g!="boolean"&&(f=g);const b=xA(u,f,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return b.kind===j.Kind.Video?b.source=j.Source.Camera:b.kind===j.Kind.Audio&&(b.source=j.Source.Microphone,b.setAudioContext(this.audioContext)),b.mediaStream=l,b instanceof _t&&r?yield b.setProcessor(r):b instanceof Lt&&s&&(yield b.setProcessor(s)),b})))})}createScreenTracks(e){return M(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new cb("getDisplayMedia not supported");e.resolution===void 0&&!cz()&&(e.resolution=ub.h1080fps30.resolution);const n=Z8(e),i=yield navigator.mediaDevices.getDisplayMedia(n),r=i.getVideoTracks();if(r.length===0)throw new ji("no video track found");const s=new Lt(r[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=j.Source.ScreenShare,e.contentHint&&(s.mediaStreamTrack.contentHint=e.contentHint);const o=[s];if(i.getAudioTracks().length>0){this.emit(V.AudioStreamAcquired);const a=new _t(i.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=j.Source.ScreenShareAudio,o.push(a)}return o})}publishTrack(e,n){return M(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return M(this,arguments,void 0,function(i,r){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var a,c,l,u;i instanceof _t&&i.setAudioContext(s.audioContext),yield(a=s.reconnectFuture)===null||a===void 0?void 0:a.promise,s.republishPromise&&!o&&(yield s.republishPromise),i instanceof Fs&&s.pendingPublishPromises.has(i)&&(yield s.pendingPublishPromises.get(i));let h;if(i instanceof MediaStreamTrack)h=i.getConstraints();else{h=i.constraints;let v;switch(i.source){case j.Source.Microphone:v="audioinput";break;case j.Source.Camera:v="videoinput"}v&&s.activeDeviceMap.has(v)&&(h=Object.assign(Object.assign({},h),{deviceId:s.activeDeviceMap.get(v)}))}if(i instanceof MediaStreamTrack)switch(i.kind){case"audio":i=new _t(i,h,!0,s.audioContext,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;case"video":i=new Lt(i,h,!0,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;default:throw new ji("unsupported MediaStreamTrack kind ".concat(i.kind))}else i.updateLoggerOptions({loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});let f;if(s.trackPublications.forEach(v=>{v.track&&v.track===i&&(f=v)}),f)return s.log.warn("track has already been published, skipping",Object.assign(Object.assign({},s.logContext),Ae(f))),f;const g="channelCount"in i.mediaStreamTrack.getSettings()&&i.mediaStreamTrack.getSettings().channelCount===2||i.mediaStreamTrack.getConstraints().channelCount===2,b=(c=r==null?void 0:r.forceStereo)!==null&&c!==void 0?c:g;b&&(r||(r={}),r.dtx===void 0&&s.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},s.logContext),Ae(i))),r.red===void 0&&s.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(l=r.dtx)!==null&&l!==void 0||(r.dtx=!1),(u=r.red)!==null&&u!==void 0||(r.red=!1));const y=Object.assign(Object.assign({},s.roomOptions.publishDefaults),r);!lz()&&s.roomOptions.e2ee&&(s.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},s.logContext)),y.simulcast=!1),y.source&&(i.source=y.source);const T=s.publish(i,y,b);s.pendingPublishPromises.set(i,T);try{return yield T}catch(v){throw v}finally{s.pendingPublishPromises.delete(i)}}()})}publish(e,n,i){return M(this,void 0,void 0,function*(){var r,s,o,a,c,l,u,h,f,g;Array.from(this.trackPublications.values()).find(R=>e instanceof Fs&&R.source===e.source)&&e.source!==j.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Ae(e))),n.stopMicTrackOnMute&&e instanceof _t&&(e.stopOnMute=!0),e.source===j.Source.ScreenShare&&ya()&&(n.simulcast=!1),n.videoCodec==="av1"&&!sz()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!oz()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Qv),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(R=>n.videoCodec===Od(R.mime))||(n.videoCodec=Od(this.enabledPublishVideoCodecs[0].mime)));const y=n.videoCodec;e.on(G.Muted,this.onTrackMuted),e.on(G.Unmuted,this.onTrackUnmuted),e.on(G.Ended,this.handleTrackEnded),e.on(G.UpstreamPaused,this.onTrackUpstreamPaused),e.on(G.UpstreamResumed,this.onTrackUpstreamResumed),e.on(G.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const T=new Nv({cid:e.mediaStreamTrack.id,name:n.name,type:j.kindToProto(e.kind),muted:e.isMuted,source:j.sourceToProto(e.source),disableDtx:!(!((r=n.dtx)!==null&&r!==void 0)||r),encryption:this.encryptionType,stereo:i,disableRed:this.isE2EEEnabled||!(!((s=n.red)!==null&&s!==void 0)||s),stream:n==null?void 0:n.stream});let v;if(e.kind===j.Kind.Video){let R={width:0,height:0};try{R=yield e.waitForDimensions()}catch{const E=(a=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&a!==void 0?a:kl.h720.resolution;R={width:E.width,height:E.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Ae(e)),{dims:R}))}T.width=R.width,T.height=R.height,e instanceof Lt&&(Fc(y)&&(e.source===j.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Ae(e))))),n.scalabilityMode=(c=n.scalabilityMode)!==null&&c!==void 0?c:"L3T3_KEY"),T.simulcastCodecs=[new Av({codec:y,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Qv}),n.backupCodec&&y!==n.backupCodec.codec&&T.encryption===yn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),T.simulcastCodecs.push(new Av({codec:n.backupCodec.codec,cid:""})))),v=Yv(e.source===j.Source.ScreenShare,T.width,T.height,n),T.layers=MS(T.width,T.height,v,Fc(n.videoCodec))}else e.kind===j.Kind.Audio&&(v=[{maxBitrate:(l=n.audioPreset)===null||l===void 0?void 0:l.maxBitrate,priority:(h=(u=n.audioPreset)===null||u===void 0?void 0:u.priority)!==null&&h!==void 0?h:"high",networkPriority:(g=(f=n.audioPreset)===null||f===void 0?void 0:f.priority)!==null&&g!==void 0?g:"high"}]);if(!this.engine||this.engine.isClosed)throw new dt("cannot publish track when not connected");const w=()=>M(this,void 0,void 0,function*(){var R,O,E;if(!this.engine.pcManager)throw new dt("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,v),e instanceof Lt&&((R=n.degradationPreference)!==null&&R!==void 0||(n.degradationPreference=$z(e)),e.setDegradationPreference(n.degradationPreference)),v)if(ya()&&e.kind===j.Kind.Audio){let _;for(const C of this.engine.pcManager.publisher.getTransceivers())if(C.sender===e.sender){_=C;break}_&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:_,codec:"opus",maxbr:!((O=v[0])===null||O===void 0)&&O.maxBitrate?v[0].maxBitrate/1e3:0})}else e.codec&&Fc(e.codec)&&(!((E=v[0])===null||E===void 0)&&E.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:T.cid,codec:e.codec,maxbr:v[0].maxBitrate/1e3});yield this.engine.negotiate()});let S;if(this.enabledPublishVideoCodecs.length>0)S=(yield Promise.all([this.engine.addTrack(T),w()]))[0];else{S=yield this.engine.addTrack(T);let R;if(S.codecs.forEach(O=>{R===void 0&&(R=O.mimeType)}),R&&e.kind===j.Kind.Video){const O=Od(R);O!==y&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Ae(e)),{codec:O})),n.videoCodec=O,v=Yv(e.source===j.Source.ScreenShare,T.width,T.height,n))}yield w()}const P=new wl(e.kind,S,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return P.options=n,e.sid=S.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:v,trackInfo:S})),e instanceof Lt?e.startMonitor(this.engine.client):e instanceof _t&&e.startMonitor(),this.addTrackPublication(P),this.emit(V.LocalTrackPublished,P),P})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,i){return M(this,void 0,void 0,function*(){var r;if(this.encryptionType!==yn.NONE)return;let s;if(this.trackPublications.forEach(g=>{g.track&&g.track===e&&(s=g)}),!s)throw new ji("track is not published");if(!(e instanceof Lt))throw new ji("track is not a video track");const o=Object.assign(Object.assign({},(r=this.roomOptions)===null||r===void 0?void 0:r.publishDefaults),i),a=Fz(e,n,o);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Ae(e)));return}const c=e.addSimulcastTrack(n,a);if(!c)return;const l=new Nv({cid:c.mediaStreamTrack.id,type:j.kindToProto(e.kind),muted:e.isMuted,source:j.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:c.mediaStreamTrack.id}]});if(l.layers=MS(l.width,l.height,a),!this.engine||this.engine.isClosed)throw new dt("cannot publish track when not connected");const u=()=>M(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,c,o,a),yield this.engine.negotiate()}),f=(yield Promise.all([this.engine.addTrack(l),u()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:f}))})}unpublishTrack(e,n){return M(this,void 0,void 0,function*(){var i,r;if(e instanceof Fs){const l=this.pendingPublishPromises.get(e);l&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Ae(e))),yield l)}const s=this.getPublicationForTrack(e),o=s?Ae(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));return}e=s.track,e.off(G.Muted,this.onTrackMuted),e.off(G.Unmuted,this.onTrackUnmuted),e.off(G.Ended,this.handleTrackEnded),e.off(G.UpstreamPaused,this.onTrackUpstreamPaused),e.off(G.UpstreamResumed,this.onTrackUpstreamResumed),e.off(G.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(r=(i=this.roomOptions)===null||i===void 0?void 0:i.stopLocalTrackOnUnpublish)!==null&&r!==void 0?r:!0),n?e.stop():e.stopMonitor();let a=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Xe.FAILED&&c)try{for(const l of this.engine.pcManager.publisher.getTransceivers())l.sender===c&&(l.direction="inactive",a=!0);if(this.engine.removeTrack(c)&&(a=!0),e instanceof Lt){for(const[,l]of e.simulcastCodecs)l.sender&&(this.engine.removeTrack(l.sender)&&(a=!0),l.sender=void 0);e.simulcastCodecs.clear()}}catch(l){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:l}))}switch(this.trackPublications.delete(s.trackSid),s.kind){case j.Kind.Audio:this.audioTrackPublications.delete(s.trackSid);break;case j.Kind.Video:this.videoTrackPublications.delete(s.trackSid);break}return this.emit(V.LocalTrackUnpublished,s),s.setTrack(void 0),a&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return M(this,void 0,void 0,function*(){return(yield Promise.all(e.map(i=>this.unpublishTrack(i)))).filter(i=>i instanceof wl)})}republishAllTracks(e){return M(this,arguments,void 0,function(n){var i=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){i.republishPromise&&(yield i.republishPromise),i.republishPromise=new Promise((s,o)=>M(i,void 0,void 0,function*(){try{const a=[];this.trackPublications.forEach(c=>{c.track&&(n&&(c.options=Object.assign(Object.assign({},c.options),n)),a.push(c))}),yield Promise.all(a.map(c=>M(this,void 0,void 0,function*(){const l=c.track;yield this.unpublishTrack(l,!1),r&&!l.isMuted&&l.source!==j.Source.ScreenShare&&l.source!==j.Source.ScreenShareAudio&&(l instanceof _t||l instanceof Lt)&&!l.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:c.trackSid})),yield l.restartTrack()),yield this.publishOrRepublishTrack(l,c.options,!0)}))),s()}catch(a){o(a)}finally{this.republishPromise=void 0}})),yield i.republishPromise}()})}publishData(e){return M(this,arguments,void 0,function(n){var i=this;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const s=r.reliable?Ve.RELIABLE:Ve.LOSSY,o=r.destinationIdentities,a=r.topic,c=new gr({kind:s,value:{case:"user",value:new wx({participantIdentity:i.identity,payload:n,destinationIdentities:o,topic:a})}});yield i.engine.sendDataPacket(c,s)}()})}publishDtmf(e,n){return M(this,void 0,void 0,function*(){const i=new gr({kind:Ve.RELIABLE,value:{case:"sipDtmf",value:new _x({code:e,digit:n})}});yield this.engine.sendDataPacket(i,Ve.RELIABLE)})}sendChatMessage(e){return M(this,void 0,void 0,function*(){const n={id:crypto.randomUUID(),message:e,timestamp:Date.now()},i=new gr({value:{case:"chatMessage",value:new Rv(Object.assign(Object.assign({},n),{timestamp:qe.parse(n.timestamp)}))}});return yield this.engine.sendDataPacket(i,Ve.RELIABLE),this.emit(V.ChatMessage,n),n})}editChatMessage(e,n){return M(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),r=new gr({value:{case:"chatMessage",value:new Rv(Object.assign(Object.assign({},i),{timestamp:qe.parse(i.timestamp),editTimestamp:qe.parse(i.editTimestamp)}))}});return yield this.engine.sendDataPacket(r,Ve.RELIABLE),this.emit(V.ChatMessage,i),i})}performRpc(e){return M(this,arguments,void 0,function(n){var i=this;let{destinationIdentity:r,method:s,payload:o,responseTimeout:a=1e4}=n;return function*(){return new Promise((l,u)=>M(i,void 0,void 0,function*(){var h,f,g,b;if(Xv(o)>jS){u(Ye.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((f=(h=this.engine.latestJoinResponse)===null||h===void 0?void 0:h.serverInfo)===null||f===void 0)&&f.version&&Ys((b=(g=this.engine.latestJoinResponse)===null||g===void 0?void 0:g.serverInfo)===null||b===void 0?void 0:b.version,"1.8.0")<0){u(Ye.builtIn("UNSUPPORTED_SERVER"));return}const y=crypto.randomUUID();yield this.publishRpcRequest(r,y,s,o,a-2e3);const T=setTimeout(()=>{this.pendingAcks.delete(y),u(Ye.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(y),clearTimeout(v)},2e3);this.pendingAcks.set(y,{resolve:()=>{clearTimeout(T)},participantIdentity:r});const v=setTimeout(()=>{this.pendingResponses.delete(y),u(Ye.builtIn("RESPONSE_TIMEOUT"))},a);this.pendingResponses.set(y,{resolve:(w,S)=>{clearTimeout(v),this.pendingAcks.has(y)&&(console.warn("RPC response received before ack",y),this.pendingAcks.delete(y),clearTimeout(T)),S?u(S):l(w??"")},participantIdentity:r})}))}()})}registerRpcMethod(e,n){this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,i){const r=this.pendingResponses.get(e);r?(r.resolve(n,i),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}handleIncomingRpcRequest(e,n,i,r,s,o){return M(this,void 0,void 0,function*(){if(yield this.publishRpcAck(e,n),o!==1){yield this.publishRpcResponse(e,n,null,Ye.builtIn("UNSUPPORTED_VERSION"));return}const a=this.rpcHandlers.get(i);if(!a){yield this.publishRpcResponse(e,n,null,Ye.builtIn("UNSUPPORTED_METHOD"));return}let c=null,l=null;try{const u=yield a({requestId:n,callerIdentity:e,payload:r,responseTimeout:s});Xv(u)>jS?(c=Ye.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(i))):l=u}catch(u){u instanceof Ye?c=u:(console.warn("Uncaught error returned by RPC handler for ".concat(i,". Returning APPLICATION_ERROR instead."),u),c=Ye.builtIn("APPLICATION_ERROR"))}yield this.publishRpcResponse(e,n,l,c)})}publishRpcRequest(e,n,i,r,s){return M(this,void 0,void 0,function*(){const o=new gr({destinationIdentities:[e],kind:Ve.RELIABLE,value:{case:"rpcRequest",value:new Sx({id:n,method:i,payload:r,responseTimeoutMs:s,version:1})}});yield this.engine.sendDataPacket(o,Ve.RELIABLE)})}publishRpcResponse(e,n,i,r){return M(this,void 0,void 0,function*(){const s=new gr({destinationIdentities:[e],kind:Ve.RELIABLE,value:{case:"rpcResponse",value:new Cx({requestId:n,value:r?{case:"error",value:r.toProto()}:{case:"payload",value:i??""}})}});yield this.engine.sendDataPacket(s,Ve.RELIABLE)})}publishRpcAck(e,n){return M(this,void 0,void 0,function*(){const i=new gr({destinationIdentities:[e],kind:Ve.RELIABLE,value:{case:"rpcAck",value:new Ex({requestId:n})}});yield this.engine.sendDataPacket(i,Ve.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:i}]of this.pendingAcks)i===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:i,resolve:r}]of this.pendingResponses)i===e&&(r(null,Ye.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var i,r;const s=this.trackPublications.get(n.sid);if(s){const o=s.isMuted||((r=(i=s.track)===null||i===void 0?void 0:i.isUpstreamPaused)!==null&&r!==void 0?r:!1);o!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Ae(s)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(i=>{const r=i.track;r&&(e instanceof MediaStreamTrack?(r instanceof _t||r instanceof Lt)&&r.mediaStreamTrack===e&&(n=i):e===r&&(n=i))}),n}waitForPendingPublicationOfSource(e){return M(this,void 0,void 0,function*(){const i=Date.now();for(;Date.now()<i+1e4;){const r=Array.from(this.pendingPublishPromises.entries()).find(s=>{let[o]=s;return o.source===e});if(r)return r[1];yield Xn(20)}})}}class _l extends Tr{constructor(e,n,i,r){super(e,n.sid,n.name,r),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=Nn.HIGH,this.handleEnded=s=>{this.setTrack(void 0),this.emit(G.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensions=s,this.emitTrackUpdate()},this.subscribed=i,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,i=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const r=new $f({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Px({participantSid:"",trackSids:[this.trackSid]})]});this.emit(G.UpdateSubscription,r),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(i)}get subscriptionStatus(){return this.subscribed===!1?Tr.SubscriptionStatus.Unsubscribed:super.isSubscribed?Tr.SubscriptionStatus.Subscribed:Tr.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Tr.PermissionStatus.Allowed:Tr.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,i;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((i=this.videoDimensions)===null||i===void 0?void 0:i.height)===e.height||(this.track instanceof jc&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof jc&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,i=this.permissionStatus,r=this.track;r!==e&&(r&&(r.off(G.VideoDimensionsChanged,this.handleVideoDimensionsChange),r.off(G.VisibilityChanged,this.handleVisibilityChange),r.off(G.Ended,this.handleEnded),r.detach(),r.stopMonitor(),this.emit(G.Unsubscribed,r)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(G.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(G.VisibilityChanged,this.handleVisibilityChange),e.on(G.Ended,this.handleEnded),this.emit(G.Subscribed,e)),this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,i=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(G.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?G.Muted:G.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(G.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(G.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===j.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof jc&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Ox({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=Nn.HIGH,this.emit(G.UpdateSettings,e)}}class Nh extends DA{static fromParticipantInfo(e,n,i){return new Nh(e,n.sid,n.identity,n.name,n.metadata,n.attributes,i,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,i,r,s,o,a){let c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:xh.STANDARD;super(n,i||"",r,s,o,a,c),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(G.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Ae(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(G.UpdateSubscription,n=>{n.participantTracks.forEach(i=>{i.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(G.SubscriptionPermissionChanged,n=>{this.emit(V.TrackSubscriptionPermissionChanged,e,n)}),e.on(G.SubscriptionStatusChanged,n=>{this.emit(V.TrackSubscriptionStatusChanged,e,n)}),e.on(G.Subscribed,n=>{this.emit(V.TrackSubscribed,n,e)}),e.on(G.Unsubscribed,n=>{this.emit(V.TrackUnsubscribed,n,e)}),e.on(G.SubscriptionFailed,n=>{this.emit(V.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:j.Source.Microphone;this.volumeMap.set(n,e);const i=this.getTrackPublication(n);i&&i.track&&i.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,i,r,s,o){let a=this.getTrackPublicationBySid(n);if(a||n.startsWith("TR")||this.trackPublications.forEach(u=>{!a&&e.kind===u.kind.toString()&&(a=u)}),!a){if(o===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(V.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,i,r,s,o-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Ae(a))),this.emit(V.TrackSubscriptionFailed,n);return}const c=e.kind==="video";let l;return c?l=new jc(e,n,r,s):l=new Xo(e,n,r,this.audioContext,this.audioOutput),l.source=a.source,l.isMuted=a.isMuted,l.setMediaStream(i),l.start(),a.setTrack(l),this.volumeMap.has(a.source)&&l instanceof Xo&&l.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,i=new Map;return e.tracks.forEach(r=>{var s,o;let a=this.getTrackPublicationBySid(r.sid);if(a)a.updateInfo(r);else{const c=j.kindFromProto(r.type);if(!c)return;a=new _l(c,r,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(o=this.loggerOptions)===null||o===void 0?void 0:o.loggerName}),a.updateInfo(r),i.set(r.sid,a);const l=Array.from(this.trackPublications.values()).find(u=>u.source===(a==null?void 0:a.source));l&&a.source!==j.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Ae(l),newTrack:Ae(a)})),this.addTrackPublication(a)}n.set(r.sid,a)}),this.trackPublications.forEach(r=>{n.has(r.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Ae(r))),this.unpublishTrack(r.trackSid,!0))}),i.forEach(r=>{this.emit(V.TrackPublished,r)}),!0}unpublishTrack(e,n){const i=this.trackPublications.get(e);if(!i)return;const{track:r}=i;switch(r&&(r.stop(),i.setTrack(void 0)),this.trackPublications.delete(e),i.kind){case j.Kind.Audio:this.audioTrackPublications.delete(e);break;case j.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(V.TrackUnpublished,i)}setAudioOutput(e){return M(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(i=>{var r;i.track instanceof Xo&&n.push(i.track.setSinkId((r=e.deviceId)!==null&&r!==void 0?r:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:i})),super.emit(e,...i)}}var pe;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting"})(pe||(pe={}));const Yz=4*1e3;class rr extends xi.EventEmitter{constructor(e){var n,i,r,s;if(super(),n=this,this.state=pe.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=ue,this.bufferedEvents=[],this.isResuming=!1,this.connect=(o,a,c)=>M(this,void 0,void 0,function*(){var l;if(!az())throw ir()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const u=yield this.disconnectLock.lock();if(this.state===pe.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),u(),Promise.resolve();if(this.connectFuture)return u(),this.connectFuture.promise;this.setAndEmitConnectionState(pe.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Gv(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new VS(o,a):this.regionUrlProvider.updateToken(a),this.regionUrlProvider.fetchRegionSettings().then(g=>{var b;(b=this.regionUrlProvider)===null||b===void 0||b.setServerReportedRegions(g)}).catch(g=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:g}))}));const h=(g,b,y)=>M(this,void 0,void 0,function*(){var T,v;this.abortController&&this.abortController.abort();const w=new AbortController;this.abortController=w,u==null||u();try{yield this.attemptConnection(y??o,a,c,w),this.abortController=void 0,g()}catch(S){if(this.regionUrlProvider&&S instanceof Ne&&S.reason!==ke.Cancelled&&S.reason!==ke.NotAllowed){let P=null;try{P=yield this.regionUrlProvider.getNextBestRegionUrl((T=this.abortController)===null||T===void 0?void 0:T.signal)}catch(R){if(R instanceof Ne&&(R.status===401||R.reason===ke.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),b(R);return}}P&&!(!((v=this.abortController)===null||v===void 0)&&v.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(S.message,". Retrying with another region: ").concat(P),this.logContext),this.recreateEngine(),yield h(g,b,P)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,SS(S)),b(S))}else{let P=Gn.UNKNOWN_REASON;S instanceof Ne&&(P=SS(S)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,P),b(S)}}}),f=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new IA((g,b)=>{h(g,b,f)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,a,c,l,u,h)=>M(this,void 0,void 0,function*(){var f,g,b;const y=yield c.join(o,a,{autoSubscribe:l.autoSubscribe,adaptiveStream:typeof u.adaptiveStream=="object"?!0:u.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},h.signal);let T=y.serverInfo;if(T||(T={version:y.serverVersion,region:y.serverRegion}),this.serverInfo=T,this.log.debug("connected to Livekit Server ".concat(Object.entries(T).map(v=>{let[w,S]=v;return"".concat(w,": ").concat(S)}).join(", ")),{room:(f=y.room)===null||f===void 0?void 0:f.name,roomSid:(g=y.room)===null||g===void 0?void 0:g.sid,identity:(b=y.participant)===null||b===void 0?void 0:b.identity}),!T.version)throw new $8("unknown server version");return T.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),u.dynacast=!1),y}),this.applyJoinResponse=o=>{const a=o.participant;if(this.localParticipant.sid=a.sid,this.localParticipant.identity=a.identity,this.localParticipant.setEnabledPublishCodecs(o.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(o.sifTrailer)}catch(c){this.log.error(c instanceof Error?c.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:c}))}this.handleParticipantUpdates([a,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room)},this.attemptConnection=(o,a,c,l)=>M(this,void 0,void 0,function*(){var u,h;this.state===pe.Reconnecting||this.isResuming||!((u=this.engine)===null||u===void 0)&&u.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((h=this.regionUrlProvider)===null||h===void 0)&&h.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},pb),c),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const f=yield this.connectSignal(o,a,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(f),this.setupLocalParticipantEvents(),this.emit(F.SignalConnected)}catch(f){yield this.engine.close(),this.recreateEngine();const g=new Ne("could not establish signal connection",ke.ServerUnreachable);throw f instanceof Error&&(g.message="".concat(g.message,": ").concat(f.message)),f instanceof Ne&&(g.reason=f.reason,g.status=f.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:f})),g}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Ne("Connection attempt aborted",ke.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(f){throw yield this.engine.close(),this.recreateEngine(),f}sn()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),sn()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(pe.Connected),this.emit(F.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return M(n,[...a],void 0,function(){var l=this;let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var h,f,g,b;const y=yield l.disconnectLock.lock();try{if(l.state===pe.Disconnected){l.log.debug("already disconnected",l.logContext);return}l.log.info("disconnect from room",Object.assign({},l.logContext)),(l.state===pe.Connecting||l.state===pe.Reconnecting||l.isResuming)&&(l.log.warn("abort connection attempt",l.logContext),(h=l.abortController)===null||h===void 0||h.abort(),(g=(f=l.connectFuture)===null||f===void 0?void 0:f.reject)===null||g===void 0||g.call(f,new Ne("Client initiated disconnect",ke.Cancelled)),l.connectFuture=void 0),!((b=l.engine)===null||b===void 0)&&b.client.isDisconnected||(yield l.engine.client.sendLeave()),l.engine&&(yield l.engine.close()),l.handleDisconnect(u,Gn.CLIENT_INITIATED),l.engine=void 0}finally{y()}}()})},this.onPageLeave=()=>M(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>M(this,void 0,void 0,function*(){const o=[],a=Ii();if(a&&a.os==="iOS"){const c="livekit-dummy-audio-el";let l=document.getElementById(c);if(!l){l=document.createElement("audio"),l.id=c,l.autoplay=!0,l.hidden=!0;const u=xm();u.enabled=!0;const h=new MediaStream([u]);l.srcObject=h,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:h,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(F.Disconnected,()=>{l==null||l.remove(),l=null})}o.push(l)}this.remoteParticipants.forEach(c=>{c.audioTrackPublications.forEach(l=>{l.track&&l.track.attachedElements.forEach(u=>{o.push(u)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(c=>(c.muted=!1,c.play()))]),this.handleAudioPlaybackStarted()}catch(c){throw this.handleAudioPlaybackFailed(c),c}}),this.startVideo=()=>M(this,void 0,void 0,function*(){const o=[];for(const a of this.remoteParticipants.values())a.videoTrackPublications.forEach(c=>{var l;(l=c.track)===null||l===void 0||l.attachedElements.forEach(u=>{o.includes(u)||o.push(u)})});yield Promise.all(o.map(a=>a.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(a=>{a.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const o of this.remoteParticipants.values())this.handleParticipantDisconnected(o.identity,o);this.setAndEmitConnectionState(pe.Reconnecting)&&this.emit(F.Reconnecting)},this.handleSignalRestarted=o=>M(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(a){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:a}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(pe.Connected),this.emit(F.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(a=>{var c;if(a.identity===this.localParticipant.identity){this.localParticipant.updateInfo(a);return}a.identity===""&&(a.identity=(c=this.sidToIdentity.get(a.sid))!==null&&c!==void 0?c:"");let l=this.remoteParticipants.get(a.identity);a.state===Pv.DISCONNECTED?this.handleParticipantDisconnected(a.identity,l):l=this.getOrCreateParticipant(a.identity,a)})},this.handleActiveSpeakersUpdate=o=>{const a=[],c={};o.forEach(l=>{if(c[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),a.push(this.localParticipant);else{const u=this.getRemoteParticipantBySid(l.sid);u&&(u.audioLevel=l.level,u.setIsSpeaking(!0),a.push(u))}}),c[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(l=>{c[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=a,this.emitWhenConnected(F.ActiveSpeakersChanged,a)},this.handleSpeakersChanged=o=>{const a=new Map;this.activeSpeakers.forEach(l=>{const u=this.remoteParticipants.get(l.identity);u&&u.sid!==l.sid||a.set(l.sid,l)}),o.forEach(l=>{let u=this.getRemoteParticipantBySid(l.sid);l.sid===this.localParticipant.sid&&(u=this.localParticipant),u&&(u.audioLevel=l.level,u.setIsSpeaking(l.active),l.active?a.set(l.sid,u):a.delete(l.sid))});const c=Array.from(a.values());c.sort((l,u)=>u.audioLevel-l.audioLevel),this.activeSpeakers=c,this.emitWhenConnected(F.ActiveSpeakersChanged,c)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(a=>{const c=this.getRemoteParticipantBySid(a.participantSid);if(!c)return;const l=c.getTrackPublicationBySid(a.trackSid);if(!l||!l.track)return;const u=j.streamStateFromProto(a.state);u!==l.track.streamState&&(l.track.streamState=u,c.emit(V.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(F.TrackStreamStateChanged,l,l.track.streamState,c))})},this.handleSubscriptionPermissionUpdate=o=>{const a=this.getRemoteParticipantBySid(o.participantSid);if(!a)return;const c=a.getTrackPublicationBySid(o.trackSid);c&&c.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const a=Array.from(this.remoteParticipants.values()).find(l=>l.trackPublications.has(o.trackSid));if(!a)return;const c=a.getTrackPublicationBySid(o.trackSid);c&&c.setSubscriptionError(o.err)},this.handleDataPacket=o=>{const a=this.remoteParticipants.get(o.participantIdentity);o.value.case==="user"?this.handleUserPacket(a,o.value.value,o.kind):o.value.case==="transcription"?this.handleTranscription(a,o.value.value):o.value.case==="sipDtmf"?this.handleSipDtmf(a,o.value.value):o.value.case==="chatMessage"?this.handleChatMessage(a,o.value.value):o.value.case==="metrics"&&this.handleMetrics(o.value.value,a)},this.handleUserPacket=(o,a,c)=>{this.emit(F.DataReceived,a.payload,o,c,a.topic),o==null||o.emit(V.DataReceived,a.payload,c)},this.handleSipDtmf=(o,a)=>{this.emit(F.SipDTMFReceived,a,o),o==null||o.emit(V.SipDTMFReceived,a)},this.bufferedSegments=new Map,this.handleTranscription=(o,a)=>{const c=a.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(a.transcribedParticipantIdentity),l=c==null?void 0:c.trackPublications.get(a.trackId),u=mz(a,this.transcriptionReceivedTimes);l==null||l.emit(G.TranscriptionReceived,u),c==null||c.emit(V.TranscriptionReceived,u,l),this.emit(F.TranscriptionReceived,u,c,l)},this.handleChatMessage=(o,a)=>{const c=gz(a);this.emit(F.ChatMessage,c,o)},this.handleMetrics=(o,a)=>{this.emit(F.MetricsReceived,o,a)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(F.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(F.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(F.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(F.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>M(this,void 0,void 0,function*(){var o,a;const c=yt.getInstance().previousDevices,l=yield yt.getInstance().getDevices(void 0,!1),u=Ii();if((u==null?void 0:u.name)==="Chrome"&&u.os!=="iOS")for(let f of l){const g=c.find(b=>b.deviceId===f.deviceId);g&&g.label!==""&&g.kind===f.kind&&g.label!==f.label&&this.getActiveDevice(f.kind)==="default"&&this.emit(F.ActiveDeviceChanged,f.kind,f.deviceId)}const h=["audiooutput","audioinput","videoinput"];for(let f of h){const g=l.filter(y=>y.kind===f),b=this.getActiveDevice(f);if(b===((o=c.filter(y=>y.kind===f)[0])===null||o===void 0?void 0:o.deviceId)&&g.length>0&&((a=g[0])===null||a===void 0?void 0:a.deviceId)!==b){yield this.switchActiveDevice(f,g[0].deviceId);continue}f==="audioinput"&&!es()||f==="videoinput"||g.length>0&&!g.find(y=>y.deviceId===this.getActiveDevice(f))&&(yield this.switchActiveDevice(f,g[0].deviceId))}this.emit(F.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const a=this.roomInfo;this.roomInfo=o,a&&a.metadata!==o.metadata&&this.emitWhenConnected(F.RoomMetadataChanged,o.metadata),(a==null?void 0:a.activeRecording)!==o.activeRecording&&this.emitWhenConnected(F.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(a=>{if(a.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(a.quality);return}const c=this.getRemoteParticipantBySid(a.participantSid);c&&c.setConnectionQuality(a.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(F.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(F.ParticipantNameChanged,o,this.localParticipant)},this.onLocalAttributesChanged=o=>{this.emit(F.ParticipantAttributesChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(F.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(F.TrackUnmuted,o,this.localParticipant)},this.onTrackProcessorUpdate=o=>{var a;(a=o==null?void 0:o.onPublish)===null||a===void 0||a.call(o,this)},this.onLocalTrackPublished=o=>M(this,void 0,void 0,function*(){var a,c,l,u,h,f;(a=o.track)===null||a===void 0||a.on(G.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.on(G.Restarted,this.onLocalTrackRestarted),(h=(u=(l=o.track)===null||l===void 0?void 0:l.getProcessor())===null||u===void 0?void 0:u.onPublish)===null||h===void 0||h.call(u,this),this.emit(F.LocalTrackPublished,o,this.localParticipant),o.track instanceof _t&&(yield o.track.checkForSilence())&&this.emit(F.LocalAudioSilenceDetected,o);const g=yield(f=o.track)===null||f===void 0?void 0:f.getDeviceId(!1),b=vS(o.source);b&&g&&g!==this.localParticipant.activeDeviceMap.get(b)&&(this.localParticipant.activeDeviceMap.set(b,g),this.emit(F.ActiveDeviceChanged,b,g))}),this.onLocalTrackUnpublished=o=>{var a,c;(a=o.track)===null||a===void 0||a.off(G.TrackProcessorUpdate,this.onTrackProcessorUpdate),(c=o.track)===null||c===void 0||c.off(G.Restarted,this.onLocalTrackRestarted),this.emit(F.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalTrackRestarted=o=>M(this,void 0,void 0,function*(){const a=yield o.getDeviceId(!1),c=vS(o.source);c&&a&&a!==this.localParticipant.activeDeviceMap.get(c)&&(this.log.debug("local track restarted, setting ".concat(c," ").concat(a," active"),this.logContext),this.localParticipant.activeDeviceMap.set(c,a),this.emit(F.ActiveDeviceChanged,c,a))}),this.onLocalConnectionQualityChanged=o=>{this.emit(F.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(F.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(F.ParticipantPermissionsChanged,o,this.localParticipant)},this.onLocalChatMessageSent=o=>{this.emit(F.ChatMessage,o,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},xz),e),this.log=nr((i=this.options.loggerName)!==null&&i!==void 0?i:ti.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},PA),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},RA),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Rz),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new rn,this.localParticipant=new BS("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Us(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Us(this.options.audioCaptureDefaults.deviceId)),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&this.switchActiveDevice("audiooutput",Us(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),sn()){const o=new AbortController;(s=navigator.mediaDevices)===null||s===void 0||s.addEventListener("devicechange",this.handleDeviceChange,{signal:o.signal}),rr.cleanupRegistry&&rr.cleanupRegistry.register(this,()=>{o.abort()})}}setE2EEEnabled(e){return M(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new yz(this.options.e2ee),this.e2eeManager.on(Nr.ParticipantEncryptionStatusChanged,(n,i)=>{i instanceof BS&&(this.isE2EEEnabled=n),this.emit(F.ParticipantEncryptionStatusChanged,n,i)}),this.e2eeManager.on(Nr.EncryptionError,n=>this.emit(F.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return M(this,void 0,void 0,function*(){return this.state===pe.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const i=r=>{r.sid!==""&&(this.engine.off(Y.RoomUpdate,i),e(r.sid))};this.engine.on(Y.RoomUpdate,i),this.once(F.Disconnected,()=>{this.engine.off(Y.RoomUpdate,i),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new qz(this.options),this.engine.on(Y.ParticipantUpdate,this.handleParticipantUpdates).on(Y.RoomUpdate,this.handleRoomUpdate).on(Y.SpeakersChanged,this.handleSpeakersChanged).on(Y.StreamStateChanged,this.handleStreamStateUpdate).on(Y.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Y.SubscriptionError,this.handleSubscriptionError).on(Y.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Y.MediaTrackAdded,(e,n,i)=>{this.onTrackAdded(e,n,i)}).on(Y.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Y.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Y.DataPacketReceived,this.handleDataPacket).on(Y.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(pe.SignalReconnecting)&&this.emit(F.SignalReconnecting)}).on(Y.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(pe.Connected)&&this.emit(F.Reconnected)}).on(Y.SignalResumed,()=>{this.bufferedEvents=[],(this.state===pe.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(Y.Restarting,this.handleRestarting).on(Y.SignalRestarted,this.handleSignalRestarted).on(Y.Offline,()=>{this.setAndEmitConnectionState(pe.Reconnecting)&&this.emit(F.Reconnecting)}).on(Y.DCBufferStatusChanged,(e,n)=>{this.emit(F.DCBufferStatusChanged,e,n)}).on(Y.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(i=>{let{trackSid:r}=i;return r===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(V.LocalTrackSubscribed,n),this.emitWhenConnected(F.LocalTrackSubscribed,n,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return yt.getInstance().getDevices(e,n)}prepareConnection(e,n){return M(this,void 0,void 0,function*(){if(this.state===pe.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Gv(new URL(e))&&n){this.regionUrlProvider=new VS(e,n);const i=yield this.regionUrlProvider.getNextBestRegionUrl();i&&this.state===pe.Disconnected&&(this.regionUrl=i,yield fetch(_S(i),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(i),this.logContext))}else yield fetch(_S(e),{method:"HEAD"})}catch(i){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:i}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return M(this,void 0,void 0,function*(){let i=()=>{},r;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":r=new hi({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":r=new hi({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":r=new hi({scenario:{case:"serverLeave",value:!0}});break;case"migration":r=new hi({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>M(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),r=new hi({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>M(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),r=new hi({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":r=new hi({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),i=()=>M(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new Bf({reason:Gn.CLIENT_INITIATED,action:Go.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");r=new hi({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break;case"leave-full-reconnect":r=new hi({scenario:{case:"leaveRequestFullReconnect",value:!0}})}r&&(yield this.engine.client.sendSimulateScenario(r),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return M(this,arguments,void 0,function(i,r){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var a,c,l,u,h,f,g;let b=!0,y=!1;const T=o?{exact:r}:r;if(i==="audioinput"){y=s.localParticipant.audioTrackPublications.size===0;const v=(a=s.getActiveDevice(i))!==null&&a!==void 0?a:s.options.audioCaptureDefaults.deviceId;s.options.audioCaptureDefaults.deviceId=T;const w=Array.from(s.localParticipant.audioTrackPublications.values()).filter(S=>S.source===j.Source.Microphone);try{b=(yield Promise.all(w.map(S=>{var P;return(P=S.audioTrack)===null||P===void 0?void 0:P.setDeviceId(T)}))).every(S=>S===!0)}catch(S){throw s.options.audioCaptureDefaults.deviceId=v,S}}else if(i==="videoinput"){y=s.localParticipant.videoTrackPublications.size===0;const v=(c=s.getActiveDevice(i))!==null&&c!==void 0?c:s.options.videoCaptureDefaults.deviceId;s.options.videoCaptureDefaults.deviceId=T;const w=Array.from(s.localParticipant.videoTrackPublications.values()).filter(S=>S.source===j.Source.Camera);try{b=(yield Promise.all(w.map(S=>{var P;return(P=S.videoTrack)===null||P===void 0?void 0:P.setDeviceId(T)}))).every(S=>S===!0)}catch(S){throw s.options.videoCaptureDefaults.deviceId=v,S}}else if(i==="audiooutput"){if(!Kv()&&!s.options.webAudioMix||s.options.webAudioMix&&s.audioContext&&!("setSinkId"in s.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");s.options.webAudioMix&&(r=(l=yield yt.getInstance().normalizeDeviceId("audiooutput",r))!==null&&l!==void 0?l:""),(u=(g=s.options).audioOutput)!==null&&u!==void 0||(g.audioOutput={});const v=(h=s.getActiveDevice(i))!==null&&h!==void 0?h:s.options.audioOutput.deviceId;s.options.audioOutput.deviceId=r;try{s.options.webAudioMix&&((f=s.audioContext)===null||f===void 0||f.setSinkId(r)),yield Promise.all(Array.from(s.remoteParticipants.values()).map(w=>w.setAudioOutput({deviceId:r})))}catch(w){throw s.options.audioOutput.deviceId=v,w}}return y&&(s.localParticipant.activeDeviceMap.set(i,r),s.emit(F.ActiveDeviceChanged,i,r)),b}()})}setupLocalParticipantEvents(){this.localParticipant.on(V.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(V.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(V.AttributesChanged,this.onLocalAttributesChanged).on(V.TrackMuted,this.onLocalTrackMuted).on(V.TrackUnmuted,this.onLocalTrackUnmuted).on(V.LocalTrackPublished,this.onLocalTrackPublished).on(V.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(V.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(V.MediaDevicesError,this.onMediaDevicesError).on(V.AudioStreamAcquired,this.startAudio).on(V.ChatMessage,this.onLocalChatMessageSent).on(V.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,i){if(this.state===pe.Connecting||this.state===pe.Reconnecting){const u=()=>{this.onTrackAdded(e,n,i),h()},h=()=>{this.off(F.Reconnected,u),this.off(F.Connected,u),this.off(F.Disconnected,h)};this.once(F.Reconnected,u),this.once(F.Connected,u),this.once(F.Disconnected,h);return}if(this.state===pe.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const r=rz(n.id),s=r[0];let o=r[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const c=Array.from(this.remoteParticipants.values()).find(u=>u.sid===s);if(!c){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}let l;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?l=this.options.adaptiveStream:l={}),c.addSubscribedMediaTrack(e,a,n,i,l)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var i;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==pe.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(r=>{r.trackPublications.forEach(s=>{r.unpublishTrack(s.trackSid)})}),this.localParticipant.trackPublications.forEach(r=>{var s,o,a;r.track&&this.localParticipant.unpublishTrack(r.track,e),e?((s=r.track)===null||s===void 0||s.detach(),(o=r.track)===null||o===void 0||o.stop()):(a=r.track)===null||a===void 0||a.stopMonitor()}),this.localParticipant.off(V.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(V.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(V.AttributesChanged,this.onLocalAttributesChanged).off(V.TrackMuted,this.onLocalTrackMuted).off(V.TrackUnmuted,this.onLocalTrackUnmuted).off(V.LocalTrackPublished,this.onLocalTrackPublished).off(V.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(V.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(V.MediaDevicesError,this.onMediaDevicesError).off(V.AudioStreamAcquired,this.startAudio).off(V.ChatMessage,this.onLocalChatMessageSent).off(V.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),sn()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(i=navigator.mediaDevices)===null||i===void 0||i.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(pe.Disconnected),this.emit(F.Disconnected,n)}}}handleParticipantDisconnected(e,n){var i;this.remoteParticipants.delete(e),n&&(n.trackPublications.forEach(r=>{n.unpublishTrack(r.trackSid,!0)}),this.emit(F.ParticipantDisconnected,n),(i=this.localParticipant)===null||i===void 0||i.handleParticipantDisconnected(n.identity))}acquireAudioContext(){return M(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=_A())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(r){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:r}))}this.options.webAudioMix&&this.remoteParticipants.forEach(r=>r.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const i=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";i!==this.canPlaybackAudio&&(this.audioEnabled=i,this.emit(F.AudioPlaybackStatusChanged,i))})}createParticipant(e,n){var i;let r;return n?r=Nh.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):r=new Nh(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&r.setAudioContext(this.audioContext),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&r.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),r}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const r=this.remoteParticipants.get(e);return n&&r.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),r}const i=this.createParticipant(e,n);return this.remoteParticipants.set(e,i),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(F.ParticipantConnected,i),i.on(V.TrackPublished,r=>{this.emitWhenConnected(F.TrackPublished,r,i)}).on(V.TrackSubscribed,(r,s)=>{r.kind===j.Kind.Audio?(r.on(G.AudioPlaybackStarted,this.handleAudioPlaybackStarted),r.on(G.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):r.kind===j.Kind.Video&&(r.on(G.VideoPlaybackFailed,this.handleVideoPlaybackFailed),r.on(G.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(F.TrackSubscribed,r,s,i)}).on(V.TrackUnpublished,r=>{this.emit(F.TrackUnpublished,r,i)}).on(V.TrackUnsubscribed,(r,s)=>{this.emit(F.TrackUnsubscribed,r,s,i)}).on(V.TrackSubscriptionFailed,r=>{this.emit(F.TrackSubscriptionFailed,r,i)}).on(V.TrackMuted,r=>{this.emitWhenConnected(F.TrackMuted,r,i)}).on(V.TrackUnmuted,r=>{this.emitWhenConnected(F.TrackUnmuted,r,i)}).on(V.ParticipantMetadataChanged,r=>{this.emitWhenConnected(F.ParticipantMetadataChanged,r,i)}).on(V.ParticipantNameChanged,r=>{this.emitWhenConnected(F.ParticipantNameChanged,r,i)}).on(V.AttributesChanged,r=>{this.emitWhenConnected(F.ParticipantAttributesChanged,r,i)}).on(V.ConnectionQualityChanged,r=>{this.emitWhenConnected(F.ConnectionQualityChanged,r,i)}).on(V.ParticipantPermissionsChanged,r=>{this.emitWhenConnected(F.ParticipantPermissionsChanged,r,i)}).on(V.TrackSubscriptionStatusChanged,(r,s)=>{this.emitWhenConnected(F.TrackSubscriptionStatusChanged,r,s,i)}).on(V.TrackSubscriptionFailed,(r,s)=>{this.emit(F.TrackSubscriptionFailed,r,i,s)}).on(V.TrackSubscriptionPermissionChanged,(r,s)=>{this.emitWhenConnected(F.TrackSubscriptionPermissionChanged,r,s,i)}),n&&i.updateInfo(n),i}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((i,r)=>(i.push(...r.getTrackPublications()),i),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&n instanceof _l&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Et.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Gn.STATE_MISMATCH))):e=0},Yz)}clearConnectionReconcile(){this.connectionReconcileInterval&&Et.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(F.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,i]=e;this.emit(n,...i)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if(this.state===pe.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,i]);else if(this.state===pe.Connected)return this.emit(e,...i);return!1}simulateParticipants(e){return M(this,void 0,void 0,function*(){var n,i;const r=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new nb({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:qe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new bl({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(F.SignalConnected),this.emit(F.Connected),this.setAndEmitConnectionState(pe.Connected),r.video){const o=new wl(j.Kind.Video,new Do({source:Mt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO,name:"video-dummy"}),new Lt(r.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:wS(160*((n=s.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(V.LocalTrackPublished,o)}if(r.audio){const o=new wl(j.Kind.Audio,new Do({source:Mt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO}),new _t(r.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:xm(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(V.LocalTrackPublished,o)}for(let o=0;o<s.count-1;o+=1){let a=new bl({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:Pv.ACTIVE,tracks:[],joinedAt:qe.parse(Date.now())});const c=this.getOrCreateParticipant(a.identity,a);if(s.video){const l=wS(160*((i=s.aspectRatios[o%s.aspectRatios.length])!==null&&i!==void 0?i:1),160,!1,!0),u=new Do({source:Mt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l]),new RTCRtpReceiver),a.tracks=[...a.tracks,u]}if(s.audio){const l=xm(),u=new Do({source:Mt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Wn.AUDIO});c.addSubscribedMediaTrack(l,u.sid,new MediaStream([l]),new RTCRtpReceiver),a.tracks=[...a.tracks,u]}c.updateInfo(a)}})}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if(e!==F.ActiveSpeakersChanged){const s=LA(i).filter(o=>o!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s}))}return super.emit(e,...i)}}rr.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{t()});function LA(t){return t.map(e=>{if(e)return Array.isArray(e)?LA(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var qn;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(qn||(qn={}));class Da extends xi.EventEmitter{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=qn.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new rr(i.roomOptions),this.connectOptions=i.connectOptions,i.errorsAsWarnings&&(this.errorsAsWarnings=i.errorsAsWarnings)}run(e){return M(this,void 0,void 0,function*(){if(this.status!==qn.IDLE)throw Error("check is running already");this.setStatus(qn.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==qn.SKIPPED&&this.setStatus(this.isSuccess()?qn.SUCCESS:qn.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return M(this,void 0,void 0,function*(){return this.room.state===pe.Connected?this.room:(yield this.room.connect(this.url,this.token,this.connectOptions),this.room)})}disconnect(){return M(this,void 0,void 0,function*(){this.room&&this.room.state!==pe.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(qn.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function gb(t){return M(this,void 0,void 0,function*(){var e,n;t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio={deviceId:"default"}),(n=t.video)!==null&&n!==void 0||(t.video={deviceId:"default"});const{audioProcessor:i,videoProcessor:r}=db(t),s=wA(t,PA,RA),o=qf(s),a=navigator.mediaDevices.getUserMedia(o);t.audio&&(yt.userMediaPromiseMap.set("audioinput",a),a.catch(()=>yt.userMediaPromiseMap.delete("audioinput"))),t.video&&(yt.userMediaPromiseMap.set("videoinput",a),a.catch(()=>yt.userMediaPromiseMap.delete("videoinput")));const c=yield a;return Promise.all(c.getTracks().map(l=>M(this,void 0,void 0,function*(){const u=l.kind==="audio";u?s.audio:s.video;let h;const f=u?o.audio:o.video;typeof f!="boolean"&&(h=f),h?h.deviceId=l.getSettings().deviceId:h={deviceId:l.getSettings().deviceId};const g=xA(l,h);return g.kind===j.Kind.Video?g.source=j.Source.Camera:g.kind===j.Kind.Audio&&(g.source=j.Source.Microphone),g.mediaStream=c,g instanceof _t&&i?yield g.setProcessor(i):g instanceof Lt&&r&&(yield g.setProcessor(r)),g})))})}function Xz(t){return M(this,void 0,void 0,function*(){return(yield gb({audio:!1,video:t}))[0]})}function Zz(t){return M(this,void 0,void 0,function*(){return(yield gb({audio:t,video:!1}))[0]})}class eq extends Da{get description(){return"Can publish audio"}perform(){return M(this,void 0,void 0,function*(){var e;const n=yield this.connect(),i=yield Zz();n.localParticipant.publishTrack(i),yield new Promise(o=>setTimeout(o,3e3));const r=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!r)throw new Error("Could not get RTCStats");let s=0;if(r.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="audio"||!o.kind&&o.mediaType==="audio")&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class tq extends Da{get description(){return"Can publish video"}perform(){return M(this,void 0,void 0,function*(){var e;const n=yield this.connect(),i=yield Xz();n.localParticipant.publishTrack(i),yield new Promise(o=>setTimeout(o,5e3));const r=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!r)throw new Error("Could not get RTCStats");let s=0;if(r.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="video"||!o.kind&&o.mediaType==="video")&&(s+=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class nq extends Da{get description(){return"Resuming connection after interruption"}perform(){return M(this,void 0,void 0,function*(){var e;const n=yield this.connect();let i=!1,r=!1,s;const o=new Promise(l=>{setTimeout(l,5e3),s=l}),a=()=>{i=!0};n.on(F.SignalReconnecting,a).on(F.Reconnecting,a).on(F.Reconnected,()=>{r=!0,s(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const c=n.engine.client.onClose;if(c&&c(""),yield o,i){if(!r||n.state!==pe.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class iq extends Da{get description(){return"Can connect via TURN"}perform(){return M(this,void 0,void 0,function*(){var e,n;const i=new hb,r=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,o=!1,a=!1;for(let c of r.iceServers)for(let l of c.urls)l.startsWith("turn:")?(o=!0,a=!0):l.startsWith("turns:")&&(o=!0,a=!0,s=!0),l.startsWith("stun:")&&(a=!0);a?o&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield i.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(c=>setTimeout(c,0)))})}}class rq extends Da{get description(){return"Establishing WebRTC connection"}perform(){return M(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(F.SignalConnected,()=>{const i=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(r,s)=>{if(r.candidate){const o=new RTCIceCandidate(r);let a="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&(sq(o.address)?a+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,a+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(a)}i&&i(r,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=r=>{r instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(r.errorCode," ").concat(r.errorText," ").concat(r.url))})});try{yield this.connect(),ue.info("now the room is connected")}catch(i){throw this.appendWarning("ports need to be open on firewall in order to connect."),i}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function sq(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class oq extends Da{get description(){return"Connecting to signal connection via WebSocket"}perform(){return M(this,void 0,void 0,function*(){var e,n,i;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let r=new hb;const s=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===Rx.Cloud&&(!((n=s.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((i=s.serverInfo)===null||i===void 0?void 0:i.region)),yield r.close()})}}class ZQ extends xi.EventEmitter{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=i}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:qn.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==qn.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return M(this,void 0,void 0,function*(){const n=this.getNextCheckId(),i=new e(this.url,this.token,this.options),r=o=>{this.updateCheck(n,o)};i.on("update",r);const s=yield i.run();return i.off("update",r),s})}checkWebsocket(){return M(this,void 0,void 0,function*(){return this.createAndRunCheck(oq)})}checkWebRTC(){return M(this,void 0,void 0,function*(){return this.createAndRunCheck(rq)})}checkTURN(){return M(this,void 0,void 0,function*(){return this.createAndRunCheck(iq)})}checkReconnect(){return M(this,void 0,void 0,function*(){return this.createAndRunCheck(nq)})}checkPublishAudio(){return M(this,void 0,void 0,function*(){return this.createAndRunCheck(eq)})}checkPublishVideo(){return M(this,void 0,void 0,function*(){return this.createAndRunCheck(tq)})}}function MA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const i=t instanceof Fs?t.mediaStreamTrack:t,r=i.getSettings();let s={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in r){const o=r.facingMode;ue.trace("rawFacingMode",{rawFacingMode:o}),o&&typeof o=="string"&&lq(o)&&(s={facingMode:o,confidence:"high"})}if(["low","medium"].includes(s.confidence)){ue.trace("Try to get facing mode from device label: (".concat(i.label,")"));const o=cq(i.label);o!==void 0&&(s=o)}return s}const zS=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),aq=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function cq(t){var e;const n=t.trim().toLowerCase();if(n!=="")return zS.has(n)?zS.get(n):(e=Array.from(aq.entries()).find(i=>{let[r]=i;return n.includes(r)}))===null||e===void 0?void 0:e[1]}function lq(t){return t===void 0||["user","environment","left","right"].includes(t)}const ey=Math.min,Zo=Math.max,Oh=Math.round,ts=t=>({x:t,y:t}),uq={left:"right",right:"left",bottom:"top",top:"bottom"},dq={start:"end",end:"start"};function qS(t,e,n){return Zo(t,ey(e,n))}function Wf(t,e){return typeof t=="function"?t(e):t}function Xs(t){return t.split("-")[0]}function Kf(t){return t.split("-")[1]}function UA(t){return t==="x"?"y":"x"}function FA(t){return t==="y"?"height":"width"}function Gf(t){return["top","bottom"].includes(Xs(t))?"y":"x"}function VA(t){return UA(Gf(t))}function hq(t,e,n){n===void 0&&(n=!1);const i=Kf(t),r=VA(t),s=FA(r);let o=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Dh(o)),[o,Dh(o)]}function fq(t){const e=Dh(t);return[ty(t),e,ty(e)]}function ty(t){return t.replace(/start|end/g,e=>dq[e])}function pq(t,e,n){const i=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:i:e?i:r;case"left":case"right":return e?s:o;default:return[]}}function mq(t,e,n,i){const r=Kf(t);let s=pq(Xs(t),n==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(ty)))),s}function Dh(t){return t.replace(/left|right|bottom|top/g,e=>uq[e])}function gq(t){return{top:0,right:0,bottom:0,left:0,...t}}function vq(t){return typeof t!="number"?gq(t):{top:t,right:t,bottom:t,left:t}}function Lh(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function HS(t,e,n){let{reference:i,floating:r}=t;const s=Gf(e),o=VA(e),a=FA(o),c=Xs(e),l=s==="y",u=i.x+i.width/2-r.width/2,h=i.y+i.height/2-r.height/2,f=i[a]/2-r[a]/2;let g;switch(c){case"top":g={x:u,y:i.y-r.height};break;case"bottom":g={x:u,y:i.y+i.height};break;case"right":g={x:i.x+i.width,y:h};break;case"left":g={x:i.x-r.width,y:h};break;default:g={x:i.x,y:i.y}}switch(Kf(e)){case"start":g[o]-=f*(n&&l?-1:1);break;case"end":g[o]+=f*(n&&l?-1:1);break}return g}const yq=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:h}=HS(l,i,c),f=i,g={},b=0;for(let y=0;y<a.length;y++){const{name:T,fn:v}=a[y],{x:w,y:S,data:P,reset:R}=await v({x:u,y:h,initialPlacement:i,placement:f,strategy:r,middlewareData:g,rects:l,platform:o,elements:{reference:t,floating:e}});u=w??u,h=S??h,g={...g,[T]:{...g[T],...P}},R&&b<=50&&(b++,typeof R=="object"&&(R.placement&&(f=R.placement),R.rects&&(l=R.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):R.rects),{x:u,y:h}=HS(l,f,c)),y=-1)}return{x:u,y:h,placement:f,strategy:r,middlewareData:g}};async function jA(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:g=0}=Wf(e,t),b=vq(g),y=a[f?h==="floating"?"reference":"floating":h],T=Lh(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(y)))==null||n?y:y.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v=h==="floating"?{...o.floating,x:i,y:r}:o.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),S=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},P=Lh(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:w,strategy:c}):v);return{top:(T.top-P.top+b.top)/S.y,bottom:(P.bottom-T.bottom+b.bottom)/S.y,left:(T.left-P.left+b.left)/S.x,right:(P.right-T.right+b.right)/S.x}}const bq=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:y=!0,...T}=Wf(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const v=Xs(r),w=Xs(a)===a,S=await(c.isRTL==null?void 0:c.isRTL(l.floating)),P=f||(w||!y?[Dh(a)]:fq(a));!f&&b!=="none"&&P.push(...mq(a,y,b,S));const R=[a,...P],O=await jA(e,T),E=[];let _=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&E.push(O[v]),h){const L=hq(r,o,S);E.push(O[L[0]],O[L[1]])}if(_=[..._,{placement:r,overflows:E}],!E.every(L=>L<=0)){var C,x;const L=(((C=s.flip)==null?void 0:C.index)||0)+1,D=R[L];if(D)return{data:{index:L,overflows:_},reset:{placement:D}};let le=(x=_.filter(ge=>ge.overflows[0]<=0).sort((ge,$e)=>ge.overflows[1]-$e.overflows[1])[0])==null?void 0:x.placement;if(!le)switch(g){case"bestFit":{var A;const ge=(A=_.map($e=>[$e.placement,$e.overflows.filter(fe=>fe>0).reduce((fe,W)=>fe+W,0)]).sort(($e,fe)=>$e[1]-fe[1])[0])==null?void 0:A[0];ge&&(le=ge);break}case"initialPlacement":le=a;break}if(r!==le)return{reset:{placement:le}}}return{}}}};async function Tq(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=Xs(n),a=Kf(n),c=Gf(n)==="y",l=["left","top"].includes(o)?-1:1,u=s&&c?-1:1,h=Wf(e,t);let{mainAxis:f,crossAxis:g,alignmentAxis:b}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return a&&typeof b=="number"&&(g=a==="end"?b*-1:b),c?{x:g*u,y:f*l}:{x:f*l,y:g*u}}const kq=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:o,middlewareData:a}=e,c=await Tq(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+c.x,y:s+c.y,data:{...c,placement:o}}}}},wq=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:T=>{let{x:v,y:w}=T;return{x:v,y:w}}},...c}=Wf(t,e),l={x:n,y:i},u=await jA(e,c),h=Gf(Xs(r)),f=UA(h);let g=l[f],b=l[h];if(s){const T=f==="y"?"top":"left",v=f==="y"?"bottom":"right",w=g+u[T],S=g-u[v];g=qS(w,g,S)}if(o){const T=h==="y"?"top":"left",v=h==="y"?"bottom":"right",w=b+u[T],S=b-u[v];b=qS(w,b,S)}const y=a.fn({...e,[f]:g,[h]:b});return{...y,data:{x:y.x-n,y:y.y-i}}}}};function Qf(){return typeof window<"u"}function La(t){return $A(t)?(t.nodeName||"").toLowerCase():"#document"}function _n(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ar(t){var e;return(e=($A(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function $A(t){return Qf()?t instanceof Node||t instanceof _n(t).Node:!1}function ni(t){return Qf()?t instanceof Element||t instanceof _n(t).Element:!1}function Pi(t){return Qf()?t instanceof HTMLElement||t instanceof _n(t).HTMLElement:!1}function WS(t){return!Qf()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof _n(t).ShadowRoot}function Kl(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=ii(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(r)}function _q(t){return["table","td","th"].includes(La(t))}function Jf(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function vb(t){const e=yb(),n=ni(t)?ii(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function Sq(t){let e=ns(t);for(;Pi(e)&&!ba(e);){if(vb(e))return e;if(Jf(e))return null;e=ns(e)}return null}function yb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ba(t){return["html","body","#document"].includes(La(t))}function ii(t){return _n(t).getComputedStyle(t)}function Yf(t){return ni(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ns(t){if(La(t)==="html")return t;const e=t.assignedSlot||t.parentNode||WS(t)&&t.host||ar(t);return WS(e)?e.host:e}function BA(t){const e=ns(t);return ba(e)?t.ownerDocument?t.ownerDocument.body:t.body:Pi(e)&&Kl(e)?e:BA(e)}function ny(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=BA(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),o=_n(r);if(s){const a=iy(o);return e.concat(o,o.visualViewport||[],Kl(r)?r:[],a&&n?ny(a):[])}return e.concat(r,ny(r,[],n))}function iy(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function zA(t){const e=ii(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Pi(t),s=r?t.offsetWidth:n,o=r?t.offsetHeight:i,a=Oh(n)!==s||Oh(i)!==o;return a&&(n=s,i=o),{width:n,height:i,$:a}}function qA(t){return ni(t)?t:t.contextElement}function ea(t){const e=qA(t);if(!Pi(e))return ts(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=zA(e);let o=(s?Oh(n.width):n.width)/i,a=(s?Oh(n.height):n.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Eq=ts(0);function HA(t){const e=_n(t);return!yb()||!e.visualViewport?Eq:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Cq(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==_n(t)?!1:e}function Sl(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=qA(t);let o=ts(1);e&&(i?ni(i)&&(o=ea(i)):o=ea(t));const a=Cq(s,n,i)?HA(s):ts(0);let c=(r.left+a.x)/o.x,l=(r.top+a.y)/o.y,u=r.width/o.x,h=r.height/o.y;if(s){const f=_n(s),g=i&&ni(i)?_n(i):i;let b=f,y=iy(b);for(;y&&i&&g!==b;){const T=ea(y),v=y.getBoundingClientRect(),w=ii(y),S=v.left+(y.clientLeft+parseFloat(w.paddingLeft))*T.x,P=v.top+(y.clientTop+parseFloat(w.paddingTop))*T.y;c*=T.x,l*=T.y,u*=T.x,h*=T.y,c+=S,l+=P,b=_n(y),y=iy(b)}}return Lh({width:u,height:h,x:c,y:l})}function Iq(t){let{elements:e,rect:n,offsetParent:i,strategy:r}=t;const s=r==="fixed",o=ar(i),a=e?Jf(e.floating):!1;if(i===o||a&&s)return n;let c={scrollLeft:0,scrollTop:0},l=ts(1);const u=ts(0),h=Pi(i);if((h||!h&&!s)&&((La(i)!=="body"||Kl(o))&&(c=Yf(i)),Pi(i))){const f=Sl(i);l=ea(i),u.x=f.x+i.clientLeft,u.y=f.y+i.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function Pq(t){return Array.from(t.getClientRects())}function ry(t,e){const n=Yf(t).scrollLeft;return e?e.left+n:Sl(ar(t)).left+n}function Rq(t){const e=ar(t),n=Yf(t),i=t.ownerDocument.body,r=Zo(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=Zo(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+ry(t);const a=-n.scrollTop;return ii(i).direction==="rtl"&&(o+=Zo(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function xq(t,e){const n=_n(t),i=ar(t),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,c=0;if(r){s=r.width,o=r.height;const l=yb();(!l||l&&e==="fixed")&&(a=r.offsetLeft,c=r.offsetTop)}return{width:s,height:o,x:a,y:c}}function Aq(t,e){const n=Sl(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=Pi(t)?ea(t):ts(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,c=r*s.x,l=i*s.y;return{width:o,height:a,x:c,y:l}}function KS(t,e,n){let i;if(e==="viewport")i=xq(t,n);else if(e==="document")i=Rq(ar(t));else if(ni(e))i=Aq(e,n);else{const r=HA(t);i={...e,x:e.x-r.x,y:e.y-r.y}}return Lh(i)}function WA(t,e){const n=ns(t);return n===e||!ni(n)||ba(n)?!1:ii(n).position==="fixed"||WA(n,e)}function Nq(t,e){const n=e.get(t);if(n)return n;let i=ny(t,[],!1).filter(a=>ni(a)&&La(a)!=="body"),r=null;const s=ii(t).position==="fixed";let o=s?ns(t):t;for(;ni(o)&&!ba(o);){const a=ii(o),c=vb(o);!c&&a.position==="fixed"&&(r=null),(s?!c&&!r:!c&&a.position==="static"&&r&&["absolute","fixed"].includes(r.position)||Kl(o)&&!c&&WA(t,o))?i=i.filter(l=>l!==o):r=a,o=ns(o)}return e.set(t,i),i}function Oq(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const s=[...n==="clippingAncestors"?Jf(e)?[]:Nq(e,this._c):[].concat(n),i],o=s[0],a=s.reduce((c,l)=>{const u=KS(e,l,r);return c.top=Zo(u.top,c.top),c.right=ey(u.right,c.right),c.bottom=ey(u.bottom,c.bottom),c.left=Zo(u.left,c.left),c},KS(e,o,r));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function Dq(t){const{width:e,height:n}=zA(t);return{width:e,height:n}}function Lq(t,e,n){const i=Pi(e),r=ar(e),s=n==="fixed",o=Sl(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const c=ts(0);if(i||!i&&!s)if((La(e)!=="body"||Kl(r))&&(a=Yf(e)),i){const g=Sl(e,!0,s,e);c.x=g.x+e.clientLeft,c.y=g.y+e.clientTop}else r&&(c.x=ry(r));let l=0,u=0;if(r&&!i&&!s){const g=r.getBoundingClientRect();u=g.top+a.scrollTop,l=g.left+a.scrollLeft-ry(r,g)}const h=o.left+a.scrollLeft-c.x-l,f=o.top+a.scrollTop-c.y-u;return{x:h,y:f,width:o.width,height:o.height}}function Fm(t){return ii(t).position==="static"}function GS(t,e){if(!Pi(t)||ii(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return ar(t)===n&&(n=n.ownerDocument.body),n}function KA(t,e){const n=_n(t);if(Jf(t))return n;if(!Pi(t)){let r=ns(t);for(;r&&!ba(r);){if(ni(r)&&!Fm(r))return r;r=ns(r)}return n}let i=GS(t,e);for(;i&&_q(i)&&Fm(i);)i=GS(i,e);return i&&ba(i)&&Fm(i)&&!vb(i)?n:i||Sq(t)||n}const Mq=async function(t){const e=this.getOffsetParent||KA,n=this.getDimensions,i=await n(t.floating);return{reference:Lq(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Uq(t){return ii(t).direction==="rtl"}const Fq={convertOffsetParentRelativeRectToViewportRelativeRect:Iq,getDocumentElement:ar,getClippingRect:Oq,getOffsetParent:KA,getElementRects:Mq,getClientRects:Pq,getDimensions:Dq,getScale:ea,isElement:ni,isRTL:Uq},Vq=kq,jq=wq,$q=bq,Bq=(t,e,n)=>{const i=new Map,r={platform:Fq,...n},s={...r.platform,_c:i};return yq(t,e,{...r,platform:s})};var Tc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function GA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var QA={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(Tc,function(){var e=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],s={},o=null;function a(y,T){var v=y[T];if(typeof v.bind=="function")return v.bind(y);try{return Function.prototype.bind.call(v,y)}catch{return function(){return Function.prototype.apply.apply(v,[y,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(y){return y==="debug"&&(y="log"),typeof console===n?!1:y==="trace"&&i?c:console[y]!==void 0?a(console,y):console.log!==void 0?a(console,"log"):e}function u(){for(var y=this.getLevel(),T=0;T<r.length;T++){var v=r[T];this[v]=T<y?e:this.methodFactory(v,y,this.name)}if(this.log=this.debug,typeof console===n&&y<this.levels.SILENT)return"No console available for logging"}function h(y){return function(){typeof console!==n&&(u.call(this),this[y].apply(this,arguments))}}function f(y,T,v){return l(y)||h.apply(this,arguments)}function g(y,T){var v=this,w,S,P,R="loglevel";typeof y=="string"?R+=":"+y:typeof y=="symbol"&&(R=void 0);function O(A){var L=(r[A]||"silent").toUpperCase();if(!(typeof window===n||!R)){try{window.localStorage[R]=L;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+L+";"}catch{}}}function E(){var A;if(!(typeof window===n||!R)){try{A=window.localStorage[R]}catch{}if(typeof A===n)try{var L=window.document.cookie,D=encodeURIComponent(R),le=L.indexOf(D+"=");le!==-1&&(A=/^([^;]+)/.exec(L.slice(le+D.length+1))[1])}catch{}return v.levels[A]===void 0&&(A=void 0),A}}function _(){if(!(typeof window===n||!R)){try{window.localStorage.removeItem(R)}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function C(A){var L=A;if(typeof L=="string"&&v.levels[L.toUpperCase()]!==void 0&&(L=v.levels[L.toUpperCase()]),typeof L=="number"&&L>=0&&L<=v.levels.SILENT)return L;throw new TypeError("log.setLevel() called with invalid level: "+A)}v.name=y,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=T||f,v.getLevel=function(){return P??S??w},v.setLevel=function(A,L){return P=C(A),L!==!1&&O(P),u.call(v)},v.setDefaultLevel=function(A){S=C(A),E()||v.setLevel(A,!1)},v.resetLevel=function(){P=null,_(),u.call(v)},v.enableAll=function(A){v.setLevel(v.levels.TRACE,A)},v.disableAll=function(A){v.setLevel(v.levels.SILENT,A)},v.rebuild=function(){if(o!==v&&(w=C(o.getLevel())),u.call(v),o===v)for(var A in s)s[A].rebuild()},w=C(o?o.getLevel():"WARN");var x=E();x!=null&&(P=C(x)),u.call(v)}o=new g,o.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var T=s[y];return T||(T=s[y]=new g(y,o.methodFactory)),T};var b=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=b),o},o.getLoggers=function(){return s},o.default=o,o})})(QA);var zq=QA.exports;const qq=GA(zq);var sy=function(t,e){return sy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},sy(t,e)};function cr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");sy(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Hq(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((i=i.apply(t,[])).next())})}function JA(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(n=0)),n;)try{if(i=1,r&&(s=l[0]&2?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,r=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],r=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ta(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ka(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),r,s=[],o;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function El(t,e,n){if(arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}function ta(t){return this instanceof ta?(this.v=t,this):new ta(t)}function Wq(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(g){return function(b){return Promise.resolve(b).then(g,h)}}function a(g,b){i[g]&&(r[g]=function(y){return new Promise(function(T,v){s.push([g,y,T,v])>1||c(g,y)})},b&&(r[g]=b(r[g])))}function c(g,b){try{l(i[g](b))}catch(y){f(s[0][3],y)}}function l(g){g.value instanceof ta?Promise.resolve(g.value.v).then(u,h):f(s[0][2],g)}function u(g){c("next",g)}function h(g){c("throw",g)}function f(g,b){g(b),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Kq(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ta=="function"?Ta(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function Me(t){return typeof t=="function"}function bb(t){var e=function(i){Error.call(i),i.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Vm=bb(function(t){return function(e){t(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function Mh(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Gl=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,i,r,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Ta(o),c=a.next();!c.done;c=a.next()){var l=c.value;l.remove(this)}}catch(y){e={error:y}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(Me(u))try{u()}catch(y){s=y instanceof Vm?y.errors:[y]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var f=Ta(h),g=f.next();!g.done;g=f.next()){var b=g.value;try{QS(b)}catch(y){s=s??[],y instanceof Vm?s=El(El([],ka(s)),ka(y.errors)):s.push(y)}}}catch(y){i={error:y}}finally{try{g&&!g.done&&(r=f.return)&&r.call(f)}finally{if(i)throw i.error}}}if(s)throw new Vm(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)QS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&Mh(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&Mh(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),YA=Gl.EMPTY;function XA(t){return t instanceof Gl||t&&"closed"in t&&Me(t.remove)&&Me(t.add)&&Me(t.unsubscribe)}function QS(t){Me(t)?t():t.unsubscribe()}var ZA={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Gq={setTimeout:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout.apply(void 0,El([t,e],ka(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function eN(t){Gq.setTimeout(function(){throw t})}function Uh(){}function Dd(t){t()}var Tb=function(t){cr(e,t);function e(n){var i=t.call(this)||this;return i.isStopped=!1,n?(i.destination=n,XA(n)&&n.add(i)):i.destination=Xq,i}return e.create=function(n,i,r){return new oy(n,i,r)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Gl),Qq=Function.prototype.bind;function jm(t,e){return Qq.call(t,e)}var Jq=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(i){Hu(i)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(i){Hu(i)}else Hu(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Hu(n)}},t}(),oy=function(t){cr(e,t);function e(n,i,r){var s=t.call(this)||this,o;if(Me(n)||!n)o={next:n??void 0,error:i??void 0,complete:r??void 0};else{var a;s&&ZA.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return s.unsubscribe()},o={next:n.next&&jm(n.next,a),error:n.error&&jm(n.error,a),complete:n.complete&&jm(n.complete,a)}):o=n}return s.destination=new Jq(o),s}return e}(Tb);function Hu(t){eN(t)}function Yq(t){throw t}var Xq={closed:!0,next:Uh,error:Yq,complete:Uh},kb=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function wb(t){return t}function Zq(t){return t.length===0?wb:t.length===1?t[0]:function(e){return t.reduce(function(n,i){return i(n)},e)}}var Tt=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,i){var r=this,s=tH(e)?e:new oy(e,n,i);return Dd(function(){var o=r,a=o.operator,c=o.source;s.add(a?a.call(s,c):c?r._subscribe(s):r._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var i=this;return n=JS(n),new n(function(r,s){var o=new oy({next:function(a){try{e(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});i.subscribe(o)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[kb]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return Zq(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=JS(e),new e(function(i,r){var s;n.subscribe(function(o){return s=o},function(o){return r(o)},function(){return i(s)})})},t.create=function(e){return new t(e)},t}();function JS(t){var e;return(e=t??ZA.Promise)!==null&&e!==void 0?e:Promise}function eH(t){return t&&Me(t.next)&&Me(t.error)&&Me(t.complete)}function tH(t){return t&&t instanceof Tb||eH(t)&&XA(t)}function nH(t){return Me(t==null?void 0:t.lift)}function Un(t){return function(e){if(nH(e))return e.lift(function(n){try{return t(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ri(t,e,n,i,r){return new iH(t,e,n,i,r)}var iH=function(t){cr(e,t);function e(n,i,r,s,o,a){var c=t.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=i?function(l){try{i(l)}catch(u){n.error(u)}}:t.prototype._next,c._error=s?function(l){try{s(l)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,c._complete=r?function(){try{r()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,c}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;t.prototype.unsubscribe.call(this),!i&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(Tb),rH=bb(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),is=function(t){cr(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var i=new YS(this,this);return i.operator=n,i},e.prototype._throwIfClosed=function(){if(this.closed)throw new rH},e.prototype.next=function(n){var i=this;Dd(function(){var r,s;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var o=Ta(i.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(n)}}catch(l){r={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(r)throw r.error}}}})},e.prototype.error=function(n){var i=this;Dd(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=n;for(var r=i.observers;r.length;)r.shift().error(n)}})},e.prototype.complete=function(){var n=this;Dd(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var i=n.observers;i.length;)i.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var i=this,r=this,s=r.hasError,o=r.isStopped,a=r.observers;return s||o?YA:(this.currentObservers=null,a.push(n),new Gl(function(){i.currentObservers=null,Mh(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var i=this,r=i.hasError,s=i.thrownError,o=i.isStopped;r?n.error(s):o&&n.complete()},e.prototype.asObservable=function(){var n=new Tt;return n.source=this,n},e.create=function(n,i){return new YS(n,i)},e}(Tt),YS=function(t){cr(e,t);function e(n,i){var r=t.call(this)||this;return r.destination=n,r.source=i,r}return e.prototype.next=function(n){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.next)===null||r===void 0||r.call(i,n)},e.prototype.error=function(n){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.error)===null||r===void 0||r.call(i,n)},e.prototype.complete=function(){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||i===void 0||i.call(n)},e.prototype._subscribe=function(n){var i,r;return(r=(i=this.source)===null||i===void 0?void 0:i.subscribe(n))!==null&&r!==void 0?r:YA},e}(is),tN=function(t){cr(e,t);function e(n){var i=t.call(this)||this;return i._value=n,i}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var i=t.prototype._subscribe.call(this,n);return!i.closed&&n.next(this._value),i},e.prototype.getValue=function(){var n=this,i=n.hasError,r=n.thrownError,s=n._value;if(i)throw r;return this._throwIfClosed(),s},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(is),sH={now:function(){return Date.now()},delegate:void 0},oH=function(t){cr(e,t);function e(n,i){return t.call(this)||this}return e.prototype.schedule=function(n,i){return this},e}(Gl),XS={setInterval:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setInterval.apply(void 0,El([t,e],ka(n)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},aH=function(t){cr(e,t);function e(n,i){var r=t.call(this,n,i)||this;return r.scheduler=n,r.work=i,r.pending=!1,r}return e.prototype.schedule=function(n,i){var r;if(i===void 0&&(i=0),this.closed)return this;this.state=n;var s=this.id,o=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(o,s,i)),this.pending=!0,this.delay=i,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,i),this},e.prototype.requestAsyncId=function(n,i,r){return r===void 0&&(r=0),XS.setInterval(n.flush.bind(n,this),r)},e.prototype.recycleAsyncId=function(n,i,r){if(r===void 0&&(r=0),r!=null&&this.delay===r&&this.pending===!1)return i;i!=null&&XS.clearInterval(i)},e.prototype.execute=function(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(n,i);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,i){var r=!1,s;try{this.work(n)}catch(o){r=!0,s=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,i=n.id,r=n.scheduler,s=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Mh(s,this),i!=null&&(this.id=this.recycleAsyncId(r,i,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(oH),ZS=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,i){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(i,n)},t.now=sH.now,t}(),cH=function(t){cr(e,t);function e(n,i){i===void 0&&(i=ZS.now);var r=t.call(this,n,i)||this;return r.actions=[],r._active=!1,r}return e.prototype.flush=function(n){var i=this.actions;if(this._active){i.push(n);return}var r;this._active=!0;do if(r=n.execute(n.state,n.delay))break;while(n=i.shift());if(this._active=!1,r){for(;n=i.shift();)n.unsubscribe();throw r}},e}(ZS),lH=new cH(aH),uH=new Tt(function(t){return t.complete()});function dH(t){return t&&Me(t.schedule)}function nN(t){return t[t.length-1]}function Xf(t){return dH(nN(t))?t.pop():void 0}function hH(t,e){return typeof nN(t)=="number"?t.pop():e}var _b=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function iN(t){return Me(t==null?void 0:t.then)}function rN(t){return Me(t[kb])}function sN(t){return Symbol.asyncIterator&&Me(t==null?void 0:t[Symbol.asyncIterator])}function oN(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function fH(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var aN=fH();function cN(t){return Me(t==null?void 0:t[aN])}function lN(t){return Wq(this,arguments,function(){var e,n,i,r;return JA(this,function(s){switch(s.label){case 0:e=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,ta(e.read())];case 3:return n=s.sent(),i=n.value,r=n.done,r?[4,ta(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,ta(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function uN(t){return Me(t==null?void 0:t.getReader)}function Ai(t){if(t instanceof Tt)return t;if(t!=null){if(rN(t))return pH(t);if(_b(t))return mH(t);if(iN(t))return gH(t);if(sN(t))return dN(t);if(cN(t))return vH(t);if(uN(t))return yH(t)}throw oN(t)}function pH(t){return new Tt(function(e){var n=t[kb]();if(Me(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function mH(t){return new Tt(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function gH(t){return new Tt(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,eN)})}function vH(t){return new Tt(function(e){var n,i;try{for(var r=Ta(t),s=r.next();!s.done;s=r.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}e.complete()})}function dN(t){return new Tt(function(e){bH(t,e).catch(function(n){return e.error(n)})})}function yH(t){return dN(lN(t))}function bH(t,e){var n,i,r,s;return Hq(this,void 0,void 0,function(){var o,a;return JA(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=Kq(t),c.label=1;case 1:return[4,n.next()];case 2:if(i=c.sent(),!!i.done)return[3,4];if(o=i.value,e.next(o),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),r={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Hr(t,e,n,i,r){i===void 0&&(i=0),r===void 0&&(r=!1);var s=e.schedule(function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function hN(t,e){return e===void 0&&(e=0),Un(function(n,i){n.subscribe(ri(i,function(r){return Hr(i,t,function(){return i.next(r)},e)},function(){return Hr(i,t,function(){return i.complete()},e)},function(r){return Hr(i,t,function(){return i.error(r)},e)}))})}function fN(t,e){return e===void 0&&(e=0),Un(function(n,i){i.add(t.schedule(function(){return n.subscribe(i)},e))})}function TH(t,e){return Ai(t).pipe(fN(e),hN(e))}function kH(t,e){return Ai(t).pipe(fN(e),hN(e))}function wH(t,e){return new Tt(function(n){var i=0;return e.schedule(function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())})})}function _H(t,e){return new Tt(function(n){var i;return Hr(n,e,function(){i=t[aN](),Hr(n,e,function(){var r,s,o;try{r=i.next(),s=r.value,o=r.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return Me(i==null?void 0:i.return)&&i.return()}})}function pN(t,e){if(!t)throw new Error("Iterable cannot be null");return new Tt(function(n){Hr(n,e,function(){var i=t[Symbol.asyncIterator]();Hr(n,e,function(){i.next().then(function(r){r.done?n.complete():n.next(r.value)})},0,!0)})})}function SH(t,e){return pN(lN(t),e)}function EH(t,e){if(t!=null){if(rN(t))return TH(t,e);if(_b(t))return wH(t,e);if(iN(t))return kH(t,e);if(sN(t))return pN(t,e);if(cN(t))return _H(t,e);if(uN(t))return SH(t,e)}throw oN(t)}function Sb(t,e){return e?EH(t,e):Ai(t)}function e1(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Xf(t);return Sb(t,n)}function CH(t){return t instanceof Date&&!isNaN(t)}var IH=bb(function(t){return function(e){e===void 0&&(e=null),t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function PH(t,e){var n=CH(t)?{first:t}:typeof t=="number"?{each:t}:t,i=n.first,r=n.each,s=n.with,o=s===void 0?RH:s,a=n.scheduler,c=a===void 0?lH:a,l=n.meta,u=l===void 0?null:l;if(i==null&&r==null)throw new TypeError("No timeout provided.");return Un(function(h,f){var g,b,y=null,T=0,v=function(w){b=Hr(f,c,function(){try{g.unsubscribe(),Ai(o({meta:u,lastValue:y,seen:T})).subscribe(f)}catch(S){f.error(S)}},w)};g=h.subscribe(ri(f,function(w){b==null||b.unsubscribe(),T++,f.next(y=w),r>0&&v(r)},void 0,void 0,function(){b!=null&&b.closed||b==null||b.unsubscribe(),y=null})),!T&&v(i!=null?typeof i=="number"?i:+i-c.now():r)})}function RH(t){throw new IH(t)}function ut(t,e){return Un(function(n,i){var r=0;n.subscribe(ri(i,function(s){i.next(t.call(e,s,r++))}))})}var xH=Array.isArray;function AH(t,e){return xH(e)?t.apply(void 0,El([],ka(e))):t(e)}function NH(t){return ut(function(e){return AH(t,e)})}function OH(t,e,n,i,r,s,o,a){var c=[],l=0,u=0,h=!1,f=function(){h&&!c.length&&!l&&e.complete()},g=function(y){return l<i?b(y):c.push(y)},b=function(y){l++;var T=!1;Ai(n(y,u++)).subscribe(ri(e,function(v){e.next(v)},function(){T=!0},void 0,function(){if(T)try{l--;for(var v=function(){var w=c.shift();o||b(w)};c.length&&l<i;)v();f()}catch(w){e.error(w)}}))};return t.subscribe(ri(e,g,function(){h=!0,f()})),function(){}}function Eb(t,e,n){return n===void 0&&(n=1/0),Me(e)?Eb(function(i,r){return ut(function(s,o){return e(i,s,r,o)})(Ai(t(i,r)))},n):(typeof e=="number"&&(n=e),Un(function(i,r){return OH(i,r,t,n)}))}function mN(t){return t===void 0&&(t=1/0),Eb(wb,t)}function DH(){return mN(1)}function Fh(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return DH()(Sb(t,Xf(t)))}var LH=["addListener","removeListener"],MH=["addEventListener","removeEventListener"],UH=["on","off"];function ay(t,e,n,i){if(Me(n)&&(i=n,n=void 0),i)return ay(t,e,n).pipe(NH(i));var r=ka(jH(t)?MH.map(function(a){return function(c){return t[a](e,c,n)}}):FH(t)?LH.map(t1(t,e)):VH(t)?UH.map(t1(t,e)):[],2),s=r[0],o=r[1];if(!s&&_b(t))return Eb(function(a){return ay(a,e,n)})(Ai(t));if(!s)throw new TypeError("Invalid event target");return new Tt(function(a){var c=function(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return a.next(1<l.length?l:l[0])};return s(c),function(){return o(c)}})}function t1(t,e){return function(n){return function(i){return t[n](e,i)}}}function FH(t){return Me(t.addListener)&&Me(t.removeListener)}function VH(t){return Me(t.on)&&Me(t.off)}function jH(t){return Me(t.addEventListener)&&Me(t.removeEventListener)}function $H(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Xf(t),i=hH(t,1/0),r=t;return r.length?r.length===1?Ai(r[0]):mN(i)(Sb(r,n)):uH}function Cb(t,e){return Un(function(n,i){var r=0;n.subscribe(ri(i,function(s){return t.call(e,s,r++)&&i.next(s)}))})}function BH(t,e,n,i,r){return function(s,o){var a=n,c=e,l=0;s.subscribe(ri(o,function(u){var h=l++;c=a?t(c,u,h):(a=!0,u),o.next(c)},r))}}function zH(t,e){return e===void 0&&(e=wb),t=t??qH,Un(function(n,i){var r,s=!0;n.subscribe(ri(i,function(o){var a=e(o);(s||!t(r,a))&&(s=!1,r=a,i.next(o))}))})}function qH(t,e){return t===e}function HH(t){return Un(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function WH(t,e){return Un(BH(t,e,arguments.length>=2,!0))}function KH(t){return Un(function(e,n){var i=!1,r=ri(n,function(){r==null||r.unsubscribe(),i=!0},Uh);Ai(t).subscribe(r),e.subscribe(ri(n,function(s){return i&&n.next(s)}))})}function ci(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Xf(t);return Un(function(i,r){(n?Fh(t,i,n):Fh(t,i)).subscribe(r)})}function n1(t){return Un(function(e,n){Ai(t).subscribe(ri(n,function(){return n.complete()},Uh)),!n.closed&&e.subscribe(n)})}var GH=Object.defineProperty,QH=Object.defineProperties,JH=Object.getOwnPropertyDescriptors,i1=Object.getOwnPropertySymbols,YH=Object.prototype.hasOwnProperty,XH=Object.prototype.propertyIsEnumerable,r1=(t,e,n)=>e in t?GH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Es=(t,e)=>{for(var n in e||(e={}))YH.call(e,n)&&r1(t,n,e[n]);if(i1)for(var n of i1(e))XH.call(e,n)&&r1(t,n,e[n]);return t},Wu=(t,e)=>QH(t,JH(e)),En=(t,e,n)=>new Promise((i,r)=>{var s=c=>{try{a(n.next(c))}catch(l){r(l)}},o=c=>{try{a(n.throw(c))}catch(l){r(l)}},a=c=>c.done?i(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())}),gN="lk";function hn(t){return typeof t>"u"?!1:ZH(t)||eW(t)}function ZH(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function eW(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function Cl(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function $t(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(Cl(t))return`${t.participant.identity}_${t.source}_placeholder`;if(hn(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function vN(t,e){return typeof e>"u"?!1:hn(t)?e.some(n=>n.participant.identity===t.participant.identity&&hn(n)&&n.publication.trackSid===t.publication.trackSid):Cl(t)?e.some(n=>n.participant.identity===t.participant.identity&&Cl(n)&&n.source===t.source):!1}function tW(t,e){return Cl(t)&&hn(e)&&e.participant.identity===t.participant.identity&&e.source===t.source}function nW(){const t=document.createElement("p");t.style.width="100%",t.style.height="200px";const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);const n=t.offsetWidth;e.style.overflow="scroll";let i=t.offsetWidth;return n===i&&(i=e.clientWidth),document.body.removeChild(e),n-i}function iW(t,e){return En(this,null,function*(){const{x:n,y:i}=yield Bq(t,e,{placement:"top",middleware:[Vq(6),$q(),jq({padding:5})]});return{x:n,y:i}})}function rW(t,e){return!t.contains(e.target)}var sW=[F.ConnectionStateChanged,F.RoomMetadataChanged,F.ActiveSpeakersChanged,F.ConnectionQualityChanged,F.ParticipantConnected,F.ParticipantDisconnected,F.ParticipantPermissionsChanged,F.ParticipantMetadataChanged,F.ParticipantNameChanged,F.ParticipantAttributesChanged,F.TrackMuted,F.TrackUnmuted,F.TrackPublished,F.TrackUnpublished,F.TrackStreamStateChanged,F.TrackSubscriptionFailed,F.TrackSubscriptionPermissionChanged,F.TrackSubscriptionStatusChanged],oW=[...sW,F.LocalTrackPublished,F.LocalTrackUnpublished];V.TrackPublished,V.TrackUnpublished,V.TrackMuted,V.TrackUnmuted,V.TrackStreamStateChanged,V.TrackSubscribed,V.TrackUnsubscribed,V.TrackSubscriptionPermissionChanged,V.TrackSubscriptionFailed,V.LocalTrackPublished,V.LocalTrackUnpublished;var aW=[V.ConnectionQualityChanged,V.IsSpeakingChanged,V.ParticipantMetadataChanged,V.ParticipantPermissionsChanged,V.TrackMuted,V.TrackUnmuted,V.TrackPublished,V.TrackUnpublished,V.TrackStreamStateChanged,V.TrackSubscriptionFailed,V.TrackSubscriptionPermissionChanged,V.TrackSubscriptionStatusChanged];[...aW,V.LocalTrackPublished,V.LocalTrackUnpublished];var de=qq.getLogger("lk-components-js");de.setDefaultLevel("WARN");var cW=[{columns:1,rows:1},{columns:1,rows:2,orientation:"portrait"},{columns:2,rows:1,orientation:"landscape"},{columns:2,rows:2,minWidth:560},{columns:3,rows:3,minWidth:700},{columns:4,rows:4,minWidth:960},{columns:5,rows:5,minWidth:1100}];function yN(t,e,n,i){if(t.length<1)throw new Error("At least one grid layout definition must be provided.");const r=lW(t);if(n<=0||i<=0)return r[0];let s=0;const o=n/i>1?"landscape":"portrait";let a=r.find((c,l,u)=>{s=l;const h=u.findIndex((f,g)=>{const b=!f.orientation||f.orientation===o,y=g>l,T=f.maxTiles===c.maxTiles;return y&&T&&b})!==-1;return c.maxTiles>=e&&!h});if(a===void 0)if(a=r[r.length-1],a)de.warn(`No layout found for: participantCount: ${e}, width/height: ${n}/${i} fallback to biggest available layout (${a}).`);else throw new Error("No layout or fallback layout found.");if((n<a.minWidth||i<a.minHeight)&&s>0){const c=r[s-1];a=yN(r.slice(0,s),c.maxTiles,n,i)}return a}function lW(t){return[...t].map(e=>{var n,i;return{name:`${e.columns}x${e.rows}`,columns:e.columns,rows:e.rows,maxTiles:e.columns*e.rows,minWidth:(n=e.minWidth)!=null?n:0,minHeight:(i=e.minHeight)!=null?i:0,orientation:e.orientation}}).sort((e,n)=>e.maxTiles!==n.maxTiles?e.maxTiles-n.maxTiles:e.minWidth!==0||n.minWidth!==0?e.minWidth-n.minWidth:e.minHeight!==0||n.minHeight!==0?e.minHeight-n.minHeight:0)}var bN=[],TN={showChat:!1,unreadMessages:0,showSettings:!1};function kN(t){return typeof t=="object"}function wN(t){return Array.isArray(t)&&t.filter(kN).length>0}function uW(t,e){return e.audioLevel-t.audioLevel}function dW(t,e){return t.isSpeaking===e.isSpeaking?0:t.isSpeaking?-1:1}function hW(t,e){var n,i,r,s;return t.lastSpokeAt!==void 0||e.lastSpokeAt!==void 0?((i=(n=e.lastSpokeAt)==null?void 0:n.getTime())!=null?i:0)-((s=(r=t.lastSpokeAt)==null?void 0:r.getTime())!=null?s:0):0}function cy(t,e){var n,i,r,s;return((i=(n=t.joinedAt)==null?void 0:n.getTime())!=null?i:0)-((s=(r=e.joinedAt)==null?void 0:r.getTime())!=null?s:0)}function fW(t,e){return hn(t)?hn(e)?0:-1:hn(e)?1:0}function pW(t,e){const n=t.participant.isCameraEnabled,i=e.participant.isCameraEnabled;return n!==i?n?-1:1:0}function mW(t){const e=[],n=[],i=[],r=[];t.forEach(a=>{a.participant.isLocal&&a.source===j.Source.Camera?e.push(a):a.source===j.Source.ScreenShare?n.push(a):a.source===j.Source.Camera?i.push(a):r.push(a)});const s=gW(n),o=vW(i);return[...e,...s,...o,...r]}function gW(t){const e=[],n=[];return t.forEach(i=>{i.participant.isLocal?e.push(i):n.push(i)}),e.sort((i,r)=>cy(i.participant,r.participant)),n.sort((i,r)=>cy(i.participant,r.participant)),[...n,...e]}function vW(t){const e=[],n=[];return t.forEach(i=>{i.participant.isLocal?e.push(i):n.push(i)}),n.sort((i,r)=>i.participant.isSpeaking&&r.participant.isSpeaking?uW(i.participant,r.participant):i.participant.isSpeaking!==r.participant.isSpeaking?dW(i.participant,r.participant):i.participant.lastSpokeAt!==r.participant.lastSpokeAt?hW(i.participant,r.participant):hn(i)!==hn(r)?fW(i,r):i.participant.isCameraEnabled!==r.participant.isCameraEnabled?pW(i,r):cy(i.participant,r.participant)),[...e,...n]}function yW(t,e){return t.reduce((n,i,r)=>r%e===0?[...n,[i]]:[...n.slice(0,-1),[...n.slice(-1)[0],i]],[])}function s1(t,e){const n=Math.max(t.length,e.length);return new Array(n).fill([]).map((i,r)=>[t[r],e[r]])}function Vh(t,e,n){return t.filter(i=>!e.map(r=>n(r)).includes(n(i)))}function ly(t){return t.map(e=>typeof e=="string"||typeof e=="number"?`${e}`:$t(e))}function bW(t,e){return{dropped:Vh(t,e,$t),added:Vh(e,t,$t)}}function TW(t){return t.added.length!==0||t.dropped.length!==0}function uy(t,e){const n=e.findIndex(i=>$t(i)===$t(t));if(n===-1)throw new Error(`Element not part of the array: ${$t(t)} not in ${ly(e)}`);return n}function kW(t,e,n){const i=uy(t,n),r=uy(e,n);return n.splice(i,1,e),n.splice(r,1,t),n}function wW(t,e){const n=uy(t,e);return e.splice(n,1),e}function _W(t,e){return[...e,t]}function $m(t,e){return yW(t,e)}function SW(t,e,n){let i=EW(t,e);if(i.length<e.length){const o=Vh(e,i,$t);i=[...i,...o]}const r=$m(i,n),s=$m(e,n);if(s1(r,s).forEach(([o,a],c)=>{if(o&&a){const l=$m(i,n)[c],u=bW(l,a);TW(u)&&(de.debug(`Detected visual changes on page: ${c}, current: ${ly(o)}, next: ${ly(a)}`,{changes:u}),u.added.length===u.dropped.length&&s1(u.added,u.dropped).forEach(([h,f])=>{if(h&&f)i=kW(h,f,i);else throw new Error(`For a swap action we need a addition and a removal one is missing: ${h}, ${f}`)}),u.added.length===0&&u.dropped.length>0&&u.dropped.forEach(h=>{i=wW(h,i)}),u.added.length>0&&u.dropped.length===0&&u.added.forEach(h=>{i=_W(h,i)}))}}),i.length>e.length){const o=Vh(i,e,$t);i=i.filter(a=>!o.map($t).includes($t(a)))}return i}function EW(t,e){return t.map(n=>e.find(r=>$t(n)===$t(r)||typeof n!="number"&&Cl(n)&&hn(r)&&tW(n,r))??n)}function fn(t){return`${gN}-${t}`}function CW(t){const e=dy(t),n=_N(t.participant).pipe(ut(()=>dy(t)),ci(e));return{className:fn(t.source===j.Source.Camera||t.source===j.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function dy(t){if(hn(t))return t.publication;{const{source:e,name:n,participant:i}=t;if(e&&n)return i.getTrackPublications().find(r=>r.source===e&&r.trackName===n);if(n)return i.getTrackPublicationByName(n);if(e)return i.getTrackPublication(e);throw new Error("At least one of source and name needs to be defined")}}function Ib(t,...e){return new Tt(n=>{const i=()=>{n.next(t)};return e.forEach(r=>{t.on(r,i)}),()=>{e.forEach(r=>{t.off(r,i)})}}).pipe(ci(t))}function Ql(t,e){return new Tt(n=>{const i=(...r)=>{n.next(r)};return t.on(e,i),()=>{t.off(e,i)}})}function IW(t){return Ql(t,F.ConnectionStateChanged).pipe(ut(([e])=>e),ci(t.state))}function PW(t,e,n=!0){var i;const r=()=>En(this,null,function*(){try{const a=yield rr.getLocalDevices(t,n);s.next(a)}catch(a){e==null||e(a)}}),s=new is,o=s.pipe(HH(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",r)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(i=navigator==null?void 0:navigator.mediaDevices)==null||i.addEventListener("devicechange",r)}return Fh(rr.getLocalDevices(t,n).catch(a=>(e==null||e(a),[])),o)}function RW(t){return Ql(t,F.DataReceived)}function xW(t){return Ql(t,F.ChatMessage)}function AW(t){return Ib(t,F.AudioPlaybackStatusChanged).pipe(ut(e=>({canPlayAudio:e.canPlaybackAudio})))}function NW(t){return Ib(t,F.VideoPlaybackStatusChanged).pipe(ut(e=>({canPlayVideo:e.canPlaybackVideo})))}function OW(t,e){return Ql(t,F.ActiveDeviceChanged).pipe(Cb(([n])=>n===e),ut(([n,i])=>(de.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:i}),i)))}function DW(t,e){return Ql(t,F.ParticipantEncryptionStatusChanged).pipe(Cb(([,n])=>(e==null?void 0:e.identity)===(n==null?void 0:n.identity)||!n&&(e==null?void 0:e.identity)===t.localParticipant.identity),ut(([n])=>n),ci(e!=null&&e.isLocal?e.isE2EEEnabled:!!(e!=null&&e.isEncrypted)))}function Pb(t,...e){return new Tt(n=>{const i=()=>{n.next(t)};return e.forEach(r=>{t.on(r,i)}),()=>{e.forEach(r=>{t.off(r,i)})}}).pipe(ci(t))}function _N(t){return Pb(t,V.TrackMuted,V.TrackUnmuted,V.ParticipantPermissionsChanged,V.TrackPublished,V.TrackUnpublished,V.LocalTrackPublished,V.LocalTrackUnpublished,V.MediaDevicesError,V.TrackSubscriptionStatusChanged).pipe(ut(e=>{const{isMicrophoneEnabled:n,isCameraEnabled:i,isScreenShareEnabled:r}=e,s=e.getTrackPublication(j.Source.Microphone),o=e.getTrackPublication(j.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:n,isScreenShareEnabled:r,cameraTrack:o,microphoneTrack:s,participant:e}}))}function LW(t){return t?Pb(t,V.ParticipantMetadataChanged,V.ParticipantNameChanged).pipe(ut(({name:e,identity:n,metadata:i})=>({name:e,identity:n,metadata:i})),ci({name:t.name,identity:t.identity,metadata:t.metadata})):void 0}function MW(t){return Rb(t,V.ConnectionQualityChanged).pipe(ut(([e])=>e),ci(t.connectionQuality))}function Rb(t,e){return new Tt(n=>{const i=(...r)=>{n.next(r)};return t.on(e,i),()=>{t.off(e,i)}})}function SN(t){var e,n,i,r;return Pb(t.participant,V.TrackMuted,V.TrackUnmuted,V.TrackSubscribed,V.TrackUnsubscribed,V.LocalTrackPublished,V.LocalTrackUnpublished).pipe(ut(s=>{var o,a;const c=(o=t.publication)!=null?o:s.getTrackPublication(t.source);return(a=c==null?void 0:c.isMuted)!=null?a:!0}),ci((r=(i=(e=t.publication)==null?void 0:e.isMuted)!=null?i:(n=t.participant.getTrackPublication(t.source))==null?void 0:n.isMuted)!=null?r:!0))}function UW(t){return Rb(t,V.IsSpeakingChanged).pipe(ut(([e])=>e))}function FW(t){return Rb(t,V.ParticipantPermissionsChanged).pipe(ut(()=>t.permissions),ci(t.permissions))}function VW(t,e,n,i,r){const{localParticipant:s}=e,o=(u,h)=>{let f=!1;switch(u){case j.Source.Camera:f=h.isCameraEnabled;break;case j.Source.Microphone:f=h.isMicrophoneEnabled;break;case j.Source.ScreenShare:f=h.isScreenShareEnabled;break}return f},a=_N(s).pipe(ut(u=>o(t,u.participant)),ci(o(t,s))),c=new is,l=(u,h)=>En(this,null,function*(){try{switch(h??(h=n),c.next(!0),t){case j.Source.Camera:return yield s.setCameraEnabled(u??!s.isCameraEnabled,h,i),s.isCameraEnabled;case j.Source.Microphone:return yield s.setMicrophoneEnabled(u??!s.isMicrophoneEnabled,h,i),s.isMicrophoneEnabled;case j.Source.ScreenShare:return yield s.setScreenShareEnabled(u??!s.isScreenShareEnabled,h,i),s.isScreenShareEnabled;default:throw new TypeError("Tried to toggle unsupported source")}}catch(f){if(r&&f instanceof Error){r==null||r(f);return}else throw f}finally{c.next(!1)}});return{className:fn("button"),toggle:l,enabledObserver:a,pendingObserver:c.asObservable()}}function jW(){let t=!1;const e=new is,n=new is,i=r=>En(this,null,function*(){n.next(!0),t=r??!t,e.next(t),n.next(!1)});return{className:fn("button"),toggle:i,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function $W(t,e,n){const i=new tN(void 0),r=OW(e,t),s=(o,...a)=>En(this,[o,...a],function*(c,l={}){var u,h,f;if(e){de.debug(`Switching active device of kind "${t}" with id ${c}.`),yield e.switchActiveDevice(t,c,l.exact);const g=(u=e.getActiveDevice(t))!=null?u:c;g!==c&&c!=="default"&&de.info(`We tried to select the device with id (${c}), but the browser decided to select the device with id (${g}) instead.`);let b;t==="audioinput"?b=(h=e.localParticipant.getTrackPublication(j.Source.Microphone))==null?void 0:h.track:t==="videoinput"&&(b=(f=e.localParticipant.getTrackPublication(j.Source.Camera))==null?void 0:f.track);const y=c==="default"&&!b||c==="default"&&(b==null?void 0:b.mediaStreamTrack.label.startsWith("Default"));i.next(y?c:g)}});return{className:fn("media-device-select"),activeDeviceObservable:r,setActiveMediaDevice:s}}function BW(t){const e=n=>{t.disconnect(n)};return{className:fn("disconnect-button"),disconnect:e}}function zW(t){const e=fn("connection-quality"),n=MW(t);return{className:e,connectionQualityObserver:n}}function qW(t){let e="track-muted-indicator-camera";switch(t.source){case j.Source.Camera:e="track-muted-indicator-camera";break;case j.Source.Microphone:e="track-muted-indicator-microphone";break}const n=fn(e),i=SN(t);return{className:n,mediaMutedObserver:i}}function HW(t){return{className:"lk-participant-name",infoObserver:LW(t)}}function WW(){return{className:fn("participant-tile")}}var o1={CHAT:"lk-chat-topic",CHAT_UPDATE:"lk-chat-update-topic"};function hy(t,e){return En(this,arguments,function*(n,i,r={}){const{reliable:s,destinationIdentities:o,topic:a}=r;yield n.publishData(i,{destinationIdentities:o,topic:a,reliable:s})})}function KW(t,e,n){const i=Array.isArray(e)?e:[e],r=RW(t).pipe(Cb(([,,,a])=>e===void 0||a!==void 0&&i.includes(a)),ut(([a,c,,l])=>({payload:a,topic:l,from:c})));let s;const o=new Tt(a=>{s=a});return{messageObservable:r,isSendingObservable:o,send:(a,...c)=>En(this,[a,...c],function*(l,u={}){s.next(!0);try{yield hy(t.localParticipant,l,Es({topic:i[0]},u))}finally{s.next(!1)}})}}function GW(t){return{chatObservable:xW(t),send:e=>En(this,null,function*(){return yield t.localParticipant.sendChatMessage(e)}),edit:(e,n)=>En(this,null,function*(){return yield t.localParticipant.editChatMessage(e,n)})}}var QW=new TextEncoder,JW=new TextDecoder,Ku=new Map,YW=t=>QW.encode(JSON.stringify(t)),XW=t=>JSON.parse(JW.decode(t));function ZW(t,e){var n,i;const r=new is,s=()=>{var _,C,x;return((_=t.serverInfo)==null?void 0:_.edition)===1||!!((C=t.serverInfo)!=null&&C.version)&&Ys((x=t.serverInfo)==null?void 0:x.version,"1.17.2")>0},{messageDecoder:o,messageEncoder:a,channelTopic:c,updateChannelTopic:l}=e??{},u=c??o1.CHAT,h=l??o1.CHAT_UPDATE;let f=!1;Ku.has(t)||(f=!0);const g=(n=Ku.get(t))!=null?n:new Map,b=(i=g.get(u))!=null?i:new is;if(g.set(u,b),Ku.set(t,g),f){const{messageObservable:_}=KW(t,[u,h]);_.pipe(n1(r)).subscribe(b)}const{chatObservable:y,send:T}=GW(t),v=o??XW,w=$H(b.pipe(ut(_=>{const C=v(_.payload),x=Wu(Es({},C),{from:_.from});if(!eK(x))return x})),y.pipe(ut(([_,C])=>Wu(Es({},_),{from:C})))).pipe(WH((_,C)=>{var x;if(!C)return _;if("id"in C&&_.find(A=>{var L,D;return((L=A.from)==null?void 0:L.identity)===((D=C.from)==null?void 0:D.identity)&&A.id===C.id})){const A=_.findIndex(L=>L.id===C.id);if(A>-1){const L=_[A];_[A]=Wu(Es({},C),{timestamp:L.timestamp,editTimestamp:(x=C.editTimestamp)!=null?x:C.timestamp})}return[..._]}return[..._,C]},[]),n1(r)),S=new tN(!1),P=a??YW,R=_=>En(this,null,function*(){S.next(!0);try{const C=yield T(_),x=P(Wu(Es({},C),{ignore:s()}));return yield hy(t.localParticipant,x,{reliable:!0,topic:u}),C}finally{S.next(!1)}}),O=(_,C)=>En(this,null,function*(){const x=Date.now(),A=typeof C=="string"?{id:C,message:"",timestamp:x}:C;S.next(!0);try{const L=yield t.localParticipant.editChatMessage(_,A),D=P(L);return yield hy(t.localParticipant,D,{topic:h,reliable:!0}),L}finally{S.next(!1)}});function E(){r.next(),r.complete(),Ku.delete(t)}return t.once(F.Disconnected,E),{messageObservable:w,isSendingObservable:S,send:R,update:O}}function eK(t){return t.ignore==!0}function tK(){const t=e=>En(this,null,function*(){de.info("Start Audio for room: ",e),yield e.startAudio()});return{className:fn("start-audio-button"),roomAudioPlaybackAllowedObservable:AW,handleStartAudioPlayback:t}}function nK(){const t=e=>En(this,null,function*(){de.info("Start Video for room: ",e),yield e.startVideo()});return{className:fn("start-audio-button"),roomVideoPlaybackAllowedObservable:NW,handleStartVideoPlayback:t}}function iK(){return{className:[fn("button"),fn("chat-toggle")].join(" ")}}function rK(){return{className:[fn("button"),fn("focus-toggle-button")].join(" ")}}function sK(){return{className:"lk-room-container"}}function a1(t,e,n=!0){const i=[t.localParticipant,...Array.from(t.remoteParticipants.values())],r=[];return i.forEach(s=>{e.forEach(o=>{const a=Array.from(s.trackPublications.values()).filter(c=>c.source===o&&(!n||c.track)).map(c=>({participant:s,publication:c,source:c.source}));r.push(...a)})}),{trackReferences:r,participants:i}}function oK(t,e,n){var i,r;const s=(i=n.additionalRoomEvents)!=null?i:oW,o=(r=n.onlySubscribed)!=null?r:!0,a=Array.from(new Set([F.ParticipantConnected,F.ParticipantDisconnected,F.ConnectionStateChanged,F.LocalTrackPublished,F.LocalTrackUnpublished,F.TrackPublished,F.TrackUnpublished,F.TrackSubscriptionStatusChanged,...s]).values());return Ib(t,...a).pipe(ut(c=>{const l=a1(c,e,o);return de.debug(`TrackReference[] was updated. (length ${l.trackReferences.length})`,l),l}),ci(a1(t,e,o)))}function aK(t,e=1e3){if(t===null)return e1(!1);const n=ay(t,"mousemove",{passive:!0}).pipe(ut(()=>!0)),i=n.pipe(PH({each:e,with:()=>Fh(e1(!1),i.pipe(KH(n)))}),zH());return i}function cK(t,e){if(typeof localStorage>"u"){de.error("Local storage is not available.");return}try{if(e){const n=Object.fromEntries(Object.entries(e).filter(([,i])=>i!==""));localStorage.setItem(t,JSON.stringify(n))}}catch(n){de.error(`Error setting item to local storage: ${n}`)}}function lK(t){if(typeof localStorage>"u"){de.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){de.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){de.error(`Error getting item from local storage: ${e}`);return}}function uK(t){return{load:()=>lK(t),save:e=>cK(t,e)}}var dK=`${gN}-user-choices`,ko={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"default",audioDeviceId:"default",username:""},{load:hK,save:fK}=uK(dK);function pK(t,e=!1){e!==!0&&fK(t)}function mK(t,e=!1){var n,i,r,s,o;const a={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:ko.videoEnabled,audioEnabled:(i=t==null?void 0:t.audioEnabled)!=null?i:ko.audioEnabled,videoDeviceId:(r=t==null?void 0:t.videoDeviceId)!=null?r:ko.videoDeviceId,audioDeviceId:(s=t==null?void 0:t.audioDeviceId)!=null?s:ko.audioDeviceId,username:(o=t==null?void 0:t.username)!=null?o:ko.username};if(e)return a;{const c=hK();return Es(Es({},a),c??{})}}function EN(t,e){if(e.msg==="show_chat")return{...t,showChat:!0,unreadMessages:0};if(e.msg==="hide_chat")return{...t,showChat:!1};if(e.msg==="toggle_chat"){const n={...t,showChat:!t.showChat};return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?{...t,unreadMessages:e.count}:e.msg==="toggle_settings"?{...t,showSettings:!t.showSettings}:{...t}}function CN(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:{...t}}const Zf=m.createContext(void 0);function gK(){const t=m.useContext(Zf);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function vK(t){const e=Jl();if(t??(t=e),!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function yK(){const[t,e]=m.useReducer(CN,bN),[n,i]=m.useReducer(EN,TN);return{pin:{dispatch:e,state:t},widget:{dispatch:i,state:n}}}function bK(t){const[e,n]=m.useReducer(CN,bN),[i,r]=m.useReducer(EN,TN);return t??{pin:{dispatch:n,state:e},widget:{dispatch:r,state:i}}}function Jl(){return m.useContext(Zf)}const xb=m.createContext(void 0);function ep(){return m.useContext(xb)}function Ma(t){const e=ep(),n=t??e;if(!n)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return n}const IN=m.createContext(void 0);function PN(){return m.useContext(IN)}function Yl(t){const e=PN(),n=ep(),i=t??e??(n==null?void 0:n.participant);if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}const Ab=m.createContext(void 0);function tp(){const t=m.useContext(Ab);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function np(){return m.useContext(Ab)}function Ua(t){const e=np(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}const RN=m.createContext(void 0);function TK(t){return m.useContext(RN)}var c1={};function xN(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=xN(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function AN(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=xN(t))&&(i&&(i+=" "),i+=e);return i}function kK(...t){return(...e)=>{for(const n of t)if(typeof n=="function")try{n(...e)}catch(i){console.error(i)}}}function lr(...t){const e={...t[0]};for(let n=1;n<t.length;n++){const i=t[n];for(const r in i){const s=e[r],o=i[r];typeof s=="function"&&typeof o=="function"&&r[0]==="o"&&r[1]==="n"&&r.charCodeAt(2)>=65&&r.charCodeAt(2)<=90?e[r]=kK(s,o):(r==="className"||r==="UNSAFE_className")&&typeof s=="string"&&typeof o=="string"?e[r]=AN(s,o):e[r]=o!==void 0?o:s}}return e}function wK(t){return t!==void 0}function us(...t){return lr(...t.filter(wK))}function _K(t,e,n){return m.Children.map(t,i=>m.isValidElement(i)&&m.Children.only(t)?(i.props.class&&(e??(e={}),e.class=AN(i.props.class,e.class),e.style={...i.props.style,...e.style}),m.cloneElement(i,{...e,key:n})):i)}function SK(t){var e,n;if(typeof window<"u"&&typeof process<"u"&&(((e=process==null?void 0:c1)==null?void 0:e.NODE_ENV)==="dev"||((n=process==null?void 0:c1)==null?void 0:n.NODE_ENV)==="development")){const i=document.querySelector(".lk-room-container");i&&!getComputedStyle(i).getPropertyValue("--lk-has-imported-styles")&&de.warn("It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.")}}function NN(t,e){return t==="processor"&&e&&typeof e=="object"&&"name"in e?e.name:t==="e2ee"&&e?"e2ee-enabled":e}const EK={connect:!0,audio:!1,video:!1};function CK(t){const{token:e,serverUrl:n,options:i,room:r,connectOptions:s,connect:o,audio:a,video:c,screen:l,onConnected:u,onDisconnected:h,onError:f,onMediaDeviceFailure:g,onEncryptionError:b,simulateParticipants:y,...T}={...EK,...t};i&&r&&de.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[v,w]=m.useState(),S=m.useRef(o);m.useEffect(()=>{w(r??new rr(i))},[r,JSON.stringify(i,NN)]);const P=m.useMemo(()=>{const{className:R}=sK();return lr(T,{className:R})},[T]);return m.useEffect(()=>{if(!v)return;const R=()=>{const x=v.localParticipant;de.debug("trying to publish local tracks"),Promise.all([x.setMicrophoneEnabled(!!a,typeof a!="boolean"?a:void 0),x.setCameraEnabled(!!c,typeof c!="boolean"?c:void 0),x.setScreenShareEnabled(!!l,typeof l!="boolean"?l:void 0)]).catch(A=>{de.warn(A),f==null||f(A)})},O=x=>{const A=Tl.getFailure(x);g==null||g(A)},E=x=>{b==null||b(x)},_=x=>{h==null||h(x)},C=()=>{u==null||u()};return v.on(F.SignalConnected,R).on(F.MediaDevicesError,O).on(F.EncryptionError,E).on(F.Disconnected,_).on(F.Connected,C),()=>{v.off(F.SignalConnected,R).off(F.MediaDevicesError,O).off(F.EncryptionError,E).off(F.Disconnected,_).off(F.Connected,C)}},[v,a,c,l,f,b,g,u,h]),m.useEffect(()=>{if(v){if(y){v.simulateParticipants({participants:{count:y},publish:{audio:!0,useRealTracks:!0}});return}if(o){if(S.current=!0,de.debug("connecting"),!e){de.debug("no token yet");return}if(!n){de.warn("no livekit url provided"),f==null||f(Error("no livekit url provided"));return}v.connect(n,e,s).catch(R=>{de.warn(R),S.current===!0&&(f==null||f(R))})}else de.debug("disconnecting because connect is false"),S.current=!1,v.disconnect()}},[o,e,JSON.stringify(s),v,f,n,y]),m.useEffect(()=>{if(v)return()=>{de.info("disconnecting on onmount"),v.disconnect()}},[v]),{room:v,htmlProps:P}}const IK=m.forwardRef(function(t,e){const{room:n,htmlProps:i}=CK(t);return m.createElement("div",{ref:e,...i},n&&m.createElement(Ab.Provider,{value:n},m.createElement(RN.Provider,{value:t.featureFlags},t.children)))}),PK=t=>{const e=m.useRef(t);return m.useEffect(()=>{e.current=t}),e};function RK(t,e){const n=AK(),i=PK(e);return m.useLayoutEffect(()=>{let r=!1;const s=t.current;if(!s)return;function o(a,c){r||i.current(a,c)}return n==null||n.subscribe(s,o),()=>{r=!0,n==null||n.unsubscribe(s,o)}},[t.current,n,i]),n==null?void 0:n.observer}function xK(){let t=!1,e=[];const n=new Map;if(typeof window>"u")return;const i=new ResizeObserver((r,s)=>{e=e.concat(r),t||window.requestAnimationFrame(()=>{const o=new Set;for(let a=0;a<e.length;a++){if(o.has(e[a].target))continue;o.add(e[a].target);const c=n.get(e[a].target);c==null||c.forEach(l=>l(e[a],s))}e=[],t=!1}),t=!0});return{observer:i,subscribe(r,s){i.observe(r);const o=n.get(r)??[];o.push(s),n.set(r,o)},unsubscribe(r,s){const o=n.get(r)??[];if(o.length===1){i.unobserve(r),n.delete(r);return}const a=o.indexOf(s);a!==-1&&o.splice(a,1),n.set(r,o)}}}let l1;const AK=()=>l1||(l1=xK()),ON=t=>{const[e,n]=m.useState({width:0,height:0});m.useLayoutEffect(()=>{if(t.current){const{width:r,height:s}=t.current.getBoundingClientRect();n({width:r,height:s})}},[t.current]);const i=m.useCallback(r=>n(r.contentRect),[]);return RK(t,i),e};function pn(t,e,n=!0){const[i,r]=m.useState(e);return m.useEffect(()=>{if(n&&r(e),typeof window>"u"||!t)return;const s=t.subscribe(r);return()=>s.unsubscribe()},[t,n]),i}function NK(t={}){const e=Yl(t.participant),{className:n,connectionQualityObserver:i}=m.useMemo(()=>zW(e),[e]),r=pn(i,xn.Unknown);return{className:n,quality:r}}function Nb(t){const e=Ua(t),n=m.useMemo(()=>IW(e),[e]);return pn(n,e.state)}function OK(t){const e=tp(),n=Nb(e);return{buttonProps:m.useMemo(()=>{const{className:i,disconnect:r}=BW(e);return lr(t,{className:i,onClick:()=>r(t.stopTracks??!0),disabled:n===pe.Disconnected})},[e,t,n])}}function DK(t){if(t.publication instanceof wl){const e=t.publication.track;if(e){const{facingMode:n}=MA(e);return n}}return"undefined"}function LK({trackRef:t,props:e}){const n=Ma(t),i=Jl(),{className:r}=m.useMemo(()=>rK(),[]),s=m.useMemo(()=>vN(n,i==null?void 0:i.pin.state),[n,i==null?void 0:i.pin.state]);return{mergedProps:m.useMemo(()=>lr(e,{className:r,onClick:o=>{var a,c,l,u,h;(a=e.onClick)==null||a.call(e,o),s?(l=i==null?void 0:(c=i.pin).dispatch)==null||l.call(c,{msg:"clear_pin"}):(h=i==null?void 0:(u=i.pin).dispatch)==null||h.call(u,{msg:"set_pin",trackReference:n})}}),[e,r,n,s,i==null?void 0:i.pin]),inFocus:s}}function MK(t,e,n={}){const i=n.gridLayouts??cW,{width:r,height:s}=ON(t),o=yN(i,e,r,s);return m.useEffect(()=>{t.current&&o&&(t.current.style.setProperty("--lk-col-count",o==null?void 0:o.columns.toString()),t.current.style.setProperty("--lk-row-count",o==null?void 0:o.rows.toString()))},[t,o]),{layout:o,containerWidth:r,containerHeight:s}}function u1(t,e={}){var n,i;const r=typeof t=="string"?e.participant:t.participant,s=Yl(r),o=typeof t=="string"?{participant:s,source:t}:t,[a,c]=m.useState(!!((n=o.publication)!=null&&n.isMuted||(i=s.getTrackPublication(o.source))!=null&&i.isMuted));return m.useEffect(()=>{const l=SN(o).subscribe(c);return()=>l.unsubscribe()},[$t(o)]),a}function UK(t){const e=Yl(t),n=m.useMemo(()=>UW(e),[e]);return pn(n,e.isSpeaking)}function FK(){const t=tp(),e=m.useMemo(()=>FW(t.localParticipant),[t]);return pn(e,t.localParticipant.permissions)}function VK({kind:t,room:e,track:n,requestPermissions:i,onError:r}){const s=np(),o=m.useMemo(()=>e??s??new rr,[e,s]),a=m.useMemo(()=>PW(t,r,i),[t,i,r]),c=pn(a,[]),[l,u]=m.useState((o==null?void 0:o.getActiveDevice(t))??"default"),{className:h,activeDeviceObservable:f,setActiveMediaDevice:g}=m.useMemo(()=>$W(t,o),[t,o,n]);return m.useEffect(()=>{const b=f.subscribe(y=>{y&&(de.info("setCurrentDeviceId",y),u(y))});return()=>{b==null||b.unsubscribe()}},[f]),{devices:c,className:h,activeDeviceId:l,setActiveMediaDevice:g}}function DN(t,e,n={}){const i=m.useRef([]),r=m.useRef(-1),s=e!==r.current,o=typeof n.customSortFunction=="function"?n.customSortFunction(t):mW(t);let a=[...o];if(s===!1)try{a=SW(i.current,o,e)}catch(c){de.error("Error while running updatePages(): ",c)}return s?i.current=o:i.current=a,r.current=e,a}function jK(t,e){const[n,i]=m.useState(1),r=Math.max(Math.ceil(e.length/t),1);n>r&&i(r);const s=n*t,o=s-t,a=u=>{i(h=>u==="next"?h===r?h:h+1:h===1?h:h-1)},c=u=>{u>r?i(r):u<1?i(1):i(u)},l=DN(e,t).slice(o,s);return{totalPageCount:r,nextPage:()=>a("next"),prevPage:()=>a("previous"),setPage:c,firstItemIndex:o,lastItemIndex:s,tracks:l,currentPage:n}}function $K({trackRef:t,onParticipantClick:e,disableSpeakingIndicator:n,htmlProps:i}){const r=Ma(t),s=m.useMemo(()=>{const{className:f}=WW();return lr(i,{className:f,onClick:g=>{var b;if((b=i.onClick)==null||b.call(i,g),typeof e=="function"){const y=r.publication??r.participant.getTrackPublication(r.source);e({participant:r.participant,track:y})}}})},[i,e,r.publication,r.source,r.participant]),o=r.participant.getTrackPublication(j.Source.Microphone),a=m.useMemo(()=>({participant:r.participant,source:j.Source.Microphone,publication:o}),[o,r.participant]),c=u1(r),l=u1(a),u=UK(r.participant),h=DK(r);return{elementProps:{"data-lk-audio-muted":l,"data-lk-video-muted":c,"data-lk-speaking":n===!0?!1:u,"data-lk-local-participant":r.participant.isLocal,"data-lk-source":r.source,"data-lk-facing-mode":h,...s}}}function BK(t){return t=vK(t),m.useMemo(()=>(t==null?void 0:t.pin.state)!==void 0&&t.pin.state.length>=1?t.pin.state:[],[t.pin.state])}function zK({room:t,props:e}){const n=Ua(t),{className:i,roomAudioPlaybackAllowedObservable:r,handleStartAudioPlayback:s}=m.useMemo(()=>tK(),[]),o=m.useMemo(()=>r(n),[n,r]),{canPlayAudio:a}=pn(o,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:m.useMemo(()=>lr(e,{className:i,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,i,a,s,n]),canPlayAudio:a}}function qK({room:t,props:e}){const n=Ua(t),{className:i,roomVideoPlaybackAllowedObservable:r,handleStartVideoPlayback:s}=m.useMemo(()=>nK(),[]),o=m.useMemo(()=>r(n),[n,r]),{canPlayVideo:a}=pn(o,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:m.useMemo(()=>lr(e,{className:i,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,i,a,s,n]),canPlayVideo:a}}function HK(t,e={}){const n=m.useRef(null),i=m.useRef(null),r=e.minSwipeDistance??50,s=c=>{i.current=null,n.current=c.targetTouches[0].clientX},o=c=>{i.current=c.targetTouches[0].clientX},a=m.useCallback(()=>{if(!n.current||!i.current)return;const c=n.current-i.current,l=c>r,u=c<-r;l&&e.onLeftSwipe&&e.onLeftSwipe(),u&&e.onRightSwipe&&e.onRightSwipe()},[r,e]);m.useEffect(()=>{const c=t.current;return c&&(c.addEventListener("touchstart",s,{passive:!0}),c.addEventListener("touchmove",o,{passive:!0}),c.addEventListener("touchend",a,{passive:!0})),()=>{c&&(c.removeEventListener("touchstart",s),c.removeEventListener("touchmove",o),c.removeEventListener("touchend",a))}},[t,a])}function WK({props:t}){const{dispatch:e,state:n}=gK().widget,{className:i}=m.useMemo(()=>iK(),[]);return{mergedProps:m.useMemo(()=>lr(t,{className:i,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,i,e,n])}}function KK(t){var e,n;const i=Ma(t),{className:r,mediaMutedObserver:s}=m.useMemo(()=>qW(i),[$t(i)]);return{isMuted:pn(s,!!((e=i.publication)!=null&&e.isMuted||(n=i.participant.getTrackPublication(i.source))!=null&&n.isMuted)),className:r}}function GK({source:t,onChange:e,initialState:n,captureOptions:i,publishOptions:r,onDeviceError:s,...o}){var a;const c=np(),l=(a=c==null?void 0:c.localParticipant)==null?void 0:a.getTrackPublication(t),u=m.useRef(!1),{toggle:h,className:f,pendingObserver:g,enabledObserver:b}=m.useMemo(()=>c?VW(t,c,i,r,s):jW(),[c,t,JSON.stringify(i),r]),y=pn(g,!1),T=pn(b,n??!!(l!=null&&l.isEnabled));m.useEffect(()=>{e==null||e(T,u.current),u.current=!1},[T,e]),m.useEffect(()=>{n!==void 0&&(de.debug("forcing initial toggle state",t,n),h(n))},[]);const v=m.useMemo(()=>lr(o,{className:f}),[o,f]),w=m.useCallback(S=>{var P;u.current=!0,h().catch(()=>u.current=!1),(P=o.onClick)==null||P.call(o,S)},[o,h]);return{toggle:h,enabled:T,pending:y,track:l,buttonProps:{...v,"aria-pressed":T,"data-lk-source":t,"data-lk-enabled":T,disabled:y,onClick:w}}}function LN(t=[j.Source.Camera,j.Source.Microphone,j.Source.ScreenShare,j.Source.ScreenShareAudio,j.Source.Unknown],e={}){const n=Ua(e.room),[i,r]=m.useState([]),[s,o]=m.useState([]),a=m.useMemo(()=>t.map(c=>kN(c)?c.source:c),[JSON.stringify(t)]);return m.useEffect(()=>{const c=oK(n,a,{additionalRoomEvents:e.updateOnlyOn,onlySubscribed:e.onlySubscribed}).subscribe(({trackReferences:l,participants:u})=>{de.debug("setting track bundles",l,u),r(l),o(u)});return()=>c.unsubscribe()},[n,JSON.stringify(e.onlySubscribed),JSON.stringify(e.updateOnlyOn),JSON.stringify(t)]),m.useMemo(()=>{if(wN(t)){const c=JK(t,s),l=Array.from(i);return s.forEach(u=>{c.has(u.identity)&&(c.get(u.identity)??[]).forEach(h=>{if(i.find(({participant:g,publication:b})=>u.identity===g.identity&&b.source===h))return;de.debug(`Add ${h} placeholder for participant ${u.identity}.`);const f={participant:u,source:h};l.push(f)})}),l}else return i},[i,s,t])}function QK(t,e){const n=new Set(t);for(const i of e)n.delete(i);return n}function JK(t,e){const n=new Map;if(wN(t)){const i=t.filter(r=>r.withPlaceholder).map(r=>r.source);e.forEach(r=>{const s=r.getTrackPublications().map(a=>{var c;return(c=a.track)==null?void 0:c.source}).filter(a=>a!==void 0),o=Array.from(QK(new Set(i),new Set(s)));o.length>0&&n.set(r.identity,o)})}return n}function YK(t){const e=tp(),n=Nb(e),i=m.useMemo(()=>n===pe.Disconnected,[n]),r=m.useMemo(()=>ZW(e,t),[e,t,i]),s=pn(r.isSendingObservable,!1),o=pn(r.messageObservable,[]);return{send:r.send,update:r.update,chatMessages:o,isSending:s}}function MN(t={}){const[e,n]=m.useState(mK(t.defaults,t.preventLoad??!1)),i=m.useCallback(c=>{n(l=>({...l,audioEnabled:c}))},[]),r=m.useCallback(c=>{n(l=>({...l,videoEnabled:c}))},[]),s=m.useCallback(c=>{n(l=>({...l,audioDeviceId:c}))},[]),o=m.useCallback(c=>{n(l=>({...l,videoDeviceId:c}))},[]),a=m.useCallback(c=>{n(l=>({...l,username:c}))},[]);return m.useEffect(()=>{pK(e,t.preventSave??!1)},[e,t.preventSave]),{userChoices:e,saveAudioInputEnabled:i,saveVideoInputEnabled:r,saveAudioInputDeviceId:s,saveVideoInputDeviceId:o,saveUsername:a}}function XK(t,e={}){const n=Yl(t),i=Ua(e.room),r=m.useMemo(()=>DW(i,n),[i,n]);return pn(r,n.isLocal?n.isE2EEEnabled:!!(n!=null&&n.isEncrypted))}const UN=m.forwardRef(function(t,e){const{mergedProps:n}=WK({props:t});return m.createElement("button",{ref:e,...n},t.children)}),ZK=m.forwardRef(function(t,e){const{buttonProps:n}=OK(t);return m.createElement("button",{ref:e,...n},t.children)}),eG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},m.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),m.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),tG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},m.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),nG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",...t},m.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),iG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none",...t},m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),d1=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},m.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})),rG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},m.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},m.createElement("path",{d:"M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9"}))),sG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),oG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},m.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M4 6.104V4a4 4 0 1 1 8 0v2.104c1.154.326 2 1.387 2 2.646v4.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-4.5c0-1.259.846-2.32 2-2.646ZM5.5 4a2.5 2.5 0 0 1 5 0v2h-5V4Z",clipRule:"evenodd"})),aG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},m.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),m.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),cG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},m.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),m.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),lG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),uG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("g",{opacity:.25},m.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),dG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("g",{opacity:.25},m.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),m.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),hG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},m.createElement("g",{opacity:.25},m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),m.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),FN=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),fG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},m.createElement("g",{fill:"currentColor"},m.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),m.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),h1=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0Z",clipRule:"evenodd"}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 12a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 8 12Z",clipRule:"evenodd",opacity:.7}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 1.072a.75.75 0 0 1 .274 1.024l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 12 1.072Z",clipRule:"evenodd"}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 11.464a.75.75 0 0 1 .274 1.025l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 6 11.464Z",clipRule:"evenodd",opacity:.6}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 4a.75.75 0 0 1-.274 1.025l-2.165 1.25a.75.75 0 1 1-.75-1.3l2.165-1.25A.75.75 0 0 1 14.928 4Z",clipRule:"evenodd"}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 10a.75.75 0 0 1-.275 1.024l-2.165 1.25a.75.75 0 0 1-.75-1.298l2.165-1.25A.75.75 0 0 1 4.536 10Z",clipRule:"evenodd",opacity:.5}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 16 8Z",clipRule:"evenodd"}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 8Z",clipRule:"evenodd",opacity:.4}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 12a.75.75 0 0 1-1.024.274l-2.165-1.25a.75.75 0 0 1 .75-1.299l2.165 1.25A.75.75 0 0 1 14.928 12Z",clipRule:"evenodd",opacity:.9}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 6a.75.75 0 0 1-1.025.275l-2.165-1.25a.75.75 0 1 1 .75-1.3l2.165 1.25A.75.75 0 0 1 4.536 6Z",clipRule:"evenodd",opacity:.3}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 14.928a.75.75 0 0 1-1.024-.274l-1.25-2.165a.75.75 0 0 1 1.298-.75l1.25 2.165A.75.75 0 0 1 12 14.928Z",clipRule:"evenodd",opacity:.8}),m.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 4.536a.75.75 0 0 1-1.024-.275l-1.25-2.165a.75.75 0 1 1 1.299-.75l1.25 2.165A.75.75 0 0 1 6 4.536Z",clipRule:"evenodd",opacity:.2})),pG=t=>m.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},m.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},m.createElement("path",{d:"M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25"}))),mG=m.forwardRef(function({trackRef:t,...e},n){const i=ep(),{mergedProps:r,inFocus:s}=LK({trackRef:t??i,props:e});return m.createElement(Zf.Consumer,null,o=>o!==void 0&&m.createElement("button",{ref:n,...r},e.children?e.children:s?m.createElement(pG,null):m.createElement(rG,null)))}),Bm=m.forwardRef(function({kind:t,initialSelection:e,onActiveDeviceChange:n,onDeviceListChange:i,onDeviceSelectError:r,exactMatch:s,track:o,requestPermissions:a,onError:c,...l},u){const h=np(),f=m.useCallback(R=>{h&&h.emit(F.MediaDevicesError,R),c==null||c(R)},[h,c]),{devices:g,activeDeviceId:b,setActiveMediaDevice:y,className:T}=VK({kind:t,room:h,track:o,requestPermissions:a,onError:f});m.useEffect(()=>{e!==void 0&&y(e)},[y]),m.useEffect(()=>{typeof i=="function"&&i(g)},[i,g]),m.useEffect(()=>{b&&b!==""&&(n==null||n(b))},[b]);const v=async R=>{try{await y(R,{exact:s})}catch(O){if(O instanceof Error)r==null||r(O);else throw O}},w=m.useMemo(()=>us(l,{className:T},{className:"lk-list"}),[T,l]),S=!!g.find(R=>R.label.toLowerCase().startsWith("default"));function P(R,O,E){return R===O||!S&&E===0&&O==="default"}return m.createElement("ul",{ref:u,...w},g.map((R,O)=>m.createElement("li",{key:R.deviceId,id:R.deviceId,"data-lk-active":P(R.deviceId,b,O),"aria-selected":P(R.deviceId,b,O),role:"option"},m.createElement("button",{className:"lk-button",onClick:()=>v(R.deviceId)},R.label))))}),gG=m.forwardRef(function({label:t,...e},n){const i=tp(),{mergedProps:r,canPlayAudio:s}=zK({room:i,props:e}),{mergedProps:o,canPlayVideo:a}=qK({room:i,props:r}),{style:c,...l}=o;return c.display=s&&a?"none":"block",m.createElement("button",{ref:n,style:c,...l},t??`Start ${s?"Video":"Audio"}`)});function VN(t,e){switch(t){case j.Source.Microphone:return e?m.createElement(cG,null):m.createElement(aG,null);case j.Source.Camera:return e?m.createElement(tG,null):m.createElement(eG,null);case j.Source.ScreenShare:return e?m.createElement(fG,null):m.createElement(FN,null);default:return}}function vG(t){switch(t){case xn.Excellent:return m.createElement(lG,null);case xn.Good:return m.createElement(uG,null);case xn.Poor:return m.createElement(dG,null);default:return m.createElement(hG,null)}}const $c=m.forwardRef(function({showIcon:t,...e},n){const{buttonProps:i,enabled:r}=GK(e);return m.createElement("button",{ref:n,...i},(t??!0)&&VN(e.source,r),e.children)}),yG=m.forwardRef(function(t,e){const{className:n,quality:i}=NK(t),r=m.useMemo(()=>({...us(t,{className:n}),"data-lk-quality":i}),[i,t,n]);return m.createElement("div",{ref:e,...r},t.children??vG(i))}),f1=m.forwardRef(function({participant:t,...e},n){const i=Yl(t),{className:r,infoObserver:s}=m.useMemo(()=>HW(i),[i]),{identity:o,name:a}=pn(s,{name:i.name,identity:i.identity,metadata:i.metadata}),c=m.useMemo(()=>us(e,{className:r,"data-lk-participant-name":a}),[e,r,a]);return m.createElement("span",{ref:n,...c},a!==""?a:o,e.children)}),bG=m.forwardRef(function({trackRef:t,show:e="always",...n},i){const{className:r,isMuted:s}=KK(t),o=e==="always"||e==="muted"&&s||e==="unmuted"&&!s,a=m.useMemo(()=>us(n,{className:r}),[r,n]);return o?m.createElement("div",{ref:i,...a,"data-lk-muted":s},n.children??VN(t.source,!s)):null}),jN=t=>m.createElement("svg",{width:320,height:320,viewBox:"0 0 320 320",preserveAspectRatio:"xMidYMid meet",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",fill:"white",fillOpacity:.25}),m.createElement("path",{d:"M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",fill:"white",fillOpacity:.25}));function $N(t,e={}){const[n,i]=m.useState(dy(t)),[r,s]=m.useState(n==null?void 0:n.isMuted),[o,a]=m.useState(n==null?void 0:n.isSubscribed),[c,l]=m.useState(n==null?void 0:n.track),[u,h]=m.useState("landscape"),f=m.useRef(),{className:g,trackObserver:b}=m.useMemo(()=>CW(t),[t.participant.sid??t.participant.identity,t.source,hn(t)&&t.publication.trackSid]);return m.useEffect(()=>{const y=b.subscribe(T=>{de.debug("update track",T),i(T),s(T==null?void 0:T.isMuted),a(T==null?void 0:T.isSubscribed),l(T==null?void 0:T.track)});return()=>y==null?void 0:y.unsubscribe()},[b]),m.useEffect(()=>{var y,T;return c&&(f.current&&c.detach(f.current),(y=e.element)!=null&&y.current&&!(t.participant.isLocal&&(c==null?void 0:c.kind)==="audio")&&c.attach(e.element.current)),f.current=(T=e.element)==null?void 0:T.current,()=>{f.current&&(c==null||c.detach(f.current))}},[c,e.element]),m.useEffect(()=>{var y,T;if(typeof((y=n==null?void 0:n.dimensions)==null?void 0:y.width)=="number"&&typeof((T=n==null?void 0:n.dimensions)==null?void 0:T.height)=="number"){const v=n.dimensions.width>n.dimensions.height?"landscape":"portrait";h(v)}},[n]),{publication:n,isMuted:r,isSubscribed:o,track:c,elementProps:us(e.props,{className:g,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":n==null?void 0:n.source,...(n==null?void 0:n.kind)==="video"&&{"data-lk-orientation":u}})}}var TG="Expected a function",p1=NaN,kG="[object Symbol]",wG=/^\s+|\s+$/g,_G=/^[-+]0x[0-9a-f]+$/i,SG=/^0b[01]+$/i,EG=/^0o[0-7]+$/i,CG=parseInt,IG=typeof Tc=="object"&&Tc&&Tc.Object===Object&&Tc,PG=typeof self=="object"&&self&&self.Object===Object&&self,RG=IG||PG||Function("return this")(),xG=Object.prototype,AG=xG.toString,NG=Math.max,OG=Math.min,zm=function(){return RG.Date.now()};function DG(t,e,n){var i,r,s,o,a,c,l=0,u=!1,h=!1,f=!0;if(typeof t!="function")throw new TypeError(TG);e=m1(e)||0,fy(n)&&(u=!!n.leading,h="maxWait"in n,s=h?NG(m1(n.maxWait)||0,e):s,f="trailing"in n?!!n.trailing:f);function g(O){var E=i,_=r;return i=r=void 0,l=O,o=t.apply(_,E),o}function b(O){return l=O,a=setTimeout(v,e),u?g(O):o}function y(O){var E=O-c,_=O-l,C=e-E;return h?OG(C,s-_):C}function T(O){var E=O-c,_=O-l;return c===void 0||E>=e||E<0||h&&_>=s}function v(){var O=zm();if(T(O))return w(O);a=setTimeout(v,y(O))}function w(O){return a=void 0,f&&i?g(O):(i=r=void 0,o)}function S(){a!==void 0&&clearTimeout(a),l=0,i=c=r=a=void 0}function P(){return a===void 0?o:w(zm())}function R(){var O=zm(),E=T(O);if(i=arguments,r=this,c=O,E){if(a===void 0)return b(c);if(h)return a=setTimeout(v,e),g(c)}return a===void 0&&(a=setTimeout(v,e)),o}return R.cancel=S,R.flush=P,R}function fy(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function LG(t){return!!t&&typeof t=="object"}function MG(t){return typeof t=="symbol"||LG(t)&&AG.call(t)==kG}function m1(t){if(typeof t=="number")return t;if(MG(t))return p1;if(fy(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=fy(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(wG,"");var n=SG.test(t);return n||EG.test(t)?CG(t.slice(2),n?2:8):_G.test(t)?p1:+t}var UG=DG;const g1=GA(UG);function FG(t){const e=m.useRef(t);e.current=t,m.useEffect(()=>()=>{e.current()},[])}function VG(t,e=500,n){const i=m.useRef();FG(()=>{i.current&&i.current.cancel()});const r=m.useMemo(()=>{const s=g1(t,e,n),o=(...a)=>s(...a);return o.cancel=()=>{s.cancel()},o.isPending=()=>!!i.current,o.flush=()=>s.flush(),o},[t,e,n]);return m.useEffect(()=>{i.current=g1(t,e,n)},[t,e,n]),r}function jG(t,e,n){const i=(l,u)=>l===u,r=t instanceof Function?t():t,[s,o]=m.useState(r),a=m.useRef(r),c=VG(o,e,n);return i(a.current,r)||(c(r),a.current=r),[s,c]}function $G({threshold:t=0,root:e=null,rootMargin:n="0%",freezeOnceVisible:i=!1,initialIsIntersecting:r=!1,onChange:s}={}){var o;const[a,c]=m.useState(null),[l,u]=m.useState(()=>({isIntersecting:r,entry:void 0})),h=m.useRef();h.current=s;const f=((o=l.entry)==null?void 0:o.isIntersecting)&&i;m.useEffect(()=>{if(!a||!("IntersectionObserver"in window)||f)return;let y;const T=new IntersectionObserver(v=>{const w=Array.isArray(T.thresholds)?T.thresholds:[T.thresholds];v.forEach(S=>{const P=S.isIntersecting&&w.some(R=>S.intersectionRatio>=R);u({isIntersecting:P,entry:S}),h.current&&h.current(P,S),P&&i&&y&&(y(),y=void 0)})},{threshold:t,root:e,rootMargin:n});return T.observe(a),()=>{T.disconnect()}},[a,JSON.stringify(t),e,n,f,i]);const g=m.useRef(null);m.useEffect(()=>{var y;!a&&(y=l.entry)!=null&&y.target&&!i&&!f&&g.current!==l.entry.target&&(g.current=l.entry.target,u({isIntersecting:r,entry:void 0}))},[a,l.entry,i,f,r]);const b=[c,!!l.isIntersecting,l.entry];return b.ref=b[0],b.isIntersecting=b[1],b.entry=b[2],b}const BG=m.forwardRef(function({onTrackClick:t,onClick:e,onSubscriptionStatusChanged:n,trackRef:i,manageSubscription:r,...s},o){const a=Ma(i),c=m.useRef(null);m.useImperativeHandle(o,()=>c.current);const l=$G({root:c.current}),[u]=jG(l,3e3);m.useEffect(()=>{r&&a.publication instanceof _l&&(u==null?void 0:u.isIntersecting)===!1&&(l==null?void 0:l.isIntersecting)===!1&&a.publication.setSubscribed(!1)},[u,a,r]),m.useEffect(()=>{r&&a.publication instanceof _l&&(l==null?void 0:l.isIntersecting)===!0&&a.publication.setSubscribed(!0)},[l,a,r]);const{elementProps:h,publication:f,isSubscribed:g}=$N(a,{element:c,props:s});m.useEffect(()=>{n==null||n(!!g)},[g,n]);const b=y=>{e==null||e(y),t==null||t({participant:a==null?void 0:a.participant,track:f})};return m.createElement("video",{ref:c,...h,muted:!0,onClick:b})}),BN=m.forwardRef(function({trackRef:t,onSubscriptionStatusChanged:e,volume:n,muted:i,...r},s){const o=Ma(t),a=m.useRef(null);m.useImperativeHandle(s,()=>a.current);const{elementProps:c,isSubscribed:l,track:u,publication:h}=$N(o,{element:a,props:r});return m.useEffect(()=>{e==null||e(!!l)},[l,e]),m.useEffect(()=>{u===void 0||n===void 0||(u instanceof Xo?u.setVolume(n):de.warn("Volume can only be set on remote audio tracks."))},[n,u]),m.useEffect(()=>{h===void 0||i===void 0||(h instanceof _l?h.setEnabled(!i):de.warn("Can only call setEnabled on remote track publications."))},[i,h,u]),m.createElement("audio",{ref:a,...c})});function zG(t){const e=!!PN();return t.participant&&!e?m.createElement(IN.Provider,{value:t.participant},t.children):m.createElement(m.Fragment,null,t.children)}function qG(t){const e=!!ep();return t.trackRef&&!e?m.createElement(xb.Provider,{value:t.trackRef},t.children):m.createElement(m.Fragment,null,t.children)}const py=m.forwardRef(function({trackRef:t,children:e,onParticipantClick:n,disableSpeakingIndicator:i,...r},s){var o,a;const c=Ma(t),{elementProps:l}=$K({htmlProps:r,disableSpeakingIndicator:i,onParticipantClick:n,trackRef:c}),u=XK(c.participant),h=Jl(),f=(o=TK())==null?void 0:o.autoSubscription,g=m.useCallback(b=>{c.source&&!b&&h&&h.pin.dispatch&&vN(c,h.pin.state)&&h.pin.dispatch({msg:"clear_pin"})},[c,h]);return m.createElement("div",{ref:s,style:{position:"relative"},...l},m.createElement(qG,{trackRef:c},m.createElement(zG,{participant:c.participant},e??m.createElement(m.Fragment,null,hn(c)&&(((a=c.publication)==null?void 0:a.kind)==="video"||c.source===j.Source.Camera||c.source===j.Source.ScreenShare)?m.createElement(BG,{trackRef:c,onSubscriptionStatusChanged:g,manageSubscription:f}):hn(c)&&m.createElement(BN,{trackRef:c,onSubscriptionStatusChanged:g}),m.createElement("div",{className:"lk-participant-placeholder"},m.createElement(jN,null)),m.createElement("div",{className:"lk-participant-metadata"},m.createElement("div",{className:"lk-participant-metadata-item"},c.source===j.Source.Camera?m.createElement(m.Fragment,null,u&&m.createElement(oG,{style:{marginRight:"0.25rem"}}),m.createElement(bG,{trackRef:{participant:c.participant,source:j.Source.Microphone},show:"muted"}),m.createElement(f1,null)):m.createElement(m.Fragment,null,m.createElement(FN,{style:{marginRight:"0.25rem"}}),m.createElement(f1,null,"'s screen"))),m.createElement(yG,{className:"lk-participant-metadata-item"}))),m.createElement(mG,{trackRef:c}))))});function HG(t){const e=us(t,{className:"lk-focus-layout"});return m.createElement("div",{...e},t.children)}function WG({trackRef:t,...e}){return m.createElement(py,{trackRef:t,...e})}function zN({tracks:t,...e}){return m.createElement(m.Fragment,null,t.map(n=>m.createElement(xb.Provider,{value:n,key:$t(n)},_K(e.children))))}function KG({totalPageCount:t,nextPage:e,prevPage:n,currentPage:i,pagesContainer:r}){const[s,o]=m.useState(!1);return m.useEffect(()=>{let a;return r&&(a=aK(r.current,2e3).subscribe(o)),()=>{a&&a.unsubscribe()}},[r]),m.createElement("div",{className:"lk-pagination-control","data-lk-user-interaction":s},m.createElement("button",{className:"lk-button",onClick:n},m.createElement(d1,null)),m.createElement("span",{className:"lk-pagination-count"},`${i} of ${t}`),m.createElement("button",{className:"lk-button",onClick:e},m.createElement(d1,null)))}const GG=m.forwardRef(function({totalPageCount:t,currentPage:e},n){const i=new Array(t).fill("").map((r,s)=>s+1===e?m.createElement("span",{"data-lk-active":!0,key:s}):m.createElement("span",{key:s}));return m.createElement("div",{ref:n,className:"lk-pagination-indicator"},i)});function QG({tracks:t,...e}){const n=m.createRef(),i=m.useMemo(()=>us(e,{className:"lk-grid-layout"}),[e]),{layout:r}=MK(n,t.length),s=jK(r.maxTiles,t);return HK(n,{onLeftSwipe:s.nextPage,onRightSwipe:s.prevPage}),m.createElement("div",{ref:n,"data-lk-pagination":s.totalPageCount>1,...i},m.createElement(zN,{tracks:s.tracks},e.children),t.length>r.maxTiles&&m.createElement(m.Fragment,null,m.createElement(GG,{totalPageCount:s.totalPageCount,currentPage:s.currentPage}),m.createElement(KG,{pagesContainer:n,...s})))}const JG=130,YG=140,XG=1,qN=16/10,ZG=(1-qN)*-1;function eQ({tracks:t,orientation:e,...n}){const i=m.useRef(null),[r,s]=m.useState(0),{width:o,height:a}=ON(i),c=e||(a>=o?"vertical":"horizontal"),l=c==="vertical"?Math.max(o*ZG,JG):Math.max(a*qN,YG),u=nW(),h=Math.max(c==="vertical"?(a-u)/l:(o-u)/l,XG);let f=Math.round(h);Math.abs(h-r)<.5?f=Math.round(r):r!==h&&s(h);const g=DN(t,f);return m.useLayoutEffect(()=>{i.current&&(i.current.dataset.lkOrientation=c,i.current.style.setProperty("--lk-max-visible-tiles",f.toString()))},[f,c]),m.createElement("aside",{key:c,className:"lk-carousel",ref:i,...n},m.createElement(zN,{tracks:g},n.children))}function tQ({value:t,onPinChange:e,onWidgetChange:n,children:i}){const r=bK(t);return m.useEffect(()=>{de.debug("PinState Updated",{state:r.pin.state}),e&&r.pin.state&&e(r.pin.state)},[r.pin.state,e]),m.useEffect(()=>{de.debug("Widget Updated",{widgetState:r.widget.state}),n&&r.widget.state&&n(r.widget.state)},[n,r.widget.state]),m.createElement(Zf.Provider,{value:r},i)}function nQ({volume:t,muted:e}){const n=LN([j.Source.Microphone,j.Source.ScreenShareAudio,j.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter(i=>!i.participant.isLocal&&i.publication.kind===j.Kind.Audio);return m.createElement("div",{style:{display:"none"}},n.map(i=>m.createElement(BN,{key:$t(i),trackRef:i,volume:t,muted:e})))}function iQ(t){const e=m.useMemo(()=>us(t,{className:"lk-toast"}),[t]);return m.createElement("div",{...e},t.children)}function rQ(t){const[e,n]=m.useState(void 0),i=Nb(t.room);return m.useEffect(()=>{switch(i){case pe.Reconnecting:n(m.createElement(m.Fragment,null,m.createElement(h1,{className:"lk-spinner"})," Reconnecting"));break;case pe.Connecting:n(m.createElement(m.Fragment,null,m.createElement(h1,{className:"lk-spinner"})," Connecting"));break;case pe.Disconnected:n(m.createElement(m.Fragment,null,"Disconnected"));break;default:n(void 0);break}},[i]),e?m.createElement(iQ,{className:"lk-toast-connection-state"},e):m.createElement(m.Fragment,null)}const sQ=m.forwardRef(function({entry:t,hideName:e=!1,hideTimestamp:n=!1,messageFormatter:i,...r},s){var o,a,c;const l=m.useMemo(()=>i?i(t.message):t.message,[t.message,i]),u=!!t.editTimestamp,h=new Date(t.timestamp),f=navigator?navigator.language:"en-US";return m.createElement("li",{ref:s,className:"lk-chat-entry",title:h.toLocaleTimeString(f,{timeStyle:"full"}),"data-lk-message-origin":(o=t.from)!=null&&o.isLocal?"local":"remote",...r},(!n||!e||u)&&m.createElement("span",{className:"lk-meta-data"},!e&&m.createElement("strong",{className:"lk-participant-name"},((a=t.from)==null?void 0:a.name)??((c=t.from)==null?void 0:c.identity)),(!n||u)&&m.createElement("span",{className:"lk-timestamp"},u&&"edited ",h.toLocaleTimeString(f,{timeStyle:"short"}))),m.createElement("span",{className:"lk-message-body"},l))});function jh({kind:t,initialSelection:e,onActiveDeviceChange:n,tracks:i,requestPermissions:r=!1,...s}){const[o,a]=m.useState(!1),[c,l]=m.useState([]),[u,h]=m.useState(!0),[f,g]=m.useState(r),b=(w,S)=>{de.debug("handle device change"),a(!1),n==null||n(w,S)},y=m.useRef(null),T=m.useRef(null);m.useLayoutEffect(()=>{o&&g(!0)},[o]),m.useLayoutEffect(()=>{y.current&&T.current&&(c||u)&&iW(y.current,T.current).then(({x:w,y:S})=>{T.current&&Object.assign(T.current.style,{left:`${w}px`,top:`${S}px`})}),h(!1)},[y,T,c,u]);const v=m.useCallback(w=>{T.current&&w.target!==y.current&&o&&rW(T.current,w)&&a(!1)},[o,T,y]);return m.useEffect(()=>(document.addEventListener("click",v),window.addEventListener("resize",()=>h(!0)),()=>{document.removeEventListener("click",v),window.removeEventListener("resize",()=>h(!0))}),[v,h]),m.createElement(m.Fragment,null,m.createElement("button",{className:"lk-button lk-button-menu","aria-pressed":o,...s,onClick:()=>a(!o),ref:y},s.children),!s.disabled&&m.createElement("div",{className:"lk-device-menu",ref:T,style:{visibility:o?"visible":"hidden"}},t?m.createElement(Bm,{initialSelection:e,onActiveDeviceChange:w=>b(t,w),onDeviceListChange:l,kind:t,track:i==null?void 0:i[t],requestPermissions:f}):m.createElement(m.Fragment,null,m.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),m.createElement(Bm,{kind:"audioinput",onActiveDeviceChange:w=>b("audioinput",w),onDeviceListChange:l,track:i==null?void 0:i.audioinput,requestPermissions:f}),m.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),m.createElement(Bm,{kind:"videoinput",onActiveDeviceChange:w=>b("videoinput",w),onDeviceListChange:l,track:i==null?void 0:i.videoinput,requestPermissions:f}))))}function oQ(){m.useEffect(()=>{SK()},[])}function aQ(t,e){const[n,i]=m.useState(),r=m.useMemo(()=>new rn,[]);return m.useEffect(()=>{let s=!1,o=[];return r.lock().then(async a=>{try{(t.audio||t.video)&&(o=await gb(t),s?o.forEach(c=>c.stop()):i(o))}catch(c){e&&c instanceof Error?e(c):de.error(c)}finally{a()}}),()=>{s=!0,o.forEach(a=>{a.stop()})}},[JSON.stringify(t,NN),e,r]),n}function cQ({defaults:t={},onValidate:e,onSubmit:n,onError:i,debug:r,joinLabel:s="Join Room",micLabel:o="Microphone",camLabel:a="Camera",userLabel:c="Username",persistUserChoices:l=!0,videoProcessor:u,...h}){const[f,g]=m.useState(ko),b={...t.audioDeviceId!==void 0&&{audioDeviceId:t.audioDeviceId},...t.videoDeviceId!==void 0&&{videoDeviceId:t.videoDeviceId},...t.audioEnabled!==void 0&&{audioEnabled:t.audioEnabled},...t.videoEnabled!==void 0&&{videoEnabled:t.videoEnabled},...t.username!==void 0&&{username:t.username}},{userChoices:y,saveAudioInputDeviceId:T,saveAudioInputEnabled:v,saveVideoInputDeviceId:w,saveVideoInputEnabled:S,saveUsername:P}=MN({defaults:b,preventSave:!l,preventLoad:!l}),[R,O]=m.useState(y.audioEnabled),[E,_]=m.useState(y.videoEnabled),[C,x]=m.useState(y.audioDeviceId),[A,L]=m.useState(y.videoDeviceId),[D,le]=m.useState(y.username);m.useEffect(()=>{v(R)},[R,v]),m.useEffect(()=>{S(E)},[E,S]),m.useEffect(()=>{T(C)},[C,T]),m.useEffect(()=>{w(A)},[A,w]),m.useEffect(()=>{P(D)},[D,P]);const ge=aQ({audio:R?{deviceId:y.audioDeviceId}:!1,video:E?{deviceId:y.videoDeviceId,processor:u}:!1},i),$e=m.useRef(null),fe=m.useMemo(()=>ge==null?void 0:ge.filter(Ee=>Ee.kind===j.Kind.Video)[0],[ge]),W=m.useMemo(()=>{if(fe){const{facingMode:Ee}=MA(fe);return Ee}else return"undefined"},[fe]),ee=m.useMemo(()=>ge==null?void 0:ge.filter(Ee=>Ee.kind===j.Kind.Audio)[0],[ge]);m.useEffect(()=>($e.current&&fe&&(fe.unmute(),fe.attach($e.current)),()=>{fe==null||fe.detach()}),[fe]);const[ne,Pe]=m.useState(),ve=m.useCallback(Ee=>typeof e=="function"?e(Ee):Ee.username!=="",[e]);m.useEffect(()=>{const Ee={username:D,videoEnabled:E,videoDeviceId:A,audioEnabled:R,audioDeviceId:C};g(Ee),Pe(ve(Ee))},[D,E,ve,R,C,A]);function He(Ee){Ee.preventDefault(),ve(f)?typeof n=="function"&&n(f):de.warn("Validation failed with: ",f)}return oQ(),m.createElement("div",{className:"lk-prejoin",...h},m.createElement("div",{className:"lk-video-container"},fe&&m.createElement("video",{ref:$e,width:"1280",height:"720","data-lk-facing-mode":W}),(!fe||!E)&&m.createElement("div",{className:"lk-camera-off-note"},m.createElement(jN,null))),m.createElement("div",{className:"lk-button-group-container"},m.createElement("div",{className:"lk-button-group audio"},m.createElement($c,{initialState:R,source:j.Source.Microphone,onChange:Ee=>O(Ee)},o),m.createElement("div",{className:"lk-button-group-menu"},m.createElement(jh,{initialSelection:C,kind:"audioinput",disabled:!ee,tracks:{audioinput:ee},onActiveDeviceChange:(Ee,mn)=>x(mn)}))),m.createElement("div",{className:"lk-button-group video"},m.createElement($c,{initialState:E,source:j.Source.Camera,onChange:Ee=>_(Ee)},a),m.createElement("div",{className:"lk-button-group-menu"},m.createElement(jh,{initialSelection:A,kind:"videoinput",disabled:!fe,tracks:{videoinput:fe},onActiveDeviceChange:(Ee,mn)=>L(mn)})))),m.createElement("form",{className:"lk-username-container"},m.createElement("input",{className:"lk-form-control",id:"username",name:"username",type:"text",defaultValue:D,placeholder:c,onChange:Ee=>le(Ee.target.value),autoComplete:"off"}),m.createElement("button",{className:"lk-button lk-join-button",type:"submit",onClick:He,disabled:!ne},s)),r&&m.createElement(m.Fragment,null,m.createElement("strong",null,"User Choices:"),m.createElement("ul",{className:"lk-list",style:{overflow:"hidden",maxWidth:"15rem"}},m.createElement("li",null,"Username: ",`${f.username}`),m.createElement("li",null,"Video Enabled: ",`${f.videoEnabled}`),m.createElement("li",null,"Audio Enabled: ",`${f.audioEnabled}`),m.createElement("li",null,"Video Device: ",`${f.videoDeviceId}`),m.createElement("li",null,"Audio Device: ",`${f.audioDeviceId}`))))}var HN={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(CO,function(){var e=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],s={},o=null;function a(y,T){var v=y[T];if(typeof v.bind=="function")return v.bind(y);try{return Function.prototype.bind.call(v,y)}catch{return function(){return Function.prototype.apply.apply(v,[y,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(y){return y==="debug"&&(y="log"),typeof console===n?!1:y==="trace"&&i?c:console[y]!==void 0?a(console,y):console.log!==void 0?a(console,"log"):e}function u(){for(var y=this.getLevel(),T=0;T<r.length;T++){var v=r[T];this[v]=T<y?e:this.methodFactory(v,y,this.name)}if(this.log=this.debug,typeof console===n&&y<this.levels.SILENT)return"No console available for logging"}function h(y){return function(){typeof console!==n&&(u.call(this),this[y].apply(this,arguments))}}function f(y,T,v){return l(y)||h.apply(this,arguments)}function g(y,T){var v=this,w,S,P,R="loglevel";typeof y=="string"?R+=":"+y:typeof y=="symbol"&&(R=void 0);function O(A){var L=(r[A]||"silent").toUpperCase();if(!(typeof window===n||!R)){try{window.localStorage[R]=L;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+L+";"}catch{}}}function E(){var A;if(!(typeof window===n||!R)){try{A=window.localStorage[R]}catch{}if(typeof A===n)try{var L=window.document.cookie,D=encodeURIComponent(R),le=L.indexOf(D+"=");le!==-1&&(A=/^([^;]+)/.exec(L.slice(le+D.length+1))[1])}catch{}return v.levels[A]===void 0&&(A=void 0),A}}function _(){if(!(typeof window===n||!R)){try{window.localStorage.removeItem(R)}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function C(A){var L=A;if(typeof L=="string"&&v.levels[L.toUpperCase()]!==void 0&&(L=v.levels[L.toUpperCase()]),typeof L=="number"&&L>=0&&L<=v.levels.SILENT)return L;throw new TypeError("log.setLevel() called with invalid level: "+A)}v.name=y,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=T||f,v.getLevel=function(){return P??S??w},v.setLevel=function(A,L){return P=C(A),L!==!1&&O(P),u.call(v)},v.setDefaultLevel=function(A){S=C(A),E()||v.setLevel(A,!1)},v.resetLevel=function(){P=null,_(),u.call(v)},v.enableAll=function(A){v.setLevel(v.levels.TRACE,A)},v.disableAll=function(A){v.setLevel(v.levels.SILENT,A)},v.rebuild=function(){if(o!==v&&(w=C(o.getLevel())),u.call(v),o===v)for(var A in s)s[A].rebuild()},w=C(o?o.getLevel():"WARN");var x=E();x!=null&&(P=C(x)),u.call(v)}o=new g,o.getLogger=function(T){if(typeof T!="symbol"&&typeof T!="string"||T==="")throw new TypeError("You must supply a name when creating a logger.");var v=s[T];return v||(v=s[T]=new g(T,o.methodFactory)),v};var b=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=b),o},o.getLoggers=function(){return s},o.default=o,o})})(HN);var lQ=HN.exports;const uQ=gy(lQ);function na(t){return typeof t>"u"?!1:dQ(t)||hQ(t)}function dQ(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function hQ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function fQ(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function v1(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(fQ(t))return`${t.participant.identity}_${t.source}_placeholder`;if(na(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function pQ(t,e){return t===void 0||e===void 0?!1:na(t)&&na(e)?t.publication.trackSid===e.publication.trackSid:v1(t)===v1(e)}function mQ(){return typeof document<"u"}var gQ=[F.ConnectionStateChanged,F.RoomMetadataChanged,F.ActiveSpeakersChanged,F.ConnectionQualityChanged,F.ParticipantConnected,F.ParticipantDisconnected,F.ParticipantPermissionsChanged,F.ParticipantMetadataChanged,F.ParticipantNameChanged,F.ParticipantAttributesChanged,F.TrackMuted,F.TrackUnmuted,F.TrackPublished,F.TrackUnpublished,F.TrackStreamStateChanged,F.TrackSubscriptionFailed,F.TrackSubscriptionPermissionChanged,F.TrackSubscriptionStatusChanged];[...gQ,F.LocalTrackPublished,F.LocalTrackUnpublished];V.TrackPublished,V.TrackUnpublished,V.TrackMuted,V.TrackUnmuted,V.TrackStreamStateChanged,V.TrackSubscribed,V.TrackUnsubscribed,V.TrackSubscriptionPermissionChanged,V.TrackSubscriptionFailed,V.LocalTrackPublished,V.LocalTrackUnpublished;var vQ=[V.ConnectionQualityChanged,V.IsSpeakingChanged,V.ParticipantMetadataChanged,V.ParticipantPermissionsChanged,V.TrackMuted,V.TrackUnmuted,V.TrackPublished,V.TrackUnpublished,V.TrackStreamStateChanged,V.TrackSubscriptionFailed,V.TrackSubscriptionPermissionChanged,V.TrackSubscriptionStatusChanged];[...vQ,V.LocalTrackPublished,V.LocalTrackUnpublished];var Ld=uQ.getLogger("lk-components-js");Ld.setDefaultLevel("WARN");new TextEncoder;new TextDecoder;function yQ(t){const e=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,i]=m.useState(e(t));function r(){i(e(t))}return m.useEffect(()=>{const s=window.matchMedia(t);return r(),s.addListener?s.addListener(r):s.addEventListener("change",r),()=>{s.removeListener?s.removeListener(r):s.removeEventListener("change",r)}},[t]),n}function bQ(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}class TQ{getToken(e,n){return Cr.post("/openvidu/token",{roomName:e,participantName:n})}startRecording(e){return Cr.post("/openvidu/recordings/start",{roomName:e})}stopRecording(e){return Cr.post("/openvidu/recordings/stop",{roomName:e})}deleteRecording(e){return Cr.delete(`/openvidu/recordings/${e}`)}listRecordings(e,n){const i="/openvidu/recordings"+(e?`?roomName=${e}`+(n?`&roomId=${n}`:""):"");return Cr.get(i)}}const Bc=new TQ;function kQ(){const t=Ua(),[e,n]=m.useState("錄製"),{summarizeMeeting:i}=Mf(),{user:r}=cs(),[s,o]=m.useState(""),a=()=>{Ce.success("摘要生成完成",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},c=()=>{Ce.error("摘要生成失敗",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})};m.useEffect(()=>{const u=async h=>{if(h)n("停止");else if(n("錄製"),r&&s!=="")try{await i(r.id,void 0,s)?a():c()}catch{c()}else c()};return t.on(F.RecordingStatusChanged,u),()=>{t.off(F.RecordingStatusChanged,u)}},[t,r,s]);const l=async()=>{if(t.isRecording){n("停止中...");const u=await Bc.stopRecording(t.name);console.log(u.data.recording),u.status===409?n("停止"):u.status===200&&o(u.data.recording.name)}else{n("錄製中...");const u=await Bc.startRecording(t.name);console.log(u.data),u.status===409&&n("錄製")}};return I.jsxs("button",{onClick:l,id:"recordButton",className:"flex items-center justify-center px-6 py-3 rounded-md bg-red-600 text-white font-bold text-lg shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2",children:[I.jsx("span",{id:"recordIcon",className:"mr-2 w-4 h-4 bg-red-800 rounded-full"}),I.jsxs("span",{id:"recordText",children:[" ",e]})]})}function wQ({variation:t,controls:e,saveUserChoices:n=!0,onDeviceError:i,...r}){var _;const[s,o]=m.useState(!1),a=Jl();m.useEffect(()=>{var C,x;((C=a==null?void 0:a.widget.state)==null?void 0:C.showChat)!==void 0&&o((x=a==null?void 0:a.widget.state)==null?void 0:x.showChat)},[(_=a==null?void 0:a.widget.state)==null?void 0:_.showChat]);const l=yQ(`(max-width: ${s?1e3:760}px)`)?"minimal":"verbose";t??(t=l);const u={leave:!0,...e},h=FK();h?(u.camera??(u.camera=h.canPublish),u.microphone??(u.microphone=h.canPublish),u.screenShare??(u.screenShare=h.canPublish),u.chat??(u.chat=h.canPublishData&&(e==null?void 0:e.chat))):(u.camera=!1,u.chat=!1,u.microphone=!1,u.screenShare=!1);const f=m.useMemo(()=>t==="minimal"||t==="verbose",[t]),g=m.useMemo(()=>t==="textOnly"||t==="verbose",[t]),b=bQ(),[y,T]=m.useState(!1),v=m.useCallback(C=>{T(C)},[T]),{saveAudioInputEnabled:w,saveVideoInputEnabled:S,saveAudioInputDeviceId:P,saveVideoInputDeviceId:R}=MN({preventSave:!n}),O=m.useCallback((C,x)=>x?w(C):null,[w]),E=m.useCallback((C,x)=>x?S(C):null,[S]);return I.jsxs("div",{className:"lk-control-bar",...r,children:[u.microphone&&I.jsxs("div",{className:"lk-button-group",children:[I.jsx($c,{source:j.Source.Microphone,showIcon:f,onChange:O,onDeviceError:C=>i==null?void 0:i({source:j.Source.Microphone,error:C}),children:g&&"麥克風"}),I.jsx("div",{className:"lk-button-group-menu",children:I.jsx(jh,{kind:"audioinput",onActiveDeviceChange:(C,x)=>P(x??"default")})})]}),u.camera&&I.jsxs("div",{className:"lk-button-group",children:[I.jsx($c,{source:j.Source.Camera,showIcon:f,onChange:E,onDeviceError:C=>i==null?void 0:i({source:j.Source.Camera,error:C}),children:g&&"相機"}),I.jsx("div",{className:"lk-button-group-menu",children:I.jsx(jh,{kind:"videoinput",onActiveDeviceChange:(C,x)=>R(x??"default")})})]}),u.screenShare&&b&&I.jsx($c,{source:j.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:f,onChange:v,onDeviceError:C=>i==null?void 0:i({source:j.Source.ScreenShare,error:C}),children:g&&(y?"停止螢幕分享":"開始螢幕分享")}),u.chat&&I.jsxs(UN,{children:[f&&I.jsx(iG,{}),g&&"聊天"]}),I.jsx(kQ,{}),u.leave&&I.jsxs(ZK,{children:[f&&I.jsx(sG,{}),g&&"離開"]}),I.jsx(gG,{})]})}function _Q(t,e,n){return m.Children.map(t,i=>m.isValidElement(i)&&m.Children.only(t)?(i.props.class&&(e??(e={}),e.class=zr(i.props.class,e.class),e.style={...i.props.style,...e.style}),m.cloneElement(i,{...e,key:n})):i)}function SQ({messageFormatter:t,messageDecoder:e,messageEncoder:n,channelTopic:i,...r}){const s=m.useRef(null),o=m.useRef(null),a=m.useMemo(()=>({messageDecoder:e,messageEncoder:n,channelTopic:i}),[e,n,i]),{send:c,chatMessages:l,isSending:u}=YK(a),h=Jl(),f=m.useRef(0);async function g(b){b.preventDefault(),s.current&&s.current.value.trim()!==""&&c&&(await c(s.current.value),s.current.value="",s.current.focus())}return m.useEffect(()=>{var b;o&&((b=o.current)==null||b.scrollTo({top:o.current.scrollHeight}))},[o,l]),m.useEffect(()=>{var T,v,w,S,P;if(!h||l.length===0)return;if((T=h.widget.state)!=null&&T.showChat&&l.length>0&&f.current!==((v=l[l.length-1])==null?void 0:v.timestamp)){f.current=(w=l[l.length-1])==null?void 0:w.timestamp;return}const b=l.filter(R=>!f.current||R.timestamp>f.current).length,{widget:y}=h;b>0&&((S=y.state)==null?void 0:S.unreadMessages)!==b&&((P=y.dispatch)==null||P.call(y,{msg:"unread_msg",count:b}))},[l,h==null?void 0:h.widget]),I.jsxs("div",{...r,className:"lk-chat",children:[I.jsxs("div",{className:"lk-chat-header",children:["聊天室",h&&I.jsx(UN,{className:"lk-close-button",children:I.jsx(nG,{})})]}),I.jsx("ul",{className:"lk-list lk-chat-messages",ref:o,children:r.children?l.map((b,y)=>_Q(r.children,{entry:b,key:b.id??y,messageFormatter:t})):l.map((b,y,T)=>{const v=y>=1&&T[y-1].from===b.from,w=y>=1&&b.timestamp-T[y-1].timestamp<6e4;return I.jsx(sQ,{hideName:v,hideTimestamp:v===!1?!1:w,entry:b,messageFormatter:t},b.id??y)})}),I.jsxs("form",{className:"lk-chat-form",onSubmit:g,children:[I.jsx("input",{className:"lk-form-control lk-chat-form-input",disabled:u,ref:s,type:"text",placeholder:"輸入訊息...",onInput:b=>b.stopPropagation(),onKeyDown:b=>b.stopPropagation(),onKeyUp:b=>b.stopPropagation()}),I.jsx("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:u,children:"傳送"})]})]})}function EQ({chatMessageFormatter:t,chatMessageDecoder:e,chatMessageEncoder:n,SettingsComponent:i,...r}){var b,y;const[s,o]=m.useState({showChat:!1,unreadMessages:0,showSettings:!1}),a=m.useRef(null),c=LN([{source:j.Source.Camera,withPlaceholder:!0},{source:j.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[F.ActiveSpeakersChanged],onlySubscribed:!1}),l=T=>{Ld.debug("updating widget state",T),o(T)},u=yK(),h=c.filter(na).filter(T=>T.publication.source===j.Source.ScreenShare),f=(b=BK(u))==null?void 0:b[0],g=c.filter(T=>!pQ(T,f));return m.useEffect(()=>{var T,v,w,S,P,R;if(h.some(O=>O.publication.isSubscribed)&&a.current===null?(Ld.debug("Auto set screen share focus:",{newScreenShareTrack:h[0]}),(v=(T=u.pin).dispatch)==null||v.call(T,{msg:"set_pin",trackReference:h[0]}),a.current=h[0]):a.current&&!h.some(O=>{var E,_;return O.publication.trackSid===((_=(E=a.current)==null?void 0:E.publication)==null?void 0:_.trackSid)})&&(Ld.debug("Auto clearing screen share focus."),(S=(w=u.pin).dispatch)==null||S.call(w,{msg:"clear_pin"}),a.current=null),f&&!na(f)){const O=c.find(E=>E.participant.identity===f.participant.identity&&E.source===f.source);O!==f&&na(O)&&((R=(P=u.pin).dispatch)==null||R.call(P,{msg:"set_pin",trackReference:O}))}},[h.map(T=>`${T.publication.trackSid}_${T.publication.isSubscribed}`).join(),(y=f==null?void 0:f.publication)==null?void 0:y.trackSid,c]),I.jsxs("div",{className:"lk-video-conference",...r,children:[mQ()&&I.jsxs(tQ,{value:u,onWidgetChange:l,children:[I.jsxs("div",{className:"lk-video-conference-inner",children:[f?I.jsx("div",{className:"lk-focus-layout-wrapper",children:I.jsxs(HG,{children:[I.jsx(eQ,{tracks:g,children:I.jsx(py,{})}),f&&I.jsx(WG,{trackRef:f})]})}):I.jsx("div",{className:"lk-grid-layout-wrapper",children:I.jsx(QG,{tracks:c,children:I.jsx(py,{})})}),I.jsx(wQ,{controls:{chat:!0,settings:!!i}})]}),I.jsx(SQ,{style:{display:s.showChat?"grid":"none"},messageFormatter:t,messageEncoder:n,messageDecoder:e}),i&&I.jsx("div",{className:"lk-settings-menu-modal",style:{display:s.showSettings?"block":"none"},children:I.jsx(i,{})})]}),I.jsx(nQ,{}),I.jsx(rQ,{})]})}function CQ(){const t=m.useCallback(async(i,r)=>{var s=await Bc.getToken(i,r);return s.data},[]),e=m.useCallback(async i=>{await Bc.startRecording(i)},[]),n=m.useCallback(async i=>{await Bc.startRecording(i)},[]);return{getToken:t,startRecording:e,stopRecording:n}}function IQ(){const t=as(),e="quickstart-room",{getToken:n}=CQ(),[i,r]=m.useState(""),[s,o]=m.useState(""),[a,c]=m.useState(!1);async function l(u){var h=await n(e,u.username);r(h.token),o(h.serverUrl),c(!0)}return I.jsx("div",{className:`
                fixed
                top-0 left-0 right-0 bottom-0
                place-content-center
                bg-black
            `,"data-lk-theme":"default",children:a?I.jsx(IK,{video:!0,audio:!0,token:i,serverUrl:s,"data-lk-theme":"default",style:{height:"100dvh"},onDisconnected:()=>t(-1),children:I.jsx(EQ,{})}):I.jsx(cQ,{camLabel:"相機",micLabel:"麥克風",joinLabel:"加入",userLabel:"使用者名稱",onSubmit:l})})}const se=t=>typeof t=="string",dc=()=>{let t,e;const n=new Promise((i,r)=>{t=i,e=r});return n.resolve=t,n.reject=e,n},y1=t=>t==null?"":""+t,PQ=(t,e,n)=>{t.forEach(i=>{e[i]&&(n[i]=e[i])})},RQ=/###/g,b1=t=>t&&t.indexOf("###")>-1?t.replace(RQ,"."):t,T1=t=>!t||se(t),zc=(t,e,n)=>{const i=se(e)?e.split("."):e;let r=0;for(;r<i.length-1;){if(T1(t))return{};const s=b1(i[r]);!t[s]&&n&&(t[s]=new n),Object.prototype.hasOwnProperty.call(t,s)?t=t[s]:t={},++r}return T1(t)?{}:{obj:t,k:b1(i[r])}},k1=(t,e,n)=>{const{obj:i,k:r}=zc(t,e,Object);if(i!==void 0||e.length===1){i[r]=n;return}let s=e[e.length-1],o=e.slice(0,e.length-1),a=zc(t,o,Object);for(;a.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),a=zc(t,o,Object),a!=null&&a.obj&&typeof a.obj[`${a.k}.${s}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${s}`]=n},xQ=(t,e,n,i)=>{const{obj:r,k:s}=zc(t,e,Object);r[s]=r[s]||[],r[s].push(n)},$h=(t,e)=>{const{obj:n,k:i}=zc(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,i))return n[i]},AQ=(t,e,n)=>{const i=$h(t,n);return i!==void 0?i:$h(e,n)},WN=(t,e,n)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in t?se(t[i])||t[i]instanceof String||se(e[i])||e[i]instanceof String?n&&(t[i]=e[i]):WN(t[i],e[i],n):t[i]=e[i]);return t},po=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var NQ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const OQ=t=>se(t)?t.replace(/[&<>"'\/]/g,e=>NQ[e]):t;class DQ{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const LQ=[" ",",","?","!",";"],MQ=new DQ(20),UQ=(t,e,n)=>{e=e||"",n=n||"";const i=LQ.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(i.length===0)return!0;const r=MQ.getRegExp(`(${i.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!r.test(t);if(!s){const o=t.indexOf(n);o>0&&!r.test(t.substring(0,o))&&(s=!0)}return s},my=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const i=e.split(n);let r=t;for(let s=0;s<i.length;){if(!r||typeof r!="object")return;let o,a="";for(let c=s;c<i.length;++c)if(c!==s&&(a+=n),a+=i[c],o=r[a],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<i.length-1)continue;s+=c-s+1;break}r=o}return r},Bh=t=>t==null?void 0:t.replace("_","-"),FQ={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var n,i;(i=(n=console==null?void 0:console[t])==null?void 0:n.apply)==null||i.call(n,console,e)}};class zh{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||FQ,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,i,r){return r&&!this.debug?null:(se(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new zh(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new zh(this.logger,e)}}var yi=new zh;class ip{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const r=this.observers[i].get(n)||0;this.observers[i].set(n,r+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(o=>{let[a,c]=o;for(let l=0;l<c;l++)a(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[a,c]=o;for(let l=0;l<c;l++)a.apply(a,[e,...i])})}}class w1 extends ip{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,i){var l,u;let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,o=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,n],i&&(Array.isArray(i)?a.push(...i):se(i)&&s?a.push(...i.split(s)):a.push(i)));const c=$h(this.data,a);return!c&&!n&&!i&&e.indexOf(".")>-1&&(e=a[0],n=a[1],i=a.slice(2).join(".")),c||!o||!se(i)?c:my((u=(l=this.data)==null?void 0:l[e])==null?void 0:u[n],i,s)}addResource(e,n,i,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let a=[e,n];i&&(a=a.concat(o?i.split(o):i)),e.indexOf(".")>-1&&(a=e.split("."),r=n,n=a[1]),this.addNamespaces(n),k1(this.data,a,r),s.silent||this.emit("added",e,n,i,r)}addResources(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const s in i)(se(i[s])||Array.isArray(i[s]))&&this.addResource(e,n,s,i[s],{silent:!0});r.silent||this.emit("added",e,n,i)}addResourceBundle(e,n,i,r,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},a=[e,n];e.indexOf(".")>-1&&(a=e.split("."),r=i,i=n,n=a[1]),this.addNamespaces(n);let c=$h(this.data,a)||{};o.skipCopy||(i=JSON.parse(JSON.stringify(i))),r?WN(c,i,s):c={...c,...i},k1(this.data,a,c),o.silent||this.emit("added",e,n,i)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(r=>n[r]&&Object.keys(n[r]).length>0)}toJSON(){return this.data}}var KN={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,i,r){return t.forEach(s=>{var o;e=((o=this.processors[s])==null?void 0:o.process(e,n,i,r))??e}),e}};const _1={};class qh extends ip{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),PQ(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=yi.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const i=this.resolve(e,n);return(i==null?void 0:i.res)!==void 0}extractFromKey(e,n){let i=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const r=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let s=n.ns||this.options.defaultNS||[];const o=i&&e.indexOf(i)>-1,a=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!UQ(e,i,r);if(o&&!a){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:se(s)?[s]:s};const l=e.split(i);(i!==r||i===r&&this.options.ns.indexOf(l[0])>-1)&&(s=l.shift()),e=l.join(r)}return{key:e,namespaces:se(s)?[s]:s}}translate(e,n,i){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const r=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:o,namespaces:a}=this.extractFromKey(e[e.length-1],n),c=a[a.length-1],l=n.lng||this.language,u=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((l==null?void 0:l.toLowerCase())==="cimode"){if(u){const P=n.nsSeparator||this.options.nsSeparator;return r?{res:`${c}${P}${o}`,usedKey:o,exactUsedKey:o,usedLng:l,usedNS:c,usedParams:this.getUsedParamsDetails(n)}:`${c}${P}${o}`}return r?{res:o,usedKey:o,exactUsedKey:o,usedLng:l,usedNS:c,usedParams:this.getUsedParamsDetails(n)}:o}const h=this.resolve(e,n);let f=h==null?void 0:h.res;const g=(h==null?void 0:h.usedKey)||o,b=(h==null?void 0:h.exactUsedKey)||o,y=Object.prototype.toString.apply(f),T=["[object Number]","[object Function]","[object RegExp]"],v=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,S=!se(f)&&typeof f!="boolean"&&typeof f!="number";if(w&&f&&S&&T.indexOf(y)<0&&!(se(v)&&Array.isArray(f))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const P=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,f,{...n,ns:a}):`key '${o} (${this.language})' returned an object instead of string.`;return r?(h.res=P,h.usedParams=this.getUsedParamsDetails(n),h):P}if(s){const P=Array.isArray(f),R=P?[]:{},O=P?b:g;for(const E in f)if(Object.prototype.hasOwnProperty.call(f,E)){const _=`${O}${s}${E}`;R[E]=this.translate(_,{...n,joinArrays:!1,ns:a}),R[E]===_&&(R[E]=f[E])}f=R}}else if(w&&se(v)&&Array.isArray(f))f=f.join(v),f&&(f=this.extendTranslation(f,e,n,i));else{let P=!1,R=!1;const O=n.count!==void 0&&!se(n.count),E=qh.hasDefaultValue(n),_=O?this.pluralResolver.getSuffix(l,n.count,n):"",C=n.ordinal&&O?this.pluralResolver.getSuffix(l,n.count,{ordinal:!1}):"",x=O&&!n.ordinal&&n.count===0,A=x&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${_}`]||n[`defaultValue${C}`]||n.defaultValue;!this.isValidLookup(f)&&E&&(P=!0,f=A),this.isValidLookup(f)||(R=!0,f=o);const D=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&R?void 0:f,le=E&&A!==f&&this.options.updateMissing;if(R||P||le){if(this.logger.log(le?"updateKey":"missingKey",l,c,o,le?A:f),s){const W=this.resolve(o,{...n,keySeparator:!1});W&&W.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ge=[];const $e=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&$e&&$e[0])for(let W=0;W<$e.length;W++)ge.push($e[W]);else this.options.saveMissingTo==="all"?ge=this.languageUtils.toResolveHierarchy(n.lng||this.language):ge.push(n.lng||this.language);const fe=(W,ee,ne)=>{var ve;const Pe=E&&ne!==f?ne:D;this.options.missingKeyHandler?this.options.missingKeyHandler(W,c,ee,Pe,le,n):(ve=this.backendConnector)!=null&&ve.saveMissing&&this.backendConnector.saveMissing(W,c,ee,Pe,le,n),this.emit("missingKey",W,c,ee,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&O?ge.forEach(W=>{const ee=this.pluralResolver.getSuffixes(W,n);x&&n[`defaultValue${this.options.pluralSeparator}zero`]&&ee.indexOf(`${this.options.pluralSeparator}zero`)<0&&ee.push(`${this.options.pluralSeparator}zero`),ee.forEach(ne=>{fe([W],o+ne,n[`defaultValue${ne}`]||A)})}):fe(ge,o,A))}f=this.extendTranslation(f,e,n,h,i),R&&f===o&&this.options.appendNamespaceToMissingKey&&(f=`${c}:${o}`),(R||P)&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${o}`:o,P?f:void 0))}return r?(h.res=f,h.usedParams=this.getUsedParamsDetails(n),h):f}extendTranslation(e,n,i,r,s){var l,u;var o=this;if((l=this.i18nFormat)!=null&&l.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const h=se(e)&&(((u=i==null?void 0:i.interpolation)==null?void 0:u.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(h){const b=e.match(this.interpolator.nestingRegexp);f=b&&b.length}let g=i.replace&&!se(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(g={...this.options.interpolation.defaultVariables,...g}),e=this.interpolator.interpolate(e,g,i.lng||this.language||r.usedLng,i),h){const b=e.match(this.interpolator.nestingRegexp),y=b&&b.length;f<y&&(i.nest=!1)}!i.lng&&r&&r.res&&(i.lng=this.language||r.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var b=arguments.length,y=new Array(b),T=0;T<b;T++)y[T]=arguments[T];return(s==null?void 0:s[0])===y[0]&&!i.context?(o.logger.warn(`It seems you are nesting recursively key: ${y[0]} in key: ${n[0]}`),null):o.translate(...y,n)},i)),i.interpolation&&this.interpolator.reset()}const a=i.postProcess||this.options.postProcess,c=se(a)?[a]:a;return e!=null&&(c!=null&&c.length)&&i.applyPostProcessor!==!1&&(e=KN.handle(c,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i,r,s,o,a;return se(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(i))return;const l=this.extractFromKey(c,n),u=l.key;r=u;let h=l.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const f=n.count!==void 0&&!se(n.count),g=f&&!n.ordinal&&n.count===0,b=n.context!==void 0&&(se(n.context)||typeof n.context=="number")&&n.context!=="",y=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);h.forEach(T=>{var v,w;this.isValidLookup(i)||(a=T,!_1[`${y[0]}-${T}`]&&((v=this.utils)!=null&&v.hasLoadedNamespace)&&!((w=this.utils)!=null&&w.hasLoadedNamespace(a))&&(_1[`${y[0]}-${T}`]=!0,this.logger.warn(`key "${r}" for languages "${y.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(S=>{var O;if(this.isValidLookup(i))return;o=S;const P=[u];if((O=this.i18nFormat)!=null&&O.addLookupKeys)this.i18nFormat.addLookupKeys(P,u,S,T,n);else{let E;f&&(E=this.pluralResolver.getSuffix(S,n.count,n));const _=`${this.options.pluralSeparator}zero`,C=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(P.push(u+E),n.ordinal&&E.indexOf(C)===0&&P.push(u+E.replace(C,this.options.pluralSeparator)),g&&P.push(u+_)),b){const x=`${u}${this.options.contextSeparator}${n.context}`;P.push(x),f&&(P.push(x+E),n.ordinal&&E.indexOf(C)===0&&P.push(x+E.replace(C,this.options.pluralSeparator)),g&&P.push(x+_))}}let R;for(;R=P.pop();)this.isValidLookup(i)||(s=R,i=this.getResource(S,T,R,n))}))})}),{res:i,usedKey:r,exactUsedKey:s,usedLng:o,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,i){var s;let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(s=this.i18nFormat)!=null&&s.getResource?this.i18nFormat.getResource(e,n,i,r):this.resourceStore.getResource(e,n,i,r)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!se(e.replace);let r=i?e.replace:e;if(i&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!i){r={...r};for(const s of n)delete r[s]}return r}static hasDefaultValue(e){const n="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&n===i.substring(0,n.length)&&e[i]!==void 0)return!0;return!1}}class S1{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=yi.create("languageUtils")}getScriptPartFromCode(e){if(e=Bh(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=Bh(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(se(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(i=>{if(n)return;const r=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(r))&&(n=r)}),!n&&this.options.supportedLngs&&e.forEach(i=>{if(n)return;const r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return n=r;n=this.options.supportedLngs.find(s=>{if(s===r)return s;if(!(s.indexOf("-")<0&&r.indexOf("-")<0)&&(s.indexOf("-")>0&&r.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===r||s.indexOf(r)===0&&r.length>1))return s})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),se(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let i=e[n];return i||(i=e[this.getScriptPartFromCode(n)]),i||(i=e[this.formatLanguageCode(n)]),i||(i=e[this.getLanguagePartFromCode(n)]),i||(i=e.default),i||[]}toResolveHierarchy(e,n){const i=this.getFallbackCodes(n||this.options.fallbackLng||[],e),r=[],s=o=>{o&&(this.isSupportedCode(o)?r.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return se(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):se(e)&&s(this.formatLanguageCode(e)),i.forEach(o=>{r.indexOf(o)<0&&s(this.formatLanguageCode(o))}),r}}const E1={zero:0,one:1,two:2,few:3,many:4,other:5},C1={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class VQ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=yi.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=Bh(e==="dev"?"en":e),r=n.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:i,type:r});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(i,{type:r})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),C1;if(!e.match(/-|_/))return C1;const c=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(c,n)}return this.pluralRulesCache[s]=o,o}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.getRule(e,n);return i||(i=this.getRule("dev",n)),(i==null?void 0:i.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,i).map(r=>`${n}${r}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.getRule(e,n);return i||(i=this.getRule("dev",n)),i?i.resolvedOptions().pluralCategories.sort((r,s)=>E1[r]-E1[s]).map(r=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r}`):[]}getSuffix(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=this.getRule(e,i);return r?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,i))}}const I1=function(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=AQ(t,e,n);return!s&&r&&se(n)&&(s=my(t,n,i),s===void 0&&(s=my(e,n,i))),s},qm=t=>t.replace(/\$/g,"$$$$");class jQ{constructor(){var n;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=yi.create("interpolator"),this.options=e,this.format=((n=e==null?void 0:e.interpolation)==null?void 0:n.format)||(i=>i),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:i,useRawValueToEscape:r,prefix:s,prefixEscaped:o,suffix:a,suffixEscaped:c,formatSeparator:l,unescapeSuffix:u,unescapePrefix:h,nestingPrefix:f,nestingPrefixEscaped:g,nestingSuffix:b,nestingSuffixEscaped:y,nestingOptionsSeparator:T,maxReplaces:v,alwaysFormat:w}=e.interpolation;this.escape=n!==void 0?n:OQ,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=s?po(s):o||"{{",this.suffix=a?po(a):c||"}}",this.formatSeparator=l||",",this.unescapePrefix=u?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=f?po(f):g||po("$t("),this.nestingSuffix=b?po(b):y||po(")"),this.nestingOptionsSeparator=T||",",this.maxReplaces=v||1e3,this.alwaysFormat=w!==void 0?w:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,i)=>(n==null?void 0:n.source)===i?(n.lastIndex=0,n):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,i,r){var g;let s,o,a;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},l=b=>{if(b.indexOf(this.formatSeparator)<0){const w=I1(n,c,b,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(w,void 0,i,{...r,...n,interpolationkey:b}):w}const y=b.split(this.formatSeparator),T=y.shift().trim(),v=y.join(this.formatSeparator).trim();return this.format(I1(n,c,T,this.options.keySeparator,this.options.ignoreJSONStructure),v,i,{...r,...n,interpolationkey:T})};this.resetRegExp();const u=(r==null?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,h=((g=r==null?void 0:r.interpolation)==null?void 0:g.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:b=>qm(b)},{regex:this.regexp,safeValue:b=>this.escapeValue?qm(this.escape(b)):qm(b)}].forEach(b=>{for(a=0;s=b.regex.exec(e);){const y=s[1].trim();if(o=l(y),o===void 0)if(typeof u=="function"){const v=u(e,s,r);o=se(v)?v:""}else if(r&&Object.prototype.hasOwnProperty.call(r,y))o="";else if(h){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${e}`),o="";else!se(o)&&!this.useRawValueToEscape&&(o=y1(o));const T=b.safeValue(o);if(e=e.replace(s[0],T),h?(b.regex.lastIndex+=o.length,b.regex.lastIndex-=s[0].length):b.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r,s,o;const a=(c,l)=>{const u=this.nestingOptionsSeparator;if(c.indexOf(u)<0)return c;const h=c.split(new RegExp(`${u}[ ]*{`));let f=`{${h[1]}`;c=h[0],f=this.interpolate(f,o);const g=f.match(/'/g),b=f.match(/"/g);(((g==null?void 0:g.length)??0)%2===0&&!b||b.length%2!==0)&&(f=f.replace(/'/g,'"'));try{o=JSON.parse(f),l&&(o={...l,...o})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,y),`${c}${u}${f}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;r=this.nestingRegexp.exec(e);){let c=[];o={...i},o=o.replace&&!se(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let l=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){const u=r[1].split(this.formatSeparator).map(h=>h.trim());r[1]=u.shift(),c=u,l=!0}if(s=n(a.call(this,r[1].trim(),o),o),s&&r[0]===e&&!se(s))return s;se(s)||(s=y1(s)),s||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),s=""),l&&(s=c.reduce((u,h)=>this.format(u,h,i.lng,{...i,interpolationkey:r[1].trim()}),s.trim())),e=e.replace(r[0],s),this.regexp.lastIndex=0}return e}}const $Q=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const i=t.split("(");e=i[0].toLowerCase().trim();const r=i[1].substring(0,i[1].length-1);e==="currency"&&r.indexOf(":")<0?n.currency||(n.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?n.range||(n.range=r.trim()):r.split(";").forEach(o=>{if(o){const[a,...c]=o.split(":"),l=c.join(":").trim().replace(/^'+|'+$/g,""),u=a.trim();n[u]||(n[u]=l),l==="false"&&(n[u]=!1),l==="true"&&(n[u]=!0),isNaN(l)||(n[u]=parseInt(l,10))}})}return{formatName:e,formatOptions:n}},mo=t=>{const e={};return(n,i,r)=>{let s=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(s={...s,[r.interpolationkey]:void 0});const o=i+JSON.stringify(s);let a=e[o];return a||(a=t(Bh(i),r),e[o]=a),a(n)}};class BQ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=yi.create("formatter"),this.options=e,this.formats={number:mo((n,i)=>{const r=new Intl.NumberFormat(n,{...i});return s=>r.format(s)}),currency:mo((n,i)=>{const r=new Intl.NumberFormat(n,{...i,style:"currency"});return s=>r.format(s)}),datetime:mo((n,i)=>{const r=new Intl.DateTimeFormat(n,{...i});return s=>r.format(s)}),relativetime:mo((n,i)=>{const r=new Intl.RelativeTimeFormat(n,{...i});return s=>r.format(s,i.range||"day")}),list:mo((n,i)=>{const r=new Intl.ListFormat(n,{...i});return s=>r.format(s)})},this.init(e)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=n.interpolation.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=mo(n)}format(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=n.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(a=>a.indexOf(")")>-1)){const a=s.findIndex(c=>c.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,a)].join(this.formatSeparator)}return s.reduce((a,c)=>{var h;const{formatName:l,formatOptions:u}=$Q(c);if(this.formats[l]){let f=a;try{const g=((h=r==null?void 0:r.formatParams)==null?void 0:h[r.interpolationkey])||{},b=g.locale||g.lng||r.locale||r.lng||i;f=this.formats[l](a,b,{...u,...r,...g})}catch(g){this.logger.warn(g)}return f}else this.logger.warn(`there was no format function for ${l}`);return a},e)}}const zQ=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class qQ extends ip{constructor(e,n,i){var s,o;let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=yi.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],(o=(s=this.backend)==null?void 0:s.init)==null||o.call(s,i,r.backend,r)}queueLoad(e,n,i,r){const s={},o={},a={},c={};return e.forEach(l=>{let u=!0;n.forEach(h=>{const f=`${l}|${h}`;!i.reload&&this.store.hasResourceBundle(l,h)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?o[f]===void 0&&(o[f]=!0):(this.state[f]=1,u=!1,o[f]===void 0&&(o[f]=!0),s[f]===void 0&&(s[f]=!0),c[h]===void 0&&(c[h]=!0)))}),u||(a[l]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(c)}}loaded(e,n,i){const r=e.split("|"),s=r[0],o=r[1];n&&this.emit("failedLoading",s,o,n),!n&&i&&this.store.addResourceBundle(s,o,i,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&i&&(this.state[e]=0);const a={};this.queue.forEach(c=>{xQ(c.loaded,[s],o),zQ(c,e),n&&c.errors.push(n),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(l=>{a[l]||(a[l]={});const u=c.loaded[l];u.length&&u.forEach(h=>{a[l][h]===void 0&&(a[l][h]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(c=>!c.done)}read(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:i,tried:r,wait:s,callback:o});return}this.readingCalls++;const a=(l,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const h=this.waitingReads.shift();this.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(l&&u&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,i,r+1,s*2,o)},s);return}o(l,u)},c=this.backend[i].bind(this.backend);if(c.length===2){try{const l=c(e,n);l&&typeof l.then=="function"?l.then(u=>a(null,u)).catch(a):a(null,l)}catch(l){a(l)}return}return c(e,n,a)}prepareLoading(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();se(e)&&(e=this.languageUtils.toResolveHierarchy(e)),se(n)&&(n=[n]);const s=this.queueLoad(e,n,i,r);if(!s.toLoad.length)return s.pending.length||r(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,i){this.prepareLoading(e,n,{},i)}reload(e,n,i){this.prepareLoading(e,n,{reload:!0},i)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=e.split("|"),r=i[0],s=i[1];this.read(r,s,"read",void 0,void 0,(o,a)=>{o&&this.logger.warn(`${n}loading namespace ${s} for language ${r} failed`,o),!o&&a&&this.logger.log(`${n}loaded namespace ${s} for language ${r}`,a),this.loaded(e,o,a)})}saveMissing(e,n,i,r,s){var c,l,u,h,f;let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((l=(c=this.services)==null?void 0:c.utils)!=null&&l.hasLoadedNamespace&&!((h=(u=this.services)==null?void 0:u.utils)!=null&&h.hasLoadedNamespace(n))){this.logger.warn(`did not save key "${i}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if((f=this.backend)!=null&&f.create){const g={...o,isUpdate:s},b=this.backend.create.bind(this.backend);if(b.length<6)try{let y;b.length===5?y=b(e,n,i,r,g):y=b(e,n,i,r),y&&typeof y.then=="function"?y.then(T=>a(null,T)).catch(a):a(null,y)}catch(y){a(y)}else b(e,n,i,r,a,g)}!e||!e[0]||this.store.addResource(e[0],n,i,r)}}}const P1=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),se(t[1])&&(e.defaultValue=t[1]),se(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(i=>{e[i]=n[i]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),R1=t=>{var e,n;return se(t.ns)&&(t.ns=[t.ns]),se(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),se(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((n=(e=t.supportedLngs)==null?void 0:e.indexOf)==null?void 0:n.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},Gu=()=>{},HQ=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class Il extends ip{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=R1(e),this.services={},this.logger=yi,this.modules={external:[]},HQ(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof n=="function"&&(i=n,n={}),n.defaultNS==null&&n.ns&&(se(n.ns)?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const r=P1();this.options={...r,...this.options,...R1(n)},this.options.interpolation={...r.interpolation,...this.options.interpolation},n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const s=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?yi.init(s(this.modules.logger),this.options):yi.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=BQ;const h=new S1(this.options);this.store=new w1(this.options.resources,this.options);const f=this.services;f.logger=yi,f.resourceStore=this.store,f.languageUtils=h,f.pluralResolver=new VQ(h,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(f.formatter=s(u),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new jQ(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new qQ(s(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(g){for(var b=arguments.length,y=new Array(b>1?b-1:0),T=1;T<b;T++)y[T-1]=arguments[T];e.emit(g,...y)}),this.modules.languageDetector&&(f.languageDetector=s(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=s(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new qh(this.services,this.options),this.translator.on("*",function(g){for(var b=arguments.length,y=new Array(b>1?b-1:0),T=1;T<b;T++)y[T-1]=arguments[T];e.emit(g,...y)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,i||(i=Gu),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=function(){return e.store[u](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=function(){return e.store[u](...arguments),e}});const c=dc(),l=()=>{const u=(h,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(f),i(h,f)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),c}loadResources(e){var s,o;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gu;const r=se(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if((r==null?void 0:r.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const a=[],c=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(h=>{h!=="cimode"&&a.indexOf(h)<0&&a.push(h)})};r?c(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>c(u)),(o=(s=this.options.preload)==null?void 0:s.forEach)==null||o.call(s,l=>c(l)),this.services.backendConnector.load(a,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(l)})}else i(null)}reloadResources(e,n,i){const r=dc();return typeof e=="function"&&(i=e,e=void 0),typeof n=="function"&&(i=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),i||(i=Gu),this.services.backendConnector.reload(e,n,s=>{r.resolve(),i(s)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&KN.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const i=this.languages[n];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}}changeLanguage(e,n){var i=this;this.isLanguageChangingTo=e;const r=dc();this.emit("languageChanging",e);const s=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},o=(c,l)=>{l?(s(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,r.resolve(function(){return i.t(...arguments)}),n&&n(c,function(){return i.t(...arguments)})},a=c=>{var u,h;!e&&!c&&this.services.languageDetector&&(c=[]);const l=se(c)?c:this.services.languageUtils.getBestMatchFromCodes(c);l&&(this.language||s(l),this.translator.language||this.translator.changeLanguage(l),(h=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||h.call(u,l)),this.loadResources(l,f=>{o(f,l)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),r}getFixedT(e,n,i){var r=this;const s=function(o,a){let c;if(typeof a!="object"){for(var l=arguments.length,u=new Array(l>2?l-2:0),h=2;h<l;h++)u[h-2]=arguments[h];c=r.options.overloadTranslationOptionHandler([o,a].concat(u))}else c={...a};c.lng=c.lng||s.lng,c.lngs=c.lngs||s.lngs,c.ns=c.ns||s.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||i||s.keyPrefix);const f=r.options.keySeparator||".";let g;return c.keyPrefix&&Array.isArray(o)?g=o.map(b=>`${c.keyPrefix}${f}${b}`):g=c.keyPrefix?`${c.keyPrefix}${f}${o}`:o,r.t(g,c)};return se(e)?s.lng=e:s.lngs=e,s.ns=n,s.keyPrefix=i,s}t(){var r;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(r=this.translator)==null?void 0:r.translate(...n)}exists(){var r;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(r=this.translator)==null?void 0:r.exists(...n)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=n.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const o=(a,c)=>{const l=this.services.backendConnector.state[`${a}|${c}`];return l===-1||l===0||l===2};if(n.precheck){const a=n.precheck(this,o);if(a!==void 0)return a}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(i,e)&&(!r||o(s,e)))}loadNamespaces(e,n){const i=dc();return this.options.ns?(se(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{i.resolve(),n&&n(r)}),i):(n&&n(),Promise.resolve())}loadLanguages(e,n){const i=dc();se(e)&&(e=[e]);const r=this.options.preload||[],s=e.filter(o=>r.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=r.concat(s),this.loadResources(o=>{i.resolve(),n&&n(o)}),i):(n&&n(),Promise.resolve())}dir(e){var r,s;if(e||(e=this.resolvedLanguage||(((r=this.languages)==null?void 0:r.length)>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=((s=this.services)==null?void 0:s.languageUtils)||new S1(P1());return n.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new Il(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gu;const i=e.forkResourceStore;i&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},s=new Il(r);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(a=>{s[a]=this[a]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},i){const a=Object.keys(this.store.data).reduce((c,l)=>(c[l]={...this.store.data[l]},Object.keys(c[l]).reduce((u,h)=>(u[h]={...c[l][h]},u),{})),{});s.store=new w1(a,r),s.services.resourceStore=s.store}return s.translator=new qh(s.services,r),s.translator.on("*",function(a){for(var c=arguments.length,l=new Array(c>1?c-1:0),u=1;u<c;u++)l[u-1]=arguments[u];s.emit(a,...l)}),s.init(r,n),s.translator.options=r,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const qt=Il.createInstance();qt.createInstance=Il.createInstance;qt.createInstance;qt.dir;qt.init;qt.loadResources;qt.reloadResources;qt.use;qt.changeLanguage;qt.getFixedT;qt.t;qt.exists;qt.setDefaultNamespace;qt.hasLoadedNamespace;qt.loadNamespaces;qt.loadLanguages;qt.use(MM).init({resources:{en:{translation:{welcome_back:"Welcome back",please_sign_in:"Please sign in to continue",title:"Never Take Meeting Notes Again",description:"Transform the way you meet with AI-driven transcription, summaries, and insights. Focus on the conversation, and we'll handle the documentation.",freeStart:"Start for Free",whyChoose:"Why Choose MeetingMind",howItWorks:"How It Works",uploadRecording:"Upload Recording",aiProcessing:"AI Processing",shareCollaborate:"Share & Collaborate",feature1:"Smart Transcription",feature1Desc:"Automatic transcription with speaker detection and timestamps",feature2:"Team Collaboration",feature2Desc:"Share insights and collaborate with your team in real-time",feature3:"Secure & Private",feature3Desc:"Enterprise-grade security with end-to-end encryption",feature4:"Multi-language Support",feature4Desc:"Support for multiple languages and automatic translation",uploadDescription:"Upload your meeting recording in any format",aiProcessingDescription:"Our AI automatically transcribes and summarizes your meeting",shareCollaborateDescription:"Share insights with your team and collaborate effectively",meetingMindDescription:"Transform your virtual meetings with AI-powered features and seamless collaboration.",quickLinks:"Quick Links",login:"Login",signUp:"Sign Up",legal:"Legal",privacyPolicy:"Privacy Policy",termsOfService:"Terms of Service",startDashboard:"Start Dashboard",HELLO:"Hello",googleLogin:"Login with Google",footer:{title:"MeetingMind",description:"Transform your virtual meetings with AI-powered features and seamless collaboration.",quickLinks:"Quick Links",login:"Login",signUp:"Sign Up",legal:"Legal",privacyPolicy:"Privacy Policy",termsOfService:"Terms of Service",copyright:"All rights reserved."},profile:"Settings",welcome_user:"Welcome, {{name}}!",guest:"Guest",meetingNotes:"Meeting Notes",meeting_notes:"Meeting Notes",upload_meeting:"Upload Meeting",new_meeting:"New Meeting",home:"Home",upload:"Upload",newestFirst:"Newest first",oldestFirst:"Oldest first",selectMeetings:"Select meetings",filterByTags:"Filter by tags",clearAll:"Clear all",logout:"Logout",english_short:"English",chinese_short:"Chinese",dashboard:"Dashboard",profile_headerTitle:"Profile",profile_statsTitle:"Stats",profile_activityFeedTitle:"Recent Activities",profile_settingsTitle:"Settings",profile_editModalTitle:"Edit Profile",profile_activities:{upload:'Uploaded "{{title}}"',process:'Completed processing "{{title}}"',edit:"Updated profile information"},profile_settings:{emailNotifications:"Email Notifications",emailNotificationsDesc:"Receive email updates about your meetings",systemAlerts:"System Alerts",systemAlertsDesc:"Get notified when processing is complete",darkMode:"Dark Mode",darkModeDesc:"Switch between light and dark themes"},upload_meeting_Btn:{uploadMeetingRecording:"Upload Meeting Recording",dragAndDrop:"Drag and drop your video file here, or",browse:"browse",uploadRecording:"Upload Recording",successNotification:"Meeting summary completed!",errorNotification:"Upload failed!"},meetingPage:{joinRoom:"Join a Video Room",participant:"Participant",room:"Room",joinButton:"Join!",roomTitle:"Room",leaveRoom:"Leave Room"},Transcript:"Transcript",Summary:"Summary"}},zh:{translation:{welcome_back:"歡迎回來",please_sign_in:"請登錄以繼續",title:"永不再記會議筆記",description:"使用AI驅動的文字記錄、摘要和見解，轉變你的會議方式。專注於對話，我們來處理文檔。",freeStart:"免費開始",whyChoose:"為什麼選擇 MeetingMind",howItWorks:"如何運作",uploadRecording:"上傳錄音",aiProcessing:"AI處理",shareCollaborate:"分享與協作",feature1:"智慧文字記錄",feature1Desc:"自動文字轉錄，帶有講者識別和時間戳",feature2:"團隊協作",feature2Desc:"即時分享見解並與團隊協作",feature3:"安全與隱私",feature3Desc:"企業級安全性，端對端加密",feature4:"多語言支援",feature4Desc:"支援多語言及自動翻譯",uploadDescription:"上傳你的會議錄音，支持任何格式",aiProcessingDescription:"我們的AI會自動轉錄並總結你的會議",shareCollaborateDescription:"與你的團隊分享見解並有效協作",meetingMindDescription:"使用AI功能和無縫協作，徹底改變你的虛擬會議。",quickLinks:"快速連結",login:"登入",signUp:"註冊",legal:"法律",privacyPolicy:"隱私政策",termsOfService:"服務條款",startDashboard:"開始使用控制面板",HELLO:"您好",googleLogin:"使用Google登錄",footer:{title:"MeetingMind",description:"利用 AI 功能和無縫協作，改變您的虛擬會議體驗。",quickLinks:"快速連結",login:"登入",signUp:"註冊",legal:"法律條款",privacyPolicy:"隱私政策",termsOfService:"服務條款",copyright:"版權所有。"},profile:"設定",welcome_user:"歡迎, {{name}}!",guest:"訪客",meetingNotes:"會議筆記",meeting_notes:"會議筆記",upload_meeting:"上傳會議",new_meeting:"新增會議",home:"首頁",upload:"上傳",newestFirst:"最新優先",oldestFirst:"最舊優先",selectMeetings:"選擇會議",filterByTags:"篩選標籤",clearAll:"清除所有篩選條件",logout:"登出",english_short:"英文",chinese_short:"中文",dashboard:"控制面板",profile_headerTitle:"個人資料",profile_statsTitle:"統計資料",profile_activityFeedTitle:"最近活動",profile_settingsTitle:"設定",profile_editModalTitle:"編輯個人資料",profile_activities:{upload:"上傳了「{{title}}」",process:"完成處理「{{title}}」",edit:"更新了個人資料"},profile_settings:{emailNotifications:"電子郵件通知",emailNotificationsDesc:"接收有關您會議的電子郵件更新",systemAlerts:"系統提醒",systemAlertsDesc:"在處理完成時獲取通知",darkMode:"深色模式",darkModeDesc:"在淺色和深色主題之間切換"},upload_meeting_Btn:{uploadMeetingRecording:"上傳會議錄音",dragAndDrop:"將錄音文件拖曳到這裡，或",browse:"瀏覽",uploadRecording:"上傳錄音",successNotification:"會議總結已完成!",errorNotification:"上傳失敗!"},meetingPage:{joinRoom:"加入視訊會議",participant:"參與名",room:"房間",joinButton:"加入！",roomTitle:"房間",leaveRoom:"離開房間"},Transcript:"錄音逐字稿",Summary:"總結"}}},lng:"zh",fallbackLng:"zh",interpolation:{escapeValue:!1}});function WQ(){return I.jsx(JL,{children:I.jsxs(YL,{children:[I.jsx(QL,{children:I.jsxs(WL,{children:[I.jsx(di,{path:"/",element:I.jsx(a9,{})}),I.jsx(di,{path:"/login",element:I.jsx(BB,{})}),I.jsxs(di,{path:"/dashboard",element:I.jsx(ZL,{children:I.jsx(G$,{children:I.jsx($M,{})})}),children:[I.jsx(di,{index:!0,element:I.jsx(Q$,{})}),I.jsx(di,{path:"upload",element:I.jsx(NB,{})}),I.jsx(di,{path:"meetingSummary/:id",element:I.jsx(LB,{})}),I.jsx(di,{path:"profile",element:I.jsx($B,{})}),I.jsx(di,{path:"meeting",element:I.jsx(IQ,{})})]}),I.jsx(di,{path:"*",element:I.jsx(nI,{to:"/",replace:!0})})]})}),I.jsx(xB,{})]})})}zC(document.getElementById("root")).render(I.jsx(m.StrictMode,{children:I.jsx(WQ,{})}));
