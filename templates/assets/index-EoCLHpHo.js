function wM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Sy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wx={exports:{}},vp={},Tx={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vc=Symbol.for("react.element"),TM=Symbol.for("react.portal"),SM=Symbol.for("react.fragment"),_M=Symbol.for("react.strict_mode"),EM=Symbol.for("react.profiler"),CM=Symbol.for("react.provider"),xM=Symbol.for("react.context"),IM=Symbol.for("react.forward_ref"),PM=Symbol.for("react.suspense"),RM=Symbol.for("react.memo"),AM=Symbol.for("react.lazy"),OT=Symbol.iterator;function NM(t){return t===null||typeof t!="object"?null:(t=OT&&t[OT]||t["@@iterator"],typeof t=="function"?t:null)}var Sx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_x=Object.assign,Ex={};function gl(t,e,n){this.props=t,this.context=e,this.refs=Ex,this.updater=n||Sx}gl.prototype.isReactComponent={};gl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Cx(){}Cx.prototype=gl.prototype;function r0(t,e,n){this.props=t,this.context=e,this.refs=Ex,this.updater=n||Sx}var i0=r0.prototype=new Cx;i0.constructor=r0;_x(i0,gl.prototype);i0.isPureReactComponent=!0;var DT=Array.isArray,xx=Object.prototype.hasOwnProperty,s0={current:null},Ix={key:!0,ref:!0,__self:!0,__source:!0};function Px(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)xx.call(e,r)&&!Ix.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Vc,type:t,key:s,ref:o,props:i,_owner:s0.current}}function OM(t,e){return{$$typeof:Vc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function o0(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vc}function DM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var LT=/\/+/g;function Ym(t,e){return typeof t=="object"&&t!==null&&t.key!=null?DM(""+t.key):e.toString(36)}function pf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Vc:case TM:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ym(o,0):r,DT(i)?(n="",t!=null&&(n=t.replace(LT,"$&/")+"/"),pf(i,e,n,"",function(u){return u})):i!=null&&(o0(i)&&(i=OM(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(LT,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",DT(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Ym(s,a);o+=pf(s,e,n,l,i)}else if(l=NM(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Ym(s,a++),o+=pf(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ad(t,e,n){if(t==null)return t;var r=[],i=0;return pf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function LM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var mn={current:null},mf={transition:null},MM={ReactCurrentDispatcher:mn,ReactCurrentBatchConfig:mf,ReactCurrentOwner:s0};function Rx(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:Ad,forEach:function(t,e,n){Ad(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ad(t,function(){e++}),e},toArray:function(t){return Ad(t,function(e){return e})||[]},only:function(t){if(!o0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xe.Component=gl;xe.Fragment=SM;xe.Profiler=EM;xe.PureComponent=r0;xe.StrictMode=_M;xe.Suspense=PM;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MM;xe.act=Rx;xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=_x({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=s0.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)xx.call(e,l)&&!Ix.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Vc,type:t.type,key:i,ref:s,props:r,_owner:o}};xe.createContext=function(t){return t={$$typeof:xM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:CM,_context:t},t.Consumer=t};xe.createElement=Px;xe.createFactory=function(t){var e=Px.bind(null,t);return e.type=t,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(t){return{$$typeof:IM,render:t}};xe.isValidElement=o0;xe.lazy=function(t){return{$$typeof:AM,_payload:{_status:-1,_result:t},_init:LM}};xe.memo=function(t,e){return{$$typeof:RM,type:t,compare:e===void 0?null:e}};xe.startTransition=function(t){var e=mf.transition;mf.transition={};try{t()}finally{mf.transition=e}};xe.unstable_act=Rx;xe.useCallback=function(t,e){return mn.current.useCallback(t,e)};xe.useContext=function(t){return mn.current.useContext(t)};xe.useDebugValue=function(){};xe.useDeferredValue=function(t){return mn.current.useDeferredValue(t)};xe.useEffect=function(t,e){return mn.current.useEffect(t,e)};xe.useId=function(){return mn.current.useId()};xe.useImperativeHandle=function(t,e,n){return mn.current.useImperativeHandle(t,e,n)};xe.useInsertionEffect=function(t,e){return mn.current.useInsertionEffect(t,e)};xe.useLayoutEffect=function(t,e){return mn.current.useLayoutEffect(t,e)};xe.useMemo=function(t,e){return mn.current.useMemo(t,e)};xe.useReducer=function(t,e,n){return mn.current.useReducer(t,e,n)};xe.useRef=function(t){return mn.current.useRef(t)};xe.useState=function(t){return mn.current.useState(t)};xe.useSyncExternalStore=function(t,e,n){return mn.current.useSyncExternalStore(t,e,n)};xe.useTransition=function(){return mn.current.useTransition()};xe.version="18.3.1";Tx.exports=xe;var v=Tx.exports;const Je=yp(v),UM=wM({__proto__:null,default:Je},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FM=v,jM=Symbol.for("react.element"),VM=Symbol.for("react.fragment"),BM=Object.prototype.hasOwnProperty,$M=FM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zM={key:!0,ref:!0,__self:!0,__source:!0};function Ax(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)BM.call(e,r)&&!zM.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:jM,type:t,key:s,ref:o,props:i,_owner:$M.current}}vp.Fragment=VM;vp.jsx=Ax;vp.jsxs=Ax;wx.exports=vp;var E=wx.exports,Nx={exports:{}},Jn={},Ox={exports:{}},Dx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,se){var M=Q.length;Q.push(se);e:for(;0<M;){var Se=M-1>>>1,ye=Q[Se];if(0<i(ye,se))Q[Se]=se,Q[M]=ye,M=Se;else break e}}function n(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var se=Q[0],M=Q.pop();if(M!==se){Q[0]=M;e:for(var Se=0,ye=Q.length,U=ye>>>1;Se<U;){var be=2*(Se+1)-1,mt=Q[be],$e=be+1,ln=Q[$e];if(0>i(mt,M))$e<ye&&0>i(ln,mt)?(Q[Se]=ln,Q[$e]=M,Se=$e):(Q[Se]=mt,Q[be]=M,Se=be);else if($e<ye&&0>i(ln,M))Q[Se]=ln,Q[$e]=M,Se=$e;else break e}}return se}function i(Q,se){var M=Q.sortIndex-se.sortIndex;return M!==0?M:Q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,d=null,h=3,p=!1,g=!1,m=!1,k=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(Q){for(var se=n(u);se!==null;){if(se.callback===null)r(u);else if(se.startTime<=Q)r(u),se.sortIndex=se.expirationTime,e(l,se);else break;se=n(u)}}function x(Q){if(m=!1,T(Q),!g)if(n(l)!==null)g=!0,Te(I);else{var se=n(u);se!==null&&ue(x,se.startTime-Q)}}function I(Q,se){g=!1,m&&(m=!1,y(_),_=-1),p=!0;var M=h;try{for(T(se),d=n(l);d!==null&&(!(d.expirationTime>se)||Q&&!A());){var Se=d.callback;if(typeof Se=="function"){d.callback=null,h=d.priorityLevel;var ye=Se(d.expirationTime<=se);se=t.unstable_now(),typeof ye=="function"?d.callback=ye:d===n(l)&&r(l),T(se)}else r(l);d=n(l)}if(d!==null)var U=!0;else{var be=n(u);be!==null&&ue(x,be.startTime-se),U=!1}return U}finally{d=null,h=M,p=!1}}var R=!1,C=null,_=-1,P=5,N=-1;function A(){return!(t.unstable_now()-N<P)}function D(){if(C!==null){var Q=t.unstable_now();N=Q;var se=!0;try{se=C(!0,Q)}finally{se?L():(R=!1,C=null)}}else R=!1}var L;if(typeof w=="function")L=function(){w(D)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,re=ae.port2;ae.port1.onmessage=D,L=function(){re.postMessage(null)}}else L=function(){k(D,0)};function Te(Q){C=Q,R||(R=!0,L())}function ue(Q,se){_=k(function(){Q(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,Te(I))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(Q){switch(h){case 1:case 2:case 3:var se=3;break;default:se=h}var M=h;h=se;try{return Q()}finally{h=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,se){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var M=h;h=Q;try{return se()}finally{h=M}},t.unstable_scheduleCallback=function(Q,se,M){var Se=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?Se+M:Se):M=Se,Q){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=M+ye,Q={id:c++,callback:se,priorityLevel:Q,startTime:M,expirationTime:ye,sortIndex:-1},M>Se?(Q.sortIndex=M,e(u,Q),n(l)===null&&Q===n(u)&&(m?(y(_),_=-1):m=!0,ue(x,M-Se))):(Q.sortIndex=ye,e(l,Q),g||p||(g=!0,Te(I))),Q},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(Q){var se=h;return function(){var M=h;h=se;try{return Q.apply(this,arguments)}finally{h=M}}}})(Dx);Ox.exports=Dx;var qM=Ox.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HM=v,Gn=qM;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Lx=new Set,Zu={};function Vo(t,e){Ja(t,e),Ja(t+"Capture",e)}function Ja(t,e){for(Zu[t]=e,t=0;t<e.length;t++)Lx.add(e[t])}var Ri=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_y=Object.prototype.hasOwnProperty,WM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,MT={},UT={};function KM(t){return _y.call(UT,t)?!0:_y.call(MT,t)?!1:WM.test(t)?UT[t]=!0:(MT[t]=!0,!1)}function GM(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QM(t,e,n,r){if(e===null||typeof e>"u"||GM(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var $t={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$t[t]=new gn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$t[e]=new gn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$t[t]=new gn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$t[t]=new gn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$t[t]=new gn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$t[t]=new gn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$t[t]=new gn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$t[t]=new gn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$t[t]=new gn(t,5,!1,t.toLowerCase(),null,!1,!1)});var a0=/[\-:]([a-z])/g;function l0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(a0,l0);$t[e]=new gn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(a0,l0);$t[e]=new gn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(a0,l0);$t[e]=new gn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$t[t]=new gn(t,1,!1,t.toLowerCase(),null,!1,!1)});$t.xlinkHref=new gn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$t[t]=new gn(t,1,!1,t.toLowerCase(),null,!0,!0)});function u0(t,e,n,r){var i=$t.hasOwnProperty(e)?$t[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QM(e,n,i,r)&&(n=null),r||i===null?KM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var $i=HM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nd=Symbol.for("react.element"),ma=Symbol.for("react.portal"),ga=Symbol.for("react.fragment"),c0=Symbol.for("react.strict_mode"),Ey=Symbol.for("react.profiler"),Mx=Symbol.for("react.provider"),Ux=Symbol.for("react.context"),d0=Symbol.for("react.forward_ref"),Cy=Symbol.for("react.suspense"),xy=Symbol.for("react.suspense_list"),f0=Symbol.for("react.memo"),os=Symbol.for("react.lazy"),Fx=Symbol.for("react.offscreen"),FT=Symbol.iterator;function Zl(t){return t===null||typeof t!="object"?null:(t=FT&&t[FT]||t["@@iterator"],typeof t=="function"?t:null)}var lt=Object.assign,Xm;function gu(t){if(Xm===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xm=e&&e[1]||""}return`
`+Xm+t}var Zm=!1;function eg(t,e){if(!t||Zm)return"";Zm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Zm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?gu(t):""}function JM(t){switch(t.tag){case 5:return gu(t.type);case 16:return gu("Lazy");case 13:return gu("Suspense");case 19:return gu("SuspenseList");case 0:case 2:case 15:return t=eg(t.type,!1),t;case 11:return t=eg(t.type.render,!1),t;case 1:return t=eg(t.type,!0),t;default:return""}}function Iy(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ga:return"Fragment";case ma:return"Portal";case Ey:return"Profiler";case c0:return"StrictMode";case Cy:return"Suspense";case xy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ux:return(t.displayName||"Context")+".Consumer";case Mx:return(t._context.displayName||"Context")+".Provider";case d0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case f0:return e=t.displayName||null,e!==null?e:Iy(t.type)||"Memo";case os:e=t._payload,t=t._init;try{return Iy(t(e))}catch{}}return null}function YM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Iy(e);case 8:return e===c0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Os(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XM(t){var e=jx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Od(t){t._valueTracker||(t._valueTracker=XM(t))}function Vx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=jx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ih(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Py(t,e){var n=e.checked;return lt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function jT(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Os(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Bx(t,e){e=e.checked,e!=null&&u0(t,"checked",e,!1)}function Ry(t,e){Bx(t,e);var n=Os(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ay(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ay(t,e.type,Os(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function VT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ay(t,e,n){(e!=="number"||ih(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var yu=Array.isArray;function Pa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Os(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Ny(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return lt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function BT(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(X(92));if(yu(n)){if(1<n.length)throw Error(X(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Os(n)}}function $x(t,e){var n=Os(e.value),r=Os(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function $T(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Oy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Dd,qx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Dd=Dd||document.createElement("div"),Dd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Dd.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ec(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Cu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ZM=["Webkit","ms","Moz","O"];Object.keys(Cu).forEach(function(t){ZM.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Cu[e]=Cu[t]})});function Hx(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Cu.hasOwnProperty(t)&&Cu[t]?(""+e).trim():e+"px"}function Wx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Hx(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var e5=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dy(t,e){if(e){if(e5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function Ly(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var My=null;function h0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Uy=null,Ra=null,Aa=null;function zT(t){if(t=zc(t)){if(typeof Uy!="function")throw Error(X(280));var e=t.stateNode;e&&(e=Sp(e),Uy(t.stateNode,t.type,e))}}function Kx(t){Ra?Aa?Aa.push(t):Aa=[t]:Ra=t}function Gx(){if(Ra){var t=Ra,e=Aa;if(Aa=Ra=null,zT(t),e)for(t=0;t<e.length;t++)zT(e[t])}}function Qx(t,e){return t(e)}function Jx(){}var tg=!1;function Yx(t,e,n){if(tg)return t(e,n);tg=!0;try{return Qx(t,e,n)}finally{tg=!1,(Ra!==null||Aa!==null)&&(Jx(),Gx())}}function tc(t,e){var n=t.stateNode;if(n===null)return null;var r=Sp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(X(231,e,typeof n));return n}var Fy=!1;if(Ri)try{var eu={};Object.defineProperty(eu,"passive",{get:function(){Fy=!0}}),window.addEventListener("test",eu,eu),window.removeEventListener("test",eu,eu)}catch{Fy=!1}function t5(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var xu=!1,sh=null,oh=!1,jy=null,n5={onError:function(t){xu=!0,sh=t}};function r5(t,e,n,r,i,s,o,a,l){xu=!1,sh=null,t5.apply(n5,arguments)}function i5(t,e,n,r,i,s,o,a,l){if(r5.apply(this,arguments),xu){if(xu){var u=sh;xu=!1,sh=null}else throw Error(X(198));oh||(oh=!0,jy=u)}}function Bo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Xx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function qT(t){if(Bo(t)!==t)throw Error(X(188))}function s5(t){var e=t.alternate;if(!e){if(e=Bo(t),e===null)throw Error(X(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return qT(i),t;if(s===r)return qT(i),e;s=s.sibling}throw Error(X(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(X(189))}}if(n.alternate!==r)throw Error(X(190))}if(n.tag!==3)throw Error(X(188));return n.stateNode.current===n?t:e}function Zx(t){return t=s5(t),t!==null?eI(t):null}function eI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=eI(t);if(e!==null)return e;t=t.sibling}return null}var tI=Gn.unstable_scheduleCallback,HT=Gn.unstable_cancelCallback,o5=Gn.unstable_shouldYield,a5=Gn.unstable_requestPaint,yt=Gn.unstable_now,l5=Gn.unstable_getCurrentPriorityLevel,p0=Gn.unstable_ImmediatePriority,nI=Gn.unstable_UserBlockingPriority,ah=Gn.unstable_NormalPriority,u5=Gn.unstable_LowPriority,rI=Gn.unstable_IdlePriority,bp=null,Zr=null;function c5(t){if(Zr&&typeof Zr.onCommitFiberRoot=="function")try{Zr.onCommitFiberRoot(bp,t,void 0,(t.current.flags&128)===128)}catch{}}var xr=Math.clz32?Math.clz32:h5,d5=Math.log,f5=Math.LN2;function h5(t){return t>>>=0,t===0?32:31-(d5(t)/f5|0)|0}var Ld=64,Md=4194304;function vu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=vu(a):(s&=o,s!==0&&(r=vu(s)))}else o=n&~i,o!==0?r=vu(o):s!==0&&(r=vu(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-xr(e),i=1<<n,r|=t[n],e&=~i;return r}function p5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function m5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-xr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=p5(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Vy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function iI(){var t=Ld;return Ld<<=1,!(Ld&4194240)&&(Ld=64),t}function ng(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-xr(e),t[e]=n}function g5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-xr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function m0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-xr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ve=0;function sI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var oI,g0,aI,lI,uI,By=!1,Ud=[],bs=null,ks=null,ws=null,nc=new Map,rc=new Map,us=[],y5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function WT(t,e){switch(t){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":nc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rc.delete(e.pointerId)}}function tu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=zc(e),e!==null&&g0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function v5(t,e,n,r,i){switch(e){case"focusin":return bs=tu(bs,t,e,n,r,i),!0;case"dragenter":return ks=tu(ks,t,e,n,r,i),!0;case"mouseover":return ws=tu(ws,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return nc.set(s,tu(nc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,rc.set(s,tu(rc.get(s)||null,t,e,n,r,i)),!0}return!1}function cI(t){var e=so(t.target);if(e!==null){var n=Bo(e);if(n!==null){if(e=n.tag,e===13){if(e=Xx(n),e!==null){t.blockedOn=e,uI(t.priority,function(){aI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=$y(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);My=r,n.target.dispatchEvent(r),My=null}else return e=zc(n),e!==null&&g0(e),t.blockedOn=n,!1;e.shift()}return!0}function KT(t,e,n){gf(t)&&n.delete(e)}function b5(){By=!1,bs!==null&&gf(bs)&&(bs=null),ks!==null&&gf(ks)&&(ks=null),ws!==null&&gf(ws)&&(ws=null),nc.forEach(KT),rc.forEach(KT)}function nu(t,e){t.blockedOn===e&&(t.blockedOn=null,By||(By=!0,Gn.unstable_scheduleCallback(Gn.unstable_NormalPriority,b5)))}function ic(t){function e(i){return nu(i,t)}if(0<Ud.length){nu(Ud[0],t);for(var n=1;n<Ud.length;n++){var r=Ud[n];r.blockedOn===t&&(r.blockedOn=null)}}for(bs!==null&&nu(bs,t),ks!==null&&nu(ks,t),ws!==null&&nu(ws,t),nc.forEach(e),rc.forEach(e),n=0;n<us.length;n++)r=us[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<us.length&&(n=us[0],n.blockedOn===null);)cI(n),n.blockedOn===null&&us.shift()}var Na=$i.ReactCurrentBatchConfig,uh=!0;function k5(t,e,n,r){var i=Ve,s=Na.transition;Na.transition=null;try{Ve=1,y0(t,e,n,r)}finally{Ve=i,Na.transition=s}}function w5(t,e,n,r){var i=Ve,s=Na.transition;Na.transition=null;try{Ve=4,y0(t,e,n,r)}finally{Ve=i,Na.transition=s}}function y0(t,e,n,r){if(uh){var i=$y(t,e,n,r);if(i===null)fg(t,e,r,ch,n),WT(t,r);else if(v5(i,t,e,n,r))r.stopPropagation();else if(WT(t,r),e&4&&-1<y5.indexOf(t)){for(;i!==null;){var s=zc(i);if(s!==null&&oI(s),s=$y(t,e,n,r),s===null&&fg(t,e,r,ch,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else fg(t,e,r,null,n)}}var ch=null;function $y(t,e,n,r){if(ch=null,t=h0(r),t=so(t),t!==null)if(e=Bo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Xx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ch=t,null}function dI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(l5()){case p0:return 1;case nI:return 4;case ah:case u5:return 16;case rI:return 536870912;default:return 16}default:return 16}}var ps=null,v0=null,yf=null;function fI(){if(yf)return yf;var t,e=v0,n=e.length,r,i="value"in ps?ps.value:ps.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return yf=i.slice(t,1<r?1-r:void 0)}function vf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Fd(){return!0}function GT(){return!1}function Yn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Fd:GT,this.isPropagationStopped=GT,this}return lt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fd)},persist:function(){},isPersistent:Fd}),e}var yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},b0=Yn(yl),$c=lt({},yl,{view:0,detail:0}),T5=Yn($c),rg,ig,ru,kp=lt({},$c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:k0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ru&&(ru&&t.type==="mousemove"?(rg=t.screenX-ru.screenX,ig=t.screenY-ru.screenY):ig=rg=0,ru=t),rg)},movementY:function(t){return"movementY"in t?t.movementY:ig}}),QT=Yn(kp),S5=lt({},kp,{dataTransfer:0}),_5=Yn(S5),E5=lt({},$c,{relatedTarget:0}),sg=Yn(E5),C5=lt({},yl,{animationName:0,elapsedTime:0,pseudoElement:0}),x5=Yn(C5),I5=lt({},yl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),P5=Yn(I5),R5=lt({},yl,{data:0}),JT=Yn(R5),A5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function D5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=O5[t])?!!e[t]:!1}function k0(){return D5}var L5=lt({},$c,{key:function(t){if(t.key){var e=A5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?N5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:k0,charCode:function(t){return t.type==="keypress"?vf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),M5=Yn(L5),U5=lt({},kp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YT=Yn(U5),F5=lt({},$c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:k0}),j5=Yn(F5),V5=lt({},yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),B5=Yn(V5),$5=lt({},kp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),z5=Yn($5),q5=[9,13,27,32],w0=Ri&&"CompositionEvent"in window,Iu=null;Ri&&"documentMode"in document&&(Iu=document.documentMode);var H5=Ri&&"TextEvent"in window&&!Iu,hI=Ri&&(!w0||Iu&&8<Iu&&11>=Iu),XT=" ",ZT=!1;function pI(t,e){switch(t){case"keyup":return q5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ya=!1;function W5(t,e){switch(t){case"compositionend":return mI(e);case"keypress":return e.which!==32?null:(ZT=!0,XT);case"textInput":return t=e.data,t===XT&&ZT?null:t;default:return null}}function K5(t,e){if(ya)return t==="compositionend"||!w0&&pI(t,e)?(t=fI(),yf=v0=ps=null,ya=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return hI&&e.locale!=="ko"?null:e.data;default:return null}}var G5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!G5[t.type]:e==="textarea"}function gI(t,e,n,r){Kx(r),e=dh(e,"onChange"),0<e.length&&(n=new b0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Pu=null,sc=null;function Q5(t){xI(t,0)}function wp(t){var e=ka(t);if(Vx(e))return t}function J5(t,e){if(t==="change")return e}var yI=!1;if(Ri){var og;if(Ri){var ag="oninput"in document;if(!ag){var tS=document.createElement("div");tS.setAttribute("oninput","return;"),ag=typeof tS.oninput=="function"}og=ag}else og=!1;yI=og&&(!document.documentMode||9<document.documentMode)}function nS(){Pu&&(Pu.detachEvent("onpropertychange",vI),sc=Pu=null)}function vI(t){if(t.propertyName==="value"&&wp(sc)){var e=[];gI(e,sc,t,h0(t)),Yx(Q5,e)}}function Y5(t,e,n){t==="focusin"?(nS(),Pu=e,sc=n,Pu.attachEvent("onpropertychange",vI)):t==="focusout"&&nS()}function X5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wp(sc)}function Z5(t,e){if(t==="click")return wp(e)}function e4(t,e){if(t==="input"||t==="change")return wp(e)}function t4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ar=typeof Object.is=="function"?Object.is:t4;function oc(t,e){if(Ar(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!_y.call(e,i)||!Ar(t[i],e[i]))return!1}return!0}function rS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function iS(t,e){var n=rS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=rS(n)}}function bI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?bI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function kI(){for(var t=window,e=ih();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ih(t.document)}return e}function T0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function n4(t){var e=kI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&bI(n.ownerDocument.documentElement,n)){if(r!==null&&T0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=iS(n,s);var o=iS(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var r4=Ri&&"documentMode"in document&&11>=document.documentMode,va=null,zy=null,Ru=null,qy=!1;function sS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qy||va==null||va!==ih(r)||(r=va,"selectionStart"in r&&T0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ru&&oc(Ru,r)||(Ru=r,r=dh(zy,"onSelect"),0<r.length&&(e=new b0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=va)))}function jd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ba={animationend:jd("Animation","AnimationEnd"),animationiteration:jd("Animation","AnimationIteration"),animationstart:jd("Animation","AnimationStart"),transitionend:jd("Transition","TransitionEnd")},lg={},wI={};Ri&&(wI=document.createElement("div").style,"AnimationEvent"in window||(delete ba.animationend.animation,delete ba.animationiteration.animation,delete ba.animationstart.animation),"TransitionEvent"in window||delete ba.transitionend.transition);function Tp(t){if(lg[t])return lg[t];if(!ba[t])return t;var e=ba[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in wI)return lg[t]=e[n];return t}var TI=Tp("animationend"),SI=Tp("animationiteration"),_I=Tp("animationstart"),EI=Tp("transitionend"),CI=new Map,oS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hs(t,e){CI.set(t,e),Vo(e,[t])}for(var ug=0;ug<oS.length;ug++){var cg=oS[ug],i4=cg.toLowerCase(),s4=cg[0].toUpperCase()+cg.slice(1);Hs(i4,"on"+s4)}Hs(TI,"onAnimationEnd");Hs(SI,"onAnimationIteration");Hs(_I,"onAnimationStart");Hs("dblclick","onDoubleClick");Hs("focusin","onFocus");Hs("focusout","onBlur");Hs(EI,"onTransitionEnd");Ja("onMouseEnter",["mouseout","mouseover"]);Ja("onMouseLeave",["mouseout","mouseover"]);Ja("onPointerEnter",["pointerout","pointerover"]);Ja("onPointerLeave",["pointerout","pointerover"]);Vo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o4=new Set("cancel close invalid load scroll toggle".split(" ").concat(bu));function aS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,i5(r,e,void 0,t),t.currentTarget=null}function xI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;aS(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;aS(i,a,u),s=l}}}if(oh)throw t=jy,oh=!1,jy=null,t}function Ze(t,e){var n=e[Qy];n===void 0&&(n=e[Qy]=new Set);var r=t+"__bubble";n.has(r)||(II(e,t,2,!1),n.add(r))}function dg(t,e,n){var r=0;e&&(r|=4),II(n,t,r,e)}var Vd="_reactListening"+Math.random().toString(36).slice(2);function ac(t){if(!t[Vd]){t[Vd]=!0,Lx.forEach(function(n){n!=="selectionchange"&&(o4.has(n)||dg(n,!1,t),dg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vd]||(e[Vd]=!0,dg("selectionchange",!1,e))}}function II(t,e,n,r){switch(dI(e)){case 1:var i=k5;break;case 4:i=w5;break;default:i=y0}n=i.bind(null,e,n,t),i=void 0,!Fy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function fg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=so(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Yx(function(){var u=s,c=h0(n),d=[];e:{var h=CI.get(t);if(h!==void 0){var p=b0,g=t;switch(t){case"keypress":if(vf(n)===0)break e;case"keydown":case"keyup":p=M5;break;case"focusin":g="focus",p=sg;break;case"focusout":g="blur",p=sg;break;case"beforeblur":case"afterblur":p=sg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=QT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=_5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=j5;break;case TI:case SI:case _I:p=x5;break;case EI:p=B5;break;case"scroll":p=T5;break;case"wheel":p=z5;break;case"copy":case"cut":case"paste":p=P5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=YT}var m=(e&4)!==0,k=!m&&t==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var w=u,T;w!==null;){T=w;var x=T.stateNode;if(T.tag===5&&x!==null&&(T=x,y!==null&&(x=tc(w,y),x!=null&&m.push(lc(w,x,T)))),k)break;w=w.return}0<m.length&&(h=new p(h,g,null,n,c),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==My&&(g=n.relatedTarget||n.fromElement)&&(so(g)||g[Ai]))break e;if((p||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=n.relatedTarget||n.toElement,p=u,g=g?so(g):null,g!==null&&(k=Bo(g),g!==k||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(m=QT,x="onMouseLeave",y="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(m=YT,x="onPointerLeave",y="onPointerEnter",w="pointer"),k=p==null?h:ka(p),T=g==null?h:ka(g),h=new m(x,w+"leave",p,n,c),h.target=k,h.relatedTarget=T,x=null,so(c)===u&&(m=new m(y,w+"enter",g,n,c),m.target=T,m.relatedTarget=k,x=m),k=x,p&&g)t:{for(m=p,y=g,w=0,T=m;T;T=na(T))w++;for(T=0,x=y;x;x=na(x))T++;for(;0<w-T;)m=na(m),w--;for(;0<T-w;)y=na(y),T--;for(;w--;){if(m===y||y!==null&&m===y.alternate)break t;m=na(m),y=na(y)}m=null}else m=null;p!==null&&lS(d,h,p,m,!1),g!==null&&k!==null&&lS(d,k,g,m,!0)}}e:{if(h=u?ka(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var I=J5;else if(eS(h))if(yI)I=e4;else{I=X5;var R=Y5}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(I=Z5);if(I&&(I=I(t,u))){gI(d,I,n,c);break e}R&&R(t,h,u),t==="focusout"&&(R=h._wrapperState)&&R.controlled&&h.type==="number"&&Ay(h,"number",h.value)}switch(R=u?ka(u):window,t){case"focusin":(eS(R)||R.contentEditable==="true")&&(va=R,zy=u,Ru=null);break;case"focusout":Ru=zy=va=null;break;case"mousedown":qy=!0;break;case"contextmenu":case"mouseup":case"dragend":qy=!1,sS(d,n,c);break;case"selectionchange":if(r4)break;case"keydown":case"keyup":sS(d,n,c)}var C;if(w0)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else ya?pI(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(hI&&n.locale!=="ko"&&(ya||_!=="onCompositionStart"?_==="onCompositionEnd"&&ya&&(C=fI()):(ps=c,v0="value"in ps?ps.value:ps.textContent,ya=!0)),R=dh(u,_),0<R.length&&(_=new JT(_,t,null,n,c),d.push({event:_,listeners:R}),C?_.data=C:(C=mI(n),C!==null&&(_.data=C)))),(C=H5?W5(t,n):K5(t,n))&&(u=dh(u,"onBeforeInput"),0<u.length&&(c=new JT("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=C))}xI(d,e)})}function lc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=tc(t,n),s!=null&&r.unshift(lc(t,s,i)),s=tc(t,e),s!=null&&r.push(lc(t,s,i))),t=t.return}return r}function na(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function lS(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=tc(n,s),l!=null&&o.unshift(lc(n,l,a))):i||(l=tc(n,s),l!=null&&o.push(lc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var a4=/\r\n?/g,l4=/\u0000|\uFFFD/g;function uS(t){return(typeof t=="string"?t:""+t).replace(a4,`
`).replace(l4,"")}function Bd(t,e,n){if(e=uS(e),uS(t)!==e&&n)throw Error(X(425))}function fh(){}var Hy=null,Wy=null;function Ky(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Gy=typeof setTimeout=="function"?setTimeout:void 0,u4=typeof clearTimeout=="function"?clearTimeout:void 0,cS=typeof Promise=="function"?Promise:void 0,c4=typeof queueMicrotask=="function"?queueMicrotask:typeof cS<"u"?function(t){return cS.resolve(null).then(t).catch(d4)}:Gy;function d4(t){setTimeout(function(){throw t})}function hg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ic(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ic(e)}function Ts(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function dS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var vl=Math.random().toString(36).slice(2),Jr="__reactFiber$"+vl,uc="__reactProps$"+vl,Ai="__reactContainer$"+vl,Qy="__reactEvents$"+vl,f4="__reactListeners$"+vl,h4="__reactHandles$"+vl;function so(t){var e=t[Jr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ai]||n[Jr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=dS(t);t!==null;){if(n=t[Jr])return n;t=dS(t)}return e}t=n,n=t.parentNode}return null}function zc(t){return t=t[Jr]||t[Ai],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ka(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function Sp(t){return t[uc]||null}var Jy=[],wa=-1;function Ws(t){return{current:t}}function tt(t){0>wa||(t.current=Jy[wa],Jy[wa]=null,wa--)}function Ge(t,e){wa++,Jy[wa]=t.current,t.current=e}var Ds={},rn=Ws(Ds),_n=Ws(!1),Eo=Ds;function Ya(t,e){var n=t.type.contextTypes;if(!n)return Ds;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function En(t){return t=t.childContextTypes,t!=null}function hh(){tt(_n),tt(rn)}function fS(t,e,n){if(rn.current!==Ds)throw Error(X(168));Ge(rn,e),Ge(_n,n)}function PI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(X(108,YM(t)||"Unknown",i));return lt({},n,r)}function ph(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ds,Eo=rn.current,Ge(rn,t),Ge(_n,_n.current),!0}function hS(t,e,n){var r=t.stateNode;if(!r)throw Error(X(169));n?(t=PI(t,e,Eo),r.__reactInternalMemoizedMergedChildContext=t,tt(_n),tt(rn),Ge(rn,t)):tt(_n),Ge(_n,n)}var yi=null,_p=!1,pg=!1;function RI(t){yi===null?yi=[t]:yi.push(t)}function p4(t){_p=!0,RI(t)}function Ks(){if(!pg&&yi!==null){pg=!0;var t=0,e=Ve;try{var n=yi;for(Ve=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}yi=null,_p=!1}catch(i){throw yi!==null&&(yi=yi.slice(t+1)),tI(p0,Ks),i}finally{Ve=e,pg=!1}}return null}var Ta=[],Sa=0,mh=null,gh=0,Zn=[],er=0,Co=null,wi=1,Ti="";function to(t,e){Ta[Sa++]=gh,Ta[Sa++]=mh,mh=t,gh=e}function AI(t,e,n){Zn[er++]=wi,Zn[er++]=Ti,Zn[er++]=Co,Co=t;var r=wi;t=Ti;var i=32-xr(r)-1;r&=~(1<<i),n+=1;var s=32-xr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,wi=1<<32-xr(e)+i|n<<i|r,Ti=s+t}else wi=1<<s|n<<i|r,Ti=t}function S0(t){t.return!==null&&(to(t,1),AI(t,1,0))}function _0(t){for(;t===mh;)mh=Ta[--Sa],Ta[Sa]=null,gh=Ta[--Sa],Ta[Sa]=null;for(;t===Co;)Co=Zn[--er],Zn[er]=null,Ti=Zn[--er],Zn[er]=null,wi=Zn[--er],Zn[er]=null}var zn=null,Bn=null,rt=!1,Tr=null;function NI(t,e){var n=sr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function pS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,zn=t,Bn=Ts(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,zn=t,Bn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Co!==null?{id:wi,overflow:Ti}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=sr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,zn=t,Bn=null,!0):!1;default:return!1}}function Yy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Xy(t){if(rt){var e=Bn;if(e){var n=e;if(!pS(t,e)){if(Yy(t))throw Error(X(418));e=Ts(n.nextSibling);var r=zn;e&&pS(t,e)?NI(r,n):(t.flags=t.flags&-4097|2,rt=!1,zn=t)}}else{if(Yy(t))throw Error(X(418));t.flags=t.flags&-4097|2,rt=!1,zn=t}}}function mS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;zn=t}function $d(t){if(t!==zn)return!1;if(!rt)return mS(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ky(t.type,t.memoizedProps)),e&&(e=Bn)){if(Yy(t))throw OI(),Error(X(418));for(;e;)NI(t,e),e=Ts(e.nextSibling)}if(mS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Bn=Ts(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Bn=null}}else Bn=zn?Ts(t.stateNode.nextSibling):null;return!0}function OI(){for(var t=Bn;t;)t=Ts(t.nextSibling)}function Xa(){Bn=zn=null,rt=!1}function E0(t){Tr===null?Tr=[t]:Tr.push(t)}var m4=$i.ReactCurrentBatchConfig;function iu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(X(309));var r=n.stateNode}if(!r)throw Error(X(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(X(284));if(!n._owner)throw Error(X(290,t))}return t}function zd(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function gS(t){var e=t._init;return e(t._payload)}function DI(t){function e(y,w){if(t){var T=y.deletions;T===null?(y.deletions=[w],y.flags|=16):T.push(w)}}function n(y,w){if(!t)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function r(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=Cs(y,w),y.index=0,y.sibling=null,y}function s(y,w,T){return y.index=T,t?(T=y.alternate,T!==null?(T=T.index,T<w?(y.flags|=2,w):T):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,w,T,x){return w===null||w.tag!==6?(w=wg(T,y.mode,x),w.return=y,w):(w=i(w,T),w.return=y,w)}function l(y,w,T,x){var I=T.type;return I===ga?c(y,w,T.props.children,x,T.key):w!==null&&(w.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===os&&gS(I)===w.type)?(x=i(w,T.props),x.ref=iu(y,w,T),x.return=y,x):(x=Ef(T.type,T.key,T.props,null,y.mode,x),x.ref=iu(y,w,T),x.return=y,x)}function u(y,w,T,x){return w===null||w.tag!==4||w.stateNode.containerInfo!==T.containerInfo||w.stateNode.implementation!==T.implementation?(w=Tg(T,y.mode,x),w.return=y,w):(w=i(w,T.children||[]),w.return=y,w)}function c(y,w,T,x,I){return w===null||w.tag!==7?(w=mo(T,y.mode,x,I),w.return=y,w):(w=i(w,T),w.return=y,w)}function d(y,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return w=wg(""+w,y.mode,T),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Nd:return T=Ef(w.type,w.key,w.props,null,y.mode,T),T.ref=iu(y,null,w),T.return=y,T;case ma:return w=Tg(w,y.mode,T),w.return=y,w;case os:var x=w._init;return d(y,x(w._payload),T)}if(yu(w)||Zl(w))return w=mo(w,y.mode,T,null),w.return=y,w;zd(y,w)}return null}function h(y,w,T,x){var I=w!==null?w.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return I!==null?null:a(y,w,""+T,x);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Nd:return T.key===I?l(y,w,T,x):null;case ma:return T.key===I?u(y,w,T,x):null;case os:return I=T._init,h(y,w,I(T._payload),x)}if(yu(T)||Zl(T))return I!==null?null:c(y,w,T,x,null);zd(y,T)}return null}function p(y,w,T,x,I){if(typeof x=="string"&&x!==""||typeof x=="number")return y=y.get(T)||null,a(w,y,""+x,I);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Nd:return y=y.get(x.key===null?T:x.key)||null,l(w,y,x,I);case ma:return y=y.get(x.key===null?T:x.key)||null,u(w,y,x,I);case os:var R=x._init;return p(y,w,T,R(x._payload),I)}if(yu(x)||Zl(x))return y=y.get(T)||null,c(w,y,x,I,null);zd(w,x)}return null}function g(y,w,T,x){for(var I=null,R=null,C=w,_=w=0,P=null;C!==null&&_<T.length;_++){C.index>_?(P=C,C=null):P=C.sibling;var N=h(y,C,T[_],x);if(N===null){C===null&&(C=P);break}t&&C&&N.alternate===null&&e(y,C),w=s(N,w,_),R===null?I=N:R.sibling=N,R=N,C=P}if(_===T.length)return n(y,C),rt&&to(y,_),I;if(C===null){for(;_<T.length;_++)C=d(y,T[_],x),C!==null&&(w=s(C,w,_),R===null?I=C:R.sibling=C,R=C);return rt&&to(y,_),I}for(C=r(y,C);_<T.length;_++)P=p(C,y,_,T[_],x),P!==null&&(t&&P.alternate!==null&&C.delete(P.key===null?_:P.key),w=s(P,w,_),R===null?I=P:R.sibling=P,R=P);return t&&C.forEach(function(A){return e(y,A)}),rt&&to(y,_),I}function m(y,w,T,x){var I=Zl(T);if(typeof I!="function")throw Error(X(150));if(T=I.call(T),T==null)throw Error(X(151));for(var R=I=null,C=w,_=w=0,P=null,N=T.next();C!==null&&!N.done;_++,N=T.next()){C.index>_?(P=C,C=null):P=C.sibling;var A=h(y,C,N.value,x);if(A===null){C===null&&(C=P);break}t&&C&&A.alternate===null&&e(y,C),w=s(A,w,_),R===null?I=A:R.sibling=A,R=A,C=P}if(N.done)return n(y,C),rt&&to(y,_),I;if(C===null){for(;!N.done;_++,N=T.next())N=d(y,N.value,x),N!==null&&(w=s(N,w,_),R===null?I=N:R.sibling=N,R=N);return rt&&to(y,_),I}for(C=r(y,C);!N.done;_++,N=T.next())N=p(C,y,_,N.value,x),N!==null&&(t&&N.alternate!==null&&C.delete(N.key===null?_:N.key),w=s(N,w,_),R===null?I=N:R.sibling=N,R=N);return t&&C.forEach(function(D){return e(y,D)}),rt&&to(y,_),I}function k(y,w,T,x){if(typeof T=="object"&&T!==null&&T.type===ga&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Nd:e:{for(var I=T.key,R=w;R!==null;){if(R.key===I){if(I=T.type,I===ga){if(R.tag===7){n(y,R.sibling),w=i(R,T.props.children),w.return=y,y=w;break e}}else if(R.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===os&&gS(I)===R.type){n(y,R.sibling),w=i(R,T.props),w.ref=iu(y,R,T),w.return=y,y=w;break e}n(y,R);break}else e(y,R);R=R.sibling}T.type===ga?(w=mo(T.props.children,y.mode,x,T.key),w.return=y,y=w):(x=Ef(T.type,T.key,T.props,null,y.mode,x),x.ref=iu(y,w,T),x.return=y,y=x)}return o(y);case ma:e:{for(R=T.key;w!==null;){if(w.key===R)if(w.tag===4&&w.stateNode.containerInfo===T.containerInfo&&w.stateNode.implementation===T.implementation){n(y,w.sibling),w=i(w,T.children||[]),w.return=y,y=w;break e}else{n(y,w);break}else e(y,w);w=w.sibling}w=Tg(T,y.mode,x),w.return=y,y=w}return o(y);case os:return R=T._init,k(y,w,R(T._payload),x)}if(yu(T))return g(y,w,T,x);if(Zl(T))return m(y,w,T,x);zd(y,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,w!==null&&w.tag===6?(n(y,w.sibling),w=i(w,T),w.return=y,y=w):(n(y,w),w=wg(T,y.mode,x),w.return=y,y=w),o(y)):n(y,w)}return k}var Za=DI(!0),LI=DI(!1),yh=Ws(null),vh=null,_a=null,C0=null;function x0(){C0=_a=vh=null}function I0(t){var e=yh.current;tt(yh),t._currentValue=e}function Zy(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Oa(t,e){vh=t,C0=_a=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wn=!0),t.firstContext=null)}function lr(t){var e=t._currentValue;if(C0!==t)if(t={context:t,memoizedValue:e,next:null},_a===null){if(vh===null)throw Error(X(308));_a=t,vh.dependencies={lanes:0,firstContext:t}}else _a=_a.next=t;return e}var oo=null;function P0(t){oo===null?oo=[t]:oo.push(t)}function MI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,P0(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ni(t,r)}function Ni(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var as=!1;function R0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function UI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ss(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,De&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ni(t,n)}return i=r.interleaved,i===null?(e.next=e,P0(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ni(t,n)}function bf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,m0(t,n)}}function yS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function bh(t,e,n,r){var i=t.updateQueue;as=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,p=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,m=a;switch(h=e,p=n,m.tag){case 1:if(g=m.payload,typeof g=="function"){d=g.call(p,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(p,d,h):g,h==null)break e;d=lt({},d,h);break e;case 2:as=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=p,l=d):c=c.next=p,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Io|=o,t.lanes=o,t.memoizedState=d}}function vS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(X(191,i));i.call(r)}}}var qc={},ei=Ws(qc),cc=Ws(qc),dc=Ws(qc);function ao(t){if(t===qc)throw Error(X(174));return t}function A0(t,e){switch(Ge(dc,e),Ge(cc,t),Ge(ei,qc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Oy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Oy(e,t)}tt(ei),Ge(ei,e)}function el(){tt(ei),tt(cc),tt(dc)}function FI(t){ao(dc.current);var e=ao(ei.current),n=Oy(e,t.type);e!==n&&(Ge(cc,t),Ge(ei,n))}function N0(t){cc.current===t&&(tt(ei),tt(cc))}var ot=Ws(0);function kh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mg=[];function O0(){for(var t=0;t<mg.length;t++)mg[t]._workInProgressVersionPrimary=null;mg.length=0}var kf=$i.ReactCurrentDispatcher,gg=$i.ReactCurrentBatchConfig,xo=0,at=null,Ct=null,At=null,wh=!1,Au=!1,fc=0,g4=0;function Kt(){throw Error(X(321))}function D0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ar(t[n],e[n]))return!1;return!0}function L0(t,e,n,r,i,s){if(xo=s,at=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kf.current=t===null||t.memoizedState===null?k4:w4,t=n(r,i),Au){s=0;do{if(Au=!1,fc=0,25<=s)throw Error(X(301));s+=1,At=Ct=null,e.updateQueue=null,kf.current=T4,t=n(r,i)}while(Au)}if(kf.current=Th,e=Ct!==null&&Ct.next!==null,xo=0,At=Ct=at=null,wh=!1,e)throw Error(X(300));return t}function M0(){var t=fc!==0;return fc=0,t}function Wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?at.memoizedState=At=t:At=At.next=t,At}function ur(){if(Ct===null){var t=at.alternate;t=t!==null?t.memoizedState:null}else t=Ct.next;var e=At===null?at.memoizedState:At.next;if(e!==null)At=e,Ct=t;else{if(t===null)throw Error(X(310));Ct=t,t={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},At===null?at.memoizedState=At=t:At=At.next=t}return At}function hc(t,e){return typeof e=="function"?e(t):e}function yg(t){var e=ur(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=Ct,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((xo&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,at.lanes|=c,Io|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Ar(r,e.memoizedState)||(wn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,at.lanes|=s,Io|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function vg(t){var e=ur(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ar(s,e.memoizedState)||(wn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function jI(){}function VI(t,e){var n=at,r=ur(),i=e(),s=!Ar(r.memoizedState,i);if(s&&(r.memoizedState=i,wn=!0),r=r.queue,U0(zI.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||At!==null&&At.memoizedState.tag&1){if(n.flags|=2048,pc(9,$I.bind(null,n,r,i,e),void 0,null),Ot===null)throw Error(X(349));xo&30||BI(n,e,i)}return i}function BI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function $I(t,e,n,r){e.value=n,e.getSnapshot=r,qI(e)&&HI(t)}function zI(t,e,n){return n(function(){qI(e)&&HI(t)})}function qI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ar(t,n)}catch{return!0}}function HI(t){var e=Ni(t,1);e!==null&&Ir(e,t,1,-1)}function bS(t){var e=Wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hc,lastRenderedState:t},e.queue=t,t=t.dispatch=b4.bind(null,at,t),[e.memoizedState,t]}function pc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function WI(){return ur().memoizedState}function wf(t,e,n,r){var i=Wr();at.flags|=t,i.memoizedState=pc(1|e,n,void 0,r===void 0?null:r)}function Ep(t,e,n,r){var i=ur();r=r===void 0?null:r;var s=void 0;if(Ct!==null){var o=Ct.memoizedState;if(s=o.destroy,r!==null&&D0(r,o.deps)){i.memoizedState=pc(e,n,s,r);return}}at.flags|=t,i.memoizedState=pc(1|e,n,s,r)}function kS(t,e){return wf(8390656,8,t,e)}function U0(t,e){return Ep(2048,8,t,e)}function KI(t,e){return Ep(4,2,t,e)}function GI(t,e){return Ep(4,4,t,e)}function QI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function JI(t,e,n){return n=n!=null?n.concat([t]):null,Ep(4,4,QI.bind(null,e,t),n)}function F0(){}function YI(t,e){var n=ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&D0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function XI(t,e){var n=ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&D0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ZI(t,e,n){return xo&21?(Ar(n,e)||(n=iI(),at.lanes|=n,Io|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wn=!0),t.memoizedState=n)}function y4(t,e){var n=Ve;Ve=n!==0&&4>n?n:4,t(!0);var r=gg.transition;gg.transition={};try{t(!1),e()}finally{Ve=n,gg.transition=r}}function eP(){return ur().memoizedState}function v4(t,e,n){var r=Es(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},tP(t))nP(e,n);else if(n=MI(t,e,n,r),n!==null){var i=hn();Ir(n,t,r,i),rP(n,e,r)}}function b4(t,e,n){var r=Es(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(tP(t))nP(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ar(a,o)){var l=e.interleaved;l===null?(i.next=i,P0(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=MI(t,e,i,r),n!==null&&(i=hn(),Ir(n,t,r,i),rP(n,e,r))}}function tP(t){var e=t.alternate;return t===at||e!==null&&e===at}function nP(t,e){Au=wh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rP(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,m0(t,n)}}var Th={readContext:lr,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},k4={readContext:lr,useCallback:function(t,e){return Wr().memoizedState=[t,e===void 0?null:e],t},useContext:lr,useEffect:kS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wf(4194308,4,QI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wf(4194308,4,t,e)},useInsertionEffect:function(t,e){return wf(4,2,t,e)},useMemo:function(t,e){var n=Wr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=v4.bind(null,at,t),[r.memoizedState,t]},useRef:function(t){var e=Wr();return t={current:t},e.memoizedState=t},useState:bS,useDebugValue:F0,useDeferredValue:function(t){return Wr().memoizedState=t},useTransition:function(){var t=bS(!1),e=t[0];return t=y4.bind(null,t[1]),Wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=at,i=Wr();if(rt){if(n===void 0)throw Error(X(407));n=n()}else{if(n=e(),Ot===null)throw Error(X(349));xo&30||BI(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,kS(zI.bind(null,r,s,t),[t]),r.flags|=2048,pc(9,$I.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Wr(),e=Ot.identifierPrefix;if(rt){var n=Ti,r=wi;n=(r&~(1<<32-xr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=g4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},w4={readContext:lr,useCallback:YI,useContext:lr,useEffect:U0,useImperativeHandle:JI,useInsertionEffect:KI,useLayoutEffect:GI,useMemo:XI,useReducer:yg,useRef:WI,useState:function(){return yg(hc)},useDebugValue:F0,useDeferredValue:function(t){var e=ur();return ZI(e,Ct.memoizedState,t)},useTransition:function(){var t=yg(hc)[0],e=ur().memoizedState;return[t,e]},useMutableSource:jI,useSyncExternalStore:VI,useId:eP,unstable_isNewReconciler:!1},T4={readContext:lr,useCallback:YI,useContext:lr,useEffect:U0,useImperativeHandle:JI,useInsertionEffect:KI,useLayoutEffect:GI,useMemo:XI,useReducer:vg,useRef:WI,useState:function(){return vg(hc)},useDebugValue:F0,useDeferredValue:function(t){var e=ur();return Ct===null?e.memoizedState=t:ZI(e,Ct.memoizedState,t)},useTransition:function(){var t=vg(hc)[0],e=ur().memoizedState;return[t,e]},useMutableSource:jI,useSyncExternalStore:VI,useId:eP,unstable_isNewReconciler:!1};function br(t,e){if(t&&t.defaultProps){e=lt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ev(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:lt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Cp={isMounted:function(t){return(t=t._reactInternals)?Bo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=hn(),i=Es(t),s=xi(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ss(t,s,i),e!==null&&(Ir(e,t,i,r),bf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=hn(),i=Es(t),s=xi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ss(t,s,i),e!==null&&(Ir(e,t,i,r),bf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=hn(),r=Es(t),i=xi(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ss(t,i,r),e!==null&&(Ir(e,t,r,n),bf(e,t,r))}};function wS(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!oc(n,r)||!oc(i,s):!0}function iP(t,e,n){var r=!1,i=Ds,s=e.contextType;return typeof s=="object"&&s!==null?s=lr(s):(i=En(e)?Eo:rn.current,r=e.contextTypes,s=(r=r!=null)?Ya(t,i):Ds),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function TS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Cp.enqueueReplaceState(e,e.state,null)}function tv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},R0(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=lr(s):(s=En(e)?Eo:rn.current,i.context=Ya(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ev(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Cp.enqueueReplaceState(i,i.state,null),bh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function tl(t,e){try{var n="",r=e;do n+=JM(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function bg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function nv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var S4=typeof WeakMap=="function"?WeakMap:Map;function sP(t,e,n){n=xi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_h||(_h=!0,fv=r),nv(t,e)},n}function oP(t,e,n){n=xi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){nv(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){nv(t,e),typeof r!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function SS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new S4;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=U4.bind(null,t,e,n),e.then(t,t))}function _S(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ES(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xi(-1,1),e.tag=2,Ss(n,e,1))),n.lanes|=1),t)}var _4=$i.ReactCurrentOwner,wn=!1;function dn(t,e,n,r){e.child=t===null?LI(e,null,n,r):Za(e,t.child,n,r)}function CS(t,e,n,r,i){n=n.render;var s=e.ref;return Oa(e,i),r=L0(t,e,n,r,s,i),n=M0(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Oi(t,e,i)):(rt&&n&&S0(e),e.flags|=1,dn(t,e,r,i),e.child)}function xS(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!W0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,aP(t,e,s,r,i)):(t=Ef(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:oc,n(o,r)&&t.ref===e.ref)return Oi(t,e,i)}return e.flags|=1,t=Cs(s,r),t.ref=e.ref,t.return=e,e.child=t}function aP(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(oc(s,r)&&t.ref===e.ref)if(wn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(wn=!0);else return e.lanes=t.lanes,Oi(t,e,i)}return rv(t,e,n,r,i)}function lP(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(Ca,jn),jn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ge(Ca,jn),jn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ge(Ca,jn),jn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ge(Ca,jn),jn|=r;return dn(t,e,i,n),e.child}function uP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function rv(t,e,n,r,i){var s=En(n)?Eo:rn.current;return s=Ya(e,s),Oa(e,i),n=L0(t,e,n,r,s,i),r=M0(),t!==null&&!wn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Oi(t,e,i)):(rt&&r&&S0(e),e.flags|=1,dn(t,e,n,i),e.child)}function IS(t,e,n,r,i){if(En(n)){var s=!0;ph(e)}else s=!1;if(Oa(e,i),e.stateNode===null)Tf(t,e),iP(e,n,r),tv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=lr(u):(u=En(n)?Eo:rn.current,u=Ya(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&TS(e,o,r,u),as=!1;var h=e.memoizedState;o.state=h,bh(e,r,o,i),l=e.memoizedState,a!==r||h!==l||_n.current||as?(typeof c=="function"&&(ev(e,n,c,r),l=e.memoizedState),(a=as||wS(e,n,a,r,h,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,UI(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:br(e.type,a),o.props=u,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=lr(l):(l=En(n)?Eo:rn.current,l=Ya(e,l));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&TS(e,o,r,l),as=!1,h=e.memoizedState,o.state=h,bh(e,r,o,i);var g=e.memoizedState;a!==d||h!==g||_n.current||as?(typeof p=="function"&&(ev(e,n,p,r),g=e.memoizedState),(u=as||wS(e,n,u,r,h,g,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return iv(t,e,n,r,s,i)}function iv(t,e,n,r,i,s){uP(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&hS(e,n,!1),Oi(t,e,s);r=e.stateNode,_4.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Za(e,t.child,null,s),e.child=Za(e,null,a,s)):dn(t,e,a,s),e.memoizedState=r.state,i&&hS(e,n,!0),e.child}function cP(t){var e=t.stateNode;e.pendingContext?fS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&fS(t,e.context,!1),A0(t,e.containerInfo)}function PS(t,e,n,r,i){return Xa(),E0(i),e.flags|=256,dn(t,e,n,r),e.child}var sv={dehydrated:null,treeContext:null,retryLane:0};function ov(t){return{baseLanes:t,cachePool:null,transitions:null}}function dP(t,e,n){var r=e.pendingProps,i=ot.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ge(ot,i&1),t===null)return Xy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Pp(o,r,0,null),t=mo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=ov(n),e.memoizedState=sv,t):j0(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return E4(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Cs(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Cs(a,s):(s=mo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?ov(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=sv,r}return s=t.child,t=s.sibling,r=Cs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function j0(t,e){return e=Pp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function qd(t,e,n,r){return r!==null&&E0(r),Za(e,t.child,null,n),t=j0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function E4(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=bg(Error(X(422))),qd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Pp({mode:"visible",children:r.children},i,0,null),s=mo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Za(e,t.child,null,o),e.child.memoizedState=ov(o),e.memoizedState=sv,s);if(!(e.mode&1))return qd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(X(419)),r=bg(s,r,void 0),qd(t,e,o,r)}if(a=(o&t.childLanes)!==0,wn||a){if(r=Ot,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ni(t,i),Ir(r,t,i,-1))}return H0(),r=bg(Error(X(421))),qd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=F4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Bn=Ts(i.nextSibling),zn=e,rt=!0,Tr=null,t!==null&&(Zn[er++]=wi,Zn[er++]=Ti,Zn[er++]=Co,wi=t.id,Ti=t.overflow,Co=e),e=j0(e,r.children),e.flags|=4096,e)}function RS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Zy(t.return,e,n)}function kg(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function fP(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(dn(t,e,r.children,n),r=ot.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&RS(t,n,e);else if(t.tag===19)RS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ge(ot,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&kh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),kg(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&kh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}kg(e,!0,n,null,s);break;case"together":kg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Tf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Oi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Io|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,n=Cs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Cs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function C4(t,e,n){switch(e.tag){case 3:cP(e),Xa();break;case 5:FI(e);break;case 1:En(e.type)&&ph(e);break;case 4:A0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ge(yh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ge(ot,ot.current&1),e.flags|=128,null):n&e.child.childLanes?dP(t,e,n):(Ge(ot,ot.current&1),t=Oi(t,e,n),t!==null?t.sibling:null);Ge(ot,ot.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return fP(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ge(ot,ot.current),r)break;return null;case 22:case 23:return e.lanes=0,lP(t,e,n)}return Oi(t,e,n)}var hP,av,pP,mP;hP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};av=function(){};pP=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ao(ei.current);var s=null;switch(n){case"input":i=Py(t,i),r=Py(t,r),s=[];break;case"select":i=lt({},i,{value:void 0}),r=lt({},r,{value:void 0}),s=[];break;case"textarea":i=Ny(t,i),r=Ny(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fh)}Dy(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Zu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Zu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ze("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};mP=function(t,e,n,r){n!==r&&(e.flags|=4)};function su(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Gt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function x4(t,e,n){var r=e.pendingProps;switch(_0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(e),null;case 1:return En(e.type)&&hh(),Gt(e),null;case 3:return r=e.stateNode,el(),tt(_n),tt(rn),O0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&($d(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tr!==null&&(mv(Tr),Tr=null))),av(t,e),Gt(e),null;case 5:N0(e);var i=ao(dc.current);if(n=e.type,t!==null&&e.stateNode!=null)pP(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return Gt(e),null}if(t=ao(ei.current),$d(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Jr]=e,r[uc]=s,t=(e.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(i=0;i<bu.length;i++)Ze(bu[i],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":jT(r,s),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ze("invalid",r);break;case"textarea":BT(r,s),Ze("invalid",r)}Dy(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Bd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Bd(r.textContent,a,t),i=["children",""+a]):Zu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ze("scroll",r)}switch(n){case"input":Od(r),VT(r,s,!0);break;case"textarea":Od(r),$T(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=fh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Jr]=e,t[uc]=r,hP(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ly(n,r),n){case"dialog":Ze("cancel",t),Ze("close",t),i=r;break;case"iframe":case"object":case"embed":Ze("load",t),i=r;break;case"video":case"audio":for(i=0;i<bu.length;i++)Ze(bu[i],t);i=r;break;case"source":Ze("error",t),i=r;break;case"img":case"image":case"link":Ze("error",t),Ze("load",t),i=r;break;case"details":Ze("toggle",t),i=r;break;case"input":jT(t,r),i=Py(t,r),Ze("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=lt({},r,{value:void 0}),Ze("invalid",t);break;case"textarea":BT(t,r),i=Ny(t,r),Ze("invalid",t);break;default:i=r}Dy(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Wx(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&qx(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ec(t,l):typeof l=="number"&&ec(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Zu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ze("scroll",t):l!=null&&u0(t,s,l,o))}switch(n){case"input":Od(t),VT(t,r,!1);break;case"textarea":Od(t),$T(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Os(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Pa(t,!!r.multiple,s,!1):r.defaultValue!=null&&Pa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=fh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gt(e),null;case 6:if(t&&e.stateNode!=null)mP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(n=ao(dc.current),ao(ei.current),$d(e)){if(r=e.stateNode,n=e.memoizedProps,r[Jr]=e,(s=r.nodeValue!==n)&&(t=zn,t!==null))switch(t.tag){case 3:Bd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Jr]=e,e.stateNode=r}return Gt(e),null;case 13:if(tt(ot),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&Bn!==null&&e.mode&1&&!(e.flags&128))OI(),Xa(),e.flags|=98560,s=!1;else if(s=$d(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(X(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(X(317));s[Jr]=e}else Xa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gt(e),s=!1}else Tr!==null&&(mv(Tr),Tr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ot.current&1?It===0&&(It=3):H0())),e.updateQueue!==null&&(e.flags|=4),Gt(e),null);case 4:return el(),av(t,e),t===null&&ac(e.stateNode.containerInfo),Gt(e),null;case 10:return I0(e.type._context),Gt(e),null;case 17:return En(e.type)&&hh(),Gt(e),null;case 19:if(tt(ot),s=e.memoizedState,s===null)return Gt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)su(s,!1);else{if(It!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=kh(t),o!==null){for(e.flags|=128,su(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ge(ot,ot.current&1|2),e.child}t=t.sibling}s.tail!==null&&yt()>nl&&(e.flags|=128,r=!0,su(s,!1),e.lanes=4194304)}else{if(!r)if(t=kh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),su(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!rt)return Gt(e),null}else 2*yt()-s.renderingStartTime>nl&&n!==1073741824&&(e.flags|=128,r=!0,su(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=yt(),e.sibling=null,n=ot.current,Ge(ot,r?n&1|2:n&1),e):(Gt(e),null);case 22:case 23:return q0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?jn&1073741824&&(Gt(e),e.subtreeFlags&6&&(e.flags|=8192)):Gt(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function I4(t,e){switch(_0(e),e.tag){case 1:return En(e.type)&&hh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return el(),tt(_n),tt(rn),O0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return N0(e),null;case 13:if(tt(ot),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));Xa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return tt(ot),null;case 4:return el(),null;case 10:return I0(e.type._context),null;case 22:case 23:return q0(),null;case 24:return null;default:return null}}var Hd=!1,Zt=!1,P4=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Ea(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ht(t,e,r)}else n.current=null}function lv(t,e,n){try{n()}catch(r){ht(t,e,r)}}var AS=!1;function R4(t,e){if(Hy=uh,t=kI(),T0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var p;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++u===i&&(a=o),h===s&&++c===r&&(l=o),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Wy={focusedElem:t,selectionRange:n},uh=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,k=g.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:br(e.type,m),k);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(x){ht(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return g=AS,AS=!1,g}function Nu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&lv(e,n,s)}i=i.next}while(i!==r)}}function xp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function uv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function gP(t){var e=t.alternate;e!==null&&(t.alternate=null,gP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Jr],delete e[uc],delete e[Qy],delete e[f4],delete e[h4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function yP(t){return t.tag===5||t.tag===3||t.tag===4}function NS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||yP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fh));else if(r!==4&&(t=t.child,t!==null))for(cv(t,e,n),t=t.sibling;t!==null;)cv(t,e,n),t=t.sibling}function dv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(dv(t,e,n),t=t.sibling;t!==null;)dv(t,e,n),t=t.sibling}var Mt=null,kr=!1;function es(t,e,n){for(n=n.child;n!==null;)vP(t,e,n),n=n.sibling}function vP(t,e,n){if(Zr&&typeof Zr.onCommitFiberUnmount=="function")try{Zr.onCommitFiberUnmount(bp,n)}catch{}switch(n.tag){case 5:Zt||Ea(n,e);case 6:var r=Mt,i=kr;Mt=null,es(t,e,n),Mt=r,kr=i,Mt!==null&&(kr?(t=Mt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mt.removeChild(n.stateNode));break;case 18:Mt!==null&&(kr?(t=Mt,n=n.stateNode,t.nodeType===8?hg(t.parentNode,n):t.nodeType===1&&hg(t,n),ic(t)):hg(Mt,n.stateNode));break;case 4:r=Mt,i=kr,Mt=n.stateNode.containerInfo,kr=!0,es(t,e,n),Mt=r,kr=i;break;case 0:case 11:case 14:case 15:if(!Zt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&lv(n,e,o),i=i.next}while(i!==r)}es(t,e,n);break;case 1:if(!Zt&&(Ea(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ht(n,e,a)}es(t,e,n);break;case 21:es(t,e,n);break;case 22:n.mode&1?(Zt=(r=Zt)||n.memoizedState!==null,es(t,e,n),Zt=r):es(t,e,n);break;default:es(t,e,n)}}function OS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new P4),e.forEach(function(r){var i=j4.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function gr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mt=a.stateNode,kr=!1;break e;case 3:Mt=a.stateNode.containerInfo,kr=!0;break e;case 4:Mt=a.stateNode.containerInfo,kr=!0;break e}a=a.return}if(Mt===null)throw Error(X(160));vP(s,o,i),Mt=null,kr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){ht(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)bP(e,t),e=e.sibling}function bP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gr(e,t),$r(t),r&4){try{Nu(3,t,t.return),xp(3,t)}catch(m){ht(t,t.return,m)}try{Nu(5,t,t.return)}catch(m){ht(t,t.return,m)}}break;case 1:gr(e,t),$r(t),r&512&&n!==null&&Ea(n,n.return);break;case 5:if(gr(e,t),$r(t),r&512&&n!==null&&Ea(n,n.return),t.flags&32){var i=t.stateNode;try{ec(i,"")}catch(m){ht(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Bx(i,s),Ly(a,o);var u=Ly(a,s);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?Wx(i,d):c==="dangerouslySetInnerHTML"?qx(i,d):c==="children"?ec(i,d):u0(i,c,d,u)}switch(a){case"input":Ry(i,s);break;case"textarea":$x(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Pa(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Pa(i,!!s.multiple,s.defaultValue,!0):Pa(i,!!s.multiple,s.multiple?[]:"",!1))}i[uc]=s}catch(m){ht(t,t.return,m)}}break;case 6:if(gr(e,t),$r(t),r&4){if(t.stateNode===null)throw Error(X(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){ht(t,t.return,m)}}break;case 3:if(gr(e,t),$r(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ic(e.containerInfo)}catch(m){ht(t,t.return,m)}break;case 4:gr(e,t),$r(t);break;case 13:gr(e,t),$r(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||($0=yt())),r&4&&OS(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Zt=(u=Zt)||c,gr(e,t),Zt=u):gr(e,t),$r(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(oe=t,c=t.child;c!==null;){for(d=oe=c;oe!==null;){switch(h=oe,p=h.child,h.tag){case 0:case 11:case 14:case 15:Nu(4,h,h.return);break;case 1:Ea(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){ht(r,n,m)}}break;case 5:Ea(h,h.return);break;case 22:if(h.memoizedState!==null){LS(d);continue}}p!==null?(p.return=h,oe=p):LS(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Hx("display",o))}catch(m){ht(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){ht(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gr(e,t),$r(t),r&4&&OS(t);break;case 21:break;default:gr(e,t),$r(t)}}function $r(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(yP(n)){var r=n;break e}n=n.return}throw Error(X(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ec(i,""),r.flags&=-33);var s=NS(t);dv(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=NS(t);cv(t,a,o);break;default:throw Error(X(161))}}catch(l){ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function A4(t,e,n){oe=t,kP(t)}function kP(t,e,n){for(var r=(t.mode&1)!==0;oe!==null;){var i=oe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Hd;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Zt;a=Hd;var u=Zt;if(Hd=o,(Zt=l)&&!u)for(oe=i;oe!==null;)o=oe,l=o.child,o.tag===22&&o.memoizedState!==null?MS(i):l!==null?(l.return=o,oe=l):MS(i);for(;s!==null;)oe=s,kP(s),s=s.sibling;oe=i,Hd=a,Zt=u}DS(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,oe=s):DS(t)}}function DS(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zt||xp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:br(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&vS(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}vS(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&ic(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}Zt||e.flags&512&&uv(e)}catch(h){ht(e,e.return,h)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function LS(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function MS(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{xp(4,e)}catch(l){ht(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ht(e,i,l)}}var s=e.return;try{uv(e)}catch(l){ht(e,s,l)}break;case 5:var o=e.return;try{uv(e)}catch(l){ht(e,o,l)}}}catch(l){ht(e,e.return,l)}if(e===t){oe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,oe=a;break}oe=e.return}}var N4=Math.ceil,Sh=$i.ReactCurrentDispatcher,V0=$i.ReactCurrentOwner,ar=$i.ReactCurrentBatchConfig,De=0,Ot=null,wt=null,Bt=0,jn=0,Ca=Ws(0),It=0,mc=null,Io=0,Ip=0,B0=0,Ou=null,bn=null,$0=0,nl=1/0,gi=null,_h=!1,fv=null,_s=null,Wd=!1,ms=null,Eh=0,Du=0,hv=null,Sf=-1,_f=0;function hn(){return De&6?yt():Sf!==-1?Sf:Sf=yt()}function Es(t){return t.mode&1?De&2&&Bt!==0?Bt&-Bt:m4.transition!==null?(_f===0&&(_f=iI()),_f):(t=Ve,t!==0||(t=window.event,t=t===void 0?16:dI(t.type)),t):1}function Ir(t,e,n,r){if(50<Du)throw Du=0,hv=null,Error(X(185));Bc(t,n,r),(!(De&2)||t!==Ot)&&(t===Ot&&(!(De&2)&&(Ip|=n),It===4&&cs(t,Bt)),Cn(t,r),n===1&&De===0&&!(e.mode&1)&&(nl=yt()+500,_p&&Ks()))}function Cn(t,e){var n=t.callbackNode;m5(t,e);var r=lh(t,t===Ot?Bt:0);if(r===0)n!==null&&HT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&HT(n),e===1)t.tag===0?p4(US.bind(null,t)):RI(US.bind(null,t)),c4(function(){!(De&6)&&Ks()}),n=null;else{switch(sI(r)){case 1:n=p0;break;case 4:n=nI;break;case 16:n=ah;break;case 536870912:n=rI;break;default:n=ah}n=IP(n,wP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wP(t,e){if(Sf=-1,_f=0,De&6)throw Error(X(327));var n=t.callbackNode;if(Da()&&t.callbackNode!==n)return null;var r=lh(t,t===Ot?Bt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ch(t,r);else{e=r;var i=De;De|=2;var s=SP();(Ot!==t||Bt!==e)&&(gi=null,nl=yt()+500,po(t,e));do try{L4();break}catch(a){TP(t,a)}while(!0);x0(),Sh.current=s,De=i,wt!==null?e=0:(Ot=null,Bt=0,e=It)}if(e!==0){if(e===2&&(i=Vy(t),i!==0&&(r=i,e=pv(t,i))),e===1)throw n=mc,po(t,0),cs(t,r),Cn(t,yt()),n;if(e===6)cs(t,r);else{if(i=t.current.alternate,!(r&30)&&!O4(i)&&(e=Ch(t,r),e===2&&(s=Vy(t),s!==0&&(r=s,e=pv(t,s))),e===1))throw n=mc,po(t,0),cs(t,r),Cn(t,yt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:no(t,bn,gi);break;case 3:if(cs(t,r),(r&130023424)===r&&(e=$0+500-yt(),10<e)){if(lh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){hn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Gy(no.bind(null,t,bn,gi),e);break}no(t,bn,gi);break;case 4:if(cs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-xr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=yt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*N4(r/1960))-r,10<r){t.timeoutHandle=Gy(no.bind(null,t,bn,gi),r);break}no(t,bn,gi);break;case 5:no(t,bn,gi);break;default:throw Error(X(329))}}}return Cn(t,yt()),t.callbackNode===n?wP.bind(null,t):null}function pv(t,e){var n=Ou;return t.current.memoizedState.isDehydrated&&(po(t,e).flags|=256),t=Ch(t,e),t!==2&&(e=bn,bn=n,e!==null&&mv(e)),t}function mv(t){bn===null?bn=t:bn.push.apply(bn,t)}function O4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ar(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function cs(t,e){for(e&=~B0,e&=~Ip,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-xr(e),r=1<<n;t[n]=-1,e&=~r}}function US(t){if(De&6)throw Error(X(327));Da();var e=lh(t,0);if(!(e&1))return Cn(t,yt()),null;var n=Ch(t,e);if(t.tag!==0&&n===2){var r=Vy(t);r!==0&&(e=r,n=pv(t,r))}if(n===1)throw n=mc,po(t,0),cs(t,e),Cn(t,yt()),n;if(n===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,no(t,bn,gi),Cn(t,yt()),null}function z0(t,e){var n=De;De|=1;try{return t(e)}finally{De=n,De===0&&(nl=yt()+500,_p&&Ks())}}function Po(t){ms!==null&&ms.tag===0&&!(De&6)&&Da();var e=De;De|=1;var n=ar.transition,r=Ve;try{if(ar.transition=null,Ve=1,t)return t()}finally{Ve=r,ar.transition=n,De=e,!(De&6)&&Ks()}}function q0(){jn=Ca.current,tt(Ca)}function po(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,u4(n)),wt!==null)for(n=wt.return;n!==null;){var r=n;switch(_0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hh();break;case 3:el(),tt(_n),tt(rn),O0();break;case 5:N0(r);break;case 4:el();break;case 13:tt(ot);break;case 19:tt(ot);break;case 10:I0(r.type._context);break;case 22:case 23:q0()}n=n.return}if(Ot=t,wt=t=Cs(t.current,null),Bt=jn=e,It=0,mc=null,B0=Ip=Io=0,bn=Ou=null,oo!==null){for(e=0;e<oo.length;e++)if(n=oo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}oo=null}return t}function TP(t,e){do{var n=wt;try{if(x0(),kf.current=Th,wh){for(var r=at.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}wh=!1}if(xo=0,At=Ct=at=null,Au=!1,fc=0,V0.current=null,n===null||n.return===null){It=1,mc=e,wt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Bt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=_S(o);if(p!==null){p.flags&=-257,ES(p,o,a,s,e),p.mode&1&&SS(s,u,e),e=p,l=u;var g=e.updateQueue;if(g===null){var m=new Set;m.add(l),e.updateQueue=m}else g.add(l);break e}else{if(!(e&1)){SS(s,u,e),H0();break e}l=Error(X(426))}}else if(rt&&a.mode&1){var k=_S(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),ES(k,o,a,s,e),E0(tl(l,a));break e}}s=l=tl(l,a),It!==4&&(It=2),Ou===null?Ou=[s]:Ou.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=sP(s,l,e);yS(s,y);break e;case 1:a=l;var w=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(_s===null||!_s.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var x=oP(s,a,e);yS(s,x);break e}}s=s.return}while(s!==null)}EP(n)}catch(I){e=I,wt===n&&n!==null&&(wt=n=n.return);continue}break}while(!0)}function SP(){var t=Sh.current;return Sh.current=Th,t===null?Th:t}function H0(){(It===0||It===3||It===2)&&(It=4),Ot===null||!(Io&268435455)&&!(Ip&268435455)||cs(Ot,Bt)}function Ch(t,e){var n=De;De|=2;var r=SP();(Ot!==t||Bt!==e)&&(gi=null,po(t,e));do try{D4();break}catch(i){TP(t,i)}while(!0);if(x0(),De=n,Sh.current=r,wt!==null)throw Error(X(261));return Ot=null,Bt=0,It}function D4(){for(;wt!==null;)_P(wt)}function L4(){for(;wt!==null&&!o5();)_P(wt)}function _P(t){var e=xP(t.alternate,t,jn);t.memoizedProps=t.pendingProps,e===null?EP(t):wt=e,V0.current=null}function EP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=I4(n,e),n!==null){n.flags&=32767,wt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{It=6,wt=null;return}}else if(n=x4(n,e,jn),n!==null){wt=n;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);It===0&&(It=5)}function no(t,e,n){var r=Ve,i=ar.transition;try{ar.transition=null,Ve=1,M4(t,e,n,r)}finally{ar.transition=i,Ve=r}return null}function M4(t,e,n,r){do Da();while(ms!==null);if(De&6)throw Error(X(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(g5(t,s),t===Ot&&(wt=Ot=null,Bt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wd||(Wd=!0,IP(ah,function(){return Da(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ar.transition,ar.transition=null;var o=Ve;Ve=1;var a=De;De|=4,V0.current=null,R4(t,n),bP(n,t),n4(Wy),uh=!!Hy,Wy=Hy=null,t.current=n,A4(n),a5(),De=a,Ve=o,ar.transition=s}else t.current=n;if(Wd&&(Wd=!1,ms=t,Eh=i),s=t.pendingLanes,s===0&&(_s=null),c5(n.stateNode),Cn(t,yt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(_h)throw _h=!1,t=fv,fv=null,t;return Eh&1&&t.tag!==0&&Da(),s=t.pendingLanes,s&1?t===hv?Du++:(Du=0,hv=t):Du=0,Ks(),null}function Da(){if(ms!==null){var t=sI(Eh),e=ar.transition,n=Ve;try{if(ar.transition=null,Ve=16>t?16:t,ms===null)var r=!1;else{if(t=ms,ms=null,Eh=0,De&6)throw Error(X(331));var i=De;for(De|=4,oe=t.current;oe!==null;){var s=oe,o=s.child;if(oe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(oe=u;oe!==null;){var c=oe;switch(c.tag){case 0:case 11:case 15:Nu(8,c,s)}var d=c.child;if(d!==null)d.return=c,oe=d;else for(;oe!==null;){c=oe;var h=c.sibling,p=c.return;if(gP(c),c===u){oe=null;break}if(h!==null){h.return=p,oe=h;break}oe=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var k=m.sibling;m.sibling=null,m=k}while(m!==null)}}oe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,oe=o;else e:for(;oe!==null;){if(s=oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Nu(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,oe=y;break e}oe=s.return}}var w=t.current;for(oe=w;oe!==null;){o=oe;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,oe=T;else e:for(o=w;oe!==null;){if(a=oe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:xp(9,a)}}catch(I){ht(a,a.return,I)}if(a===o){oe=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,oe=x;break e}oe=a.return}}if(De=i,Ks(),Zr&&typeof Zr.onPostCommitFiberRoot=="function")try{Zr.onPostCommitFiberRoot(bp,t)}catch{}r=!0}return r}finally{Ve=n,ar.transition=e}}return!1}function FS(t,e,n){e=tl(n,e),e=sP(t,e,1),t=Ss(t,e,1),e=hn(),t!==null&&(Bc(t,1,e),Cn(t,e))}function ht(t,e,n){if(t.tag===3)FS(t,t,n);else for(;e!==null;){if(e.tag===3){FS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_s===null||!_s.has(r))){t=tl(n,t),t=oP(e,t,1),e=Ss(e,t,1),t=hn(),e!==null&&(Bc(e,1,t),Cn(e,t));break}}e=e.return}}function U4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=hn(),t.pingedLanes|=t.suspendedLanes&n,Ot===t&&(Bt&n)===n&&(It===4||It===3&&(Bt&130023424)===Bt&&500>yt()-$0?po(t,0):B0|=n),Cn(t,e)}function CP(t,e){e===0&&(t.mode&1?(e=Md,Md<<=1,!(Md&130023424)&&(Md=4194304)):e=1);var n=hn();t=Ni(t,e),t!==null&&(Bc(t,e,n),Cn(t,n))}function F4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),CP(t,n)}function j4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),CP(t,n)}var xP;xP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_n.current)wn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wn=!1,C4(t,e,n);wn=!!(t.flags&131072)}else wn=!1,rt&&e.flags&1048576&&AI(e,gh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Tf(t,e),t=e.pendingProps;var i=Ya(e,rn.current);Oa(e,n),i=L0(null,e,r,t,i,n);var s=M0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,En(r)?(s=!0,ph(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,R0(e),i.updater=Cp,e.stateNode=i,i._reactInternals=e,tv(e,r,t,n),e=iv(null,e,r,!0,s,n)):(e.tag=0,rt&&s&&S0(e),dn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Tf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=B4(r),t=br(r,t),i){case 0:e=rv(null,e,r,t,n);break e;case 1:e=IS(null,e,r,t,n);break e;case 11:e=CS(null,e,r,t,n);break e;case 14:e=xS(null,e,r,br(r.type,t),n);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),rv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),IS(t,e,r,i,n);case 3:e:{if(cP(e),t===null)throw Error(X(387));r=e.pendingProps,s=e.memoizedState,i=s.element,UI(t,e),bh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=tl(Error(X(423)),e),e=PS(t,e,r,n,i);break e}else if(r!==i){i=tl(Error(X(424)),e),e=PS(t,e,r,n,i);break e}else for(Bn=Ts(e.stateNode.containerInfo.firstChild),zn=e,rt=!0,Tr=null,n=LI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xa(),r===i){e=Oi(t,e,n);break e}dn(t,e,r,n)}e=e.child}return e;case 5:return FI(e),t===null&&Xy(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Ky(r,i)?o=null:s!==null&&Ky(r,s)&&(e.flags|=32),uP(t,e),dn(t,e,o,n),e.child;case 6:return t===null&&Xy(e),null;case 13:return dP(t,e,n);case 4:return A0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Za(e,null,r,n):dn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),CS(t,e,r,i,n);case 7:return dn(t,e,e.pendingProps,n),e.child;case 8:return dn(t,e,e.pendingProps.children,n),e.child;case 12:return dn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ge(yh,r._currentValue),r._currentValue=o,s!==null)if(Ar(s.value,o)){if(s.children===i.children&&!_n.current){e=Oi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=xi(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Zy(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(X(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Zy(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}dn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Oa(e,n),i=lr(i),r=r(i),e.flags|=1,dn(t,e,r,n),e.child;case 14:return r=e.type,i=br(r,e.pendingProps),i=br(r.type,i),xS(t,e,r,i,n);case 15:return aP(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:br(r,i),Tf(t,e),e.tag=1,En(r)?(t=!0,ph(e)):t=!1,Oa(e,n),iP(e,r,i),tv(e,r,i,n),iv(null,e,r,!0,t,n);case 19:return fP(t,e,n);case 22:return lP(t,e,n)}throw Error(X(156,e.tag))};function IP(t,e){return tI(t,e)}function V4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sr(t,e,n,r){return new V4(t,e,n,r)}function W0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function B4(t){if(typeof t=="function")return W0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===d0)return 11;if(t===f0)return 14}return 2}function Cs(t,e){var n=t.alternate;return n===null?(n=sr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ef(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")W0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ga:return mo(n.children,i,s,e);case c0:o=8,i|=8;break;case Ey:return t=sr(12,n,e,i|2),t.elementType=Ey,t.lanes=s,t;case Cy:return t=sr(13,n,e,i),t.elementType=Cy,t.lanes=s,t;case xy:return t=sr(19,n,e,i),t.elementType=xy,t.lanes=s,t;case Fx:return Pp(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Mx:o=10;break e;case Ux:o=9;break e;case d0:o=11;break e;case f0:o=14;break e;case os:o=16,r=null;break e}throw Error(X(130,t==null?t:typeof t,""))}return e=sr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function mo(t,e,n,r){return t=sr(7,t,r,e),t.lanes=n,t}function Pp(t,e,n,r){return t=sr(22,t,r,e),t.elementType=Fx,t.lanes=n,t.stateNode={isHidden:!1},t}function wg(t,e,n){return t=sr(6,t,null,e),t.lanes=n,t}function Tg(t,e,n){return e=sr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function $4(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ng(0),this.expirationTimes=ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ng(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function K0(t,e,n,r,i,s,o,a,l){return t=new $4(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=sr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},R0(s),t}function z4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ma,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function PP(t){if(!t)return Ds;t=t._reactInternals;e:{if(Bo(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(En(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var n=t.type;if(En(n))return PI(t,n,e)}return e}function RP(t,e,n,r,i,s,o,a,l){return t=K0(n,r,!0,t,i,s,o,a,l),t.context=PP(null),n=t.current,r=hn(),i=Es(n),s=xi(r,i),s.callback=e??null,Ss(n,s,i),t.current.lanes=i,Bc(t,i,r),Cn(t,r),t}function Rp(t,e,n,r){var i=e.current,s=hn(),o=Es(i);return n=PP(n),e.context===null?e.context=n:e.pendingContext=n,e=xi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ss(i,e,o),t!==null&&(Ir(t,i,o,s),bf(t,i,o)),o}function xh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function jS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function G0(t,e){jS(t,e),(t=t.alternate)&&jS(t,e)}var AP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Q0(t){this._internalRoot=t}Ap.prototype.render=Q0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));Rp(t,e,null,null)};Ap.prototype.unmount=Q0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Po(function(){Rp(null,t,null,null)}),e[Ai]=null}};function Ap(t){this._internalRoot=t}Ap.prototype.unstable_scheduleHydration=function(t){if(t){var e=lI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<us.length&&e!==0&&e<us[n].priority;n++);us.splice(n,0,t),n===0&&cI(t)}};function J0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Np(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function VS(){}function q4(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=xh(o);s.call(u)}}var o=RP(e,r,t,0,null,!1,!1,"",VS);return t._reactRootContainer=o,t[Ai]=o.current,ac(t.nodeType===8?t.parentNode:t),Po(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=xh(l);a.call(u)}}var l=K0(t,0,!1,null,null,!1,!1,"",VS);return t._reactRootContainer=l,t[Ai]=l.current,ac(t.nodeType===8?t.parentNode:t),Po(function(){Rp(e,l,n,r)}),l}function Op(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=xh(o);a.call(l)}}Rp(e,o,t,i)}else o=q4(n,e,t,i,r);return xh(o)}oI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=vu(e.pendingLanes);n!==0&&(m0(e,n|1),Cn(e,yt()),!(De&6)&&(nl=yt()+500,Ks()))}break;case 13:Po(function(){var r=Ni(t,1);if(r!==null){var i=hn();Ir(r,t,1,i)}}),G0(t,1)}};g0=function(t){if(t.tag===13){var e=Ni(t,134217728);if(e!==null){var n=hn();Ir(e,t,134217728,n)}G0(t,134217728)}};aI=function(t){if(t.tag===13){var e=Es(t),n=Ni(t,e);if(n!==null){var r=hn();Ir(n,t,e,r)}G0(t,e)}};lI=function(){return Ve};uI=function(t,e){var n=Ve;try{return Ve=t,e()}finally{Ve=n}};Uy=function(t,e,n){switch(e){case"input":if(Ry(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Sp(r);if(!i)throw Error(X(90));Vx(r),Ry(r,i)}}}break;case"textarea":$x(t,n);break;case"select":e=n.value,e!=null&&Pa(t,!!n.multiple,e,!1)}};Qx=z0;Jx=Po;var H4={usingClientEntryPoint:!1,Events:[zc,ka,Sp,Kx,Gx,z0]},ou={findFiberByHostInstance:so,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},W4={bundleType:ou.bundleType,version:ou.version,rendererPackageName:ou.rendererPackageName,rendererConfig:ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$i.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Zx(t),t===null?null:t.stateNode},findFiberByHostInstance:ou.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{bp=Kd.inject(W4),Zr=Kd}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H4;Jn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!J0(e))throw Error(X(200));return z4(t,e,null,n)};Jn.createRoot=function(t,e){if(!J0(t))throw Error(X(299));var n=!1,r="",i=AP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=K0(t,1,!1,null,null,n,!1,r,i),t[Ai]=e.current,ac(t.nodeType===8?t.parentNode:t),new Q0(e)};Jn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=Zx(e),t=t===null?null:t.stateNode,t};Jn.flushSync=function(t){return Po(t)};Jn.hydrate=function(t,e,n){if(!Np(e))throw Error(X(200));return Op(null,t,e,!0,n)};Jn.hydrateRoot=function(t,e,n){if(!J0(t))throw Error(X(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=AP;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=RP(e,null,t,1,n??null,i,!1,s,o),t[Ai]=e.current,ac(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Ap(e)};Jn.render=function(t,e,n){if(!Np(e))throw Error(X(200));return Op(null,t,e,!1,n)};Jn.unmountComponentAtNode=function(t){if(!Np(t))throw Error(X(40));return t._reactRootContainer?(Po(function(){Op(null,null,t,!1,function(){t._reactRootContainer=null,t[Ai]=null})}),!0):!1};Jn.unstable_batchedUpdates=z0;Jn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Np(n))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return Op(t,e,n,!1,r)};Jn.version="18.3.1-next-f1338f8080-20240426";function NP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(NP)}catch(t){console.error(t)}}NP(),Nx.exports=Jn;var OP=Nx.exports;const DP=yp(OP);var LP,BS=OP;LP=BS.createRoot,BS.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gc(){return gc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gc.apply(this,arguments)}var gs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gs||(gs={}));const $S="popstate";function K4(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return gv("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:UP(i)}return Q4(e,n,null,t)}function Tt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function MP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function G4(){return Math.random().toString(36).substr(2,8)}function zS(t,e){return{usr:t.state,key:t.key,idx:e}}function gv(t,e,n,r){return n===void 0&&(n=null),gc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?bl(e):e,{state:n,key:e&&e.key||r||G4()})}function UP(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function bl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function Q4(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=gs.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(gc({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function d(){a=gs.Pop;let k=c(),y=k==null?null:k-u;u=k,l&&l({action:a,location:m.location,delta:y})}function h(k,y){a=gs.Push;let w=gv(m.location,k,y);u=c()+1;let T=zS(w,u),x=m.createHref(w);try{o.pushState(T,"",x)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;i.location.assign(x)}s&&l&&l({action:a,location:m.location,delta:1})}function p(k,y){a=gs.Replace;let w=gv(m.location,k,y);u=c();let T=zS(w,u),x=m.createHref(w);o.replaceState(T,"",x),s&&l&&l({action:a,location:m.location,delta:0})}function g(k){let y=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof k=="string"?k:UP(k);return w=w.replace(/ $/,"%20"),Tt(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let m={get action(){return a},get location(){return t(i,o)},listen(k){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener($S,d),l=k,()=>{i.removeEventListener($S,d),l=null}},createHref(k){return e(i,k)},createURL:g,encodeLocation(k){let y=g(k);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:p,go(k){return o.go(k)}};return m}var qS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(qS||(qS={}));function J4(t,e,n){return n===void 0&&(n="/"),Y4(t,e,n)}function Y4(t,e,n,r){let i=typeof e=="string"?bl(e):e,s=VP(i.pathname||"/",n);if(s==null)return null;let o=FP(t);X4(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=cU(s);a=aU(o[l],u)}return a}function FP(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Tt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=go([r,l.relativePath]),c=n.concat(l);s.children&&s.children.length>0&&(Tt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),FP(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:sU(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of jP(s.path))i(s,o,l)}),e}function jP(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=jP(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function X4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:oU(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Z4=/^:[\w-]+$/,eU=3,tU=2,nU=1,rU=10,iU=-2,HS=t=>t==="*";function sU(t,e){let n=t.split("/"),r=n.length;return n.some(HS)&&(r+=iU),e&&(r+=tU),n.filter(i=>!HS(i)).reduce((i,s)=>i+(Z4.test(s)?eU:s===""?nU:rU),r)}function oU(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function aU(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",d=lU({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),h=l.route;if(!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:go([s,d.pathname]),pathnameBase:pU(go([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=go([s,d.pathnameBase]))}return o}function lU(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=uU(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,c,d)=>{let{paramName:h,isOptional:p}=c;if(h==="*"){let m=a[d]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=a[d];return p&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function uU(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),MP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function cU(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return MP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function VP(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function dU(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?bl(t):t;return{pathname:n?n.startsWith("/")?n:fU(n,e):e,search:mU(r),hash:gU(i)}}function fU(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Sg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hU(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function BP(t,e){let n=hU(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function $P(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=bl(t):(i=gc({},t),Tt(!i.pathname||!i.pathname.includes("?"),Sg("?","pathname","search",i)),Tt(!i.pathname||!i.pathname.includes("#"),Sg("#","pathname","hash",i)),Tt(!i.search||!i.search.includes("#"),Sg("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=dU(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const go=t=>t.join("/").replace(/\/\/+/g,"/"),pU=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),mU=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,gU=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function yU(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const zP=["post","put","patch","delete"];new Set(zP);const vU=["get",...zP];new Set(vU);/**
 * React Router v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yc(){return yc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yc.apply(this,arguments)}const Y0=v.createContext(null),bU=v.createContext(null),Hc=v.createContext(null),Dp=v.createContext(null),zi=v.createContext({outlet:null,matches:[],isDataRoute:!1}),qP=v.createContext(null);function Wc(){return v.useContext(Dp)!=null}function X0(){return Wc()||Tt(!1),v.useContext(Dp).location}function HP(t){v.useContext(Hc).static||v.useLayoutEffect(t)}function qi(){let{isDataRoute:t}=v.useContext(zi);return t?LU():kU()}function kU(){Wc()||Tt(!1);let t=v.useContext(Y0),{basename:e,future:n,navigator:r}=v.useContext(Hc),{matches:i}=v.useContext(zi),{pathname:s}=X0(),o=JSON.stringify(BP(i,n.v7_relativeSplatPath)),a=v.useRef(!1);return HP(()=>{a.current=!0}),v.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let d=$P(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:go([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,o,s,t])}const wU=v.createContext(null);function TU(t){let e=v.useContext(zi).outlet;return e&&v.createElement(wU.Provider,{value:t},e)}function SU(){let{matches:t}=v.useContext(zi),e=t[t.length-1];return e?e.params:{}}function _U(t,e){return EU(t,e)}function EU(t,e,n,r){Wc()||Tt(!1);let{navigator:i}=v.useContext(Hc),{matches:s}=v.useContext(zi),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=X0(),c;if(e){var d;let k=typeof e=="string"?bl(e):e;l==="/"||(d=k.pathname)!=null&&d.startsWith(l)||Tt(!1),c=k}else c=u;let h=c.pathname||"/",p=h;if(l!=="/"){let k=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(k.length).join("/")}let g=J4(t,{pathname:p}),m=RU(g&&g.map(k=>Object.assign({},k,{params:Object.assign({},a,k.params),pathname:go([l,i.encodeLocation?i.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?l:go([l,i.encodeLocation?i.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),s,n,r);return e&&m?v.createElement(Dp.Provider,{value:{location:yc({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:gs.Pop}},m):m}function CU(){let t=DU(),e=yU(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),n?v.createElement("pre",{style:i},n):null,null)}const xU=v.createElement(CU,null);class IU extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?v.createElement(zi.Provider,{value:this.props.routeContext},v.createElement(qP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PU(t){let{routeContext:e,match:n,children:r}=t,i=v.useContext(Y0);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),v.createElement(zi.Provider,{value:e},r)}function RU(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let c=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);c>=0||Tt(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let d=o[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:h,errors:p}=n,g=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,d,h)=>{let p,g=!1,m=null,k=null;n&&(p=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||xU,l&&(u<0&&h===0?(g=!0,k=null):u===h&&(g=!0,k=d.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,h+1)),w=()=>{let T;return p?T=m:g?T=k:d.route.Component?T=v.createElement(d.route.Component,null):d.route.element?T=d.route.element:T=c,v.createElement(PU,{match:d,routeContext:{outlet:c,matches:y,isDataRoute:n!=null},children:T})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?v.createElement(IU,{location:n.location,revalidation:n.revalidation,component:m,error:p,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var WP=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(WP||{}),Ih=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Ih||{});function AU(t){let e=v.useContext(Y0);return e||Tt(!1),e}function NU(t){let e=v.useContext(bU);return e||Tt(!1),e}function OU(t){let e=v.useContext(zi);return e||Tt(!1),e}function KP(t){let e=OU(),n=e.matches[e.matches.length-1];return n.route.id||Tt(!1),n.route.id}function DU(){var t;let e=v.useContext(qP),n=NU(Ih.UseRouteError),r=KP(Ih.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function LU(){let{router:t}=AU(WP.UseNavigateStable),e=KP(Ih.UseNavigateStable),n=v.useRef(!1);return HP(()=>{n.current=!0}),v.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,yc({fromRouteId:e},s)))},[t,e])}const WS={};function MU(t,e){WS[e]||(WS[e]=!0,console.warn(e))}const KS=(t,e,n)=>MU(t,"⚠️ React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function UU(t,e){(t==null?void 0:t.v7_startTransition)===void 0&&KS("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(t==null?void 0:t.v7_relativeSplatPath)===void 0&&KS("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function GP(t){let{to:e,replace:n,state:r,relative:i}=t;Wc()||Tt(!1);let{future:s,static:o}=v.useContext(Hc),{matches:a}=v.useContext(zi),{pathname:l}=X0(),u=qi(),c=$P(e,BP(a,s.v7_relativeSplatPath),l,i==="path"),d=JSON.stringify(c);return v.useEffect(()=>u(JSON.parse(d),{replace:n,state:r,relative:i}),[u,d,i,n,r]),null}function FU(t){return TU(t.context)}function qr(t){Tt(!1)}function jU(t){let{basename:e="/",children:n=null,location:r,navigationType:i=gs.Pop,navigator:s,static:o=!1,future:a}=t;Wc()&&Tt(!1);let l=e.replace(/^\/*/,"/"),u=v.useMemo(()=>({basename:l,navigator:s,static:o,future:yc({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=bl(r));let{pathname:c="/",search:d="",hash:h="",state:p=null,key:g="default"}=r,m=v.useMemo(()=>{let k=VP(c,l);return k==null?null:{location:{pathname:k,search:d,hash:h,state:p,key:g},navigationType:i}},[l,c,d,h,p,g,i]);return m==null?null:v.createElement(Hc.Provider,{value:u},v.createElement(Dp.Provider,{children:n,value:m}))}function VU(t){let{children:e,location:n}=t;return _U(yv(e),n)}new Promise(()=>{});function yv(t,e){e===void 0&&(e=[]);let n=[];return v.Children.forEach(t,(r,i)=>{if(!v.isValidElement(r))return;let s=[...e,i];if(r.type===v.Fragment){n.push.apply(n,yv(r.props.children,s));return}r.type!==qr&&Tt(!1),!r.props.index||!r.props.children||Tt(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=yv(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const BU="6";try{window.__reactRouterVersion=BU}catch{}const $U="startTransition",GS=UM[$U];function zU(t){let{basename:e,children:n,future:r,window:i}=t,s=v.useRef();s.current==null&&(s.current=K4({window:i,v5Compat:!0}));let o=s.current,[a,l]=v.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},c=v.useCallback(d=>{u&&GS?GS(()=>l(d)):l(d)},[l,u]);return v.useLayoutEffect(()=>o.listen(c),[o,c]),v.useEffect(()=>UU(r),[r]),v.createElement(jU,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}var QS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(QS||(QS={}));var JS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(JS||(JS={}));var YS={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},qU=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},JP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,c=s>>2,d=(s&3)<<4|a>>4;let h=(a&15)<<2|u>>6,p=u&63;l||(p=64,o||(h=64)),r.push(n[c],n[d],n[h],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(QP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):qU(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const d=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||d==null)throw new HU;const h=s<<2|a>>4;if(r.push(h),u!==64){const p=a<<4&240|u>>2;if(r.push(p),d!==64){const g=u<<6&192|d;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class HU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const WU=function(t){const e=QP(t);return JP.encodeByteArray(e,!0)},Ph=function(t){return WU(t).replace(/\./g,"")},YP=function(t){try{return JP.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GU=()=>KU().__FIREBASE_DEFAULTS__,QU=()=>{if(typeof process>"u"||typeof YS>"u")return;const t=YS.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},JU=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&YP(t[1]);return e&&JSON.parse(e)},Lp=()=>{try{return GU()||QU()||JU()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},XP=t=>{var e,n;return(n=(e=Lp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},ZP=t=>{const e=XP(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},eR=()=>{var t;return(t=Lp())===null||t===void 0?void 0:t.config},tR=t=>{var e;return(e=Lp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XU(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ph(JSON.stringify(n)),Ph(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sn())}function e3(){var t;const e=(t=Lp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function t3(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function r3(){const t=sn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function i3(){return!e3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rR(){try{return typeof indexedDB=="object"}catch{return!1}}function iR(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function s3(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3="FirebaseError";class Ur extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=o3,Object.setPrototypeOf(this,Ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$o.prototype.create)}}class $o{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?a3(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ur(i,a,r)}}function a3(t,e){return t.replace(l3,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const l3=/\{\$([^}]+)}/g;function u3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(XS(s)&&XS(o)){if(!vc(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function XS(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function c3(t,e){const n=new d3(t,e);return n.subscribe.bind(n)}class d3{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");f3(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=_g),i.error===void 0&&(i.error=_g),i.complete===void 0&&(i.complete=_g);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function f3(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function _g(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=1e3,p3=2,m3=4*60*60*1e3,g3=.5;function ZS(t,e=h3,n=p3){const r=e*Math.pow(n,t),i=Math.round(g3*r*(Math.random()-.5)*2);return Math.min(m3,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(t){return t&&t._delegate?t._delegate:t}class cr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new YU;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(b3(e))try{this.getOrInitializeService({instanceIdentifier:ro})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ro){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ro){return this.instances.has(e)}getOptions(e=ro){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:v3(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ro){return this.component?this.component.multipleInstances?e:ro:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v3(t){return t===ro?void 0:t}function b3(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new y3(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pe||(Pe={}));const w3={debug:Pe.DEBUG,verbose:Pe.VERBOSE,info:Pe.INFO,warn:Pe.WARN,error:Pe.ERROR,silent:Pe.SILENT},T3=Pe.INFO,S3={[Pe.DEBUG]:"log",[Pe.VERBOSE]:"log",[Pe.INFO]:"info",[Pe.WARN]:"warn",[Pe.ERROR]:"error"},_3=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=S3[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let Mp=class{constructor(e){this.name=e,this._logLevel=T3,this._logHandler=_3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?w3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pe.DEBUG,...e),this._logHandler(this,Pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pe.VERBOSE,...e),this._logHandler(this,Pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pe.INFO,...e),this._logHandler(this,Pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pe.WARN,...e),this._logHandler(this,Pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pe.ERROR,...e),this._logHandler(this,Pe.ERROR,...e)}};const E3=(t,e)=>e.some(n=>t instanceof n);let e_,t_;function C3(){return e_||(e_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function x3(){return t_||(t_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sR=new WeakMap,vv=new WeakMap,oR=new WeakMap,Eg=new WeakMap,Z0=new WeakMap;function I3(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(xs(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&sR.set(n,t)}).catch(()=>{}),Z0.set(e,t),e}function P3(t){if(vv.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});vv.set(t,e)}let bv={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return vv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oR.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function R3(t){bv=t(bv)}function A3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Cg(this),e,...n);return oR.set(r,e.sort?e.sort():[e]),xs(r)}:x3().includes(t)?function(...e){return t.apply(Cg(this),e),xs(sR.get(this))}:function(...e){return xs(t.apply(Cg(this),e))}}function N3(t){return typeof t=="function"?A3(t):(t instanceof IDBTransaction&&P3(t),E3(t,C3())?new Proxy(t,bv):t)}function xs(t){if(t instanceof IDBRequest)return I3(t);if(Eg.has(t))return Eg.get(t);const e=N3(t);return e!==t&&(Eg.set(t,e),Z0.set(e,t)),e}const Cg=t=>Z0.get(t);function aR(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=xs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(xs(o.result),l.oldVersion,l.newVersion,xs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const O3=["get","getKey","getAll","getAllKeys","count"],D3=["put","add","delete","clear"],xg=new Map;function n_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xg.get(e))return xg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=D3.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||O3.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return xg.set(e,s),s}R3(t=>({...t,get:(e,n,r)=>n_(e,n)||t.get(e,n,r),has:(e,n)=>!!n_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(M3(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function M3(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const kv="@firebase/app",r_="0.10.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=new Mp("@firebase/app"),U3="@firebase/app-compat",F3="@firebase/analytics-compat",j3="@firebase/analytics",V3="@firebase/app-check-compat",B3="@firebase/app-check",$3="@firebase/auth",z3="@firebase/auth-compat",q3="@firebase/database",H3="@firebase/data-connect",W3="@firebase/database-compat",K3="@firebase/functions",G3="@firebase/functions-compat",Q3="@firebase/installations",J3="@firebase/installations-compat",Y3="@firebase/messaging",X3="@firebase/messaging-compat",Z3="@firebase/performance",eF="@firebase/performance-compat",tF="@firebase/remote-config",nF="@firebase/remote-config-compat",rF="@firebase/storage",iF="@firebase/storage-compat",sF="@firebase/firestore",oF="@firebase/vertexai",aF="@firebase/firestore-compat",lF="firebase",uF="11.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="[DEFAULT]",cF={[kv]:"fire-core",[U3]:"fire-core-compat",[j3]:"fire-analytics",[F3]:"fire-analytics-compat",[B3]:"fire-app-check",[V3]:"fire-app-check-compat",[$3]:"fire-auth",[z3]:"fire-auth-compat",[q3]:"fire-rtdb",[H3]:"fire-data-connect",[W3]:"fire-rtdb-compat",[K3]:"fire-fn",[G3]:"fire-fn-compat",[Q3]:"fire-iid",[J3]:"fire-iid-compat",[Y3]:"fire-fcm",[X3]:"fire-fcm-compat",[Z3]:"fire-perf",[eF]:"fire-perf-compat",[tF]:"fire-rc",[nF]:"fire-rc-compat",[rF]:"fire-gcs",[iF]:"fire-gcs-compat",[sF]:"fire-fst",[aF]:"fire-fst-compat",[oF]:"fire-vertex","fire-js":"fire-js",[lF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh=new Map,dF=new Map,Tv=new Map;function i_(t,e){try{t.container.addComponent(e)}catch(n){Di.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Nr(t){const e=t.name;if(Tv.has(e))return Di.debug(`There were multiple attempts to register component ${e}.`),!1;Tv.set(e,t);for(const n of Rh.values())i_(n,t);for(const n of dF.values())i_(n,t);return!0}function Gs(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Si(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Is=new $o("app","Firebase",fF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new cr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Is.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=uF;function lR(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:wv,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Is.create("bad-app-name",{appName:String(i)});if(n||(n=eR()),!n)throw Is.create("no-options");const s=Rh.get(i);if(s){if(vc(n,s.options)&&vc(r,s.config))return s;throw Is.create("duplicate-app",{appName:i})}const o=new k3(i);for(const l of Tv.values())o.addComponent(l);const a=new hF(n,r,o);return Rh.set(i,a),a}function Up(t=wv){const e=Rh.get(t);if(!e&&t===wv&&eR())return lR();if(!e)throw Is.create("no-app",{appName:t});return e}function xn(t,e,n){var r;let i=(r=cF[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Di.warn(a.join(" "));return}Nr(new cr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF="firebase-heartbeat-database",mF=1,bc="firebase-heartbeat-store";let Ig=null;function uR(){return Ig||(Ig=aR(pF,mF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Is.create("idb-open",{originalErrorMessage:t.message})})),Ig}async function gF(t){try{const n=(await uR()).transaction(bc),r=await n.objectStore(bc).get(cR(t));return await n.done,r}catch(e){if(e instanceof Ur)Di.warn(e.message);else{const n=Is.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Di.warn(n.message)}}}async function s_(t,e){try{const r=(await uR()).transaction(bc,"readwrite");await r.objectStore(bc).put(e,cR(t)),await r.done}catch(n){if(n instanceof Ur)Di.warn(n.message);else{const r=Is.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Di.warn(r.message)}}}function cR(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=1024,vF=30*24*60*60*1e3;class bF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new wF(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=o_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=vF}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Di.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=o_(),{heartbeatsToSend:r,unsentEntries:i}=kF(this._heartbeatsCache.heartbeats),s=Ph(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Di.warn(n),""}}}function o_(){return new Date().toISOString().substring(0,10)}function kF(t,e=yF){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),a_(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),a_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class wF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rR()?iR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await gF(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return s_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return s_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function a_(t){return Ph(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(t){Nr(new cr("platform-logger",e=>new L3(e),"PRIVATE")),Nr(new cr("heartbeat",e=>new bF(e),"PRIVATE")),xn(kv,r_,t),xn(kv,r_,"esm2017"),xn("fire-js","")}TF("");function ek(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function dR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const SF=dR,fR=new $o("auth","Firebase",dR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Mp("@firebase/auth");function _F(t,...e){Ah.logLevel<=Pe.WARN&&Ah.warn(`Auth (${kl}): ${t}`,...e)}function Cf(t,...e){Ah.logLevel<=Pe.ERROR&&Ah.error(`Auth (${kl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(t,...e){throw nk(t,...e)}function Pr(t,...e){return nk(t,...e)}function tk(t,e,n){const r=Object.assign(Object.assign({},SF()),{[e]:n});return new $o("auth","Firebase",r).create(e,{appName:t.name})}function yo(t){return tk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function EF(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&ii(t,"argument-error"),tk(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function nk(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return fR.create(t,...e)}function pe(t,e,...n){if(!t)throw nk(e,...n)}function _i(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Cf(e),new Error(e)}function Li(t,e){t||_i(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function CF(){return l_()==="http:"||l_()==="https:"}function l_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CF()||nR()||"connection"in navigator)?navigator.onLine:!0}function IF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Li(n>e,"Short delay should be less than long delay!"),this.isMobile=ZU()||n3()}get(){return xF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(t,e){Li(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_i("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_i("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_i("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RF=new Gc(3e4,6e4);function ik(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function wl(t,e,n,r,i={}){return pR(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Kc(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return t3()||(u.referrerPolicy="no-referrer"),hR.fetch()(mR(t,t.config.apiHost,n,a),u)})}async function pR(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},PF),e);try{const i=new NF(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Gd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gd(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Gd(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Gd(t,"user-disabled",o);const c=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw tk(t,c,u);ii(t,c)}}catch(i){if(i instanceof Ur)throw i;ii(t,"network-request-failed",{message:String(i)})}}async function AF(t,e,n,r,i={}){const s=await wl(t,e,n,r,i);return"mfaPendingCredential"in s&&ii(t,"multi-factor-auth-required",{_serverResponse:s}),s}function mR(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?rk(t.config,i):`${t.config.apiScheme}://${i}`}class NF{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Pr(this.auth,"network-request-failed")),RF.get())})}}function Gd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Pr(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OF(t,e){return wl(t,"POST","/v1/accounts:delete",e)}async function gR(t,e){return wl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function DF(t,e=!1){const n=zt(t),r=await n.getIdToken(e),i=sk(r);pe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Lu(Pg(i.auth_time)),issuedAtTime:Lu(Pg(i.iat)),expirationTime:Lu(Pg(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Pg(t){return Number(t)*1e3}function sk(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Cf("JWT malformed, contained fewer than 3 sections"),null;try{const i=YP(n);return i?JSON.parse(i):(Cf("Failed to decode base64 JWT payload"),null)}catch(i){return Cf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function u_(t){const e=sk(t);return pe(e,"internal-error"),pe(typeof e.exp<"u","internal-error"),pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ur&&LF(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function LF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lu(this.lastLoginAt),this.creationTime=Lu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await kc(t,gR(n,{idToken:r}));pe(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?yR(s.providerUserInfo):[],a=FF(t.providerData,o),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),c=l?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new _v(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(t,d)}async function UF(t){const e=zt(t);await Nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function FF(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function yR(t){return t.map(e=>{var{providerId:n}=e,r=ek(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jF(t,e){const n=await pR(t,{},async()=>{const r=Kc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=mR(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",hR.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function VF(t,e){return wl(t,"POST","/v2/accounts:revokeToken",ik(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pe(e.idToken,"internal-error"),pe(typeof e.idToken<"u","internal-error"),pe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):u_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){pe(e.length!==0,"internal-error");const n=u_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await jF(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new La;return r&&(pe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(pe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(pe(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new La,this.toJSON())}_performRefresh(){return _i("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(t,e){pe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ei{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=ek(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new MF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new _v(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await kc(this,this.stsTokenManager.getToken(this.auth,e));return pe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return DF(this,e)}reload(){return UF(this)}_assign(e){this!==e&&(pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ei(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Nh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Si(this.auth.app))return Promise.reject(yo(this.auth));const e=await this.getIdToken();return await kc(this,OF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,u,c;const d=(r=n.displayName)!==null&&r!==void 0?r:void 0,h=(i=n.email)!==null&&i!==void 0?i:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,m=(a=n.tenantId)!==null&&a!==void 0?a:void 0,k=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,y=(u=n.createdAt)!==null&&u!==void 0?u:void 0,w=(c=n.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:T,emailVerified:x,isAnonymous:I,providerData:R,stsTokenManager:C}=n;pe(T&&C,e,"internal-error");const _=La.fromJSON(this.name,C);pe(typeof T=="string",e,"internal-error"),ts(d,e.name),ts(h,e.name),pe(typeof x=="boolean",e,"internal-error"),pe(typeof I=="boolean",e,"internal-error"),ts(p,e.name),ts(g,e.name),ts(m,e.name),ts(k,e.name),ts(y,e.name),ts(w,e.name);const P=new Ei({uid:T,auth:e,email:h,emailVerified:x,displayName:d,isAnonymous:I,photoURL:g,phoneNumber:p,tenantId:m,stsTokenManager:_,createdAt:y,lastLoginAt:w});return R&&Array.isArray(R)&&(P.providerData=R.map(N=>Object.assign({},N))),k&&(P._redirectEventId=k),P}static async _fromIdTokenResponse(e,n,r=!1){const i=new La;i.updateFromServerResponse(n);const s=new Ei({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Nh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];pe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?yR(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new La;a.updateFromIdToken(r);const l=new Ei({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new _v(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_=new Map;function Ci(t){Li(t instanceof Function,"Expected a class definition");let e=c_.get(t);return e?(Li(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,c_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}vR.type="NONE";const d_=vR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xf(t,e,n){return`firebase:${t}:${e}:${n}`}class Ma{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=xf(this.userKey,i.apiKey,s),this.fullPersistenceKey=xf("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ei._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ma(Ci(d_),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Ci(d_);const o=xf(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const c=await u._get(o);if(c){const d=Ei._fromJSON(e,c);u!==s&&(a=d),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ma(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new Ma(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(TR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_R(e))return"Blackberry";if(ER(e))return"Webos";if(kR(e))return"Safari";if((e.includes("chrome/")||wR(e))&&!e.includes("edge/"))return"Chrome";if(SR(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function bR(t=sn()){return/firefox\//i.test(t)}function kR(t=sn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wR(t=sn()){return/crios\//i.test(t)}function TR(t=sn()){return/iemobile/i.test(t)}function SR(t=sn()){return/android/i.test(t)}function _R(t=sn()){return/blackberry/i.test(t)}function ER(t=sn()){return/webos/i.test(t)}function ok(t=sn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function BF(t=sn()){var e;return ok(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function $F(){return r3()&&document.documentMode===10}function CR(t=sn()){return ok(t)||SR(t)||ER(t)||_R(t)||/windows phone/i.test(t)||TR(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR(t,e=[]){let n;switch(t){case"Browser":n=f_(sn());break;case"Worker":n=`${f_(sn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${kl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(t,e={}){return wl(t,"GET","/v2/passwordPolicy",ik(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=6;class WF{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:HF,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new h_(this),this.idTokenSubscription=new h_(this),this.beforeStateQueue=new zF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ci(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Ma.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await gR(this,{idToken:e}),r=await Ei._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Si(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Nh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Si(this.app))return Promise.reject(yo(this));const n=e?zt(e):null;return n&&pe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Si(this.app)?Promise.reject(yo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Si(this.app)?Promise.reject(yo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ci(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await qF(this),n=new WF(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new $o("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await VF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ci(e)||this._popupRedirectResolver;pe(n,this,"argument-error"),this.redirectPersistenceManager=await Ma.create(this,[Ci(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(pe(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&_F(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Fp(t){return zt(t)}class h_{constructor(e){this.auth=e,this.observer=null,this.addObserver=c3(n=>this.observer=n)}get next(){return pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ak={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function GF(t){ak=t}function QF(t){return ak.loadJS(t)}function JF(){return ak.gapiScript}function YF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XF(t,e){const n=Gs(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(vc(s,e??{}))return i;ii(i,"already-initialized")}return n.initialize({options:e})}function ZF(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ci);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function ej(t,e,n){const r=Fp(t);pe(r._canInitEmulator,r,"emulator-config-failed"),pe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=IR(e),{host:o,port:a}=tj(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),nj()}function IR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function tj(t){const e=IR(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:p_(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:p_(o)}}}function p_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return _i("not implemented")}_getIdTokenResponse(e){return _i("not implemented")}_linkToIdToken(e,n){return _i("not implemented")}_getReauthenticationResolver(e){return _i("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ua(t,e){return AF(t,"POST","/v1/accounts:signInWithIdp",ik(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rj="http://localhost";class Ro extends PR{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ro(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ii("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=ek(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Ro(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ua(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ua(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ua(e,n)}buildRequest(){const e={requestUri:rj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Kc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc extends lk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends Qc{constructor(){super("facebook.com")}static credential(e){return Ro._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ds.credential(e.oauthAccessToken)}catch{return null}}}ds.FACEBOOK_SIGN_IN_METHOD="facebook.com";ds.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends Qc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ro._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return vi.credential(n,r)}catch{return null}}}vi.GOOGLE_SIGN_IN_METHOD="google.com";vi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs extends Qc{constructor(){super("github.com")}static credential(e){return Ro._fromParams({providerId:fs.PROVIDER_ID,signInMethod:fs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fs.credentialFromTaggedObject(e)}static credentialFromError(e){return fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fs.credential(e.oauthAccessToken)}catch{return null}}}fs.GITHUB_SIGN_IN_METHOD="github.com";fs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends Qc{constructor(){super("twitter.com")}static credential(e,n){return Ro._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return hs.credential(n,r)}catch{return null}}}hs.TWITTER_SIGN_IN_METHOD="twitter.com";hs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ei._fromIdTokenResponse(e,r,i),o=m_(r);return new rl({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=m_(r);return new rl({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function m_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh extends Ur{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Oh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Oh(e,n,r,i)}}function RR(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Oh._fromErrorAndOperation(t,s,e,r):s})}async function ij(t,e,n=!1){const r=await kc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return rl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sj(t,e,n=!1){const{auth:r}=t;if(Si(r.app))return Promise.reject(yo(r));const i="reauthenticate";try{const s=await kc(t,RR(r,i,e,t),n);pe(s.idToken,r,"internal-error");const o=sk(s.idToken);pe(o,r,"internal-error");const{sub:a}=o;return pe(t.uid===a,r,"user-mismatch"),rl._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ii(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oj(t,e,n=!1){if(Si(t.app))return Promise.reject(yo(t));const r="signIn",i=await RR(t,r,e),s=await rl._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function aj(t,e,n,r){return zt(t).onIdTokenChanged(e,n,r)}function lj(t,e,n){return zt(t).beforeAuthStateChanged(e,n)}function uj(t,e,n,r){return zt(t).onAuthStateChanged(e,n,r)}function cj(t){return zt(t).signOut()}const Dh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj=1e3,fj=10;class NR extends AR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=CR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);$F()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,fj):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},dj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}NR.type="LOCAL";const hj=NR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR extends AR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}OR.type="SESSION";const DR=OR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new jp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await pj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uk(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=uk("",20);i.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(d){const h=d;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(h.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(){return window}function gj(t){ti().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(){return typeof ti().WorkerGlobalScope<"u"&&typeof ti().importScripts=="function"}async function yj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function bj(){return LR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR="firebaseLocalStorageDb",kj=1,Lh="firebaseLocalStorage",UR="fbase_key";class Jc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Vp(t,e){return t.transaction([Lh],e?"readwrite":"readonly").objectStore(Lh)}function wj(){const t=indexedDB.deleteDatabase(MR);return new Jc(t).toPromise()}function Ev(){const t=indexedDB.open(MR,kj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Lh,{keyPath:UR})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Lh)?e(r):(r.close(),await wj(),e(await Ev()))})})}async function g_(t,e,n){const r=Vp(t,!0).put({[UR]:e,value:n});return new Jc(r).toPromise()}async function Tj(t,e){const n=Vp(t,!1).get(e),r=await new Jc(n).toPromise();return r===void 0?null:r.value}function y_(t,e){const n=Vp(t,!0).delete(e);return new Jc(n).toPromise()}const Sj=800,_j=3;class FR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ev(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>_j)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return LR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jp._getInstance(bj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await yj(),!this.activeServiceWorker)return;this.sender=new mj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ev();return await g_(e,Dh,"1"),await y_(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>g_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Tj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>y_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Vp(i,!1).getAll();return new Jc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Sj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FR.type="LOCAL";const Ej=FR;new Gc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(t,e){return e?Ci(e):(pe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck extends PR{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ua(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ua(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ua(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Cj(t){return oj(t.auth,new ck(t),t.bypassAuthState)}function xj(t){const{auth:e,user:n}=t;return pe(n,e,"internal-error"),sj(n,new ck(t),t.bypassAuthState)}async function Ij(t){const{auth:e,user:n}=t;return pe(n,e,"internal-error"),ij(n,new ck(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Cj;case"linkViaPopup":case"linkViaRedirect":return Ij;case"reauthViaPopup":case"reauthViaRedirect":return xj;default:ii(this.auth,"internal-error")}}resolve(e){Li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pj=new Gc(2e3,1e4);async function Rj(t,e,n){if(Si(t.app))return Promise.reject(Pr(t,"operation-not-supported-in-this-environment"));const r=Fp(t);EF(t,e,lk);const i=jR(r,n);return new lo(r,"signInViaPopup",e,i).executeNotNull()}class lo extends VR{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,lo.currentPopupAction&&lo.currentPopupAction.cancel(),lo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pe(e,this.auth,"internal-error"),e}async onExecution(){Li(this.filter.length===1,"Popup operations only handle one event");const e=uk();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Pr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Pr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,lo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Pr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Pj.get())};e()}}lo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj="pendingRedirect",If=new Map;class Nj extends VR{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=If.get(this.auth._key());if(!e){try{const r=await Oj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}If.set(this.auth._key(),e)}return this.bypassAuthState||If.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Oj(t,e){const n=Mj(e),r=Lj(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function Dj(t,e){If.set(t._key(),e)}function Lj(t){return Ci(t._redirectPersistence)}function Mj(t){return xf(Aj,t.config.apiKey,t.name)}async function Uj(t,e,n=!1){if(Si(t.app))return Promise.reject(yo(t));const r=Fp(t),i=jR(r,e),o=await new Nj(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=10*60*1e3;class jj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Vj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!BR(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Pr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Fj&&this.cachedEventUids.clear(),this.cachedEventUids.has(v_(e))}saveEventToCache(e){this.cachedEventUids.add(v_(e)),this.lastProcessedEventTime=Date.now()}}function v_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function BR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Vj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return BR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bj(t,e={}){return wl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zj=/^https?/;async function qj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Bj(t);for(const n of e)try{if(Hj(n))return}catch{}ii(t,"unauthorized-domain")}function Hj(t){const e=Sv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!zj.test(n))return!1;if($j.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=new Gc(3e4,6e4);function b_(){const t=ti().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Kj(t){return new Promise((e,n)=>{var r,i,s;function o(){b_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{b_(),n(Pr(t,"network-request-failed"))},timeout:Wj.get()})}if(!((i=(r=ti().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ti().gapi)===null||s===void 0)&&s.load)o();else{const a=YF("iframefcb");return ti()[a]=()=>{gapi.load?o():n(Pr(t,"network-request-failed"))},QF(`${JF()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Pf=null,e})}let Pf=null;function Gj(t){return Pf=Pf||Kj(t),Pf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qj=new Gc(5e3,15e3),Jj="__/auth/iframe",Yj="emulator/auth/iframe",Xj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Zj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eV(t){const e=t.config;pe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?rk(e,Yj):`https://${t.config.authDomain}/${Jj}`,r={apiKey:e.apiKey,appName:t.name,v:kl},i=Zj.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Kc(r).slice(1)}`}async function tV(t){const e=await Gj(t),n=ti().gapi;return pe(n,t,"internal-error"),e.open({where:document.body,url:eV(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Xj,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Pr(t,"network-request-failed"),a=ti().setTimeout(()=>{s(o)},Qj.get());function l(){ti().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rV=500,iV=600,sV="_blank",oV="http://localhost";class k_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aV(t,e,n,r=rV,i=iV){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},nV),{width:r.toString(),height:i.toString(),top:s,left:o}),u=sn().toLowerCase();n&&(a=wR(u)?sV:n),bR(u)&&(e=e||oV,l.scrollbars="yes");const c=Object.entries(l).reduce((h,[p,g])=>`${h}${p}=${g},`,"");if(BF(u)&&a!=="_self")return lV(e||"",a),new k_(null);const d=window.open(e||"",a,c);pe(d,t,"popup-blocked");try{d.focus()}catch{}return new k_(d)}function lV(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uV="__/auth/handler",cV="emulator/auth/handler",dV=encodeURIComponent("fac");async function w_(t,e,n,r,i,s){pe(t.config.authDomain,t,"auth-domain-config-required"),pe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:kl,eventId:i};if(e instanceof lk){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",u3(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,d]of Object.entries({}))o[c]=d}if(e instanceof Qc){const c=e.getScopes().filter(d=>d!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const l=await t._getAppCheckToken(),u=l?`#${dV}=${encodeURIComponent(l)}`:"";return`${fV(t)}?${Kc(a).slice(1)}${u}`}function fV({config:t}){return t.emulator?rk(t,cV):`https://${t.authDomain}/${uV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg="webStorageSupport";class hV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=DR,this._completeRedirectFn=Uj,this._overrideRedirectResult=Dj}async _openPopup(e,n,r,i){var s;Li((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await w_(e,n,r,Sv(),i);return aV(e,o,uk())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await w_(e,n,r,Sv(),i);return gj(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Li(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await tV(e),r=new jj(e);return n.register("authEvent",i=>(pe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Rg,{type:Rg},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Rg];o!==void 0&&n(!!o),ii(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=qj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return CR()||kR()||ok()}}const pV=hV;var T_="@firebase/auth",S_="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yV(t){Nr(new cr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;pe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xR(t)},u=new KF(r,i,s,l);return ZF(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Nr(new cr("auth-internal",e=>{const n=Fp(e.getProvider("auth").getImmediate());return(r=>new mV(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),xn(T_,S_,gV(t)),xn(T_,S_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV=5*60,bV=tR("authIdTokenMaxAge")||vV;let __=null;const kV=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>bV)return;const i=n==null?void 0:n.token;__!==i&&(__=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Cv(t=Up()){const e=Gs(t,"auth");if(e.isInitialized())return e.getImmediate();const n=XF(t,{popupRedirectResolver:pV,persistence:[Ej,hj,DR]}),r=tR("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=kV(s.toString());lj(n,o,()=>o(n.currentUser)),aj(n,a=>o(a))}}const i=XP("auth");return i&&ej(n,`http://${i}`),n}function wV(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}GF({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Pr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",wV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yV("Browser");var E_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vo,$R;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,_){function P(){}P.prototype=_.prototype,C.D=_.prototype,C.prototype=new P,C.prototype.constructor=C,C.C=function(N,A,D){for(var L=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)L[ae-2]=arguments[ae];return _.prototype[A].apply(N,L)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,_,P){P||(P=0);var N=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)N[A]=_.charCodeAt(P++)|_.charCodeAt(P++)<<8|_.charCodeAt(P++)<<16|_.charCodeAt(P++)<<24;else for(A=0;16>A;++A)N[A]=_[P++]|_[P++]<<8|_[P++]<<16|_[P++]<<24;_=C.g[0],P=C.g[1],A=C.g[2];var D=C.g[3],L=_+(D^P&(A^D))+N[0]+3614090360&4294967295;_=P+(L<<7&4294967295|L>>>25),L=D+(A^_&(P^A))+N[1]+3905402710&4294967295,D=_+(L<<12&4294967295|L>>>20),L=A+(P^D&(_^P))+N[2]+606105819&4294967295,A=D+(L<<17&4294967295|L>>>15),L=P+(_^A&(D^_))+N[3]+3250441966&4294967295,P=A+(L<<22&4294967295|L>>>10),L=_+(D^P&(A^D))+N[4]+4118548399&4294967295,_=P+(L<<7&4294967295|L>>>25),L=D+(A^_&(P^A))+N[5]+1200080426&4294967295,D=_+(L<<12&4294967295|L>>>20),L=A+(P^D&(_^P))+N[6]+2821735955&4294967295,A=D+(L<<17&4294967295|L>>>15),L=P+(_^A&(D^_))+N[7]+4249261313&4294967295,P=A+(L<<22&4294967295|L>>>10),L=_+(D^P&(A^D))+N[8]+1770035416&4294967295,_=P+(L<<7&4294967295|L>>>25),L=D+(A^_&(P^A))+N[9]+2336552879&4294967295,D=_+(L<<12&4294967295|L>>>20),L=A+(P^D&(_^P))+N[10]+4294925233&4294967295,A=D+(L<<17&4294967295|L>>>15),L=P+(_^A&(D^_))+N[11]+2304563134&4294967295,P=A+(L<<22&4294967295|L>>>10),L=_+(D^P&(A^D))+N[12]+1804603682&4294967295,_=P+(L<<7&4294967295|L>>>25),L=D+(A^_&(P^A))+N[13]+4254626195&4294967295,D=_+(L<<12&4294967295|L>>>20),L=A+(P^D&(_^P))+N[14]+2792965006&4294967295,A=D+(L<<17&4294967295|L>>>15),L=P+(_^A&(D^_))+N[15]+1236535329&4294967295,P=A+(L<<22&4294967295|L>>>10),L=_+(A^D&(P^A))+N[1]+4129170786&4294967295,_=P+(L<<5&4294967295|L>>>27),L=D+(P^A&(_^P))+N[6]+3225465664&4294967295,D=_+(L<<9&4294967295|L>>>23),L=A+(_^P&(D^_))+N[11]+643717713&4294967295,A=D+(L<<14&4294967295|L>>>18),L=P+(D^_&(A^D))+N[0]+3921069994&4294967295,P=A+(L<<20&4294967295|L>>>12),L=_+(A^D&(P^A))+N[5]+3593408605&4294967295,_=P+(L<<5&4294967295|L>>>27),L=D+(P^A&(_^P))+N[10]+38016083&4294967295,D=_+(L<<9&4294967295|L>>>23),L=A+(_^P&(D^_))+N[15]+3634488961&4294967295,A=D+(L<<14&4294967295|L>>>18),L=P+(D^_&(A^D))+N[4]+3889429448&4294967295,P=A+(L<<20&4294967295|L>>>12),L=_+(A^D&(P^A))+N[9]+568446438&4294967295,_=P+(L<<5&4294967295|L>>>27),L=D+(P^A&(_^P))+N[14]+3275163606&4294967295,D=_+(L<<9&4294967295|L>>>23),L=A+(_^P&(D^_))+N[3]+4107603335&4294967295,A=D+(L<<14&4294967295|L>>>18),L=P+(D^_&(A^D))+N[8]+1163531501&4294967295,P=A+(L<<20&4294967295|L>>>12),L=_+(A^D&(P^A))+N[13]+2850285829&4294967295,_=P+(L<<5&4294967295|L>>>27),L=D+(P^A&(_^P))+N[2]+4243563512&4294967295,D=_+(L<<9&4294967295|L>>>23),L=A+(_^P&(D^_))+N[7]+1735328473&4294967295,A=D+(L<<14&4294967295|L>>>18),L=P+(D^_&(A^D))+N[12]+2368359562&4294967295,P=A+(L<<20&4294967295|L>>>12),L=_+(P^A^D)+N[5]+4294588738&4294967295,_=P+(L<<4&4294967295|L>>>28),L=D+(_^P^A)+N[8]+2272392833&4294967295,D=_+(L<<11&4294967295|L>>>21),L=A+(D^_^P)+N[11]+1839030562&4294967295,A=D+(L<<16&4294967295|L>>>16),L=P+(A^D^_)+N[14]+4259657740&4294967295,P=A+(L<<23&4294967295|L>>>9),L=_+(P^A^D)+N[1]+2763975236&4294967295,_=P+(L<<4&4294967295|L>>>28),L=D+(_^P^A)+N[4]+1272893353&4294967295,D=_+(L<<11&4294967295|L>>>21),L=A+(D^_^P)+N[7]+4139469664&4294967295,A=D+(L<<16&4294967295|L>>>16),L=P+(A^D^_)+N[10]+3200236656&4294967295,P=A+(L<<23&4294967295|L>>>9),L=_+(P^A^D)+N[13]+681279174&4294967295,_=P+(L<<4&4294967295|L>>>28),L=D+(_^P^A)+N[0]+3936430074&4294967295,D=_+(L<<11&4294967295|L>>>21),L=A+(D^_^P)+N[3]+3572445317&4294967295,A=D+(L<<16&4294967295|L>>>16),L=P+(A^D^_)+N[6]+76029189&4294967295,P=A+(L<<23&4294967295|L>>>9),L=_+(P^A^D)+N[9]+3654602809&4294967295,_=P+(L<<4&4294967295|L>>>28),L=D+(_^P^A)+N[12]+3873151461&4294967295,D=_+(L<<11&4294967295|L>>>21),L=A+(D^_^P)+N[15]+530742520&4294967295,A=D+(L<<16&4294967295|L>>>16),L=P+(A^D^_)+N[2]+3299628645&4294967295,P=A+(L<<23&4294967295|L>>>9),L=_+(A^(P|~D))+N[0]+4096336452&4294967295,_=P+(L<<6&4294967295|L>>>26),L=D+(P^(_|~A))+N[7]+1126891415&4294967295,D=_+(L<<10&4294967295|L>>>22),L=A+(_^(D|~P))+N[14]+2878612391&4294967295,A=D+(L<<15&4294967295|L>>>17),L=P+(D^(A|~_))+N[5]+4237533241&4294967295,P=A+(L<<21&4294967295|L>>>11),L=_+(A^(P|~D))+N[12]+1700485571&4294967295,_=P+(L<<6&4294967295|L>>>26),L=D+(P^(_|~A))+N[3]+2399980690&4294967295,D=_+(L<<10&4294967295|L>>>22),L=A+(_^(D|~P))+N[10]+4293915773&4294967295,A=D+(L<<15&4294967295|L>>>17),L=P+(D^(A|~_))+N[1]+2240044497&4294967295,P=A+(L<<21&4294967295|L>>>11),L=_+(A^(P|~D))+N[8]+1873313359&4294967295,_=P+(L<<6&4294967295|L>>>26),L=D+(P^(_|~A))+N[15]+4264355552&4294967295,D=_+(L<<10&4294967295|L>>>22),L=A+(_^(D|~P))+N[6]+2734768916&4294967295,A=D+(L<<15&4294967295|L>>>17),L=P+(D^(A|~_))+N[13]+1309151649&4294967295,P=A+(L<<21&4294967295|L>>>11),L=_+(A^(P|~D))+N[4]+4149444226&4294967295,_=P+(L<<6&4294967295|L>>>26),L=D+(P^(_|~A))+N[11]+3174756917&4294967295,D=_+(L<<10&4294967295|L>>>22),L=A+(_^(D|~P))+N[2]+718787259&4294967295,A=D+(L<<15&4294967295|L>>>17),L=P+(D^(A|~_))+N[9]+3951481745&4294967295,C.g[0]=C.g[0]+_&4294967295,C.g[1]=C.g[1]+(A+(L<<21&4294967295|L>>>11))&4294967295,C.g[2]=C.g[2]+A&4294967295,C.g[3]=C.g[3]+D&4294967295}r.prototype.u=function(C,_){_===void 0&&(_=C.length);for(var P=_-this.blockSize,N=this.B,A=this.h,D=0;D<_;){if(A==0)for(;D<=P;)i(this,C,D),D+=this.blockSize;if(typeof C=="string"){for(;D<_;)if(N[A++]=C.charCodeAt(D++),A==this.blockSize){i(this,N),A=0;break}}else for(;D<_;)if(N[A++]=C[D++],A==this.blockSize){i(this,N),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var _=1;_<C.length-8;++_)C[_]=0;var P=8*this.o;for(_=C.length-8;_<C.length;++_)C[_]=P&255,P/=256;for(this.u(C),C=Array(16),_=P=0;4>_;++_)for(var N=0;32>N;N+=8)C[P++]=this.g[_]>>>N&255;return C};function s(C,_){var P=a;return Object.prototype.hasOwnProperty.call(P,C)?P[C]:P[C]=_(C)}function o(C,_){this.h=_;for(var P=[],N=!0,A=C.length-1;0<=A;A--){var D=C[A]|0;N&&D==_||(P[A]=D,N=!1)}this.g=P}var a={};function l(C){return-128<=C&&128>C?s(C,function(_){return new o([_|0],0>_?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return d;if(0>C)return k(u(-C));for(var _=[],P=1,N=0;C>=P;N++)_[N]=C/P|0,P*=4294967296;return new o(_,0)}function c(C,_){if(C.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(C.charAt(0)=="-")return k(c(C.substring(1),_));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(_,8)),N=d,A=0;A<C.length;A+=8){var D=Math.min(8,C.length-A),L=parseInt(C.substring(A,A+D),_);8>D?(D=u(Math.pow(_,D)),N=N.j(D).add(u(L))):(N=N.j(P),N=N.add(u(L)))}return N}var d=l(0),h=l(1),p=l(16777216);t=o.prototype,t.m=function(){if(m(this))return-k(this).m();for(var C=0,_=1,P=0;P<this.g.length;P++){var N=this.i(P);C+=(0<=N?N:4294967296+N)*_,_*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(g(this))return"0";if(m(this))return"-"+k(this).toString(C);for(var _=u(Math.pow(C,6)),P=this,N="";;){var A=x(P,_).g;P=y(P,A.j(_));var D=((0<P.g.length?P.g[0]:P.h)>>>0).toString(C);if(P=A,g(P))return D+N;for(;6>D.length;)D="0"+D;N=D+N}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function g(C){if(C.h!=0)return!1;for(var _=0;_<C.g.length;_++)if(C.g[_]!=0)return!1;return!0}function m(C){return C.h==-1}t.l=function(C){return C=y(this,C),m(C)?-1:g(C)?0:1};function k(C){for(var _=C.g.length,P=[],N=0;N<_;N++)P[N]=~C.g[N];return new o(P,~C.h).add(h)}t.abs=function(){return m(this)?k(this):this},t.add=function(C){for(var _=Math.max(this.g.length,C.g.length),P=[],N=0,A=0;A<=_;A++){var D=N+(this.i(A)&65535)+(C.i(A)&65535),L=(D>>>16)+(this.i(A)>>>16)+(C.i(A)>>>16);N=L>>>16,D&=65535,L&=65535,P[A]=L<<16|D}return new o(P,P[P.length-1]&-2147483648?-1:0)};function y(C,_){return C.add(k(_))}t.j=function(C){if(g(this)||g(C))return d;if(m(this))return m(C)?k(this).j(k(C)):k(k(this).j(C));if(m(C))return k(this.j(k(C)));if(0>this.l(p)&&0>C.l(p))return u(this.m()*C.m());for(var _=this.g.length+C.g.length,P=[],N=0;N<2*_;N++)P[N]=0;for(N=0;N<this.g.length;N++)for(var A=0;A<C.g.length;A++){var D=this.i(N)>>>16,L=this.i(N)&65535,ae=C.i(A)>>>16,re=C.i(A)&65535;P[2*N+2*A]+=L*re,w(P,2*N+2*A),P[2*N+2*A+1]+=D*re,w(P,2*N+2*A+1),P[2*N+2*A+1]+=L*ae,w(P,2*N+2*A+1),P[2*N+2*A+2]+=D*ae,w(P,2*N+2*A+2)}for(N=0;N<_;N++)P[N]=P[2*N+1]<<16|P[2*N];for(N=_;N<2*_;N++)P[N]=0;return new o(P,0)};function w(C,_){for(;(C[_]&65535)!=C[_];)C[_+1]+=C[_]>>>16,C[_]&=65535,_++}function T(C,_){this.g=C,this.h=_}function x(C,_){if(g(_))throw Error("division by zero");if(g(C))return new T(d,d);if(m(C))return _=x(k(C),_),new T(k(_.g),k(_.h));if(m(_))return _=x(C,k(_)),new T(k(_.g),_.h);if(30<C.g.length){if(m(C)||m(_))throw Error("slowDivide_ only works with positive integers.");for(var P=h,N=_;0>=N.l(C);)P=I(P),N=I(N);var A=R(P,1),D=R(N,1);for(N=R(N,2),P=R(P,2);!g(N);){var L=D.add(N);0>=L.l(C)&&(A=A.add(P),D=L),N=R(N,1),P=R(P,1)}return _=y(C,A.j(_)),new T(A,_)}for(A=d;0<=C.l(_);){for(P=Math.max(1,Math.floor(C.m()/_.m())),N=Math.ceil(Math.log(P)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),D=u(P),L=D.j(_);m(L)||0<L.l(C);)P-=N,D=u(P),L=D.j(_);g(D)&&(D=h),A=A.add(D),C=y(C,L)}return new T(A,C)}t.A=function(C){return x(this,C).h},t.and=function(C){for(var _=Math.max(this.g.length,C.g.length),P=[],N=0;N<_;N++)P[N]=this.i(N)&C.i(N);return new o(P,this.h&C.h)},t.or=function(C){for(var _=Math.max(this.g.length,C.g.length),P=[],N=0;N<_;N++)P[N]=this.i(N)|C.i(N);return new o(P,this.h|C.h)},t.xor=function(C){for(var _=Math.max(this.g.length,C.g.length),P=[],N=0;N<_;N++)P[N]=this.i(N)^C.i(N);return new o(P,this.h^C.h)};function I(C){for(var _=C.g.length+1,P=[],N=0;N<_;N++)P[N]=C.i(N)<<1|C.i(N-1)>>>31;return new o(P,C.h)}function R(C,_){var P=_>>5;_%=32;for(var N=C.g.length-P,A=[],D=0;D<N;D++)A[D]=0<_?C.i(D+P)>>>_|C.i(D+P+1)<<32-_:C.i(D+P);return new o(A,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,$R=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=c,vo=o}).apply(typeof E_<"u"?E_:typeof self<"u"?self:typeof window<"u"?window:{});var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zR,ku,qR,Rf,xv,HR,WR,KR;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,b,S){return f==Array.prototype||f==Object.prototype||(f[b]=S.value),f};function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qd=="object"&&Qd];for(var b=0;b<f.length;++b){var S=f[b];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var r=n(this);function i(f,b){if(b)e:{var S=r;f=f.split(".");for(var O=0;O<f.length-1;O++){var j=f[O];if(!(j in S))break e;S=S[j]}f=f[f.length-1],O=S[f],b=b(O),b!=O&&b!=null&&e(S,f,{configurable:!0,writable:!0,value:b})}}function s(f,b){f instanceof String&&(f+="");var S=0,O=!1,j={next:function(){if(!O&&S<f.length){var z=S++;return{value:b(z,f[z]),done:!1}}return O=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.values",function(f){return f||function(){return s(this,function(b,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(f){var b=typeof f;return b=b!="object"?b:f?Array.isArray(f)?"array":b:"null",b=="array"||b=="object"&&typeof f.length=="number"}function u(f){var b=typeof f;return b=="object"&&f!=null||b=="function"}function c(f,b,S){return f.call.apply(f.bind,arguments)}function d(f,b,S){if(!f)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,O),f.apply(b,j)}}return function(){return f.apply(b,arguments)}}function h(f,b,S){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?c:d,h.apply(null,arguments)}function p(f,b){var S=Array.prototype.slice.call(arguments,1);return function(){var O=S.slice();return O.push.apply(O,arguments),f.apply(this,O)}}function g(f,b){function S(){}S.prototype=b.prototype,f.aa=b.prototype,f.prototype=new S,f.prototype.constructor=f,f.Qb=function(O,j,z){for(var te=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)te[ze-2]=arguments[ze];return b.prototype[j].apply(O,te)}}function m(f){const b=f.length;if(0<b){const S=Array(b);for(let O=0;O<b;O++)S[O]=f[O];return S}return[]}function k(f,b){for(let S=1;S<arguments.length;S++){const O=arguments[S];if(l(O)){const j=f.length||0,z=O.length||0;f.length=j+z;for(let te=0;te<z;te++)f[j+te]=O[te]}else f.push(O)}}class y{constructor(b,S){this.i=b,this.j=S,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function w(f){return/^[\s\xa0]*$/.test(f)}function T(){var f=a.navigator;return f&&(f=f.userAgent)?f:""}function x(f){return x[" "](f),f}x[" "]=function(){};var I=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function R(f,b,S){for(const O in f)b.call(S,f[O],O,f)}function C(f,b){for(const S in f)b.call(void 0,f[S],S,f)}function _(f){const b={};for(const S in f)b[S]=f[S];return b}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(f,b){let S,O;for(let j=1;j<arguments.length;j++){O=arguments[j];for(S in O)f[S]=O[S];for(let z=0;z<P.length;z++)S=P[z],Object.prototype.hasOwnProperty.call(O,S)&&(f[S]=O[S])}}function A(f){var b=1;f=f.split(":");const S=[];for(;0<b&&f.length;)S.push(f.shift()),b--;return f.length&&S.push(f.join(":")),S}function D(f){a.setTimeout(()=>{throw f},0)}function L(){var f=se;let b=null;return f.g&&(b=f.g,f.g=f.g.next,f.g||(f.h=null),b.next=null),b}class ae{constructor(){this.h=this.g=null}add(b,S){const O=re.get();O.set(b,S),this.h?this.h.next=O:this.g=O,this.h=O}}var re=new y(()=>new Te,f=>f.reset());class Te{constructor(){this.next=this.g=this.h=null}set(b,S){this.h=b,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,Q=!1,se=new ae,M=()=>{const f=a.Promise.resolve(void 0);ue=()=>{f.then(Se)}};var Se=()=>{for(var f;f=L();){try{f.h.call(f.g)}catch(S){D(S)}var b=re;b.j(f),100>b.h&&(b.h++,f.next=b.g,b.g=f)}Q=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(f,b){this.type=f,this.g=this.target=b,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var be=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var f=!1,b=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const S=()=>{};a.addEventListener("test",S,b),a.removeEventListener("test",S,b)}catch{}return f}();function mt(f,b){if(U.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var S=this.type=f.type,O=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=b,b=f.relatedTarget){if(I){e:{try{x(b.nodeName);var j=!0;break e}catch{}j=!1}j||(b=null)}}else S=="mouseover"?b=f.fromElement:S=="mouseout"&&(b=f.toElement);this.relatedTarget=b,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:$e[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&mt.aa.h.call(this)}}g(mt,U);var $e={2:"touch",3:"pen",4:"mouse"};mt.prototype.h=function(){mt.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ln="closure_listenable_"+(1e6*Math.random()|0),Br=0;function Gi(f,b,S,O,j){this.listener=f,this.proxy=null,this.src=b,this.type=S,this.capture=!!O,this.ha=j,this.key=++Br,this.da=this.fa=!1}function pr(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function fi(f){this.src=f,this.g={},this.h=0}fi.prototype.add=function(f,b,S,O,j){var z=f.toString();f=this.g[z],f||(f=this.g[z]=[],this.h++);var te=Ll(f,b,O,j);return-1<te?(b=f[te],S||(b.fa=!1)):(b=new Gi(b,this.src,z,!!O,j),b.fa=S,f.push(b)),b};function Dl(f,b){var S=b.type;if(S in f.g){var O=f.g[S],j=Array.prototype.indexOf.call(O,b,void 0),z;(z=0<=j)&&Array.prototype.splice.call(O,j,1),z&&(pr(b),f.g[S].length==0&&(delete f.g[S],f.h--))}}function Ll(f,b,S,O){for(var j=0;j<f.length;++j){var z=f[j];if(!z.da&&z.listener==b&&z.capture==!!S&&z.ha==O)return j}return-1}var Ml="closure_lm_"+(1e6*Math.random()|0),Jo={};function Ul(f,b,S,O,j){if(Array.isArray(b)){for(var z=0;z<b.length;z++)Ul(f,b[z],S,O,j);return null}return S=md(S),f&&f[ln]?f.K(b,S,u(O)?!!O.capture:!1,j):hd(f,b,S,!1,O,j)}function hd(f,b,S,O,j,z){if(!b)throw Error("Invalid event type");var te=u(j)?!!j.capture:!!j,ze=jl(f);if(ze||(f[Ml]=ze=new fi(f)),S=ze.add(b,S,O,te,z),S.proxy)return S;if(O=Lm(),S.proxy=O,O.src=f,O.listener=S,f.addEventListener)be||(j=te),j===void 0&&(j=!1),f.addEventListener(b.toString(),O,j);else if(f.attachEvent)f.attachEvent(pd(b.toString()),O);else if(f.addListener&&f.removeListener)f.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Lm(){function f(S){return b.call(f.src,f.listener,S)}const b=Mm;return f}function Fl(f,b,S,O,j){if(Array.isArray(b))for(var z=0;z<b.length;z++)Fl(f,b[z],S,O,j);else O=u(O)?!!O.capture:!!O,S=md(S),f&&f[ln]?(f=f.i,b=String(b).toString(),b in f.g&&(z=f.g[b],S=Ll(z,S,O,j),-1<S&&(pr(z[S]),Array.prototype.splice.call(z,S,1),z.length==0&&(delete f.g[b],f.h--)))):f&&(f=jl(f))&&(b=f.g[b.toString()],f=-1,b&&(f=Ll(b,S,O,j)),(S=-1<f?b[f]:null)&&Yo(S))}function Yo(f){if(typeof f!="number"&&f&&!f.da){var b=f.src;if(b&&b[ln])Dl(b.i,f);else{var S=f.type,O=f.proxy;b.removeEventListener?b.removeEventListener(S,O,f.capture):b.detachEvent?b.detachEvent(pd(S),O):b.addListener&&b.removeListener&&b.removeListener(O),(S=jl(b))?(Dl(S,f),S.h==0&&(S.src=null,b[Ml]=null)):pr(f)}}}function pd(f){return f in Jo?Jo[f]:Jo[f]="on"+f}function Mm(f,b){if(f.da)f=!0;else{b=new mt(b,this);var S=f.listener,O=f.ha||f.src;f.fa&&Yo(f),f=S.call(O,b)}return f}function jl(f){return f=f[Ml],f instanceof fi?f:null}var Vl="__closure_events_fn_"+(1e9*Math.random()>>>0);function md(f){return typeof f=="function"?f:(f[Vl]||(f[Vl]=function(b){return f.handleEvent(b)}),f[Vl])}function q(){ye.call(this),this.i=new fi(this),this.M=this,this.F=null}g(q,ye),q.prototype[ln]=!0,q.prototype.removeEventListener=function(f,b,S,O){Fl(this,f,b,S,O)};function Y(f,b){var S,O=f.F;if(O)for(S=[];O;O=O.F)S.push(O);if(f=f.M,O=b.type||b,typeof b=="string")b=new U(b,f);else if(b instanceof U)b.target=b.target||f;else{var j=b;b=new U(O,f),N(b,j)}if(j=!0,S)for(var z=S.length-1;0<=z;z--){var te=b.g=S[z];j=de(te,O,!0,b)&&j}if(te=b.g=f,j=de(te,O,!0,b)&&j,j=de(te,O,!1,b)&&j,S)for(z=0;z<S.length;z++)te=b.g=S[z],j=de(te,O,!1,b)&&j}q.prototype.N=function(){if(q.aa.N.call(this),this.i){var f=this.i,b;for(b in f.g){for(var S=f.g[b],O=0;O<S.length;O++)pr(S[O]);delete f.g[b],f.h--}}this.F=null},q.prototype.K=function(f,b,S,O){return this.i.add(String(f),b,!1,S,O)},q.prototype.L=function(f,b,S,O){return this.i.add(String(f),b,!0,S,O)};function de(f,b,S,O){if(b=f.i.g[String(b)],!b)return!0;b=b.concat();for(var j=!0,z=0;z<b.length;++z){var te=b[z];if(te&&!te.da&&te.capture==S){var ze=te.listener,Lt=te.ha||te.src;te.fa&&Dl(f.i,te),j=ze.call(Lt,O)!==!1&&j}}return j&&!O.defaultPrevented}function _e(f,b,S){if(typeof f=="function")S&&(f=h(f,S));else if(f&&typeof f.handleEvent=="function")f=h(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:a.setTimeout(f,b||0)}function Fe(f){f.g=_e(()=>{f.g=null,f.i&&(f.i=!1,Fe(f))},f.l);const b=f.h;f.h=null,f.m.apply(null,b)}class Dn extends ye{constructor(b,S){super(),this.m=b,this.l=S,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Fe(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ln(f){ye.call(this),this.h=f,this.g={}}g(Ln,ye);var Xn=[];function Qi(f){R(f.g,function(b,S){this.g.hasOwnProperty(S)&&Yo(b)},f),f.g={}}Ln.prototype.N=function(){Ln.aa.N.call(this),Qi(this)},Ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hi=a.JSON.stringify,un=a.JSON.parse,Ji=class{stringify(f){return a.JSON.stringify(f,void 0)}parse(f){return a.JSON.parse(f,void 0)}};function Mn(){}Mn.prototype.h=null;function $w(f){return f.h||(f.h=f.i())}function zw(){}var Bl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Um(){U.call(this,"d")}g(Um,U);function Fm(){U.call(this,"c")}g(Fm,U);var Ys={},qw=null;function gd(){return qw=qw||new q}Ys.La="serverreachability";function Hw(f){U.call(this,Ys.La,f)}g(Hw,U);function $l(f){const b=gd();Y(b,new Hw(b))}Ys.STAT_EVENT="statevent";function Ww(f,b){U.call(this,Ys.STAT_EVENT,f),this.stat=b}g(Ww,U);function cn(f){const b=gd();Y(b,new Ww(b,f))}Ys.Ma="timingevent";function Kw(f,b){U.call(this,Ys.Ma,f),this.size=b}g(Kw,U);function zl(f,b){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){f()},b)}function ql(){this.g=!0}ql.prototype.xa=function(){this.g=!1};function X2(f,b,S,O,j,z){f.info(function(){if(f.g)if(z)for(var te="",ze=z.split("&"),Lt=0;Lt<ze.length;Lt++){var Le=ze[Lt].split("=");if(1<Le.length){var Ht=Le[0];Le=Le[1];var Wt=Ht.split("_");te=2<=Wt.length&&Wt[1]=="type"?te+(Ht+"="+Le+"&"):te+(Ht+"=redacted&")}}else te=null;else te=z;return"XMLHTTP REQ ("+O+") [attempt "+j+"]: "+b+`
`+S+`
`+te})}function Z2(f,b,S,O,j,z,te){f.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+j+"]: "+b+`
`+S+`
`+z+" "+te})}function Xo(f,b,S,O){f.info(function(){return"XMLHTTP TEXT ("+b+"): "+tM(f,S)+(O?" "+O:"")})}function eM(f,b){f.info(function(){return"TIMEOUT: "+b})}ql.prototype.info=function(){};function tM(f,b){if(!f.g)return b;if(!b)return null;try{var S=JSON.parse(b);if(S){for(f=0;f<S.length;f++)if(Array.isArray(S[f])){var O=S[f];if(!(2>O.length)){var j=O[1];if(Array.isArray(j)&&!(1>j.length)){var z=j[0];if(z!="noop"&&z!="stop"&&z!="close")for(var te=1;te<j.length;te++)j[te]=""}}}}return hi(S)}catch{return b}}var yd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Gw={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},jm;function vd(){}g(vd,Mn),vd.prototype.g=function(){return new XMLHttpRequest},vd.prototype.i=function(){return{}},jm=new vd;function Yi(f,b,S,O){this.j=f,this.i=b,this.l=S,this.R=O||1,this.U=new Ln(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qw}function Qw(){this.i=null,this.g="",this.h=!1}var Jw={},Vm={};function Bm(f,b,S){f.L=1,f.v=Td(pi(b)),f.m=S,f.P=!0,Yw(f,null)}function Yw(f,b){f.F=Date.now(),bd(f),f.A=pi(f.v);var S=f.A,O=f.R;Array.isArray(O)||(O=[String(O)]),dT(S.i,"t",O),f.C=0,S=f.j.J,f.h=new Qw,f.g=PT(f.j,S?b:null,!f.m),0<f.O&&(f.M=new Dn(h(f.Y,f,f.g),f.O)),b=f.U,S=f.g,O=f.ca;var j="readystatechange";Array.isArray(j)||(j&&(Xn[0]=j.toString()),j=Xn);for(var z=0;z<j.length;z++){var te=Ul(S,j[z],O||b.handleEvent,!1,b.h||b);if(!te)break;b.g[te.key]=te}b=f.H?_(f.H):{},f.m?(f.u||(f.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,b)):(f.u="GET",f.g.ea(f.A,f.u,null,b)),$l(),X2(f.i,f.u,f.A,f.l,f.R,f.m)}Yi.prototype.ca=function(f){f=f.target;const b=this.M;b&&mi(f)==3?b.j():this.Y(f)},Yi.prototype.Y=function(f){try{if(f==this.g)e:{const Wt=mi(this.g);var b=this.g.Ba();const ta=this.g.Z();if(!(3>Wt)&&(Wt!=3||this.g&&(this.h.h||this.g.oa()||vT(this.g)))){this.J||Wt!=4||b==7||(b==8||0>=ta?$l(3):$l(2)),$m(this);var S=this.g.Z();this.X=S;t:if(Xw(this)){var O=vT(this.g);f="";var j=O.length,z=mi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xs(this),Hl(this);var te="";break t}this.h.i=new a.TextDecoder}for(b=0;b<j;b++)this.h.h=!0,f+=this.h.i.decode(O[b],{stream:!(z&&b==j-1)});O.length=0,this.h.g+=f,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=S==200,Z2(this.i,this.u,this.A,this.l,this.R,Wt,S),this.o){if(this.T&&!this.K){t:{if(this.g){var ze,Lt=this.g;if((ze=Lt.g?Lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(ze)){var Le=ze;break t}}Le=null}if(S=Le)Xo(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zm(this,S);else{this.o=!1,this.s=3,cn(12),Xs(this),Hl(this);break e}}if(this.P){S=!0;let mr;for(;!this.J&&this.C<te.length;)if(mr=nM(this,te),mr==Vm){Wt==4&&(this.s=4,cn(14),S=!1),Xo(this.i,this.l,null,"[Incomplete Response]");break}else if(mr==Jw){this.s=4,cn(15),Xo(this.i,this.l,te,"[Invalid Chunk]"),S=!1;break}else Xo(this.i,this.l,mr,null),zm(this,mr);if(Xw(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Wt!=4||te.length!=0||this.h.h||(this.s=1,cn(16),S=!1),this.o=this.o&&S,!S)Xo(this.i,this.l,te,"[Invalid Chunked Response]"),Xs(this),Hl(this);else if(0<te.length&&!this.W){this.W=!0;var Ht=this.j;Ht.g==this&&Ht.ba&&!Ht.M&&(Ht.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),Qm(Ht),Ht.M=!0,cn(11))}}else Xo(this.i,this.l,te,null),zm(this,te);Wt==4&&Xs(this),this.o&&!this.J&&(Wt==4?ET(this.j,this):(this.o=!1,bd(this)))}else bM(this.g),S==400&&0<te.indexOf("Unknown SID")?(this.s=3,cn(12)):(this.s=0,cn(13)),Xs(this),Hl(this)}}}catch{}finally{}};function Xw(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function nM(f,b){var S=f.C,O=b.indexOf(`
`,S);return O==-1?Vm:(S=Number(b.substring(S,O)),isNaN(S)?Jw:(O+=1,O+S>b.length?Vm:(b=b.slice(O,O+S),f.C=O+S,b)))}Yi.prototype.cancel=function(){this.J=!0,Xs(this)};function bd(f){f.S=Date.now()+f.I,Zw(f,f.I)}function Zw(f,b){if(f.B!=null)throw Error("WatchDog timer not null");f.B=zl(h(f.ba,f),b)}function $m(f){f.B&&(a.clearTimeout(f.B),f.B=null)}Yi.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(eM(this.i,this.A),this.L!=2&&($l(),cn(17)),Xs(this),this.s=2,Hl(this)):Zw(this,this.S-f)};function Hl(f){f.j.G==0||f.J||ET(f.j,f)}function Xs(f){$m(f);var b=f.M;b&&typeof b.ma=="function"&&b.ma(),f.M=null,Qi(f.U),f.g&&(b=f.g,f.g=null,b.abort(),b.ma())}function zm(f,b){try{var S=f.j;if(S.G!=0&&(S.g==f||qm(S.h,f))){if(!f.K&&qm(S.h,f)&&S.G==3){try{var O=S.Da.g.parse(b)}catch{O=null}if(Array.isArray(O)&&O.length==3){var j=O;if(j[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<f.F)Id(S),Cd(S);else break e;Gm(S),cn(18)}}else S.za=j[1],0<S.za-S.T&&37500>j[2]&&S.F&&S.v==0&&!S.C&&(S.C=zl(h(S.Za,S),6e3));if(1>=nT(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else eo(S,11)}else if((f.K||S.g==f)&&Id(S),!w(b))for(j=S.Da.g.parse(b),b=0;b<j.length;b++){let Le=j[b];if(S.T=Le[0],Le=Le[1],S.G==2)if(Le[0]=="c"){S.K=Le[1],S.ia=Le[2];const Ht=Le[3];Ht!=null&&(S.la=Ht,S.j.info("VER="+S.la));const Wt=Le[4];Wt!=null&&(S.Aa=Wt,S.j.info("SVER="+S.Aa));const ta=Le[5];ta!=null&&typeof ta=="number"&&0<ta&&(O=1.5*ta,S.L=O,S.j.info("backChannelRequestTimeoutMs_="+O)),O=S;const mr=f.g;if(mr){const Rd=mr.g?mr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rd){var z=O.h;z.g||Rd.indexOf("spdy")==-1&&Rd.indexOf("quic")==-1&&Rd.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(Hm(z,z.h),z.h=null))}if(O.D){const Jm=mr.g?mr.g.getResponseHeader("X-HTTP-Session-Id"):null;Jm&&(O.ya=Jm,Xe(O.I,O.D,Jm))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-f.F,S.j.info("Handshake RTT: "+S.R+"ms")),O=S;var te=f;if(O.qa=IT(O,O.J?O.ia:null,O.W),te.K){rT(O.h,te);var ze=te,Lt=O.L;Lt&&(ze.I=Lt),ze.B&&($m(ze),bd(ze)),O.g=te}else ST(O);0<S.i.length&&xd(S)}else Le[0]!="stop"&&Le[0]!="close"||eo(S,7);else S.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?eo(S,7):Km(S):Le[0]!="noop"&&S.l&&S.l.ta(Le),S.v=0)}}$l(4)}catch{}}var rM=class{constructor(f,b){this.g=f,this.map=b}};function eT(f){this.l=f||10,a.PerformanceNavigationTiming?(f=a.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tT(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function nT(f){return f.h?1:f.g?f.g.size:0}function qm(f,b){return f.h?f.h==b:f.g?f.g.has(b):!1}function Hm(f,b){f.g?f.g.add(b):f.h=b}function rT(f,b){f.h&&f.h==b?f.h=null:f.g&&f.g.has(b)&&f.g.delete(b)}eT.prototype.cancel=function(){if(this.i=iT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function iT(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let b=f.i;for(const S of f.g.values())b=b.concat(S.D);return b}return m(f.i)}function iM(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var b=[],S=f.length,O=0;O<S;O++)b.push(f[O]);return b}b=[],S=0;for(O in f)b[S++]=f[O];return b}function sM(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var b=[];f=f.length;for(var S=0;S<f;S++)b.push(S);return b}b=[],S=0;for(const O in f)b[S++]=O;return b}}}function sT(f,b){if(f.forEach&&typeof f.forEach=="function")f.forEach(b,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,b,void 0);else for(var S=sM(f),O=iM(f),j=O.length,z=0;z<j;z++)b.call(void 0,O[z],S&&S[z],f)}var oT=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oM(f,b){if(f){f=f.split("&");for(var S=0;S<f.length;S++){var O=f[S].indexOf("="),j=null;if(0<=O){var z=f[S].substring(0,O);j=f[S].substring(O+1)}else z=f[S];b(z,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Zs(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Zs){this.h=f.h,kd(this,f.j),this.o=f.o,this.g=f.g,wd(this,f.s),this.l=f.l;var b=f.i,S=new Gl;S.i=b.i,b.g&&(S.g=new Map(b.g),S.h=b.h),aT(this,S),this.m=f.m}else f&&(b=String(f).match(oT))?(this.h=!1,kd(this,b[1]||"",!0),this.o=Wl(b[2]||""),this.g=Wl(b[3]||"",!0),wd(this,b[4]),this.l=Wl(b[5]||"",!0),aT(this,b[6]||"",!0),this.m=Wl(b[7]||"")):(this.h=!1,this.i=new Gl(null,this.h))}Zs.prototype.toString=function(){var f=[],b=this.j;b&&f.push(Kl(b,lT,!0),":");var S=this.g;return(S||b=="file")&&(f.push("//"),(b=this.o)&&f.push(Kl(b,lT,!0),"@"),f.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&f.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&f.push("/"),f.push(Kl(S,S.charAt(0)=="/"?uM:lM,!0))),(S=this.i.toString())&&f.push("?",S),(S=this.m)&&f.push("#",Kl(S,dM)),f.join("")};function pi(f){return new Zs(f)}function kd(f,b,S){f.j=S?Wl(b,!0):b,f.j&&(f.j=f.j.replace(/:$/,""))}function wd(f,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);f.s=b}else f.s=null}function aT(f,b,S){b instanceof Gl?(f.i=b,fM(f.i,f.h)):(S||(b=Kl(b,cM)),f.i=new Gl(b,f.h))}function Xe(f,b,S){f.i.set(b,S)}function Td(f){return Xe(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Wl(f,b){return f?b?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Kl(f,b,S){return typeof f=="string"?(f=encodeURI(f).replace(b,aM),S&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function aM(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var lT=/[#\/\?@]/g,lM=/[#\?:]/g,uM=/[#\?]/g,cM=/[#\?@]/g,dM=/#/g;function Gl(f,b){this.h=this.g=null,this.i=f||null,this.j=!!b}function Xi(f){f.g||(f.g=new Map,f.h=0,f.i&&oM(f.i,function(b,S){f.add(decodeURIComponent(b.replace(/\+/g," ")),S)}))}t=Gl.prototype,t.add=function(f,b){Xi(this),this.i=null,f=Zo(this,f);var S=this.g.get(f);return S||this.g.set(f,S=[]),S.push(b),this.h+=1,this};function uT(f,b){Xi(f),b=Zo(f,b),f.g.has(b)&&(f.i=null,f.h-=f.g.get(b).length,f.g.delete(b))}function cT(f,b){return Xi(f),b=Zo(f,b),f.g.has(b)}t.forEach=function(f,b){Xi(this),this.g.forEach(function(S,O){S.forEach(function(j){f.call(b,j,O,this)},this)},this)},t.na=function(){Xi(this);const f=Array.from(this.g.values()),b=Array.from(this.g.keys()),S=[];for(let O=0;O<b.length;O++){const j=f[O];for(let z=0;z<j.length;z++)S.push(b[O])}return S},t.V=function(f){Xi(this);let b=[];if(typeof f=="string")cT(this,f)&&(b=b.concat(this.g.get(Zo(this,f))));else{f=Array.from(this.g.values());for(let S=0;S<f.length;S++)b=b.concat(f[S])}return b},t.set=function(f,b){return Xi(this),this.i=null,f=Zo(this,f),cT(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[b]),this.h+=1,this},t.get=function(f,b){return f?(f=this.V(f),0<f.length?String(f[0]):b):b};function dT(f,b,S){uT(f,b),0<S.length&&(f.i=null,f.g.set(Zo(f,b),m(S)),f.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],b=Array.from(this.g.keys());for(var S=0;S<b.length;S++){var O=b[S];const z=encodeURIComponent(String(O)),te=this.V(O);for(O=0;O<te.length;O++){var j=z;te[O]!==""&&(j+="="+encodeURIComponent(String(te[O]))),f.push(j)}}return this.i=f.join("&")};function Zo(f,b){return b=String(b),f.j&&(b=b.toLowerCase()),b}function fM(f,b){b&&!f.j&&(Xi(f),f.i=null,f.g.forEach(function(S,O){var j=O.toLowerCase();O!=j&&(uT(this,O),dT(this,j,S))},f)),f.j=b}function hM(f,b){const S=new ql;if(a.Image){const O=new Image;O.onload=p(Zi,S,"TestLoadImage: loaded",!0,b,O),O.onerror=p(Zi,S,"TestLoadImage: error",!1,b,O),O.onabort=p(Zi,S,"TestLoadImage: abort",!1,b,O),O.ontimeout=p(Zi,S,"TestLoadImage: timeout",!1,b,O),a.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=f}else b(!1)}function pM(f,b){const S=new ql,O=new AbortController,j=setTimeout(()=>{O.abort(),Zi(S,"TestPingServer: timeout",!1,b)},1e4);fetch(f,{signal:O.signal}).then(z=>{clearTimeout(j),z.ok?Zi(S,"TestPingServer: ok",!0,b):Zi(S,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(j),Zi(S,"TestPingServer: error",!1,b)})}function Zi(f,b,S,O,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),O(S)}catch{}}function mM(){this.g=new Ji}function gM(f,b,S){const O=S||"";try{sT(f,function(j,z){let te=j;u(j)&&(te=hi(j)),b.push(O+z+"="+encodeURIComponent(te))})}catch(j){throw b.push(O+"type="+encodeURIComponent("_badmap")),j}}function Sd(f){this.l=f.Ub||null,this.j=f.eb||!1}g(Sd,Mn),Sd.prototype.g=function(){return new _d(this.l,this.j)},Sd.prototype.i=function(f){return function(){return f}}({});function _d(f,b){q.call(this),this.D=f,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(_d,q),t=_d.prototype,t.open=function(f,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=b,this.readyState=1,Jl(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(b.body=f),(this.D||a).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ql(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Jl(this)),this.g&&(this.readyState=3,Jl(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fT(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function fT(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var b=f.value?f.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!f.done}))&&(this.response=this.responseText+=b)}f.done?Ql(this):Jl(this),this.readyState==3&&fT(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Ql(this))},t.Qa=function(f){this.g&&(this.response=f,Ql(this))},t.ga=function(){this.g&&Ql(this)};function Ql(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Jl(f)}t.setRequestHeader=function(f,b){this.u.append(f,b)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],b=this.h.entries();for(var S=b.next();!S.done;)S=S.value,f.push(S[0]+": "+S[1]),S=b.next();return f.join(`\r
`)};function Jl(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(_d.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function hT(f){let b="";return R(f,function(S,O){b+=O,b+=":",b+=S,b+=`\r
`}),b}function Wm(f,b,S){e:{for(O in S){var O=!1;break e}O=!0}O||(S=hT(S),typeof f=="string"?S!=null&&encodeURIComponent(String(S)):Xe(f,b,S))}function ct(f){q.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(ct,q);var yM=/^https?$/i,vM=["POST","PUT"];t=ct.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,b,S,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);b=b?b.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jm.g(),this.v=this.o?$w(this.o):$w(jm),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(b,String(f),!0),this.B=!1}catch(z){pT(this,z);return}if(f=S||"",S=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var j in O)S.set(j,O[j]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const z of O.keys())S.set(z,O.get(z));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(S.keys()).find(z=>z.toLowerCase()=="content-type"),j=a.FormData&&f instanceof a.FormData,!(0<=Array.prototype.indexOf.call(vM,b,void 0))||O||j||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,te]of S)this.g.setRequestHeader(z,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{yT(this),this.u=!0,this.g.send(f),this.u=!1}catch(z){pT(this,z)}};function pT(f,b){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=b,f.m=5,mT(f),Ed(f)}function mT(f){f.A||(f.A=!0,Y(f,"complete"),Y(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Y(this,"complete"),Y(this,"abort"),Ed(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ed(this,!0)),ct.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gT(this):this.bb())},t.bb=function(){gT(this)};function gT(f){if(f.h&&typeof o<"u"&&(!f.v[1]||mi(f)!=4||f.Z()!=2)){if(f.u&&mi(f)==4)_e(f.Ea,0,f);else if(Y(f,"readystatechange"),mi(f)==4){f.h=!1;try{const te=f.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var S;if(!(S=b)){var O;if(O=te===0){var j=String(f.D).match(oT)[1]||null;!j&&a.self&&a.self.location&&(j=a.self.location.protocol.slice(0,-1)),O=!yM.test(j?j.toLowerCase():"")}S=O}if(S)Y(f,"complete"),Y(f,"success");else{f.m=6;try{var z=2<mi(f)?f.g.statusText:""}catch{z=""}f.l=z+" ["+f.Z()+"]",mT(f)}}finally{Ed(f)}}}}function Ed(f,b){if(f.g){yT(f);const S=f.g,O=f.v[0]?()=>{}:null;f.g=null,f.v=null,b||Y(f,"ready");try{S.onreadystatechange=O}catch{}}}function yT(f){f.I&&(a.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function mi(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<mi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var b=this.g.responseText;return f&&b.indexOf(f)==0&&(b=b.substring(f.length)),un(b)}};function vT(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function bM(f){const b={};f=(f.g&&2<=mi(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<f.length;O++){if(w(f[O]))continue;var S=A(f[O]);const j=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const z=b[j]||[];b[j]=z,z.push(S)}C(b,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yl(f,b,S){return S&&S.internalChannelParams&&S.internalChannelParams[f]||b}function bT(f){this.Aa=0,this.i=[],this.j=new ql,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yl("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yl("baseRetryDelayMs",5e3,f),this.cb=Yl("retryDelaySeedMs",1e4,f),this.Wa=Yl("forwardChannelMaxRetries",2,f),this.wa=Yl("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new eT(f&&f.concurrentRequestLimit),this.Da=new mM,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=bT.prototype,t.la=8,t.G=1,t.connect=function(f,b,S,O){cn(0),this.W=f,this.H=b||{},S&&O!==void 0&&(this.H.OSID=S,this.H.OAID=O),this.F=this.X,this.I=IT(this,null,this.W),xd(this)};function Km(f){if(kT(f),f.G==3){var b=f.U++,S=pi(f.I);if(Xe(S,"SID",f.K),Xe(S,"RID",b),Xe(S,"TYPE","terminate"),Xl(f,S),b=new Yi(f,f.j,b),b.L=2,b.v=Td(pi(S)),S=!1,a.navigator&&a.navigator.sendBeacon)try{S=a.navigator.sendBeacon(b.v.toString(),"")}catch{}!S&&a.Image&&(new Image().src=b.v,S=!0),S||(b.g=PT(b.j,null),b.g.ea(b.v)),b.F=Date.now(),bd(b)}xT(f)}function Cd(f){f.g&&(Qm(f),f.g.cancel(),f.g=null)}function kT(f){Cd(f),f.u&&(a.clearTimeout(f.u),f.u=null),Id(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&a.clearTimeout(f.s),f.s=null)}function xd(f){if(!tT(f.h)&&!f.s){f.s=!0;var b=f.Ga;ue||M(),Q||(ue(),Q=!0),se.add(b,f),f.B=0}}function kM(f,b){return nT(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=b.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=zl(h(f.Ga,f,b),CT(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const j=new Yi(this,this.j,f);let z=this.o;if(this.S&&(z?(z=_(z),N(z,this.S)):z=this.S),this.m!==null||this.O||(j.H=z,z=null),this.P)e:{for(var b=0,S=0;S<this.i.length;S++){t:{var O=this.i[S];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(b+=O,4096<b){b=S;break e}if(b===4096||S===this.i.length-1){b=S+1;break e}}b=1e3}else b=1e3;b=TT(this,j,b),S=pi(this.I),Xe(S,"RID",f),Xe(S,"CVER",22),this.D&&Xe(S,"X-HTTP-Session-Id",this.D),Xl(this,S),z&&(this.O?b="headers="+encodeURIComponent(String(hT(z)))+"&"+b:this.m&&Wm(S,this.m,z)),Hm(this.h,j),this.Ua&&Xe(S,"TYPE","init"),this.P?(Xe(S,"$req",b),Xe(S,"SID","null"),j.T=!0,Bm(j,S,null)):Bm(j,S,b),this.G=2}}else this.G==3&&(f?wT(this,f):this.i.length==0||tT(this.h)||wT(this))};function wT(f,b){var S;b?S=b.l:S=f.U++;const O=pi(f.I);Xe(O,"SID",f.K),Xe(O,"RID",S),Xe(O,"AID",f.T),Xl(f,O),f.m&&f.o&&Wm(O,f.m,f.o),S=new Yi(f,f.j,S,f.B+1),f.m===null&&(S.H=f.o),b&&(f.i=b.D.concat(f.i)),b=TT(f,S,1e3),S.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Hm(f.h,S),Bm(S,O,b)}function Xl(f,b){f.H&&R(f.H,function(S,O){Xe(b,O,S)}),f.l&&sT({},function(S,O){Xe(b,O,S)})}function TT(f,b,S){S=Math.min(f.i.length,S);var O=f.l?h(f.l.Na,f.l,f):null;e:{var j=f.i;let z=-1;for(;;){const te=["count="+S];z==-1?0<S?(z=j[0].g,te.push("ofs="+z)):z=0:te.push("ofs="+z);let ze=!0;for(let Lt=0;Lt<S;Lt++){let Le=j[Lt].g;const Ht=j[Lt].map;if(Le-=z,0>Le)z=Math.max(0,j[Lt].g-100),ze=!1;else try{gM(Ht,te,"req"+Le+"_")}catch{O&&O(Ht)}}if(ze){O=te.join("&");break e}}}return f=f.i.splice(0,S),b.D=f,O}function ST(f){if(!f.g&&!f.u){f.Y=1;var b=f.Fa;ue||M(),Q||(ue(),Q=!0),se.add(b,f),f.v=0}}function Gm(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=zl(h(f.Fa,f),CT(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,_T(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=zl(h(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,cn(10),Cd(this),_T(this))};function Qm(f){f.A!=null&&(a.clearTimeout(f.A),f.A=null)}function _T(f){f.g=new Yi(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var b=pi(f.qa);Xe(b,"RID","rpc"),Xe(b,"SID",f.K),Xe(b,"AID",f.T),Xe(b,"CI",f.F?"0":"1"),!f.F&&f.ja&&Xe(b,"TO",f.ja),Xe(b,"TYPE","xmlhttp"),Xl(f,b),f.m&&f.o&&Wm(b,f.m,f.o),f.L&&(f.g.I=f.L);var S=f.g;f=f.ia,S.L=1,S.v=Td(pi(b)),S.m=null,S.P=!0,Yw(S,f)}t.Za=function(){this.C!=null&&(this.C=null,Cd(this),Gm(this),cn(19))};function Id(f){f.C!=null&&(a.clearTimeout(f.C),f.C=null)}function ET(f,b){var S=null;if(f.g==b){Id(f),Qm(f),f.g=null;var O=2}else if(qm(f.h,b))S=b.D,rT(f.h,b),O=1;else return;if(f.G!=0){if(b.o)if(O==1){S=b.m?b.m.length:0,b=Date.now()-b.F;var j=f.B;O=gd(),Y(O,new Kw(O,S)),xd(f)}else ST(f);else if(j=b.s,j==3||j==0&&0<b.X||!(O==1&&kM(f,b)||O==2&&Gm(f)))switch(S&&0<S.length&&(b=f.h,b.i=b.i.concat(S)),j){case 1:eo(f,5);break;case 4:eo(f,10);break;case 3:eo(f,6);break;default:eo(f,2)}}}function CT(f,b){let S=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(S*=2),S*b}function eo(f,b){if(f.j.info("Error code "+b),b==2){var S=h(f.fb,f),O=f.Xa;const j=!O;O=new Zs(O||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||kd(O,"https"),Td(O),j?hM(O.toString(),S):pM(O.toString(),S)}else cn(2);f.G=0,f.l&&f.l.sa(b),xT(f),kT(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),cn(2)):(this.j.info("Failed to ping google.com"),cn(1))};function xT(f){if(f.G=0,f.ka=[],f.l){const b=iT(f.h);(b.length!=0||f.i.length!=0)&&(k(f.ka,b),k(f.ka,f.i),f.h.i.length=0,m(f.i),f.i.length=0),f.l.ra()}}function IT(f,b,S){var O=S instanceof Zs?pi(S):new Zs(S);if(O.g!="")b&&(O.g=b+"."+O.g),wd(O,O.s);else{var j=a.location;O=j.protocol,b=b?b+"."+j.hostname:j.hostname,j=+j.port;var z=new Zs(null);O&&kd(z,O),b&&(z.g=b),j&&wd(z,j),S&&(z.l=S),O=z}return S=f.D,b=f.ya,S&&b&&Xe(O,S,b),Xe(O,"VER",f.la),Xl(f,O),O}function PT(f,b,S){if(b&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=f.Ca&&!f.pa?new ct(new Sd({eb:S})):new ct(f.pa),b.Ha(f.J),b}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function RT(){}t=RT.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Pd(){}Pd.prototype.g=function(f,b){return new Un(f,b)};function Un(f,b){q.call(this),this.g=new bT(b),this.l=f,this.h=b&&b.messageUrlParams||null,f=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(f?f["X-WebChannel-Content-Type"]=b.messageContentType:f={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(f?f["X-WebChannel-Client-Profile"]=b.va:f={"X-WebChannel-Client-Profile":b.va}),this.g.S=f,(f=b&&b.Sb)&&!w(f)&&(this.g.m=f),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!w(b)&&(this.g.D=b,f=this.h,f!==null&&b in f&&(f=this.h,b in f&&delete f[b])),this.j=new ea(this)}g(Un,q),Un.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Un.prototype.close=function(){Km(this.g)},Un.prototype.o=function(f){var b=this.g;if(typeof f=="string"){var S={};S.__data__=f,f=S}else this.u&&(S={},S.__data__=hi(f),f=S);b.i.push(new rM(b.Ya++,f)),b.G==3&&xd(b)},Un.prototype.N=function(){this.g.l=null,delete this.j,Km(this.g),delete this.g,Un.aa.N.call(this)};function AT(f){Um.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var b=f.__sm__;if(b){e:{for(const S in b){f=S;break e}f=void 0}(this.i=f)&&(f=this.i,b=b!==null&&f in b?b[f]:void 0),this.data=b}else this.data=f}g(AT,Um);function NT(){Fm.call(this),this.status=1}g(NT,Fm);function ea(f){this.g=f}g(ea,RT),ea.prototype.ua=function(){Y(this.g,"a")},ea.prototype.ta=function(f){Y(this.g,new AT(f))},ea.prototype.sa=function(f){Y(this.g,new NT)},ea.prototype.ra=function(){Y(this.g,"b")},Pd.prototype.createWebChannel=Pd.prototype.g,Un.prototype.send=Un.prototype.o,Un.prototype.open=Un.prototype.m,Un.prototype.close=Un.prototype.close,KR=function(){return new Pd},WR=function(){return gd()},HR=Ys,xv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},yd.NO_ERROR=0,yd.TIMEOUT=8,yd.HTTP_ERROR=6,Rf=yd,Gw.COMPLETE="complete",qR=Gw,zw.EventType=Bl,Bl.OPEN="a",Bl.CLOSE="b",Bl.ERROR="c",Bl.MESSAGE="d",q.prototype.listen=q.prototype.K,ku=zw,ct.prototype.listenOnce=ct.prototype.L,ct.prototype.getLastError=ct.prototype.Ka,ct.prototype.getLastErrorCode=ct.prototype.Ba,ct.prototype.getStatus=ct.prototype.Z,ct.prototype.getResponseJson=ct.prototype.Oa,ct.prototype.getResponseText=ct.prototype.oa,ct.prototype.send=ct.prototype.ea,ct.prototype.setWithCredentials=ct.prototype.Ha,zR=ct}).apply(typeof Qd<"u"?Qd:typeof self<"u"?self:typeof window<"u"?window:{});const C_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=new Mp("@firebase/firestore");function ua(){return Ao.logLevel}function ie(t,...e){if(Ao.logLevel<=Pe.DEBUG){const n=e.map(dk);Ao.debug(`Firestore (${Tl}): ${t}`,...n)}}function Mi(t,...e){if(Ao.logLevel<=Pe.ERROR){const n=e.map(dk);Ao.error(`Firestore (${Tl}): ${t}`,...n)}}function il(t,...e){if(Ao.logLevel<=Pe.WARN){const n=e.map(dk);Ao.warn(`Firestore (${Tl}): ${t}`,...n)}}function dk(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t="Unexpected state"){const e=`FIRESTORE (${Tl}) INTERNAL ASSERTION FAILED: `+t;throw Mi(e),new Error(e)}function je(t,e){t||he()}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class le extends Ur{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class TV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}}class SV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class _V{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){je(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Ii;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ii,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ii)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(je(typeof r.accessToken=="string"),new GR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string"),new Xt(e)}}class EV{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class CV{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new EV(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class xV{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IV{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){je(this.o===void 0);const r=s=>{s.error!=null&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(je(typeof n.token=="string"),this.R=n.token,new xV(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PV(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=PV(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Ae(t,e){return t<e?-1:t>e?1:0}function sl(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pn=class Af{static now(){return Af.fromMillis(Date.now())}static fromDate(e){return Af.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Af(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new le(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new le(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new le(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new le(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ae(this.nanoseconds,e.nanoseconds):Ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{static fromTimestamp(e){return new ge(e)}static min(){return new ge(new pn(0,0))}static max(){return new ge(new pn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(),r===void 0?r=e.length-n:r>e.length-n&&he(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return wc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof wc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class it extends wc{construct(e,n,r){return new it(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new le(J.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new it(n)}static emptyPath(){return new it([])}}const RV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jt extends wc{construct(e,n,r){return new jt(e,n,r)}static isValidIdentifier(e){return RV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new jt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new le(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new le(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new le(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new le(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jt(n)}static emptyPath(){return new jt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.path=e}static fromPath(e){return new ce(it.fromString(e))}static fromName(e){return new ce(it.fromString(e).popFirst(5))}static empty(){return new ce(it.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&it.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return it.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new it(e.slice()))}}function AV(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ge.fromTimestamp(r===1e9?new pn(n+1,0):new pn(n,r));return new Ls(i,ce.empty(),e)}function NV(t){return new Ls(t.readTime,t.key,-1)}class Ls{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ls(ge.min(),ce.empty(),-1)}static max(){return new Ls(ge.max(),ce.empty(),-1)}}function OV(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ce.comparator(t.documentKey,e.documentKey),n!==0?n:Ae(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class LV{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sl(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==DV)throw t;ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new K((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof K?n:K.resolve(n)}catch(n){return K.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):K.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):K.reject(n)}static resolve(e){return new K((n,r)=>{n(e)})}static reject(e){return new K((n,r)=>{r(e)})}static waitFor(e){return new K((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=K.resolve(!1);for(const r of e)n=n.next(i=>i?K.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new K((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(c=>{o[u]=c,++a,a===s&&r(o)},c=>i(c))}})}static doWhile(e,n){return new K((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function MV(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function _l(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Bp.oe=-1;function $p(t){return t==null}function Mh(t){return t===0&&1/t==-1/0}function UV(t){return typeof t=="number"&&Number.isInteger(t)&&!Mh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FV(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=x_(e)),e=jV(t.get(n),e);return x_(e)}function jV(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function x_(t){return t+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function JR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e,n){this.comparator=e,this.root=n||Ft.EMPTY}insert(e,n){return new ut(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ft.BLACK,null,null))}remove(e){return new ut(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jd(this.root,e,this.comparator,!0)}}class Jd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ft{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ft.RED,this.left=i??Ft.EMPTY,this.right=s??Ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ft(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ft.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw he();const e=this.left.check();if(e!==this.right.check())throw he();return e+(this.isRed()?0:1)}}Ft.EMPTY=null,Ft.RED=!0,Ft.BLACK=!1;Ft.EMPTY=new class{constructor(){this.size=0}get key(){throw he()}get value(){throw he()}get color(){throw he()}get left(){throw he()}get right(){throw he()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ft(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.comparator=e,this.data=new ut(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new P_(this.data.getIterator())}getIteratorFrom(e){return new P_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Pt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Pt(this.comparator);return n.data=e,n}}class P_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e){this.fields=e,e.sort(jt.comparator)}static empty(){return new Er([])}unionWith(e){let n=new Pt(jt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Er(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return sl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new YR("Invalid base64 string: "+s):s}}(e);return new qt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new qt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qt.EMPTY_BYTE_STRING=new qt("");const VV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ms(t){if(je(!!t),typeof t=="string"){let e=0;const n=VV.exec(t);if(je(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gt(t.seconds),nanos:gt(t.nanos)}}function gt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Us(t){return typeof t=="string"?qt.fromBase64String(t):qt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function zp(t){const e=t.mapValue.fields.__previous_value__;return fk(e)?zp(e):e}function Tc(t){const e=Ms(t.mapValue.fields.__local_write_time__.timestampValue);return new pn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Sc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Sc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Sc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Fs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fk(t)?4:zV(t)?9007199254740991:$V(t)?10:11:he()}function si(t,e){if(t===e)return!0;const n=Fs(t);if(n!==Fs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Tc(t).isEqual(Tc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ms(i.timestampValue),a=Ms(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Us(i.bytesValue).isEqual(Us(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return gt(i.geoPointValue.latitude)===gt(s.geoPointValue.latitude)&&gt(i.geoPointValue.longitude)===gt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return gt(i.integerValue)===gt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=gt(i.doubleValue),a=gt(s.doubleValue);return o===a?Mh(o)===Mh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return sl(t.arrayValue.values||[],e.arrayValue.values||[],si);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(I_(o)!==I_(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!si(o[l],a[l])))return!1;return!0}(t,e);default:return he()}}function _c(t,e){return(t.values||[]).find(n=>si(n,e))!==void 0}function ol(t,e){if(t===e)return 0;const n=Fs(t),r=Fs(e);if(n!==r)return Ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ae(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=gt(s.integerValue||s.doubleValue),l=gt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return R_(t.timestampValue,e.timestampValue);case 4:return R_(Tc(t),Tc(e));case 5:return Ae(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Us(s),l=Us(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const c=Ae(a[u],l[u]);if(c!==0)return c}return Ae(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ae(gt(s.latitude),gt(o.latitude));return a!==0?a:Ae(gt(s.longitude),gt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return A_(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,c;const d=s.fields||{},h=o.fields||{},p=(a=d.value)===null||a===void 0?void 0:a.arrayValue,g=(l=h.value)===null||l===void 0?void 0:l.arrayValue,m=Ae(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0);return m!==0?m:A_(p,g)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Yd.mapValue&&o===Yd.mapValue)return 0;if(s===Yd.mapValue)return 1;if(o===Yd.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},c=Object.keys(u);l.sort(),c.sort();for(let d=0;d<l.length&&d<c.length;++d){const h=Ae(l[d],c[d]);if(h!==0)return h;const p=ol(a[l[d]],u[c[d]]);if(p!==0)return p}return Ae(l.length,c.length)}(t.mapValue,e.mapValue);default:throw he()}}function R_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ae(t,e);const n=Ms(t),r=Ms(e),i=Ae(n.seconds,r.seconds);return i!==0?i:Ae(n.nanos,r.nanos)}function A_(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ol(n[i],r[i]);if(s)return s}return Ae(n.length,r.length)}function al(t){return Iv(t)}function Iv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ms(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Us(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ce.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Iv(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Iv(n.fields[o])}`;return i+"}"}(t.mapValue):he()}function Nf(t){switch(Fs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zp(t);return e?16+Nf(e):16;case 5:return 2*t.stringValue.length;case 6:return Us(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Nf(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return zo(r.fields,(s,o)=>{i+=s.length+Nf(o)}),i}(t.mapValue);default:throw he()}}function Pv(t){return!!t&&"integerValue"in t}function hk(t){return!!t&&"arrayValue"in t}function N_(t){return!!t&&"nullValue"in t}function O_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Of(t){return!!t&&"mapValue"in t}function $V(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Mu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return zo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Mu(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Mu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function zV(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.value=e}static empty(){return new nr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Of(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mu(n)}setAll(e){let n=jt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Mu(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Of(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return si(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Of(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){zo(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new nr(Mu(this.value))}}function XR(t){const e=[];return zo(t.fields,(n,r)=>{const i=new jt([n]);if(Of(r)){const s=XR(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Er(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new en(e,0,ge.min(),ge.min(),ge.min(),nr.empty(),0)}static newFoundDocument(e,n,r,i){return new en(e,1,n,ge.min(),r,i,0)}static newNoDocument(e,n){return new en(e,2,n,ge.min(),ge.min(),nr.empty(),0)}static newUnknownDocument(e,n){return new en(e,3,n,ge.min(),ge.min(),nr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ge.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n){this.position=e,this.inclusive=n}}function D_(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ce.comparator(ce.fromName(o.referenceValue),n.key):r=ol(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function L_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!si(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,n="asc"){this.field=e,this.dir=n}}function qV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ZR=class{};class xt extends ZR{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new WV(e,n,r):n==="array-contains"?new QV(e,r):n==="in"?new JV(e,r):n==="not-in"?new YV(e,r):n==="array-contains-any"?new XV(e,r):new xt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new KV(e,r):new GV(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ol(n,this.value)):n!==null&&Fs(this.value)===Fs(n)&&this.matchesComparison(ol(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oi extends ZR{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new oi(e,n)}matches(e){return eA(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function eA(t){return t.op==="and"}function tA(t){return HV(t)&&eA(t)}function HV(t){for(const e of t.filters)if(e instanceof oi)return!1;return!0}function Rv(t){if(t instanceof xt)return t.field.canonicalString()+t.op.toString()+al(t.value);if(tA(t))return t.filters.map(e=>Rv(e)).join(",");{const e=t.filters.map(n=>Rv(n)).join(",");return`${t.op}(${e})`}}function nA(t,e){return t instanceof xt?function(r,i){return i instanceof xt&&r.op===i.op&&r.field.isEqual(i.field)&&si(r.value,i.value)}(t,e):t instanceof oi?function(r,i){return i instanceof oi&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&nA(o,i.filters[a]),!0):!1}(t,e):void he()}function rA(t){return t instanceof xt?function(n){return`${n.field.canonicalString()} ${n.op} ${al(n.value)}`}(t):t instanceof oi?function(n){return n.op.toString()+" {"+n.getFilters().map(rA).join(" ,")+"}"}(t):"Filter"}class WV extends xt{constructor(e,n,r){super(e,n,r),this.key=ce.fromName(r.referenceValue)}matches(e){const n=ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class KV extends xt{constructor(e,n){super(e,"in",n),this.keys=iA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class GV extends xt{constructor(e,n){super(e,"not-in",n),this.keys=iA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function iA(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ce.fromName(r.referenceValue))}class QV extends xt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return hk(n)&&_c(n.arrayValue,this.value)}}class JV extends xt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&_c(this.value.arrayValue,n)}}class YV extends xt{constructor(e,n){super(e,"not-in",n)}matches(e){if(_c(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!_c(this.value.arrayValue,n)}}class XV extends xt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!hk(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>_c(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function M_(t,e=null,n=[],r=[],i=null,s=null,o=null){return new ZV(t,e,n,r,i,s,o)}function pk(t){const e=ve(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Rv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),$p(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>al(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>al(r)).join(",")),e.ue=n}return e.ue}function mk(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!qV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!nA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!L_(t.startAt,e.startAt)&&L_(t.endAt,e.endAt)}function Av(t){return ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function e6(t,e,n,r,i,s,o,a){return new qp(t,e,n,r,i,s,o,a)}function gk(t){return new qp(t)}function U_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function t6(t){return t.collectionGroup!==null}function Uu(t){const e=ve(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Pt(jt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Fh(s,r))}),n.has(jt.keyField().canonicalString())||e.ce.push(new Fh(jt.keyField(),r))}return e.ce}function ni(t){const e=ve(t);return e.le||(e.le=n6(e,Uu(t))),e.le}function n6(t,e){if(t.limitType==="F")return M_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Fh(i.field,s)});const n=t.endAt?new Uh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Uh(t.startAt.position,t.startAt.inclusive):null;return M_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Nv(t,e,n){return new qp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Hp(t,e){return mk(ni(t),ni(e))&&t.limitType===e.limitType}function sA(t){return`${pk(ni(t))}|lt:${t.limitType}`}function ca(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>rA(i)).join(", ")}]`),$p(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>al(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>al(i)).join(",")),`Target(${r})`}(ni(t))}; limitType=${t.limitType})`}function Wp(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ce.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Uu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=D_(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Uu(r),i)||r.endAt&&!function(o,a,l){const u=D_(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Uu(r),i))}(t,e)}function r6(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function oA(t){return(e,n)=>{let r=!1;for(const i of Uu(t)){const s=i6(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function i6(t,e,n){const r=t.field.isKeyField()?ce.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?ol(l,u):he()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zo(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return JR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=new ut(ce.comparator);function Ui(){return s6}const aA=new ut(ce.comparator);function wu(...t){let e=aA;for(const n of t)e=e.insert(n.key,n);return e}function lA(t){let e=aA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function uo(){return Fu()}function uA(){return Fu()}function Fu(){return new qo(t=>t.toString(),(t,e)=>t.isEqual(e))}const o6=new ut(ce.comparator),a6=new Pt(ce.comparator);function Re(...t){let e=a6;for(const n of t)e=e.add(n);return e}const l6=new Pt(Ae);function u6(){return l6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yk(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mh(e)?"-0":e}}function cA(t){return{integerValue:""+t}}function c6(t,e){return UV(e)?cA(e):yk(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(){this._=void 0}}function d6(t,e,n){return t instanceof jh?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&fk(s)&&(s=zp(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ec?fA(t,e):t instanceof Cc?hA(t,e):function(i,s){const o=dA(i,s),a=F_(o)+F_(i.Pe);return Pv(o)&&Pv(i.Pe)?cA(a):yk(i.serializer,a)}(t,e)}function f6(t,e,n){return t instanceof Ec?fA(t,e):t instanceof Cc?hA(t,e):n}function dA(t,e){return t instanceof Vh?function(r){return Pv(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class jh extends Kp{}class Ec extends Kp{constructor(e){super(),this.elements=e}}function fA(t,e){const n=pA(e);for(const r of t.elements)n.some(i=>si(i,r))||n.push(r);return{arrayValue:{values:n}}}class Cc extends Kp{constructor(e){super(),this.elements=e}}function hA(t,e){let n=pA(e);for(const r of t.elements)n=n.filter(i=>!si(i,r));return{arrayValue:{values:n}}}class Vh extends Kp{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function F_(t){return gt(t.integerValue||t.doubleValue)}function pA(t){return hk(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function h6(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ec&&i instanceof Ec||r instanceof Cc&&i instanceof Cc?sl(r.elements,i.elements,si):r instanceof Vh&&i instanceof Vh?si(r.Pe,i.Pe):r instanceof jh&&i instanceof jh}(t.transform,e.transform)}class p6{constructor(e,n){this.version=e,this.transformResults=n}}class Pi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Pi}static exists(e){return new Pi(void 0,e)}static updateTime(e){return new Pi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Df(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Gp{}function mA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new yA(t.key,Pi.none()):new Yc(t.key,t.data,Pi.none());{const n=t.data,r=nr.empty();let i=new Pt(jt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ho(t.key,r,new Er(i.toArray()),Pi.none())}}function m6(t,e,n){t instanceof Yc?function(i,s,o){const a=i.value.clone(),l=V_(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ho?function(i,s,o){if(!Df(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=V_(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(gA(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ju(t,e,n,r){return t instanceof Yc?function(s,o,a,l){if(!Df(s.precondition,o))return a;const u=s.value.clone(),c=B_(s.fieldTransforms,l,o);return u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ho?function(s,o,a,l){if(!Df(s.precondition,o))return a;const u=B_(s.fieldTransforms,l,o),c=o.data;return c.setAll(gA(s)),c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Df(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function g6(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=dA(r.transform,i||null);s!=null&&(n===null&&(n=nr.empty()),n.set(r.field,s))}return n||null}function j_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&sl(r,i,(s,o)=>h6(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Yc extends Gp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ho extends Gp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function gA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function V_(t,e,n){const r=new Map;je(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,f6(o,a,n[i]))}return r}function B_(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,d6(s,o,e))}return r}class yA extends Gp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class y6 extends Gp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&m6(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ju(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ju(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=uA();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=mA(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ge.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Re())}isEqual(e){return this.batchId===e.batchId&&sl(this.mutations,e.mutations,(n,r)=>j_(n,r))&&sl(this.baseMutations,e.baseMutations,(n,r)=>j_(n,r))}}class vk{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){je(e.mutations.length===r.length);let i=function(){return o6}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new vk(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt,Ne;function w6(t){switch(t){default:return he();case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0}}function vA(t){if(t===void 0)return Mi("GRPC error has no .code"),J.UNKNOWN;switch(t){case bt.OK:return J.OK;case bt.CANCELLED:return J.CANCELLED;case bt.UNKNOWN:return J.UNKNOWN;case bt.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case bt.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case bt.INTERNAL:return J.INTERNAL;case bt.UNAVAILABLE:return J.UNAVAILABLE;case bt.UNAUTHENTICATED:return J.UNAUTHENTICATED;case bt.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case bt.NOT_FOUND:return J.NOT_FOUND;case bt.ALREADY_EXISTS:return J.ALREADY_EXISTS;case bt.PERMISSION_DENIED:return J.PERMISSION_DENIED;case bt.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case bt.ABORTED:return J.ABORTED;case bt.OUT_OF_RANGE:return J.OUT_OF_RANGE;case bt.UNIMPLEMENTED:return J.UNIMPLEMENTED;case bt.DATA_LOSS:return J.DATA_LOSS;default:return he()}}(Ne=bt||(bt={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T6(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6=new vo([4294967295,4294967295],0);function $_(t){const e=T6().encode(t),n=new $R;return n.update(e),new Uint8Array(n.digest())}function z_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new vo([n,r],0),new vo([i,s],0)]}class bk{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Tu(`Invalid padding: ${n}`);if(r<0)throw new Tu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Tu(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Tu(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ie=vo.fromNumber(this.Te)}Ee(e,n,r){let i=e.add(n.multiply(vo.fromNumber(r)));return i.compare(S6)===1&&(i=new vo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const n=$_(e),[r,i]=z_(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new bk(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const n=$_(e),[r,i]=z_(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Tu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Xc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Qp(ge.min(),i,new ut(Ae),Ui(),Re())}}class Xc{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Xc(r,n,Re(),Re(),Re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class bA{constructor(e,n){this.targetId=e,this.me=n}}class kA{constructor(e,n,r=qt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class q_{constructor(){this.fe=0,this.ge=H_(),this.pe=qt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Re(),n=Re(),r=Re();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:he()}}),new Xc(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=H_()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,je(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class _6{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ui(),this.qe=Xd(),this.Qe=Xd(),this.Ke=new ut(Ae)}$e(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(n,e.Ve):this.We(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.We(n,e.key,e.Ve)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.je(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.De(e.resumeToken));break;default:he()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.me.count,i=this.Ye(n);if(i){const s=i.target;if(Av(s))if(r===0){const o=new ce(s.path);this.We(n,o,en.newNoDocument(o,ge.min()))}else je(r===1);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}}}}}Xe(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Us(r).toUint8Array()}catch(l){if(l instanceof YR)return il("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new bk(o,i,s)}catch(l){return il(l instanceof Tu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,n,r){return n.me.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&Av(a.target)){const l=new ce(a.target.path);this.st(l).has(o)||this.ot(o,l)||this.We(o,l,en.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Re();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Ye(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Qp(e,n,this.Ke,this.ke,r);return this.ke=Ui(),this.qe=Xd(),this.Qe=Xd(),this.Ke=new ut(Ae),i}Ue(e,n){if(!this.je(e))return;const r=this.ot(e,n.key)?2:0;this.ze(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e)),this.Qe=this.Qe.insert(n.key,this._t(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.ot(e,n)?i.Fe(n,1):i.Me(n),this.Qe=this.Qe.insert(n,this._t(n).delete(e)),this.Qe=this.Qe.insert(n,this._t(n).add(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let n=this.Be.get(e);return n||(n=new q_,this.Be.set(e,n)),n}_t(e){let n=this.Qe.get(e);return n||(n=new Pt(Ae),this.Qe=this.Qe.insert(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Pt(Ae),this.qe=this.qe.insert(e,n)),n}je(e){const n=this.Ye(e)!==null;return n||ie("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new q_),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}ot(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Xd(){return new ut(ce.comparator)}function H_(){return new ut(ce.comparator)}const E6={asc:"ASCENDING",desc:"DESCENDING"},C6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},x6={and:"AND",or:"OR"};class I6{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ov(t,e){return t.useProto3Json||$p(e)?e:{value:e}}function Bh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function P6(t,e){return Bh(t,e.toTimestamp())}function ri(t){return je(!!t),ge.fromTimestamp(function(n){const r=Ms(n);return new pn(r.seconds,r.nanos)}(t))}function kk(t,e){return Dv(t,e).canonicalString()}function Dv(t,e){const n=function(i){return new it(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function TA(t){const e=it.fromString(t);return je(xA(e)),e}function Lv(t,e){return kk(t.databaseId,e.path)}function Ag(t,e){const n=TA(e);if(n.get(1)!==t.databaseId.projectId)throw new le(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new le(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ce(_A(n))}function SA(t,e){return kk(t.databaseId,e)}function R6(t){const e=TA(t);return e.length===4?it.emptyPath():_A(e)}function Mv(t){return new it(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _A(t){return je(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function W_(t,e,n){return{name:Lv(t,e),fields:n.value.mapValue.fields}}function A6(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:he()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?(je(c===void 0||typeof c=="string"),qt.fromBase64String(c||"")):(je(c===void 0||c instanceof Buffer||c instanceof Uint8Array),qt.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const c=u.code===void 0?J.UNKNOWN:vA(u.code);return new le(c,u.message||"")}(o);n=new kA(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ag(t,r.document.name),s=ri(r.document.updateTime),o=r.document.createTime?ri(r.document.createTime):ge.min(),a=new nr({mapValue:{fields:r.document.fields}}),l=en.newFoundDocument(i,s,o,a),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Lf(u,c,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ag(t,r.document),s=r.readTime?ri(r.readTime):ge.min(),o=en.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Lf([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ag(t,r.document),s=r.removedTargetIds||[];n=new Lf([],s,i,null)}else{if(!("filter"in e))return he();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new k6(i,s),a=r.targetId;n=new bA(a,o)}}return n}function N6(t,e){let n;if(e instanceof Yc)n={update:W_(t,e.key,e.value)};else if(e instanceof yA)n={delete:Lv(t,e.key)};else if(e instanceof Ho)n={update:W_(t,e.key,e.data),updateMask:B6(e.fieldMask)};else{if(!(e instanceof y6))return he();n={verify:Lv(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof jh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ec)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Cc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Vh)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw he()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:P6(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:he()}(t,e.precondition)),n}function O6(t,e){return t&&t.length>0?(je(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ri(i.updateTime):ri(s);return o.isEqual(ge.min())&&(o=ri(s)),new p6(o,i.transformResults||[])}(n,e))):[]}function D6(t,e){return{documents:[SA(t,e.path)]}}function L6(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=SA(t,i);const s=function(u){if(u.length!==0)return CA(oi.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(c=>function(h){return{field:da(h.field),direction:F6(h.dir)}}(c))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Ov(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ct:n,parent:i}}function M6(t){let e=R6(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){je(r===1);const c=n.from[0];c.allDescendants?i=c.collectionId:e=e.child(c.collectionId)}let s=[];n.where&&(s=function(d){const h=EA(d);return h instanceof oi&&tA(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(g){return new Fh(fa(g.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,$p(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(d){const h=!!d.before,p=d.values||[];return new Uh(p,h)}(n.startAt));let u=null;return n.endAt&&(u=function(d){const h=!d.before,p=d.values||[];return new Uh(p,h)}(n.endAt)),e6(e,i,o,s,a,"F",l,u)}function U6(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function EA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=fa(n.unaryFilter.field);return xt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=fa(n.unaryFilter.field);return xt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=fa(n.unaryFilter.field);return xt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=fa(n.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return he()}}(t):t.fieldFilter!==void 0?function(n){return xt.create(fa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return he()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return oi.create(n.compositeFilter.filters.map(r=>EA(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he()}}(n.compositeFilter.op))}(t):he()}function F6(t){return E6[t]}function j6(t){return C6[t]}function V6(t){return x6[t]}function da(t){return{fieldPath:t.canonicalString()}}function fa(t){return jt.fromServerFormat(t.fieldPath)}function CA(t){return t instanceof xt?function(n){if(n.op==="=="){if(O_(n.value))return{unaryFilter:{field:da(n.field),op:"IS_NAN"}};if(N_(n.value))return{unaryFilter:{field:da(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(O_(n.value))return{unaryFilter:{field:da(n.field),op:"IS_NOT_NAN"}};if(N_(n.value))return{unaryFilter:{field:da(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:da(n.field),op:j6(n.op),value:n.value}}}(t):t instanceof oi?function(n){const r=n.getFilters().map(i=>CA(i));return r.length===1?r[0]:{compositeFilter:{op:V6(n.op),filters:r}}}(t):he()}function B6(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function xA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,n,r,i,s=ge.min(),o=ge.min(),a=qt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ys(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(e){this.ht=e}}function z6(t){const e=M6({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Nv(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(){this.ln=new H6}addToCollectionParentIndex(e,n){return this.ln.add(n),K.resolve()}getCollectionParents(e,n){return K.resolve(this.ln.getEntries(n))}addFieldIndex(e,n){return K.resolve()}deleteFieldIndex(e,n){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,n){return K.resolve()}getDocumentsMatchingTarget(e,n){return K.resolve(null)}getIndexType(e,n){return K.resolve(0)}getFieldIndexes(e,n){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,n){return K.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,n){return K.resolve(Ls.min())}updateCollectionGroup(e,n,r){return K.resolve()}updateIndexEntries(e,n){return K.resolve()}}class H6{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Pt(it.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Pt(it.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class vn{static withCacheSize(e){return new vn(e,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn.DEFAULT_COLLECTION_PERCENTILE=10,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vn.DEFAULT=new vn(41943040,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vn.DISABLED=new vn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new ll(0)}static Qn(){return new ll(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G_([t,e],[n,r]){const i=Ae(t,n);return i===0?Ae(e,r):i}class W6{constructor(e){this.Gn=e,this.buffer=new Pt(G_),this.zn=0}jn(){return++this.zn}Hn(e){const n=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();G_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class K6{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){ie("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){_l(n)?ie("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Sl(n)}await this.Yn(3e5)})}}class G6{constructor(e,n){this.Zn=e,this.params=n}calculateTargetCount(e,n){return this.Zn.Xn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return K.resolve(Bp.oe);const r=new W6(n);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ie("LruGarbageCollector","Garbage collection skipped; disabled"),K.resolve(K_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),K_):this.tr(e,n))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,n){let r,i,s,o,a,l,u;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),ua()<=Pe.DEBUG&&ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-c}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(u-l)+`ms
Total Duration: ${u-c}ms`),K.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function Q6(t,e){return new G6(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(){this.changes=new qo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?K.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&ju(r.mutation,i,Er.empty(),pn.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Re()){const i=uo();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=wu();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=uo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Re()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Ui();const o=Fu(),a=function(){return Fu()}();return n.forEach((l,u)=>{const c=r.get(u.key);i.has(u.key)&&(c===void 0||c.mutation instanceof Ho)?s=s.insert(u.key,u):c!==void 0?(o.set(u.key,c.mutation.getFieldMask()),ju(c.mutation,u,c.mutation.getFieldMask(),pn.now())):o.set(u.key,Er.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,c)=>o.set(u,c)),n.forEach((u,c)=>{var d;return a.set(u,new Y6(c,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Fu();let i=new ut((o,a)=>o-a),s=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let c=r.get(l)||Er.empty();c=a.applyToLocalView(u,c),r.set(l,c);const d=(i.get(a.batchId)||Re()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,c=l.value,d=uA();c.forEach(h=>{if(!s.has(h)){const p=mA(n.get(h),r.get(h));p!==null&&d.set(h,p),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return K.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ce.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):t6(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):K.resolve(uo());let a=-1,l=s;return o.next(u=>K.forEach(u,(c,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(c)?K.resolve():this.remoteDocumentCache.getEntry(e,c).next(h=>{l=l.insert(c,h)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Re())).next(c=>({batchId:a,changes:lA(c)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ce(n)).next(r=>{let i=wu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=wu();return this.indexManager.getCollectionParents(e,s).next(a=>K.forEach(a,l=>{const u=function(d,h){return new qp(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(c=>{c.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const c=u.getKey();o.get(c)===null&&(o=o.insert(c,en.newInvalidDocument(c)))});let a=wu();return o.forEach((l,u)=>{const c=s.get(l);c!==void 0&&ju(c.mutation,u,Er.empty(),pn.now()),Wp(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,n){return K.resolve(this.Tr.get(n))}saveBundleMetadata(e,n){return this.Tr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ri(i.createTime)}}(n)),K.resolve()}getNamedQuery(e,n){return K.resolve(this.Ir.get(n))}saveNamedQuery(e,n){return this.Ir.set(n.name,function(i){return{name:i.name,query:z6(i.bundledQuery),readTime:ri(i.readTime)}}(n)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e9{constructor(){this.overlays=new ut(ce.comparator),this.Er=new Map}getOverlay(e,n){return K.resolve(this.overlays.get(n))}getOverlays(e,n){const r=uo();return K.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.Tt(e,n,s)}),K.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Er.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Er.delete(r)),K.resolve()}getOverlaysForCollection(e,n,r){const i=uo(),s=n.length+1,o=new ce(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return K.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new ut((u,c)=>u-c);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let c=s.get(u.largestBatchId);c===null&&(c=uo(),s=s.insert(u.largestBatchId,c)),c.set(u.getKey(),u)}}const a=uo(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,c)=>a.set(u,c)),!(a.size()>=i)););return K.resolve(a)}Tt(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Er.get(i.largestBatchId).delete(r.key);this.Er.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new b6(n,r));let s=this.Er.get(n);s===void 0&&(s=Re(),this.Er.set(n,s)),this.Er.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{constructor(){this.sessionToken=qt.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(){this.dr=new Pt(Rt.Ar),this.Rr=new Pt(Rt.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,n){const r=new Rt(e,n);this.dr=this.dr.add(r),this.Rr=this.Rr.add(r)}mr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.gr(new Rt(e,n))}pr(e,n){e.forEach(r=>this.removeReference(r,n))}yr(e){const n=new ce(new it([])),r=new Rt(n,e),i=new Rt(n,e+1),s=[];return this.Rr.forEachInRange([r,i],o=>{this.gr(o),s.push(o.key)}),s}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const n=new ce(new it([])),r=new Rt(n,e),i=new Rt(n,e+1);let s=Re();return this.Rr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Rt(e,0),r=this.dr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Rt{constructor(e,n){this.key=e,this.br=n}static Ar(e,n){return ce.comparator(e.key,n.key)||Ae(e.br,n.br)}static Vr(e,n){return Ae(e.br,n.br)||ce.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Dr=1,this.vr=new Pt(Rt.Ar)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new v6(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.vr=this.vr.add(new Rt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return K.resolve(o)}lookupMutationBatch(e,n){return K.resolve(this.Cr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.Fr(r),s=i<0?0:i;return K.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Rt(n,0),i=new Rt(n,Number.POSITIVE_INFINITY),s=[];return this.vr.forEachInRange([r,i],o=>{const a=this.Cr(o.br);s.push(a)}),K.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Pt(Ae);return n.forEach(i=>{const s=new Rt(i,0),o=new Rt(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([s,o],a=>{r=r.add(a.br)})}),K.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ce.isDocumentKey(s)||(s=s.child(""));const o=new Rt(new ce(s),0);let a=new Pt(Ae);return this.vr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.br)),!0)},o),K.resolve(this.Mr(a))}Mr(e){const n=[];return e.forEach(r=>{const i=this.Cr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){je(this.Or(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return K.forEach(n.mutations,i=>{const s=new Rt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Ln(e){}containsKey(e,n){const r=new Rt(n,0),i=this.vr.firstAfterOrEqual(r);return K.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}Or(e,n){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const n=this.Fr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r9{constructor(e){this.Nr=e,this.docs=function(){return new ut(ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Nr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return K.resolve(r?r.document.mutableCopy():en.newInvalidDocument(n))}getEntries(e,n){let r=Ui();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():en.newInvalidDocument(i))}),K.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Ui();const o=n.path,a=new ce(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:c}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||OV(NV(c),r)<=0||(i.has(c.key)||Wp(n,c))&&(s=s.insert(c.key,c.mutableCopy()))}return K.resolve(s)}getAllFromCollectionGroup(e,n,r,i){he()}Lr(e,n){return K.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new i9(this)}getSize(e){return K.resolve(this.size)}}class i9 extends J6{constructor(e){super(),this.hr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),K.waitFor(n)}getFromCache(e,n){return this.hr.getEntry(e,n)}getAllFromCache(e,n){return this.hr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e){this.persistence=e,this.Br=new qo(n=>pk(n),mk),this.lastRemoteSnapshotVersion=ge.min(),this.highestTargetId=0,this.kr=0,this.qr=new wk,this.targetCount=0,this.Qr=ll.qn()}forEachTarget(e,n){return this.Br.forEach((r,i)=>n(i)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.kr&&(this.kr=n),K.resolve()}Un(e){this.Br.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Qr=new ll(n),this.highestTargetId=n),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,n){return this.Un(n),this.targetCount+=1,K.resolve()}updateTargetData(e,n){return this.Un(n),K.resolve()}removeTargetData(e,n){return this.Br.delete(n.target),this.qr.yr(n.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Br.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Br.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),K.waitFor(s).next(()=>i)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,n){const r=this.Br.get(n)||null;return K.resolve(r)}addMatchingKeys(e,n,r){return this.qr.mr(n,r),K.resolve()}removeMatchingKeys(e,n,r){this.qr.pr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),K.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.qr.yr(n),K.resolve()}getMatchingKeysForTargetId(e,n){const r=this.qr.Sr(n);return K.resolve(r)}containsKey(e,n){return K.resolve(this.qr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e,n){this.Kr={},this.overlays={},this.$r=new Bp(0),this.Ur=!1,this.Ur=!0,this.Wr=new t9,this.referenceDelegate=e(this),this.Gr=new s9(this),this.indexManager=new q6,this.remoteDocumentCache=function(i){return new r9(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new $6(n),this.jr=new Z6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new e9,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Kr[e.toKey()];return r||(r=new n9(n,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,n,r){ie("MemoryPersistence","Starting transaction:",e);const i=new o9(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(s=>this.referenceDelegate.Jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Yr(e,n){return K.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,n)))}}class o9 extends LV{constructor(e){super(),this.currentSequenceNumber=e}}class Tk{constructor(e){this.persistence=e,this.Zr=new wk,this.Xr=null}static ei(e){return new Tk(e)}get ti(){if(this.Xr)return this.Xr;throw he()}addReference(e,n,r){return this.Zr.addReference(r,n),this.ti.delete(r.toString()),K.resolve()}removeReference(e,n,r){return this.Zr.removeReference(r,n),this.ti.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,n){return this.ti.add(n.toString()),K.resolve()}removeTarget(e,n){this.Zr.yr(n.targetId).forEach(i=>this.ti.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.ti.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Hr(){this.Xr=new Set}Jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.ti,r=>{const i=ce.fromPath(r);return this.ni(e,i).next(s=>{s||n.removeEntry(i,ge.min())})}).next(()=>(this.Xr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ni(e,n).next(r=>{r?this.ti.delete(n.toString()):this.ti.add(n.toString())})}zr(e){return 0}ni(e,n){return K.or([()=>K.resolve(this.Zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Yr(e,n)])}}class $h{constructor(e,n){this.persistence=e,this.ri=new qo(r=>FV(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Q6(this,n)}static ei(e,n){return new $h(e,n)}Hr(){}Jr(e){return K.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Xn(e){const n=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}nr(e){let n=0;return this.er(e,r=>{n++}).next(()=>n)}er(e,n){return K.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(s=>s?K.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Lr(e,o=>this.ir(e,o,n).next(a=>{a||(r++,s.removeEntry(o,ge.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ri.set(n,e.currentSequenceNumber),K.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),K.resolve()}removeReference(e,n,r){return this.ri.set(r,e.currentSequenceNumber),K.resolve()}updateLimboDocument(e,n){return this.ri.set(n,e.currentSequenceNumber),K.resolve()}zr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Nf(e.data.value)),n}ir(e,n,r){return K.or([()=>this.persistence.Yr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.ri.get(n);return K.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Wi=r,this.Gi=i}static zi(e,n){let r=Re(),i=Re();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Sk(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a9{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return i3()?8:MV(sn())>0?6:4}()}initialize(e,n){this.Zi=e,this.indexManager=n,this.ji=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Xi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.es(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new a9;return this.ts(e,n,o).next(a=>{if(s.result=a,this.Hi)return this.ns(e,n,o,a.size)})}).next(()=>s.result)}ns(e,n,r,i){return r.documentReadCount<this.Ji?(ua()<=Pe.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",ca(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),K.resolve()):(ua()<=Pe.DEBUG&&ie("QueryEngine","Query:",ca(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(ua()<=Pe.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",ca(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ni(n))):K.resolve())}Xi(e,n){if(U_(n))return K.resolve(null);let r=ni(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Nv(n,null,"F"),r=ni(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Re(...s);return this.Zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.rs(n,a);return this.ss(n,u,o,l.readTime)?this.Xi(e,Nv(n,null,"F")):this.os(e,u,n,l)}))})))}es(e,n,r,i){return U_(n)||i.isEqual(ge.min())?K.resolve(null):this.Zi.getDocuments(e,r).next(s=>{const o=this.rs(n,s);return this.ss(n,o,r,i)?K.resolve(null):(ua()<=Pe.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ca(n)),this.os(e,o,n,AV(i,-1)).next(a=>a))})}rs(e,n){let r=new Pt(oA(e));return n.forEach((i,s)=>{Wp(e,s)&&(r=r.add(s))}),r}ss(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ts(e,n,r){return ua()<=Pe.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",ca(n)),this.Zi.getDocumentsMatchingQuery(e,n,Ls.min(),r)}os(e,n,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{constructor(e,n,r,i){this.persistence=e,this._s=n,this.serializer=i,this.us=new ut(Ae),this.cs=new qo(s=>pk(s),mk),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new X6(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.us))}}function c9(t,e,n,r){return new u9(t,e,n,r)}async function PA(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Ps(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Re();for(const u of i){o.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}for(const u of s){a.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}return n.localDocuments.getDocuments(r,l).next(u=>({Ts:u,removedBatchIds:o,addedBatchIds:a}))})})}function d9(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.hs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,c){const d=u.batch,h=d.keys();let p=K.resolve();return h.forEach(g=>{p=p.next(()=>c.getEntry(l,g)).next(m=>{const k=u.docVersions.get(g);je(k!==null),m.version.compareTo(k)<0&&(d.applyToRemoteDocument(m,u),m.isValidDocument()&&(m.setReadTime(u.commitVersion),c.addEntry(m)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Re();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function RA(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Gr.getLastRemoteSnapshotVersion(n))}function f9(t,e){const n=ve(t),r=e.snapshotVersion;let i=n.us;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.hs.newChangeBuffer({trackRemovals:!0});i=n.us;const a=[];e.targetChanges.forEach((c,d)=>{const h=i.get(d);if(!h)return;a.push(n.Gr.removeMatchingKeys(s,c.removedDocuments,d).next(()=>n.Gr.addMatchingKeys(s,c.addedDocuments,d)));let p=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(qt.EMPTY_BYTE_STRING,ge.min()).withLastLimboFreeSnapshotVersion(ge.min()):c.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(c.resumeToken,r)),i=i.insert(d,p),function(m,k,y){return m.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(h,p,c)&&a.push(n.Gr.updateTargetData(s,p))});let l=Ui(),u=Re();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,c))}),a.push(h9(s,o,e.documentUpdates).next(c=>{l=c.Is,u=c.Es})),!r.isEqual(ge.min())){const c=n.Gr.getLastRemoteSnapshotVersion(s).next(d=>n.Gr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(c)}return K.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.us=i,s))}function h9(t,e,n){let r=Re(),i=Re();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Ui();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ge.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ie("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Is:o,Es:i}})}function p9(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function m9(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Gr.getTargetData(r,e).next(s=>s?(i=s,K.resolve(i)):n.Gr.allocateTargetId(r).next(o=>(i=new ys(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.us=n.us.insert(r.targetId,r),n.cs.set(e,r.targetId)),r})}async function Uv(t,e,n){const r=ve(t),i=r.us.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!_l(o))throw o;ie("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.us=r.us.remove(e),r.cs.delete(i.target)}function Q_(t,e,n){const r=ve(t);let i=ge.min(),s=Re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,c){const d=ve(l),h=d.cs.get(c);return h!==void 0?K.resolve(d.us.get(h)):d.Gr.getTargetData(u,c)}(r,o,ni(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r._s.getDocumentsMatchingQuery(o,e,n?i:ge.min(),n?s:Re())).next(a=>(g9(r,r6(e),a),{documents:a,ds:s})))}function g9(t,e,n){let r=t.ls.get(e)||ge.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ls.set(e,r)}class J_{constructor(){this.activeTargetIds=u6()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class y9{constructor(){this._o=new J_,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,n,r){this.ao[e]=n}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new J_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zd=null;function Ng(){return Zd===null?Zd=function(){return 268435456+Math.round(2147483648*Math.random())}():Zd++,"0x"+Zd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k9{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="WebChannelConnection";class w9 extends class{get Co(){return!1}constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+n.host,this.Mo=`projects/${i}/databases/${s}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Oo(n,r,i,s,o){const a=Ng(),l=this.No(n,r.toUriEncodedString());ie("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(u,s,o),this.Bo(n,l,u,i).then(c=>(ie("RestConnection",`Received RPC '${n}' ${a}: `,c),c),c=>{throw il("RestConnection",`RPC '${n}' ${a} failed with error: `,c,"url: ",l,"request:",i),c})}ko(n,r,i,s,o,a){return this.Oo(n,r,i,s,o)}Lo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}No(n,r){const i=b9[n];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,n,r,i){const s=Ng();return new Promise((o,a)=>{const l=new zR;l.setWithCredentials(!0),l.listenOnce(qR.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Rf.NO_ERROR:const c=l.getResponseJson();ie(Qt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(c)),o(c);break;case Rf.TIMEOUT:ie(Qt,`RPC '${e}' ${s} timed out`),a(new le(J.DEADLINE_EXCEEDED,"Request time out"));break;case Rf.HTTP_ERROR:const d=l.getStatus();if(ie(Qt,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const g=function(k){const y=k.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(y)>=0?y:J.UNKNOWN}(p.status);a(new le(g,p.message))}else a(new le(J.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new le(J.UNAVAILABLE,"Connection failed."));break;default:he()}}finally{ie(Qt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);ie(Qt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}qo(e,n,r){const i=Ng(),s=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=KR(),a=WR(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Lo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const c=s.join("");ie(Qt,`Creating RPC '${e}' stream ${i}: ${c}`,l);const d=o.createWebChannel(c,l);let h=!1,p=!1;const g=new k9({Eo:k=>{p?ie(Qt,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(h||(ie(Qt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),ie(Qt,`RPC '${e}' stream ${i} sending:`,k),d.send(k))},Ao:()=>d.close()}),m=(k,y,w)=>{k.listen(y,T=>{try{w(T)}catch(x){setTimeout(()=>{throw x},0)}})};return m(d,ku.EventType.OPEN,()=>{p||(ie(Qt,`RPC '${e}' stream ${i} transport opened.`),g.So())}),m(d,ku.EventType.CLOSE,()=>{p||(p=!0,ie(Qt,`RPC '${e}' stream ${i} transport closed`),g.Do())}),m(d,ku.EventType.ERROR,k=>{p||(p=!0,il(Qt,`RPC '${e}' stream ${i} transport errored:`,k),g.Do(new le(J.UNAVAILABLE,"The operation could not be completed")))}),m(d,ku.EventType.MESSAGE,k=>{var y;if(!p){const w=k.data[0];je(!!w);const T=w,x=(T==null?void 0:T.error)||((y=T[0])===null||y===void 0?void 0:y.error);if(x){ie(Qt,`RPC '${e}' stream ${i} received error:`,x);const I=x.status;let R=function(P){const N=bt[P];if(N!==void 0)return vA(N)}(I),C=x.message;R===void 0&&(R=J.INTERNAL,C="Unknown error status: "+I+" with message "+x.message),p=!0,g.Do(new le(R,C)),d.close()}else ie(Qt,`RPC '${e}' stream ${i} received:`,w),g.vo(w)}}),m(a,HR.STAT_EVENT,k=>{k.stat===xv.PROXY?ie(Qt,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===xv.NOPROXY&&ie(Qt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.bo()},0),g}}function Og(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(t){return new I6(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e,n,r=1e3,i=1.5,s=6e4){this.li=e,this.timerId=n,this.Qo=r,this.Ko=i,this.$o=s,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const n=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,n-r);i>0&&ie("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e,n,r,i,s,o,a,l){this.li=e,this.Yo=r,this.Zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new AA(e,n)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,n){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(Mi(n.toString()),Mi("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(n)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),n=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===n&&this.I_(r,i)},r=>{e(()=>{const i=new le(J.UNKNOWN,"Fetching auth token failed: "+r.message);return this.E_(i)})})}I_(e,n){const r=this.T_(this.Xo);this.stream=this.d_(e,n),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.E_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return n=>{this.li.enqueueAndForget(()=>this.Xo===e?n():(ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class T9 extends NA{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}d_(e,n){return this.connection.qo("Listen",e,n)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const n=A6(this.serializer,e),r=function(s){if(!("targetChange"in s))return ge.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ge.min():o.readTime?ri(o.readTime):ge.min()}(e);return this.listener.R_(n,r)}V_(e){const n={};n.database=Mv(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Av(l)?{documents:D6(s,l)}:{query:L6(s,l).ct},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=wA(s,o.resumeToken);const u=Ov(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ge.min())>0){a.readTime=Bh(s,o.snapshotVersion.toTimestamp());const u=Ov(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=U6(this.serializer,e);r&&(n.labels=r),this.c_(n)}m_(e){const n={};n.database=Mv(this.serializer),n.removeTarget=e,this.c_(n)}}class S9 extends NA{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,n){return this.connection.qo("Write",e,n)}A_(e){return je(!!e.streamToken),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){je(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const n=O6(e.writeResults,e.commitTime),r=ri(e.commitTime);return this.listener.y_(r,n)}w_(){const e={};e.database=Mv(this.serializer),this.c_(e)}g_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>N6(this.serializer,r))};this.c_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _9 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new le(J.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,n,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Oo(e,Dv(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new le(J.UNKNOWN,s.toString())})}ko(e,n,r,i,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.ko(e,Dv(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new le(J.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class E9{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Mi(n),this.C_=!1):ie("OnlineStateTracker",n)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=s,this.Q_.uo(o=>{r.enqueueAndForget(async()=>{Wo(this)&&(ie("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=ve(l);u.k_.add(4),await Zc(u),u.K_.set("Unknown"),u.k_.delete(4),await Yp(u)}(this))})}),this.K_=new E9(r,i)}}async function Yp(t){if(Wo(t))for(const e of t.q_)await e(!0)}async function Zc(t){for(const e of t.q_)await e(!1)}function OA(t,e){const n=ve(t);n.B_.has(e.targetId)||(n.B_.set(e.targetId,e),xk(n)?Ck(n):El(n).s_()&&Ek(n,e))}function _k(t,e){const n=ve(t),r=El(n);n.B_.delete(e),r.s_()&&DA(n,e),n.B_.size===0&&(r.s_()?r.a_():Wo(n)&&n.K_.set("Unknown"))}function Ek(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ge.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}El(t).V_(e)}function DA(t,e){t.U_.xe(e),El(t).m_(e)}function Ck(t){t.U_=new _6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),El(t).start(),t.K_.F_()}function xk(t){return Wo(t)&&!El(t).i_()&&t.B_.size>0}function Wo(t){return ve(t).k_.size===0}function LA(t){t.U_=void 0}async function x9(t){t.K_.set("Online")}async function I9(t){t.B_.forEach((e,n)=>{Ek(t,e)})}async function P9(t,e){LA(t),xk(t)?(t.K_.O_(e),Ck(t)):t.K_.set("Unknown")}async function R9(t,e,n){if(t.K_.set("Online"),e instanceof kA&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.B_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.B_.delete(a),i.U_.removeTarget(a))}(t,e)}catch(r){ie("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zh(t,r)}else if(e instanceof Lf?t.U_.$e(e):e instanceof bA?t.U_.Je(e):t.U_.Ge(e),!n.isEqual(ge.min()))try{const r=await RA(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.U_.it(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const c=s.B_.get(u);c&&s.B_.set(u,c.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const c=s.B_.get(l);if(!c)return;s.B_.set(l,c.withResumeToken(qt.EMPTY_BYTE_STRING,c.snapshotVersion)),DA(s,l);const d=new ys(c.target,l,u,c.sequenceNumber);Ek(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ie("RemoteStore","Failed to raise snapshot:",r),await zh(t,r)}}async function zh(t,e,n){if(!_l(e))throw e;t.k_.add(1),await Zc(t),t.K_.set("Offline"),n||(n=()=>RA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ie("RemoteStore","Retrying IndexedDB access"),await n(),t.k_.delete(1),await Yp(t)})}function MA(t,e){return e().catch(n=>zh(t,n,e))}async function Xp(t){const e=ve(t),n=js(e);let r=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;A9(e);)try{const i=await p9(e.localStore,r);if(i===null){e.L_.length===0&&n.a_();break}r=i.batchId,N9(e,i)}catch(i){await zh(e,i)}UA(e)&&FA(e)}function A9(t){return Wo(t)&&t.L_.length<10}function N9(t,e){t.L_.push(e);const n=js(t);n.s_()&&n.f_&&n.g_(e.mutations)}function UA(t){return Wo(t)&&!js(t).i_()&&t.L_.length>0}function FA(t){js(t).start()}async function O9(t){js(t).w_()}async function D9(t){const e=js(t);for(const n of t.L_)e.g_(n.mutations)}async function L9(t,e,n){const r=t.L_.shift(),i=vk.from(r,e,n);await MA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Xp(t)}async function M9(t,e){e&&js(t).f_&&await async function(r,i){if(function(o){return w6(o)&&o!==J.ABORTED}(i.code)){const s=r.L_.shift();js(r).__(),await MA(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Xp(r)}}(t,e),UA(t)&&FA(t)}async function X_(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),ie("RemoteStore","RemoteStore received new credentials");const r=Wo(n);n.k_.add(3),await Zc(n),r&&n.K_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.k_.delete(3),await Yp(n)}async function U9(t,e){const n=ve(t);e?(n.k_.delete(2),await Yp(n)):e||(n.k_.add(2),await Zc(n),n.K_.set("Unknown"))}function El(t){return t.W_||(t.W_=function(n,r,i){const s=ve(n);return s.b_(),new T9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Ro:x9.bind(null,t),mo:I9.bind(null,t),po:P9.bind(null,t),R_:R9.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),xk(t)?Ck(t):t.K_.set("Unknown")):(await t.W_.stop(),LA(t))})),t.W_}function js(t){return t.G_||(t.G_=function(n,r,i){const s=ve(n);return s.b_(),new S9(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:O9.bind(null,t),po:M9.bind(null,t),p_:D9.bind(null,t),y_:L9.bind(null,t)}),t.q_.push(async e=>{e?(t.G_.__(),await Xp(t)):(await t.G_.stop(),t.L_.length>0&&(ie("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))})),t.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ii,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Ik(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new le(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pk(t,e){if(Mi("AsyncQueue",`${e}: ${t}`),_l(t))return new le(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{static emptySet(e){return new Fa(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ce.comparator(n.key,r.key):(n,r)=>ce.comparator(n.key,r.key),this.keyedMap=wu(),this.sortedSet=new ut(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Fa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Fa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(){this.z_=new ut(ce.comparator)}track(e){const n=e.doc.key,r=this.z_.get(n);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(n,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(n):e.type===1&&r.type===2?this.z_=this.z_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(n,{type:2,doc:e.doc}):he():this.z_=this.z_.insert(n,e)}j_(){const e=[];return this.z_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ul{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ul(e,n,Fa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F9{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class j9{constructor(){this.queries=eE(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(n,r){const i=ve(n),s=i.queries;i.queries=eE(),s.forEach((o,a)=>{for(const l of a.J_)l.onError(r)})})(this,new le(J.ABORTED,"Firestore shutting down"))}}function eE(){return new qo(t=>sA(t),Hp)}async function jA(t,e){const n=ve(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Y_()&&e.Z_()&&(r=2):(s=new F9,r=e.Z_()?0:1);try{switch(r){case 0:s.H_=await n.onListen(i,!0);break;case 1:s.H_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Pk(o,`Initialization of query '${ca(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.J_.push(e),e.ea(n.onlineState),s.H_&&e.ta(s.H_)&&Rk(n)}async function VA(t,e){const n=ve(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.J_.indexOf(e);o>=0&&(s.J_.splice(o,1),s.J_.length===0?i=e.Z_()?0:1:!s.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function V9(t,e){const n=ve(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.J_)a.ta(i)&&(r=!0);o.H_=i}}r&&Rk(n)}function B9(t,e,n){const r=ve(t),i=r.queries.get(e);if(i)for(const s of i.J_)s.onError(n);r.queries.delete(e)}function Rk(t){t.X_.forEach(e=>{e.next()})}var Fv,tE;(tE=Fv||(Fv={})).na="default",tE.Cache="cache";class BA{constructor(e,n,r){this.query=e,this.ra=n,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ul(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ia?this.oa(e)&&(this.ra.next(e),n=!0):this._a(e,this.onlineState)&&(this.aa(e),n=!0),this.sa=e,n}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let n=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),n=!0),n}_a(e,n){if(!e.fromCache||!this.Z_())return!0;const r=n!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const n=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}aa(e){e=ul.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==Fv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e){this.key=e}}class zA{constructor(e){this.key=e}}class $9{constructor(e,n){this.query=e,this.da=n,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Re(),this.mutatedKeys=Re(),this.Va=oA(e),this.ma=new Fa(this.Va)}get fa(){return this.da}ga(e,n){const r=n?n.pa:new Z_,i=n?n.ma:this.ma;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((c,d)=>{const h=i.get(c),p=Wp(this.query,d)?d:null,g=!!h&&this.mutatedKeys.has(h.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let k=!1;h&&p?h.data.isEqual(p.data)?g!==m&&(r.track({type:3,doc:p}),k=!0):this.ya(h,p)||(r.track({type:2,doc:p}),k=!0,(l&&this.Va(p,l)>0||u&&this.Va(p,u)<0)&&(a=!0)):!h&&p?(r.track({type:0,doc:p}),k=!0):h&&!p&&(r.track({type:1,doc:h}),k=!0,(l||u)&&(a=!0)),k&&(p?(o=o.add(p),s=m?s.add(c):s.delete(c)):(o=o.delete(c),s=s.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),s=s.delete(c.key),r.track({type:1,doc:c})}return{ma:o,pa:r,ss:a,mutatedKeys:s}}ya(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((c,d)=>function(p,g){const m=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he()}};return m(p)-m(g)}(c.type,d.type)||this.Va(c.doc,d.doc)),this.wa(r),i=i!=null&&i;const a=n&&!i?this.Sa():[],l=this.Ra.size===0&&this.current&&!i?1:0,u=l!==this.Aa;return this.Aa=l,o.length!==0||u?{snapshot:new ul(this.query,e.ma,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new Z_,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(n=>this.da=this.da.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.da=this.da.delete(n)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=Re(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});const n=[];return e.forEach(r=>{this.Ra.has(r)||n.push(new zA(r))}),this.Ra.forEach(r=>{e.has(r)||n.push(new $A(r))}),n}va(e){this.da=e.ds,this.Ra=Re();const n=this.ga(e.documents);return this.applyChanges(n,!0)}Ca(){return ul.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class z9{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class q9{constructor(e){this.key=e,this.Fa=!1}}class H9{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new qo(a=>sA(a),Hp),this.Oa=new Map,this.Na=new Set,this.La=new ut(ce.comparator),this.Ba=new Map,this.ka=new wk,this.qa={},this.Qa=new Map,this.Ka=ll.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function W9(t,e,n=!0){const r=QA(t);let i;const s=r.xa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Ca()):i=await qA(r,e,n,!0),i}async function K9(t,e){const n=QA(t);await qA(n,e,!0,!1)}async function qA(t,e,n,r){const i=await m9(t.localStore,ni(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await G9(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&OA(t.remoteStore,i),a}async function G9(t,e,n,r,i){t.Ua=(d,h,p)=>async function(m,k,y,w){let T=k.view.ga(y);T.ss&&(T=await Q_(m.localStore,k.query,!1).then(({documents:C})=>k.view.ga(C,T)));const x=w&&w.targetChanges.get(k.targetId),I=w&&w.targetMismatches.get(k.targetId)!=null,R=k.view.applyChanges(T,m.isPrimaryClient,x,I);return rE(m,k.targetId,R.ba),R.snapshot}(t,d,h,p);const s=await Q_(t.localStore,e,!0),o=new $9(e,s.ds),a=o.ga(s.documents),l=Xc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);rE(t,n,u.ba);const c=new z9(e,n,o);return t.xa.set(e,c),t.Oa.has(n)?t.Oa.get(n).push(e):t.Oa.set(n,[e]),u.snapshot}async function Q9(t,e,n){const r=ve(t),i=r.xa.get(e),s=r.Oa.get(i.targetId);if(s.length>1)return r.Oa.set(i.targetId,s.filter(o=>!Hp(o,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Uv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&_k(r.remoteStore,i.targetId),jv(r,i.targetId)}).catch(Sl)):(jv(r,i.targetId),await Uv(r.localStore,i.targetId,!0))}async function J9(t,e){const n=ve(t),r=n.xa.get(e),i=n.Oa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),_k(n.remoteStore,r.targetId))}async function Y9(t,e,n){const r=iB(t);try{const i=await function(o,a){const l=ve(o),u=pn.now(),c=a.reduce((p,g)=>p.add(g.key),Re());let d,h;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=Ui(),m=Re();return l.hs.getEntries(p,c).next(k=>{g=k,g.forEach((y,w)=>{w.isValidDocument()||(m=m.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(k=>{d=k;const y=[];for(const w of a){const T=g6(w,d.get(w.key).overlayedDocument);T!=null&&y.push(new Ho(w.key,T,XR(T.value.mapValue),Pi.exists(!0)))}return l.mutationQueue.addMutationBatch(p,u,y,a)}).next(k=>{h=k;const y=k.applyToLocalDocumentSet(d,m);return l.documentOverlayCache.saveOverlays(p,k.batchId,y)})}).then(()=>({batchId:h.batchId,changes:lA(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.qa[o.currentUser.toKey()];u||(u=new ut(Ae)),u=u.insert(a,l),o.qa[o.currentUser.toKey()]=u}(r,i.batchId,n),await ed(r,i.changes),await Xp(r.remoteStore)}catch(i){const s=Pk(i,"Failed to persist write");n.reject(s)}}async function HA(t,e){const n=ve(t);try{const r=await f9(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Ba.get(s);o&&(je(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Fa=!0:i.modifiedDocuments.size>0?je(o.Fa):i.removedDocuments.size>0&&(je(o.Fa),o.Fa=!1))}),await ed(n,r,e)}catch(r){await Sl(r)}}function nE(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.xa.forEach((s,o)=>{const a=o.view.ea(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ve(o);l.onlineState=a;let u=!1;l.queries.forEach((c,d)=>{for(const h of d.J_)h.ea(a)&&(u=!0)}),u&&Rk(l)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function X9(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Ba.get(e),s=i&&i.key;if(s){let o=new ut(ce.comparator);o=o.insert(s,en.newNoDocument(s,ge.min()));const a=Re().add(s),l=new Qp(ge.min(),new Map,new ut(Ae),o,a);await HA(r,l),r.La=r.La.remove(s),r.Ba.delete(e),Ak(r)}else await Uv(r.localStore,e,!1).then(()=>jv(r,e,n)).catch(Sl)}async function Z9(t,e){const n=ve(t),r=e.batch.batchId;try{const i=await d9(n.localStore,e);KA(n,r,null),WA(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ed(n,i)}catch(i){await Sl(i)}}async function eB(t,e,n){const r=ve(t);try{const i=await function(o,a){const l=ve(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return l.mutationQueue.lookupMutationBatch(u,a).next(d=>(je(d!==null),c=d.keys(),l.mutationQueue.removeMutationBatch(u,d))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,c,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>l.localDocuments.getDocuments(u,c))})}(r.localStore,e);KA(r,e,n),WA(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ed(r,i)}catch(i){await Sl(i)}}function WA(t,e){(t.Qa.get(e)||[]).forEach(n=>{n.resolve()}),t.Qa.delete(e)}function KA(t,e,n){const r=ve(t);let i=r.qa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function jv(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Oa.get(e))t.xa.delete(r),n&&t.Ma.Wa(r,n);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(r=>{t.ka.containsKey(r)||GA(t,r)})}function GA(t,e){t.Na.delete(e.path.canonicalString());const n=t.La.get(e);n!==null&&(_k(t.remoteStore,n),t.La=t.La.remove(e),t.Ba.delete(n),Ak(t))}function rE(t,e,n){for(const r of n)r instanceof $A?(t.ka.addReference(r.key,e),tB(t,r)):r instanceof zA?(ie("SyncEngine","Document no longer in limbo: "+r.key),t.ka.removeReference(r.key,e),t.ka.containsKey(r.key)||GA(t,r.key)):he()}function tB(t,e){const n=e.key,r=n.path.canonicalString();t.La.get(n)||t.Na.has(r)||(ie("SyncEngine","New document in limbo: "+n),t.Na.add(r),Ak(t))}function Ak(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const n=new ce(it.fromString(e)),r=t.Ka.next();t.Ba.set(r,new q9(n)),t.La=t.La.insert(n,r),OA(t.remoteStore,new ys(ni(gk(n.path)),r,"TargetPurposeLimboResolution",Bp.oe))}}async function ed(t,e,n){const r=ve(t),i=[],s=[],o=[];r.xa.isEmpty()||(r.xa.forEach((a,l)=>{o.push(r.Ua(l,e,n).then(u=>{var c;if((u||n)&&r.isPrimaryClient){const d=u?!u.fromCache:(c=n==null?void 0:n.targetChanges.get(l.targetId))===null||c===void 0?void 0:c.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){i.push(u);const d=Sk.zi(l.targetId,u);s.push(d)}}))}),await Promise.all(o),r.Ma.R_(i),await async function(l,u){const c=ve(l);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>K.forEach(u,h=>K.forEach(h.Wi,p=>c.persistence.referenceDelegate.addReference(d,h.targetId,p)).next(()=>K.forEach(h.Gi,p=>c.persistence.referenceDelegate.removeReference(d,h.targetId,p)))))}catch(d){if(!_l(d))throw d;ie("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const h=d.targetId;if(!d.fromCache){const p=c.us.get(h),g=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(g);c.us=c.us.insert(h,m)}}}(r.localStore,s))}async function nB(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){ie("SyncEngine","User change. New user:",e.toKey());const r=await PA(n.localStore,e);n.currentUser=e,function(s,o){s.Qa.forEach(a=>{a.forEach(l=>{l.reject(new le(J.CANCELLED,o))})}),s.Qa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ed(n,r.Ts)}}function rB(t,e){const n=ve(t),r=n.Ba.get(e);if(r&&r.Fa)return Re().add(r.key);{let i=Re();const s=n.Oa.get(e);if(!s)return i;for(const o of s){const a=n.xa.get(o);i=i.unionWith(a.view.fa)}return i}}function QA(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=HA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=X9.bind(null,e),e.Ma.R_=V9.bind(null,e.eventManager),e.Ma.Wa=B9.bind(null,e.eventManager),e}function iB(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eB.bind(null,e),e}class qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jp(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,n){return null}Ya(e,n){return null}Ha(e){return c9(this.persistence,new l9,e.initialUser,this.serializer)}ja(e){return new IA(Tk.ei,this.serializer)}za(e){return new y9}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qh.provider={build:()=>new qh};class sB extends qh{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,n){je(this.persistence.referenceDelegate instanceof $h);const r=this.persistence.referenceDelegate.garbageCollector;return new K6(r,e.asyncQueue,n)}ja(e){const n=this.cacheSizeBytes!==void 0?vn.withCacheSize(this.cacheSizeBytes):vn.DEFAULT;return new IA(r=>$h.ei(r,n),this.serializer)}}class Vv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>nE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nB.bind(null,this.syncEngine),await U9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new j9}()}createDatastore(e){const n=Jp(e.databaseInfo.databaseId),r=function(s){return new w9(s)}(e.databaseInfo);return function(s,o,a,l){return new _9(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new C9(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>nE(this.syncEngine,n,0),function(){return Y_.p()?new Y_:new v9}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,c){const d=new H9(i,s,o,a,l,u);return c&&(d.$a=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ve(i);ie("RemoteStore","RemoteStore shutting down."),s.k_.add(5),await Zc(s),s.Q_.shutdown(),s.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Vv.provider={build:()=>new Vv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Mi("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oB{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=QR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ie("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ie("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ii;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Pk(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Dg(t,e){t.asyncQueue.verifyOperationInProgress(),ie("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await PA(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function iE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await aB(t);ie("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>X_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>X_(e.remoteStore,i)),t._onlineComponents=e}async function aB(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await Dg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===J.FAILED_PRECONDITION||i.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;il("Error using user provided cache. Falling back to memory cache: "+n),await Dg(t,new qh)}}else ie("FirestoreClient","Using default OfflineComponentProvider"),await Dg(t,new sB(void 0));return t._offlineComponents}async function YA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ie("FirestoreClient","Using user provided OnlineComponentProvider"),await iE(t,t._uninitializedComponentsProvider._online)):(ie("FirestoreClient","Using default OnlineComponentProvider"),await iE(t,new Vv))),t._onlineComponents}function lB(t){return YA(t).then(e=>e.syncEngine)}async function XA(t){const e=await YA(t),n=e.eventManager;return n.onListen=W9.bind(null,e.syncEngine),n.onUnlisten=Q9.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=K9.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=J9.bind(null,e.syncEngine),n}function uB(t,e,n={}){const r=new Ii;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const c=new JA({next:h=>{c.eu(),o.enqueueAndForget(()=>VA(s,d));const p=h.docs.has(a);!p&&h.fromCache?u.reject(new le(J.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&h.fromCache&&l&&l.source==="server"?u.reject(new le(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new BA(gk(a.path),c,{includeMetadataChanges:!0,ua:!0});return jA(s,d)}(await XA(t),t.asyncQueue,e,n,r)),r.promise}function cB(t,e,n={}){const r=new Ii;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const c=new JA({next:h=>{c.eu(),o.enqueueAndForget(()=>VA(s,d)),h.fromCache&&l.source==="server"?u.reject(new le(J.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new BA(a,c,{includeMetadataChanges:!0,ua:!0});return jA(s,d)}(await XA(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(t,e,n){if(!n)throw new le(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dB(t,e,n,r){if(e===!0&&r===!0)throw new le(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function oE(t){if(!ce.isDocumentKey(t))throw new le(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function aE(t){if(ce.isDocumentKey(t))throw new le(J.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Nk(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he()}function No(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new le(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Nk(t);throw new le(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new le(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new le(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dB("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new le(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new le(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new le(J.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zp{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new le(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new le(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lE(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new TV;switch(r.type){case"firstParty":return new CV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new le(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=sE.get(n);r&&(ie("ComponentProvider","Removing Datastore"),sE.delete(n),r.terminate())}(this),Promise.resolve()}}function fB(t,e,n,r={}){var i;const s=(t=No(t,Zp))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&il("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Xt.MOCK_USER;else{a=XU(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new le(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Xt(u)}t._authCredentials=new SV(new GR(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new em(this.firestore,e,this._query)}}class qn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ps(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qn(this.firestore,e,this._key)}}class Ps extends em{constructor(e,n,r){super(e,n,gk(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qn(this.firestore,null,new ce(e))}withConverter(e){return new Ps(this.firestore,e,this._path)}}function hB(t,e,...n){if(t=zt(t),eN("collection","path",e),t instanceof Zp){const r=it.fromString(e,...n);return aE(r),new Ps(t,null,r)}{if(!(t instanceof qn||t instanceof Ps))throw new le(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return aE(r),new Ps(t.firestore,null,r)}}function tN(t,e,...n){if(t=zt(t),arguments.length===1&&(e=QR.newId()),eN("doc","path",e),t instanceof Zp){const r=it.fromString(e,...n);return oE(r),new qn(t,null,new ce(r))}{if(!(t instanceof qn||t instanceof Ps))throw new le(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(it.fromString(e,...n));return oE(r),new qn(t.firestore,t instanceof Ps?t.converter:null,new ce(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new AA(this,"async_queue_retry"),this.fu=()=>{const r=Og();r&&ie("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;const n=Og();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const n=Og();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const n=new Ii;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!_l(e))throw e;ie("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const n=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Mi("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=n,n}enqueueAfterDelay(e,n,r){this.pu(),this.mu.indexOf(e)>-1&&(n=0);const i=Ik.createAndSchedule(this,e,n,r,s=>this.Su(s));return this.du.push(i),i}pu(){this.Au&&he()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const n of this.du)if(n.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.du)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const n=this.du.indexOf(e);this.du.splice(n,1)}}class tm extends Zp{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new uE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new uE(e),this._firestoreClient=void 0,await e}}}function pB(t,e){const n=typeof t=="object"?t:Up(),r=typeof t=="string"?t:"(default)",i=Gs(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=ZP("firestore");s&&fB(i,...s)}return i}function Ok(t){if(t._terminated)throw new le(J.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||mB(t),t._firestoreClient}function mB(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,u,c){return new BV(a,l,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,ZA(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new oB(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cl(qt.fromBase64String(e))}catch(n){throw new le(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new cl(qt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new le(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new le(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new le(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ae(this._lat,e._lat)||Ae(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gB=/^__.*__$/;class yB{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ho(e,this.data,this.fieldMask,n,this.fieldTransforms):new Yc(e,this.data,n,this.fieldTransforms)}}function rN(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he()}}class Uk{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Fu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new Uk(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.xu({path:r,Nu:!1});return i.Lu(e),i}Bu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return Hh(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(rN(this.Mu)&&gB.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class vB{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Jp(e)}$u(e,n,r,i=!1){return new Uk({Mu:e,methodName:n,Ku:r,path:jt.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bB(t){const e=t._freezeSettings(),n=Jp(t._databaseId);return new vB(t._databaseId,!!e.ignoreUndefinedProperties,n)}function kB(t,e,n,r,i,s={}){const o=t.$u(s.merge||s.mergeFields?2:0,e,n,i);aN("Data must be an object, but it was:",o,r);const a=sN(r,o);let l,u;if(s.merge)l=new Er(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const c=[];for(const d of s.mergeFields){const h=wB(e,d,n);if(!o.contains(h))throw new le(J.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);SB(c,h)||c.push(h)}l=new Er(c),u=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,u=o.fieldTransforms;return new yB(new nr(a),l,u)}function iN(t,e){if(oN(t=zt(t)))return aN("Unsupported field value:",e,t),sN(t,e);if(t instanceof nN)return function(r,i){if(!rN(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=iN(a,i.ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=zt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return c6(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=pn.fromDate(r);return{timestampValue:Bh(i.serializer,s)}}if(r instanceof pn){const s=new pn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Bh(i.serializer,s)}}if(r instanceof Lk)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof cl)return{bytesValue:wA(i.serializer,r._byteString)};if(r instanceof qn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:kk(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Mk)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.qu("VectorValues must only contain numeric values.");return yk(a.serializer,l)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${Nk(r)}`)}(t,e)}function sN(t,e){const n={};return JR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zo(t,(r,i)=>{const s=iN(i,e.Ou(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function oN(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof pn||t instanceof Lk||t instanceof cl||t instanceof qn||t instanceof nN||t instanceof Mk)}function aN(t,e,n){if(!oN(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Nk(n);throw r==="an object"?e.qu(t+" a custom object"):e.qu(t+" "+r)}}function wB(t,e,n){if((e=zt(e))instanceof Dk)return e._internalPath;if(typeof e=="string")return lN(t,e);throw Hh("Field path arguments must be of type string or ",t,!1,void 0,n)}const TB=new RegExp("[~\\*/\\[\\]]");function lN(t,e,n){if(e.search(TB)>=0)throw Hh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Dk(...e.split("."))._internalPath}catch{throw Hh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Hh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new le(J.INVALID_ARGUMENT,a+t+l)}function SB(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _B(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(cN("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class _B extends uN{data(){return super.data()}}function cN(t,e){return typeof e=="string"?lN(t,e):e instanceof Dk?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new le(J.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class CB{convertValue(e,n="none"){switch(Fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return zo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>gt(o.doubleValue));return new Mk(s)}convertGeoPoint(e){return new Lk(gt(e.latitude),gt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Tc(e));default:return null}}convertTimestamp(e){const n=Ms(e);return new pn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=it.fromString(e);je(xA(r));const i=new Sc(r.get(1),r.get(3)),s=new ce(r.popFirst(5));return i.isEqual(n)||Mi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xB(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dN extends uN{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Mf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(cN("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Mf extends dN{data(e={}){return super.data(e)}}class IB{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Su(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Mf(this._firestore,this._userDataWriter,r.key,r,new Su(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new le(J.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Mf(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Su(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Mf(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Su(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,c=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),c=o.indexOf(a.doc.key)),{type:PB(a.type),doc:l,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function PB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RB(t){t=No(t,qn);const e=No(t.firestore,tm);return uB(Ok(e),t._key).then(n=>DB(e,t,n))}class fN extends CB{constructor(e){super(),this.firestore=e}convertBytes(e){return new cl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new qn(this.firestore,null,n)}}function AB(t){t=No(t,em);const e=No(t.firestore,tm),n=Ok(e),r=new fN(e);return EB(t._query),cB(n,t._query).then(i=>new IB(e,r,t,i))}function NB(t,e,n){t=No(t,qn);const r=No(t.firestore,tm),i=xB(t.converter,e);return OB(r,[kB(bB(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Pi.none())])}function OB(t,e){return function(r,i){const s=new Ii;return r.asyncQueue.enqueueAndForget(async()=>Y9(await lB(r),i,s)),s.promise}(Ok(t),e)}function DB(t,e,n){const r=n.docs.get(e._key),i=new fN(t);return new dN(t,i,e._key,r,new Su(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Tl=i})(kl),Nr(new cr("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new tm(new _V(r.getProvider("auth-internal")),new IV(r.getProvider("app-check-internal")),function(u,c){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new le(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sc(u.options.projectId,c)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),xn(C_,"4.7.5",e),xn(C_,"4.7.5","esm2017")})();const hN="@firebase/installations",Fk="0.6.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=1e4,mN=`w:${Fk}`,gN="FIS_v2",LB="https://firebaseinstallations.googleapis.com/v1",MB=60*60*1e3,UB="installations",FB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Oo=new $o(UB,FB,jB);function yN(t){return t instanceof Ur&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN({projectId:t}){return`${LB}/projects/${t}/installations`}function bN(t){return{token:t.token,requestStatus:2,expiresIn:BB(t.expiresIn),creationTime:Date.now()}}async function kN(t,e){const r=(await e.json()).error;return Oo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function wN({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function VB(t,{refreshToken:e}){const n=wN(t);return n.append("Authorization",$B(e)),n}async function TN(t){const e=await t();return e.status>=500&&e.status<600?t():e}function BB(t){return Number(t.replace("s","000"))}function $B(t){return`${gN} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zB({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=vN(t),i=wN(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:gN,appId:t.appId,sdkVersion:mN},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await TN(()=>fetch(r,a));if(l.ok){const u=await l.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:bN(u.authToken)}}else throw await kN("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SN(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HB=/^[cdef][\w-]{21}$/,Bv="";function WB(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=KB(t);return HB.test(n)?n:Bv}catch{return Bv}}function KB(t){return qB(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nm(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N=new Map;function EN(t,e){const n=nm(t);CN(n,e),GB(n,e)}function CN(t,e){const n=_N.get(t);if(n)for(const r of n)r(e)}function GB(t,e){const n=QB();n&&n.postMessage({key:t,fid:e}),JB()}let co=null;function QB(){return!co&&"BroadcastChannel"in self&&(co=new BroadcastChannel("[Firebase] FID Change"),co.onmessage=t=>{CN(t.data.key,t.data.fid)}),co}function JB(){_N.size===0&&co&&(co.close(),co=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YB="firebase-installations-database",XB=1,Do="firebase-installations-store";let Lg=null;function jk(){return Lg||(Lg=aR(YB,XB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Do)}}})),Lg}async function Wh(t,e){const n=nm(t),i=(await jk()).transaction(Do,"readwrite"),s=i.objectStore(Do),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&EN(t,e.fid),e}async function xN(t){const e=nm(t),r=(await jk()).transaction(Do,"readwrite");await r.objectStore(Do).delete(e),await r.done}async function rm(t,e){const n=nm(t),i=(await jk()).transaction(Do,"readwrite"),s=i.objectStore(Do),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&EN(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vk(t){let e;const n=await rm(t.appConfig,r=>{const i=ZB(r),s=e$(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Bv?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function ZB(t){const e=t||{fid:WB(),registrationStatus:0};return IN(e)}function e$(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Oo.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=t$(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:n$(t)}:{installationEntry:e}}async function t$(t,e){try{const n=await zB(t,e);return Wh(t.appConfig,n)}catch(n){throw yN(n)&&n.customData.serverCode===409?await xN(t.appConfig):await Wh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function n$(t){let e=await cE(t.appConfig);for(;e.registrationStatus===1;)await SN(100),e=await cE(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Vk(t);return r||n}return e}function cE(t){return rm(t,e=>{if(!e)throw Oo.create("installation-not-found");return IN(e)})}function IN(t){return r$(t)?{fid:t.fid,registrationStatus:0}:t}function r$(t){return t.registrationStatus===1&&t.registrationTime+pN<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i$({appConfig:t,heartbeatServiceProvider:e},n){const r=s$(t,n),i=VB(t,n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:mN,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await TN(()=>fetch(r,a));if(l.ok){const u=await l.json();return bN(u)}else throw await kN("Generate Auth Token",l)}function s$(t,{fid:e}){return`${vN(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bk(t,e=!1){let n;const r=await rm(t.appConfig,s=>{if(!PN(s))throw Oo.create("not-registered");const o=s.authToken;if(!e&&l$(o))return s;if(o.requestStatus===1)return n=o$(t,e),s;{if(!navigator.onLine)throw Oo.create("app-offline");const a=c$(s);return n=a$(t,a),a}});return n?await n:r.authToken}async function o$(t,e){let n=await dE(t.appConfig);for(;n.authToken.requestStatus===1;)await SN(100),n=await dE(t.appConfig);const r=n.authToken;return r.requestStatus===0?Bk(t,e):r}function dE(t){return rm(t,e=>{if(!PN(e))throw Oo.create("not-registered");const n=e.authToken;return d$(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function a$(t,e){try{const n=await i$(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Wh(t.appConfig,r),n}catch(n){if(yN(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await xN(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Wh(t.appConfig,r)}throw n}}function PN(t){return t!==void 0&&t.registrationStatus===2}function l$(t){return t.requestStatus===2&&!u$(t)}function u$(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+MB}function c$(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function d$(t){return t.requestStatus===1&&t.requestTime+pN<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f$(t){const e=t,{installationEntry:n,registrationPromise:r}=await Vk(e);return r?r.catch(console.error):Bk(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h$(t,e=!1){const n=t;return await p$(n),(await Bk(n,e)).token}async function p$(t){const{registrationPromise:e}=await Vk(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m$(t){if(!t||!t.options)throw Mg("App Configuration");if(!t.name)throw Mg("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Mg(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Mg(t){return Oo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN="installations",g$="installations-internal",y$=t=>{const e=t.getProvider("app").getImmediate(),n=m$(e),r=Gs(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},v$=t=>{const e=t.getProvider("app").getImmediate(),n=Gs(e,RN).getImmediate();return{getId:()=>f$(n),getToken:i=>h$(n,i)}};function b$(){Nr(new cr(RN,y$,"PUBLIC")),Nr(new cr(g$,v$,"PRIVATE"))}b$();xn(hN,Fk);xn(hN,Fk,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh="analytics",k$="firebase_id",w$="origin",T$=60*1e3,S$="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",$k="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In=new Mp("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _$={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Hn=new $o("analytics","Analytics",_$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E$(t){if(!t.startsWith($k)){const e=Hn.create("invalid-gtag-resource",{gtagURL:t});return In.warn(e.message),""}return t}function AN(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function C$(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function x$(t,e){const n=C$("firebase-js-sdk-policy",{createScriptURL:E$}),r=document.createElement("script"),i=`${$k}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function I$(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function P$(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await AN(n)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(a){In.error(a)}t("config",i,s)}async function R$(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await AN(n);for(const l of o){const u=a.find(d=>d.measurementId===l),c=u&&e[u.appId];if(c)s.push(c);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){In.error(s)}}function A$(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await R$(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await P$(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,u]=o;t("get",a,l,u)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){In.error(a)}}return i}function N$(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=A$(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function O$(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes($k)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D$=30,L$=1e3;class M${constructor(e={},n=L$){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const NN=new M$;function U$(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function F$(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:U$(r)},s=S$.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Hn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function j$(t,e=NN,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Hn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Hn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new $$;return setTimeout(async()=>{a.abort()},T$),ON({appId:r,apiKey:i,measurementId:s},o,a,e)}async function ON(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=NN){var s;const{appId:o,measurementId:a}=t;try{await V$(r,e)}catch(l){if(a)return In.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await F$(t);return i.deleteThrottleMetadata(o),l}catch(l){const u=l;if(!B$(u)){if(i.deleteThrottleMetadata(o),a)return In.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:a};throw l}const c=Number((s=u==null?void 0:u.customData)===null||s===void 0?void 0:s.httpStatus)===503?ZS(n,i.intervalMillis,D$):ZS(n,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return i.setThrottleMetadata(o,d),In.debug(`Calling attemptFetch again in ${c} millis`),ON(t,d,r,i)}}function V$(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Hn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function B$(t){if(!(t instanceof Ur)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class $${constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function z$(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q$(){if(rR())try{await iR()}catch(t){return In.warn(Hn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return In.warn(Hn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function H$(t,e,n,r,i,s,o){var a;const l=j$(t);l.then(p=>{n[p.measurementId]=p.appId,t.options.measurementId&&p.measurementId!==t.options.measurementId&&In.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>In.error(p)),e.push(l);const u=q$().then(p=>{if(p)return r.getId()}),[c,d]=await Promise.all([l,u]);O$(s)||x$(s,c.measurementId),i("js",new Date);const h=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return h[w$]="firebase",h.update=!0,d!=null&&(h[k$]=d),i("config",c.measurementId,h),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W${constructor(e){this.app=e}_delete(){return delete Vu[this.app.options.appId],Promise.resolve()}}let Vu={},fE=[];const hE={};let Ug="dataLayer",K$="gtag",pE,DN,mE=!1;function G$(){const t=[];if(nR()&&t.push("This is a browser extension environment."),s3()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Hn.create("invalid-analytics-context",{errorInfo:e});In.warn(n.message)}}function Q$(t,e,n){G$();const r=t.options.appId;if(!r)throw Hn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)In.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Hn.create("no-api-key");if(Vu[r]!=null)throw Hn.create("already-exists",{id:r});if(!mE){I$(Ug);const{wrappedGtag:s,gtagCore:o}=N$(Vu,fE,hE,Ug,K$);DN=s,pE=o,mE=!0}return Vu[r]=H$(t,fE,hE,e,pE,Ug,n),new W$(t)}function J$(t=Up()){t=zt(t);const e=Gs(t,Kh);return e.isInitialized()?e.getImmediate():Y$(t)}function Y$(t,e={}){const n=Gs(t,Kh);if(n.isInitialized()){const i=n.getImmediate();if(vc(e,n.getOptions()))return i;throw Hn.create("already-initialized")}return n.initialize({options:e})}function X$(t,e,n,r){t=zt(t),z$(DN,Vu[t.app.options.appId],e,n,r).catch(i=>In.error(i))}const gE="@firebase/analytics",yE="0.10.10";function Z$(){Nr(new cr(Kh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return Q$(r,i,n)},"PUBLIC")),Nr(new cr("analytics-internal",t,"PRIVATE")),xn(gE,yE),xn(gE,yE,"esm2017");function t(e){try{const n=e.getProvider(Kh).getImmediate();return{logEvent:(r,i,s)=>X$(n,r,i,s)}}catch(n){throw Hn.create("interop-component-reg-failed",{reason:n})}}}Z$();var ez="firebase",tz="11.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xn(ez,tz,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v="us-central1";class rz{constructor(e,n,r,i,s=$v,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new nz(n,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(s);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=$v}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function iz(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const vE="@firebase/functions",bE="0.12.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz="auth-internal",oz="app-check-internal",az="messaging-internal";function lz(t){const e=(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),s=n.getProvider(sz),o=n.getProvider(az),a=n.getProvider(oz);return new rz(i,s,o,a,r)};Nr(new cr(LN,e,"PUBLIC").setMultipleInstances(!0)),xn(vE,bE,t),xn(vE,bE,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(t=Up(),e=$v){const r=Gs(zt(t),LN).getImmediate({identifier:e}),i=ZP("functions");return i&&cz(r,...i),r}function cz(t,e,n){iz(zt(t),e,n)}lz();const dz={apiKey:"AIzaSyB4KqBBfiRISzURE42wP8j8ej9nkVaLGVc",authDomain:"meetingsummary-76642.firebaseapp.com",databaseURL:"https://meetingsummary-76642-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"meetingsummary-76642",storageBucket:"meetingsummary-76642.firebasestorage.app",messagingSenderId:"718986171927",appId:"1:718986171927:web:6e090a5b342fa395476e52",measurementId:"G-PZ2JG0Y4Y5"},im=lR(dz);J$(im);const fz=Cv(im),hz=new vi,zv=pB(im);uz(im);class pz{async fetchMeetingSummariesData(e){try{console.log(e);const n=await AB(hB(zv,"user",e,"summaries")),r=[];return n.forEach(i=>{const s=i.data();r.push(s)}),r}catch(n){throw console.error("Error fetching data: ",n),n}}async fetchUserProfileData(e){try{const n=tN(zv,"user",e),r=await RB(n);if(r.exists())return r.data();console.log("No such document!")}catch(n){throw console.error("Error fetching data: ",n),n}}}const MN=new pz;class mz{async updateUserProfile(e,n){return await new Promise(r=>setTimeout(r,1e3)),e.preferences=n,e}}const gz=new mz,UN=v.createContext(null);function yz({children:t}){const[e,n]=v.useState(null),[r,i]=v.useState(!1),[s,o]=v.useState(!1),[a,l]=v.useState(null),u=Cv(),c=v.useCallback((g,m)=>g==="user"&&m==="Useruser"?(n({id:"default_userId",name:"default_userName",email:"default_userEmail",preferences:{lineNotification:{uid:"",enabled:!1},darkMode:!1}}),!0):!1,[]),d=v.useCallback(async()=>{const g=Cv();try{await cj(g),localStorage.removeItem("uid"),n(null),console.log("User signed out from Firebase")}catch(m){console.error("Error signing out:",m)}},[]),h=v.useCallback(async g=>{const m=await MN.fetchUserProfileData(g.uid),k={id:g.uid,name:g.displayName||"",email:g.email||"",avatarUrl:g.photoURL||"",preferences:(m==null?void 0:m.preferences)??{lineNotification:null,darkMode:!1}};console.log(k),n(k)},[]),p=v.useCallback(async g=>{if(console.log("UPDATE"),console.log(e),e){console.log(g),o(!0),l(null);try{const m=await gz.updateUserProfile(e,g);console.log(m);const k=tN(zv,"user",e.id);return NB(k,e),n(m),!0}catch(m){return l(m instanceof Error?m.message:"更新失敗"),!1}finally{o(!1)}}return!1},[e]);return v.useEffect(()=>{(async()=>{try{uj(u,async m=>{console.log(m),m&&await h(m),i(!0)})}catch(m){console.error("初始化錯誤:",m),l("初始化失敗")}finally{}})()},[]),E.jsx(UN.Provider,{value:{isChecked:r,user:e,setGoogleUser:h,login:c,logout:d,updateUser:p},children:t})}function Fr(){const t=v.useContext(UN);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}const FN=v.createContext(null);function vz({children:t}){const[e,n]=v.useState(()=>typeof window>"u"?!1:document.documentElement.classList.contains("dark"));v.useEffect(()=>{e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[e]);const r=()=>{n(i=>!i)};return E.jsx(FN.Provider,{value:{isDarkMode:e,toggleDarkMode:r},children:t})}function bz(){const t=v.useContext(FN);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}function jN(t,e){return function(){return t.apply(e,arguments)}}const{toString:kz}=Object.prototype,{getPrototypeOf:zk}=Object,sm=(t=>e=>{const n=kz.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),jr=t=>(t=t.toLowerCase(),e=>sm(e)===t),om=t=>e=>typeof e===t,{isArray:Cl}=Array,xc=om("undefined");function wz(t){return t!==null&&!xc(t)&&t.constructor!==null&&!xc(t.constructor)&&Wn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const VN=jr("ArrayBuffer");function Tz(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&VN(t.buffer),e}const Sz=om("string"),Wn=om("function"),BN=om("number"),am=t=>t!==null&&typeof t=="object",_z=t=>t===!0||t===!1,Uf=t=>{if(sm(t)!=="object")return!1;const e=zk(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Ez=jr("Date"),Cz=jr("File"),xz=jr("Blob"),Iz=jr("FileList"),Pz=t=>am(t)&&Wn(t.pipe),Rz=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Wn(t.append)&&((e=sm(t))==="formdata"||e==="object"&&Wn(t.toString)&&t.toString()==="[object FormData]"))},Az=jr("URLSearchParams"),[Nz,Oz,Dz,Lz]=["ReadableStream","Request","Response","Headers"].map(jr),Mz=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function td(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Cl(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,t[a],a,t)}}function $N(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const fo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,zN=t=>!xc(t)&&t!==fo;function qv(){const{caseless:t}=zN(this)&&this||{},e={},n=(r,i)=>{const s=t&&$N(e,i)||i;Uf(e[s])&&Uf(r)?e[s]=qv(e[s],r):Uf(r)?e[s]=qv({},r):Cl(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&td(arguments[r],n);return e}const Uz=(t,e,n,{allOwnKeys:r}={})=>(td(e,(i,s)=>{n&&Wn(i)?t[s]=jN(i,n):t[s]=i},{allOwnKeys:r}),t),Fz=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),jz=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},Vz=(t,e,n,r)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&zk(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},Bz=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},$z=t=>{if(!t)return null;if(Cl(t))return t;let e=t.length;if(!BN(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},zz=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&zk(Uint8Array)),qz=(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},Hz=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},Wz=jr("HTMLFormElement"),Kz=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),kE=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Gz=jr("RegExp"),qN=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};td(n,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(r[s]=o||i)}),Object.defineProperties(t,r)},Qz=t=>{qN(t,(e,n)=>{if(Wn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Wn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Jz=(t,e)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return Cl(t)?r(t):r(String(t).split(e)),n},Yz=()=>{},Xz=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,Fg="abcdefghijklmnopqrstuvwxyz",wE="0123456789",HN={DIGIT:wE,ALPHA:Fg,ALPHA_DIGIT:Fg+Fg.toUpperCase()+wE},Zz=(t=16,e=HN.ALPHA_DIGIT)=>{let n="";const{length:r}=e;for(;t--;)n+=e[Math.random()*r|0];return n};function e7(t){return!!(t&&Wn(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const t7=t=>{const e=new Array(10),n=(r,i)=>{if(am(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[i]=r;const s=Cl(r)?[]:{};return td(r,(o,a)=>{const l=n(o,i+1);!xc(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return n(t,0)},n7=jr("AsyncFunction"),r7=t=>t&&(am(t)||Wn(t))&&Wn(t.then)&&Wn(t.catch),WN=((t,e)=>t?setImmediate:e?((n,r)=>(fo.addEventListener("message",({source:i,data:s})=>{i===fo&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),fo.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Wn(fo.postMessage)),i7=typeof queueMicrotask<"u"?queueMicrotask.bind(fo):typeof process<"u"&&process.nextTick||WN,W={isArray:Cl,isArrayBuffer:VN,isBuffer:wz,isFormData:Rz,isArrayBufferView:Tz,isString:Sz,isNumber:BN,isBoolean:_z,isObject:am,isPlainObject:Uf,isReadableStream:Nz,isRequest:Oz,isResponse:Dz,isHeaders:Lz,isUndefined:xc,isDate:Ez,isFile:Cz,isBlob:xz,isRegExp:Gz,isFunction:Wn,isStream:Pz,isURLSearchParams:Az,isTypedArray:zz,isFileList:Iz,forEach:td,merge:qv,extend:Uz,trim:Mz,stripBOM:Fz,inherits:jz,toFlatObject:Vz,kindOf:sm,kindOfTest:jr,endsWith:Bz,toArray:$z,forEachEntry:qz,matchAll:Hz,isHTMLForm:Wz,hasOwnProperty:kE,hasOwnProp:kE,reduceDescriptors:qN,freezeMethods:Qz,toObjectSet:Jz,toCamelCase:Kz,noop:Yz,toFiniteNumber:Xz,findKey:$N,global:fo,isContextDefined:zN,ALPHABET:HN,generateString:Zz,isSpecCompliantForm:e7,toJSONObject:t7,isAsyncFn:n7,isThenable:r7,setImmediate:WN,asap:i7};function we(t,e,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}W.inherits(we,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:W.toJSONObject(this.config),code:this.code,status:this.status}}});const KN=we.prototype,GN={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{GN[t]={value:t}});Object.defineProperties(we,GN);Object.defineProperty(KN,"isAxiosError",{value:!0});we.from=(t,e,n,r,i,s)=>{const o=Object.create(KN);return W.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),we.call(o,t.message,e,n,r,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const s7=null;function Hv(t){return W.isPlainObject(t)||W.isArray(t)}function QN(t){return W.endsWith(t,"[]")?t.slice(0,-2):t}function TE(t,e,n){return t?t.concat(e).map(function(i,s){return i=QN(i),!n&&s?"["+i+"]":i}).join(n?".":""):e}function o7(t){return W.isArray(t)&&!t.some(Hv)}const a7=W.toFlatObject(W,{},null,function(e){return/^is[A-Z]/.test(e)});function lm(t,e,n){if(!W.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=W.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,k){return!W.isUndefined(k[m])});const r=n.metaTokens,i=n.visitor||c,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&W.isSpecCompliantForm(e);if(!W.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(W.isDate(g))return g.toISOString();if(!l&&W.isBlob(g))throw new we("Blob is not supported. Use a Buffer instead.");return W.isArrayBuffer(g)||W.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,m,k){let y=g;if(g&&!k&&typeof g=="object"){if(W.endsWith(m,"{}"))m=r?m:m.slice(0,-2),g=JSON.stringify(g);else if(W.isArray(g)&&o7(g)||(W.isFileList(g)||W.endsWith(m,"[]"))&&(y=W.toArray(g)))return m=QN(m),y.forEach(function(T,x){!(W.isUndefined(T)||T===null)&&e.append(o===!0?TE([m],x,s):o===null?m:m+"[]",u(T))}),!1}return Hv(g)?!0:(e.append(TE(k,m,s),u(g)),!1)}const d=[],h=Object.assign(a7,{defaultVisitor:c,convertValue:u,isVisitable:Hv});function p(g,m){if(!W.isUndefined(g)){if(d.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(g),W.forEach(g,function(y,w){(!(W.isUndefined(y)||y===null)&&i.call(e,y,W.isString(w)?w.trim():w,m,h))===!0&&p(y,m?m.concat(w):[w])}),d.pop()}}if(!W.isObject(t))throw new TypeError("data must be an object");return p(t),e}function SE(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function qk(t,e){this._pairs=[],t&&lm(t,this,e)}const JN=qk.prototype;JN.append=function(e,n){this._pairs.push([e,n])};JN.toString=function(e){const n=e?function(r){return e.call(this,r,SE)}:SE;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function l7(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function YN(t,e,n){if(!e)return t;const r=n&&n.encode||l7;W.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(e,n):s=W.isURLSearchParams(e)?e.toString():new qk(e,n).toString(r),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class _E{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){W.forEach(this.handlers,function(r){r!==null&&e(r)})}}const XN={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},u7=typeof URLSearchParams<"u"?URLSearchParams:qk,c7=typeof FormData<"u"?FormData:null,d7=typeof Blob<"u"?Blob:null,f7={isBrowser:!0,classes:{URLSearchParams:u7,FormData:c7,Blob:d7},protocols:["http","https","file","blob","url","data"]},Hk=typeof window<"u"&&typeof document<"u",Wv=typeof navigator=="object"&&navigator||void 0,h7=Hk&&(!Wv||["ReactNative","NativeScript","NS"].indexOf(Wv.product)<0),p7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",m7=Hk&&window.location.href||"http://localhost",g7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Hk,hasStandardBrowserEnv:h7,hasStandardBrowserWebWorkerEnv:p7,navigator:Wv,origin:m7},Symbol.toStringTag,{value:"Module"})),tn={...g7,...f7};function y7(t,e){return lm(t,new tn.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,s){return tn.isNode&&W.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function v7(t){return W.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function b7(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}function ZN(t){function e(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=n.length;return o=!o&&W.isArray(i)?i.length:o,l?(W.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!W.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],s)&&W.isArray(i[o])&&(i[o]=b7(i[o])),!a)}if(W.isFormData(t)&&W.isFunction(t.entries)){const n={};return W.forEachEntry(t,(r,i)=>{e(v7(r),i,n,0)}),n}return null}function k7(t,e,n){if(W.isString(t))try{return(e||JSON.parse)(t),W.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(0,JSON.stringify)(t)}const nd={transitional:XN,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=W.isObject(e);if(s&&W.isHTMLForm(e)&&(e=new FormData(e)),W.isFormData(e))return i?JSON.stringify(ZN(e)):e;if(W.isArrayBuffer(e)||W.isBuffer(e)||W.isStream(e)||W.isFile(e)||W.isBlob(e)||W.isReadableStream(e))return e;if(W.isArrayBufferView(e))return e.buffer;if(W.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return y7(e,this.formSerializer).toString();if((a=W.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return lm(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),k7(e)):e}],transformResponse:[function(e){const n=this.transitional||nd.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(W.isResponse(e)||W.isReadableStream(e))return e;if(e&&W.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?we.from(a,we.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tn.classes.FormData,Blob:tn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};W.forEach(["delete","get","head","post","put","patch"],t=>{nd.headers[t]={}});const w7=W.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),T7=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&w7[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},EE=Symbol("internals");function au(t){return t&&String(t).trim().toLowerCase()}function Ff(t){return t===!1||t==null?t:W.isArray(t)?t.map(Ff):String(t)}function S7(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const _7=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function jg(t,e,n,r,i){if(W.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!W.isString(e)){if(W.isString(r))return e.indexOf(r)!==-1;if(W.isRegExp(r))return r.test(e)}}function E7(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function C7(t,e){const n=W.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}class Pn{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function s(a,l,u){const c=au(l);if(!c)throw new Error("header name must be a non-empty string");const d=W.findKey(i,c);(!d||i[d]===void 0||u===!0||u===void 0&&i[d]!==!1)&&(i[d||l]=Ff(a))}const o=(a,l)=>W.forEach(a,(u,c)=>s(u,c,l));if(W.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(W.isString(e)&&(e=e.trim())&&!_7(e))o(T7(e),n);else if(W.isHeaders(e))for(const[a,l]of e.entries())s(l,a,r);else e!=null&&s(n,e,r);return this}get(e,n){if(e=au(e),e){const r=W.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return S7(i);if(W.isFunction(n))return n.call(this,i,r);if(W.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=au(e),e){const r=W.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||jg(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function s(o){if(o=au(o),o){const a=W.findKey(r,o);a&&(!n||jg(r,r[a],a,n))&&(delete r[a],i=!0)}}return W.isArray(e)?e.forEach(s):s(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!e||jg(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const n=this,r={};return W.forEach(this,(i,s)=>{const o=W.findKey(r,s);if(o){n[o]=Ff(i),delete n[s];return}const a=e?E7(s):String(s).trim();a!==s&&delete n[s],n[a]=Ff(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return W.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&W.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[EE]=this[EE]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=au(o);r[a]||(C7(i,o),r[a]=!0)}return W.isArray(e)?e.forEach(s):s(e),this}}Pn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);W.reduceDescriptors(Pn.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});W.freezeMethods(Pn);function Vg(t,e){const n=this||nd,r=e||n,i=Pn.from(r.headers);let s=r.data;return W.forEach(t,function(a){s=a.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function eO(t){return!!(t&&t.__CANCEL__)}function xl(t,e,n){we.call(this,t??"canceled",we.ERR_CANCELED,e,n),this.name="CanceledError"}W.inherits(xl,we,{__CANCEL__:!0});function tO(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new we("Request failed with status code "+n.status,[we.ERR_BAD_REQUEST,we.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function x7(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function I7(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[s];o||(o=u),n[i]=l,r[i]=u;let d=s,h=0;for(;d!==i;)h+=n[d++],d=d%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-o<e)return;const p=c&&u-c;return p?Math.round(h*1e3/p):void 0}}function P7(t,e){let n=0,r=1e3/e,i,s;const o=(u,c=Date.now())=>{n=c,i=null,s&&(clearTimeout(s),s=null),t.apply(null,u)};return[(...u)=>{const c=Date.now(),d=c-n;d>=r?o(u,c):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},r-d)))},()=>i&&o(i)]}const Gh=(t,e,n=3)=>{let r=0;const i=I7(50,250);return P7(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-r,u=i(l),c=o<=a;r=o;const d={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&c?(a-o)/u:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(d)},n)},CE=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},xE=t=>(...e)=>W.asap(()=>t(...e)),R7=tn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,tn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(tn.origin),tn.navigator&&/(msie|trident)/i.test(tn.navigator.userAgent)):()=>!0,A7=tn.hasStandardBrowserEnv?{write(t,e,n,r,i,s){const o=[t+"="+encodeURIComponent(e)];W.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),W.isString(r)&&o.push("path="+r),W.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function N7(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function O7(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function nO(t,e){return t&&!N7(e)?O7(t,e):e}const IE=t=>t instanceof Pn?{...t}:t;function Lo(t,e){e=e||{};const n={};function r(u,c,d,h){return W.isPlainObject(u)&&W.isPlainObject(c)?W.merge.call({caseless:h},u,c):W.isPlainObject(c)?W.merge({},c):W.isArray(c)?c.slice():c}function i(u,c,d,h){if(W.isUndefined(c)){if(!W.isUndefined(u))return r(void 0,u,d,h)}else return r(u,c,d,h)}function s(u,c){if(!W.isUndefined(c))return r(void 0,c)}function o(u,c){if(W.isUndefined(c)){if(!W.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function a(u,c,d){if(d in e)return r(u,c);if(d in t)return r(void 0,u)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c,d)=>i(IE(u),IE(c),d,!0)};return W.forEach(Object.keys(Object.assign({},t,e)),function(c){const d=l[c]||i,h=d(t[c],e[c],c);W.isUndefined(h)&&d!==a||(n[c]=h)}),n}const rO=t=>{const e=Lo({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:a}=e;e.headers=o=Pn.from(o),e.url=YN(nO(e.baseURL,e.url),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(W.isFormData(n)){if(tn.hasStandardBrowserEnv||tn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...c]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...c].join("; "))}}if(tn.hasStandardBrowserEnv&&(r&&W.isFunction(r)&&(r=r(e)),r||r!==!1&&R7(e.url))){const u=i&&s&&A7.read(s);u&&o.set(i,u)}return e},D7=typeof XMLHttpRequest<"u",L7=D7&&function(t){return new Promise(function(n,r){const i=rO(t);let s=i.data;const o=Pn.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=i,c,d,h,p,g;function m(){p&&p(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(c),i.signal&&i.signal.removeEventListener("abort",c)}let k=new XMLHttpRequest;k.open(i.method.toUpperCase(),i.url,!0),k.timeout=i.timeout;function y(){if(!k)return;const T=Pn.from("getAllResponseHeaders"in k&&k.getAllResponseHeaders()),I={data:!a||a==="text"||a==="json"?k.responseText:k.response,status:k.status,statusText:k.statusText,headers:T,config:t,request:k};tO(function(C){n(C),m()},function(C){r(C),m()},I),k=null}"onloadend"in k?k.onloadend=y:k.onreadystatechange=function(){!k||k.readyState!==4||k.status===0&&!(k.responseURL&&k.responseURL.indexOf("file:")===0)||setTimeout(y)},k.onabort=function(){k&&(r(new we("Request aborted",we.ECONNABORTED,t,k)),k=null)},k.onerror=function(){r(new we("Network Error",we.ERR_NETWORK,t,k)),k=null},k.ontimeout=function(){let x=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const I=i.transitional||XN;i.timeoutErrorMessage&&(x=i.timeoutErrorMessage),r(new we(x,I.clarifyTimeoutError?we.ETIMEDOUT:we.ECONNABORTED,t,k)),k=null},s===void 0&&o.setContentType(null),"setRequestHeader"in k&&W.forEach(o.toJSON(),function(x,I){k.setRequestHeader(I,x)}),W.isUndefined(i.withCredentials)||(k.withCredentials=!!i.withCredentials),a&&a!=="json"&&(k.responseType=i.responseType),u&&([h,g]=Gh(u,!0),k.addEventListener("progress",h)),l&&k.upload&&([d,p]=Gh(l),k.upload.addEventListener("progress",d),k.upload.addEventListener("loadend",p)),(i.cancelToken||i.signal)&&(c=T=>{k&&(r(!T||T.type?new xl(null,t,k):T),k.abort(),k=null)},i.cancelToken&&i.cancelToken.subscribe(c),i.signal&&(i.signal.aborted?c():i.signal.addEventListener("abort",c)));const w=x7(i.url);if(w&&tn.protocols.indexOf(w)===-1){r(new we("Unsupported protocol "+w+":",we.ERR_BAD_REQUEST,t));return}k.send(s||null)})},M7=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,i;const s=function(u){if(!i){i=!0,a();const c=u instanceof Error?u:this.reason;r.abort(c instanceof we?c:new xl(c instanceof Error?c.message:c))}};let o=e&&setTimeout(()=>{o=null,s(new we(`timeout ${e} of ms exceeded`,we.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),t=null)};t.forEach(u=>u.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>W.asap(a),l}},U7=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,i;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},F7=async function*(t,e){for await(const n of j7(t))yield*U7(n,e)},j7=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},PE=(t,e,n,r)=>{const i=F7(t,e);let s=0,o,a=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:u,value:c}=await i.next();if(u){a(),l.close();return}let d=c.byteLength;if(n){let h=s+=d;n(h)}l.enqueue(new Uint8Array(c))}catch(u){throw a(u),u}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},um=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",iO=um&&typeof ReadableStream=="function",V7=um&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),sO=(t,...e)=>{try{return!!t(...e)}catch{return!1}},B7=iO&&sO(()=>{let t=!1;const e=new Request(tn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),RE=64*1024,Kv=iO&&sO(()=>W.isReadableStream(new Response("").body)),Qh={stream:Kv&&(t=>t.body)};um&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Qh[e]&&(Qh[e]=W.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new we(`Response type '${e}' is not supported`,we.ERR_NOT_SUPPORT,r)})})})(new Response);const $7=async t=>{if(t==null)return 0;if(W.isBlob(t))return t.size;if(W.isSpecCompliantForm(t))return(await new Request(tn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(W.isArrayBufferView(t)||W.isArrayBuffer(t))return t.byteLength;if(W.isURLSearchParams(t)&&(t=t+""),W.isString(t))return(await V7(t)).byteLength},z7=async(t,e)=>{const n=W.toFiniteNumber(t.getContentLength());return n??$7(e)},q7=um&&(async t=>{let{url:e,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:c,withCredentials:d="same-origin",fetchOptions:h}=rO(t);u=u?(u+"").toLowerCase():"text";let p=M7([i,s&&s.toAbortSignal()],o),g;const m=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let k;try{if(l&&B7&&n!=="get"&&n!=="head"&&(k=await z7(c,r))!==0){let I=new Request(e,{method:"POST",body:r,duplex:"half"}),R;if(W.isFormData(r)&&(R=I.headers.get("content-type"))&&c.setContentType(R),I.body){const[C,_]=CE(k,Gh(xE(l)));r=PE(I.body,RE,C,_)}}W.isString(d)||(d=d?"include":"omit");const y="credentials"in Request.prototype;g=new Request(e,{...h,signal:p,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",credentials:y?d:void 0});let w=await fetch(g);const T=Kv&&(u==="stream"||u==="response");if(Kv&&(a||T&&m)){const I={};["status","statusText","headers"].forEach(P=>{I[P]=w[P]});const R=W.toFiniteNumber(w.headers.get("content-length")),[C,_]=a&&CE(R,Gh(xE(a),!0))||[];w=new Response(PE(w.body,RE,C,()=>{_&&_(),m&&m()}),I)}u=u||"text";let x=await Qh[W.findKey(Qh,u)||"text"](w,t);return!T&&m&&m(),await new Promise((I,R)=>{tO(I,R,{data:x,headers:Pn.from(w.headers),status:w.status,statusText:w.statusText,config:t,request:g})})}catch(y){throw m&&m(),y&&y.name==="TypeError"&&/fetch/i.test(y.message)?Object.assign(new we("Network Error",we.ERR_NETWORK,t,g),{cause:y.cause||y}):we.from(y,y&&y.code,t,g)}}),Gv={http:s7,xhr:L7,fetch:q7};W.forEach(Gv,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const AE=t=>`- ${t}`,H7=t=>W.isFunction(t)||t===null||t===!1,oO={getAdapter:t=>{t=W.isArray(t)?t:[t];const{length:e}=t;let n,r;const i={};for(let s=0;s<e;s++){n=t[s];let o;if(r=n,!H7(n)&&(r=Gv[(o=String(n)).toLowerCase()],r===void 0))throw new we(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(AE).join(`
`):" "+AE(s[0]):"as no adapter specified";throw new we("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Gv};function Bg(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new xl(null,t)}function NE(t){return Bg(t),t.headers=Pn.from(t.headers),t.data=Vg.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),oO.getAdapter(t.adapter||nd.adapter)(t).then(function(r){return Bg(t),r.data=Vg.call(t,t.transformResponse,r),r.headers=Pn.from(r.headers),r},function(r){return eO(r)||(Bg(t),r&&r.response&&(r.response.data=Vg.call(t,t.transformResponse,r.response),r.response.headers=Pn.from(r.response.headers))),Promise.reject(r)})}const aO="1.7.9",cm={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{cm[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const OE={};cm.transitional=function(e,n,r){function i(s,o){return"[Axios v"+aO+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new we(i(o," has been removed"+(n?" in "+n:"")),we.ERR_DEPRECATED);return n&&!OE[o]&&(OE[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};cm.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function W7(t,e,n){if(typeof t!="object")throw new we("options must be an object",we.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new we("option "+s+" must be "+l,we.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new we("Unknown option "+s,we.ERR_BAD_OPTION)}}const jf={assertOptions:W7,validators:cm},zr=jf.validators;class bo{constructor(e){this.defaults=e,this.interceptors={request:new _E,response:new _E}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Lo(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&jf.assertOptions(r,{silentJSONParsing:zr.transitional(zr.boolean),forcedJSONParsing:zr.transitional(zr.boolean),clarifyTimeoutError:zr.transitional(zr.boolean)},!1),i!=null&&(W.isFunction(i)?n.paramsSerializer={serialize:i}:jf.assertOptions(i,{encode:zr.function,serialize:zr.function},!0)),jf.assertOptions(n,{baseUrl:zr.spelling("baseURL"),withXsrfToken:zr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&W.merge(s.common,s[n.method]);s&&W.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),n.headers=Pn.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let c,d=0,h;if(!l){const g=[NE.bind(this),void 0];for(g.unshift.apply(g,a),g.push.apply(g,u),h=g.length,c=Promise.resolve(n);d<h;)c=c.then(g[d++],g[d++]);return c}h=a.length;let p=n;for(d=0;d<h;){const g=a[d++],m=a[d++];try{p=g(p)}catch(k){m.call(this,k);break}}try{c=NE.call(this,p)}catch(g){return Promise.reject(g)}for(d=0,h=u.length;d<h;)c=c.then(u[d++],u[d++]);return c}getUri(e){e=Lo(this.defaults,e);const n=nO(e.baseURL,e.url);return YN(n,e.params,e.paramsSerializer)}}W.forEach(["delete","get","head","options"],function(e){bo.prototype[e]=function(n,r){return this.request(Lo(r||{},{method:e,url:n,data:(r||{}).data}))}});W.forEach(["post","put","patch"],function(e){function n(r){return function(s,o,a){return this.request(Lo(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}bo.prototype[e]=n(),bo.prototype[e+"Form"]=n(!0)});class Wk{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new xl(s,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Wk(function(i){e=i}),cancel:e}}}function K7(t){return function(n){return t.apply(null,n)}}function G7(t){return W.isObject(t)&&t.isAxiosError===!0}const Qv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Qv).forEach(([t,e])=>{Qv[e]=t});function lO(t){const e=new bo(t),n=jN(bo.prototype.request,e);return W.extend(n,bo.prototype,e,{allOwnKeys:!0}),W.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return lO(Lo(t,i))},n}const St=lO(nd);St.Axios=bo;St.CanceledError=xl;St.CancelToken=Wk;St.isCancel=eO;St.VERSION=aO;St.toFormData=lm;St.AxiosError=we;St.Cancel=St.CanceledError;St.all=function(e){return Promise.all(e)};St.spread=K7;St.isAxiosError=G7;St.mergeConfig=Lo;St.AxiosHeaders=Pn;St.formToJSON=t=>ZN(W.isHTMLForm(t)?new FormData(t):t);St.getAdapter=oO.getAdapter;St.HttpStatusCode=Qv;St.default=St;const rr=St.create({baseURL:"/api/",timeout:3e4,headers:{"Content-Type":"application/json"}});let $g=null;rr.interceptors.request.use(t=>($g||($g=new AbortController),t.signal=$g.signal,t),t=>Promise.reject(t));rr.interceptors.response.use(t=>t,async t=>{if(t.config,t.response)switch(t.response.status){}return Promise.reject(t)});class Q7{summarize(e){return rr.post("/summarize",e,{headers:{"Content-Type":"multipart/form-data"}})}deleteSummary(e,n){return rr.delete(`/summary/${n}`,{headers:{"X-User-Id":e}})}getChatbotHistory(e){return rr.get("/chatbot/history",{headers:{"X-User-Id":e}})}getChatbotMessage(e,n,r){const i={uid:e,message:n};return r&&(i.chatId=r),rr.post("/chatbot/message",i)}}const Jh=new Q7,uO=v.createContext(void 0);function J7({children:t}){const{user:e}=Fr(),[n,r]=v.useState([]),[i,s]=v.useState(!1),o=v.useCallback(d=>{r(h=>[...h].sort((p,g)=>{const m=new Date(p.date).getTime(),k=new Date(g.date).getTime();return d==="asc"?m-k:k-m}))},[]),a=v.useCallback(d=>{r(h=>{var p=h.filter(m=>m.id!==d.id);return[...p,d]})},[]),l=v.useCallback(async d=>{if(e){s(!0);const h=new FormData;h.append("uid",e.id),d.file&&h.append("file",d.file),d.s3FileName&&h.append("s3_file_name",d.s3FileName),d.summaryId&&h.append("summary_id",d.summaryId);try{const p=await Jh.summarize(h);return a(p.data.summary),p.data}catch(p){throw console.error("Error uploading file:",p),p}finally{s(!1)}}},[]),u=v.useCallback(async d=>{try{const h=await MN.fetchMeetingSummariesData(d);r(h)}catch(h){console.error("Error fetching meeting summaries:",h)}},[]),c=v.useCallback(async d=>{if(e)try{return s(!0),(await Jh.deleteSummary(e.id,d)).status===200?(r(p=>{var g=p.filter(m=>m.id!==d);return g}),!0):!1}catch(h){throw console.error("Error delete file:",h),h}finally{s(!1)}else return!1},[]);return E.jsx(uO.Provider,{value:{isLoading:i,meetingSummaries:n,addMeetingSummary:a,sortMeetingSummaries:o,summarizeMeeting:l,fetchMeetingSummaries:u,deleteMeetingSummary:c},children:t})}const rd=()=>v.useContext(uO);function Y7({children:t}){const{isChecked:e,user:n}=Fr(),{fetchMeetingSummaries:r}=rd();if(console.log("PrivateRoute"),e)return n?(v.useEffect(()=>{(async()=>{if(n)try{await r(n.id)}catch(s){console.error("Error fetching meeting summaries:",s)}})()},[n,r]),E.jsx(E.Fragment,{children:t})):E.jsx(GP,{to:"/welcomePage",replace:!0});if(n)return""}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var X7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z7=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),We=(t,e)=>{const n=v.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:l,...u},c)=>v.createElement("svg",{ref:c,...X7,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:["lucide",`lucide-${Z7(t)}`,a].join(" "),...u},[...e.map(([d,h])=>v.createElement(d,h)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=We("AlignJustify",[["line",{x1:"3",x2:"21",y1:"6",y2:"6",key:"4m8b97"}],["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["line",{x1:"3",x2:"21",y1:"18",y2:"18",key:"kwyyxn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t8=We("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=We("ArrowLeftToLine",[["path",{d:"M3 19V5",key:"rwsyhb"}],["path",{d:"m13 6-6 6 6 6",key:"1yhaz7"}],["path",{d:"M7 12h14",key:"uoisry"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=We("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=We("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=We("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=We("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s8=We("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=We("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o8=We("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a8=We("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l8=We("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=We("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=We("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c8=We("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d8=We("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=We("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h8=We("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=We("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m8=We("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g8=We("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y8=We("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v8=We("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b8=We("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=We("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k8=We("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=We("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),w8=(t,e,n,r)=>{var s,o,a,l;const i=[n,{code:e,...r||{}}];if((o=(s=t==null?void 0:t.services)==null?void 0:s.logger)!=null&&o.forward)return t.services.logger.forward(i,"warn","react-i18next::",!0);ko(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),(l=(a=t==null?void 0:t.services)==null?void 0:a.logger)!=null&&l.warn?t.services.logger.warn(...i):console!=null&&console.warn&&console.warn(...i)},LE={},Xv=(t,e,n,r)=>{ko(n)&&LE[n]||(ko(n)&&(LE[n]=new Date),w8(t,e,n,r))},cO=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}},Zv=(t,e,n)=>{t.loadNamespaces(e,cO(t,n))},ME=(t,e,n,r)=>{if(ko(n)&&(n=[n]),t.options.preload&&t.options.preload.indexOf(e)>-1)return Zv(t,n,r);n.forEach(i=>{t.options.ns.indexOf(i)<0&&t.options.ns.push(i)}),t.loadLanguages(e,cO(t,r))},T8=(t,e,n={})=>!e.languages||!e.languages.length?(Xv(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:n.lng,precheck:(r,i)=>{var s;if(((s=n.bindI18n)==null?void 0:s.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!i(r.isLanguageChangingTo,t))return!1}}),ko=t=>typeof t=="string",S8=t=>typeof t=="object"&&t!==null,_8=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,E8={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},C8=t=>E8[t],x8=t=>t.replace(_8,C8);let eb={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:x8};const I8=(t={})=>{eb={...eb,...t}},P8=()=>eb;let dO;const R8=t=>{dO=t},A8=()=>dO,N8={type:"3rdParty",init(t){I8(t.options.react),R8(t)}},O8=v.createContext();class D8{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const L8=(t,e)=>{const n=v.useRef();return v.useEffect(()=>{n.current=t},[t,e]),n.current},fO=(t,e,n,r)=>t.getFixedT(e,n,r),M8=(t,e,n,r)=>v.useCallback(fO(t,e,n,r),[t,e,n,r]),dr=(t,e={})=>{var x,I,R,C;const{i18n:n}=e,{i18n:r,defaultNS:i}=v.useContext(O8)||{},s=n||r||A8();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new D8),!s){Xv(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const _=(N,A)=>ko(A)?A:S8(A)&&ko(A.defaultValue)?A.defaultValue:Array.isArray(N)?N[N.length-1]:N,P=[_,{},!1];return P.t=_,P.i18n={},P.ready=!1,P}(x=s.options.react)!=null&&x.wait&&Xv(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...P8(),...s.options.react,...e},{useSuspense:a,keyPrefix:l}=o;let u=i||((I=s.options)==null?void 0:I.defaultNS);u=ko(u)?[u]:u||["translation"],(C=(R=s.reportNamespaces).addUsedNamespaces)==null||C.call(R,u);const c=(s.isInitialized||s.initializedStoreOnce)&&u.every(_=>T8(_,s,o)),d=M8(s,e.lng||null,o.nsMode==="fallback"?u:u[0],l),h=()=>d,p=()=>fO(s,e.lng||null,o.nsMode==="fallback"?u:u[0],l),[g,m]=v.useState(h);let k=u.join();e.lng&&(k=`${e.lng}${k}`);const y=L8(k),w=v.useRef(!0);v.useEffect(()=>{const{bindI18n:_,bindI18nStore:P}=o;w.current=!0,!c&&!a&&(e.lng?ME(s,e.lng,u,()=>{w.current&&m(p)}):Zv(s,u,()=>{w.current&&m(p)})),c&&y&&y!==k&&w.current&&m(p);const N=()=>{w.current&&m(p)};return _&&(s==null||s.on(_,N)),P&&(s==null||s.store.on(P,N)),()=>{w.current=!1,s&&(_==null||_.split(" ").forEach(A=>s.off(A,N))),P&&s&&P.split(" ").forEach(A=>s.store.off(A,N))}},[s,k]),v.useEffect(()=>{w.current&&c&&m(h)},[s,l,c]);const T=[g,s,c];if(T.t=g,T.i18n=s,T.ready=c,c||!c&&!a)return T;throw new Promise(_=>{e.lng?ME(s,e.lng,u,()=>_()):Zv(s,u,()=>_())})};function U8(){const{user:t}=Fr(),[e,n]=v.useState([]),[r,i]=v.useState(!1),s=async a=>{if(t){const u={content:a.trim(),role:"user",date:new Date().toISOString()};n(c=>[...c,u]),i(!0);try{var l=await Jh.getChatbotMessage(t.id,a);if(l.status===200){const c=await l.data;n(c.messages)}else console.error("Error from API:",l.data),n(c=>[...c,{content:"抱歉，我現在無法回應，請稍後再試。",role:"assistant",date:new Date().toISOString()}])}catch(c){console.error("API call failed:",c),n(d=>[...d,{content:"抱歉，發生了技術問題，請稍後再試。",role:"assistant",date:new Date().toISOString()}])}finally{i(!1)}}},o=v.useCallback(async()=>{try{if(t){i(!0);var a=await Jh.getChatbotHistory(t.id);if(a.status===200){const l=await a.data;n(l.messages)}else console.error("Error from API:",a.data),n(l=>[...l,{content:"抱歉，無法獲取歷史訊息，請稍後再試。",role:"assistant",date:new Date().toISOString()}])}}catch(l){console.error("API call failed:",l),n(u=>[...u,{content:"抱歉，發生了技術問題，請稍後再試。",role:"assistant",date:new Date().toISOString()}])}finally{i(!1)}},[]);return{isLoading:r,chatbotMessages:e,getChatbotMessage:s,getChatHistory:o}}function F8(t,e){const n={};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const j8=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,V8=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,B8={};function UE(t,e){return(B8.jsx?V8:j8).test(t)}const $8=/[ \t\n\f\r]/g;function z8(t){return typeof t=="object"?t.type==="text"?FE(t.value):!1:FE(t)}function FE(t){return t.replace($8,"")===""}class id{constructor(e,n,r){this.property=e,this.normal=n,r&&(this.space=r)}}id.prototype.property={};id.prototype.normal={};id.prototype.space=null;function hO(t,e){const n={},r={};let i=-1;for(;++i<t.length;)Object.assign(n,t[i].property),Object.assign(r,t[i].normal);return new id(n,r,e)}function tb(t){return t.toLowerCase()}class fr{constructor(e,n){this.property=e,this.attribute=n}}fr.prototype.space=null;fr.prototype.boolean=!1;fr.prototype.booleanish=!1;fr.prototype.overloadedBoolean=!1;fr.prototype.number=!1;fr.prototype.commaSeparated=!1;fr.prototype.spaceSeparated=!1;fr.prototype.commaOrSpaceSeparated=!1;fr.prototype.mustUseProperty=!1;fr.prototype.defined=!1;let q8=0;const ke=Ko(),kt=Ko(),pO=Ko(),Z=Ko(),Ke=Ko(),ja=Ko(),Fn=Ko();function Ko(){return 2**++q8}const nb=Object.freeze(Object.defineProperty({__proto__:null,boolean:ke,booleanish:kt,commaOrSpaceSeparated:Fn,commaSeparated:ja,number:Z,overloadedBoolean:pO,spaceSeparated:Ke},Symbol.toStringTag,{value:"Module"})),zg=Object.keys(nb);class Gk extends fr{constructor(e,n,r,i){let s=-1;if(super(e,n),jE(this,"space",i),typeof r=="number")for(;++s<zg.length;){const o=zg[s];jE(this,zg[s],(r&nb[o])===nb[o])}}}Gk.prototype.defined=!0;function jE(t,e,n){n&&(t[e]=n)}const H8={}.hasOwnProperty;function Il(t){const e={},n={};let r;for(r in t.properties)if(H8.call(t.properties,r)){const i=t.properties[r],s=new Gk(r,t.transform(t.attributes||{},r),i,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,n[tb(r)]=r,n[tb(s.attribute)]=r}return new id(e,n,t.space)}const mO=Il({space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),gO=Il({space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function yO(t,e){return e in t?t[e]:e}function vO(t,e){return yO(t,e.toLowerCase())}const bO=Il({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:vO,properties:{xmlns:null,xmlnsXLink:null}}),kO=Il({transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:kt,ariaAutoComplete:null,ariaBusy:kt,ariaChecked:kt,ariaColCount:Z,ariaColIndex:Z,ariaColSpan:Z,ariaControls:Ke,ariaCurrent:null,ariaDescribedBy:Ke,ariaDetails:null,ariaDisabled:kt,ariaDropEffect:Ke,ariaErrorMessage:null,ariaExpanded:kt,ariaFlowTo:Ke,ariaGrabbed:kt,ariaHasPopup:null,ariaHidden:kt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Ke,ariaLevel:Z,ariaLive:null,ariaModal:kt,ariaMultiLine:kt,ariaMultiSelectable:kt,ariaOrientation:null,ariaOwns:Ke,ariaPlaceholder:null,ariaPosInSet:Z,ariaPressed:kt,ariaReadOnly:kt,ariaRelevant:null,ariaRequired:kt,ariaRoleDescription:Ke,ariaRowCount:Z,ariaRowIndex:Z,ariaRowSpan:Z,ariaSelected:kt,ariaSetSize:Z,ariaSort:null,ariaValueMax:Z,ariaValueMin:Z,ariaValueNow:Z,ariaValueText:null,role:null}}),W8=Il({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:vO,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:ja,acceptCharset:Ke,accessKey:Ke,action:null,allow:null,allowFullScreen:ke,allowPaymentRequest:ke,allowUserMedia:ke,alt:null,as:null,async:ke,autoCapitalize:null,autoComplete:Ke,autoFocus:ke,autoPlay:ke,blocking:Ke,capture:null,charSet:null,checked:ke,cite:null,className:Ke,cols:Z,colSpan:null,content:null,contentEditable:kt,controls:ke,controlsList:Ke,coords:Z|ja,crossOrigin:null,data:null,dateTime:null,decoding:null,default:ke,defer:ke,dir:null,dirName:null,disabled:ke,download:pO,draggable:kt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:ke,formTarget:null,headers:Ke,height:Z,hidden:ke,high:Z,href:null,hrefLang:null,htmlFor:Ke,httpEquiv:Ke,id:null,imageSizes:null,imageSrcSet:null,inert:ke,inputMode:null,integrity:null,is:null,isMap:ke,itemId:null,itemProp:Ke,itemRef:Ke,itemScope:ke,itemType:Ke,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:ke,low:Z,manifest:null,max:null,maxLength:Z,media:null,method:null,min:null,minLength:Z,multiple:ke,muted:ke,name:null,nonce:null,noModule:ke,noValidate:ke,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:ke,optimum:Z,pattern:null,ping:Ke,placeholder:null,playsInline:ke,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:ke,referrerPolicy:null,rel:Ke,required:ke,reversed:ke,rows:Z,rowSpan:Z,sandbox:Ke,scope:null,scoped:ke,seamless:ke,selected:ke,shadowRootClonable:ke,shadowRootDelegatesFocus:ke,shadowRootMode:null,shape:null,size:Z,sizes:null,slot:null,span:Z,spellCheck:kt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Z,step:null,style:null,tabIndex:Z,target:null,title:null,translate:null,type:null,typeMustMatch:ke,useMap:null,value:kt,width:Z,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Ke,axis:null,background:null,bgColor:null,border:Z,borderColor:null,bottomMargin:Z,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:ke,declare:ke,event:null,face:null,frame:null,frameBorder:null,hSpace:Z,leftMargin:Z,link:null,longDesc:null,lowSrc:null,marginHeight:Z,marginWidth:Z,noResize:ke,noHref:ke,noShade:ke,noWrap:ke,object:null,profile:null,prompt:null,rev:null,rightMargin:Z,rules:null,scheme:null,scrolling:kt,standby:null,summary:null,text:null,topMargin:Z,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Z,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:ke,disableRemotePlayback:ke,prefix:null,property:null,results:Z,security:null,unselectable:null}}),K8=Il({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:yO,properties:{about:Fn,accentHeight:Z,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Z,amplitude:Z,arabicForm:null,ascent:Z,attributeName:null,attributeType:null,azimuth:Z,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Z,by:null,calcMode:null,capHeight:Z,className:Ke,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Z,diffuseConstant:Z,direction:null,display:null,dur:null,divisor:Z,dominantBaseline:null,download:ke,dx:null,dy:null,edgeMode:null,editable:null,elevation:Z,enableBackground:null,end:null,event:null,exponent:Z,externalResourcesRequired:null,fill:null,fillOpacity:Z,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:ja,g2:ja,glyphName:ja,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Z,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Z,horizOriginX:Z,horizOriginY:Z,id:null,ideographic:Z,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Z,k:Z,k1:Z,k2:Z,k3:Z,k4:Z,kernelMatrix:Fn,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Z,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Z,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Z,overlineThickness:Z,paintOrder:null,panose1:null,path:null,pathLength:Z,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Ke,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Z,pointsAtY:Z,pointsAtZ:Z,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Fn,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Fn,rev:Fn,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Fn,requiredFeatures:Fn,requiredFonts:Fn,requiredFormats:Fn,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Z,specularExponent:Z,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Z,strikethroughThickness:Z,string:null,stroke:null,strokeDashArray:Fn,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Z,strokeOpacity:Z,strokeWidth:null,style:null,surfaceScale:Z,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Fn,tabIndex:Z,tableValues:null,target:null,targetX:Z,targetY:Z,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Fn,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Z,underlineThickness:Z,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Z,values:null,vAlphabetic:Z,vMathematical:Z,vectorEffect:null,vHanging:Z,vIdeographic:Z,version:null,vertAdvY:Z,vertOriginX:Z,vertOriginY:Z,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Z,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),G8=/^data[-\w.:]+$/i,VE=/-[a-z]/g,Q8=/[A-Z]/g;function J8(t,e){const n=tb(e);let r=e,i=fr;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&G8.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(VE,X8);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!VE.test(s)){let o=s.replace(Q8,Y8);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}i=Gk}return new i(r,e)}function Y8(t){return"-"+t.toLowerCase()}function X8(t){return t.charAt(1).toUpperCase()}const Z8={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},eq=hO([gO,mO,bO,kO,W8],"html"),Qk=hO([gO,mO,bO,kO,K8],"svg");function tq(t){return t.join(" ").trim()}var wO={},BE=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,nq=/\n/g,rq=/^\s*/,iq=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,sq=/^:\s*/,oq=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,aq=/^[;\s]*/,lq=/^\s+|\s+$/g,uq=`
`,$E="/",zE="*",io="",cq="comment",dq="declaration",fq=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function i(g){var m=g.match(nq);m&&(n+=m.length);var k=g.lastIndexOf(uq);r=~k?g.length-k:r+g.length}function s(){var g={line:n,column:r};return function(m){return m.position=new o(g),u(),m}}function o(g){this.start=g,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function a(g){var m=new Error(e.source+":"+n+":"+r+": "+g);if(m.reason=g,m.filename=e.source,m.line=n,m.column=r,m.source=t,!e.silent)throw m}function l(g){var m=g.exec(t);if(m){var k=m[0];return i(k),t=t.slice(k.length),m}}function u(){l(rq)}function c(g){var m;for(g=g||[];m=d();)m!==!1&&g.push(m);return g}function d(){var g=s();if(!($E!=t.charAt(0)||zE!=t.charAt(1))){for(var m=2;io!=t.charAt(m)&&(zE!=t.charAt(m)||$E!=t.charAt(m+1));)++m;if(m+=2,io===t.charAt(m-1))return a("End of comment missing");var k=t.slice(2,m-2);return r+=2,i(k),t=t.slice(m),r+=2,g({type:cq,comment:k})}}function h(){var g=s(),m=l(iq);if(m){if(d(),!l(sq))return a("property missing ':'");var k=l(oq),y=g({type:dq,property:qE(m[0].replace(BE,io)),value:k?qE(k[0].replace(BE,io)):io});return l(aq),y}}function p(){var g=[];c(g);for(var m;m=h();)m!==!1&&(g.push(m),c(g));return g}return u(),p()};function qE(t){return t?t.replace(lq,io):io}var hq=Sy&&Sy.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(wO,"__esModule",{value:!0});var HE=wO.default=mq,pq=hq(fq);function mq(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,pq.default)(t),i=typeof e=="function";return r.forEach(function(s){if(s.type==="declaration"){var o=s.property,a=s.value;i?e(o,a,s):a&&(n=n||{},n[o]=a)}}),n}const gq=HE.default||HE,TO=SO("end"),Jk=SO("start");function SO(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function yq(t){const e=Jk(t),n=TO(t);if(e&&n)return{start:e,end:n}}function $u(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?WE(t.position):"start"in t||"end"in t?WE(t):"line"in t||"column"in t?rb(t):""}function rb(t){return KE(t&&t.line)+":"+KE(t&&t.column)}function WE(t){return rb(t&&t.start)+"-"+rb(t&&t.end)}function KE(t){return t&&typeof t=="number"?t:1}class on extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",s={},o=!1;if(n&&("line"in n&&"column"in n?s={place:n}:"start"in n&&"end"in n?s={place:n}:"type"in n?s={ancestors:[n],place:n.position}:s={...n}),typeof e=="string"?i=e:!s.cause&&e&&(o=!0,i=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof r=="string"){const l=r.indexOf(":");l===-1?s.ruleId=r:(s.source=r.slice(0,l),s.ruleId=r.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const a=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=a?a.column:void 0,this.fatal=void 0,this.file,this.message=i,this.line=a?a.line:void 0,this.name=$u(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=o&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual,this.expected,this.note,this.url}}on.prototype.file="";on.prototype.name="";on.prototype.reason="";on.prototype.message="";on.prototype.stack="";on.prototype.column=void 0;on.prototype.line=void 0;on.prototype.ancestors=void 0;on.prototype.cause=void 0;on.prototype.fatal=void 0;on.prototype.place=void 0;on.prototype.ruleId=void 0;on.prototype.source=void 0;const Yk={}.hasOwnProperty,vq=new Map,bq=/[A-Z]/g,kq=/-([a-z])/g,wq=new Set(["table","tbody","thead","tfoot","tr"]),Tq=new Set(["td","th"]),_O="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Sq(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Aq(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=Rq(n,e.jsx,e.jsxs)}const i={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?Qk:eq,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=EO(i,t,void 0);return s&&typeof s!="string"?s:i.create(t,i.Fragment,{children:s||void 0},void 0)}function EO(t,e,n){if(e.type==="element")return _q(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return Eq(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return xq(t,e,n);if(e.type==="mdxjsEsm")return Cq(t,e);if(e.type==="root")return Iq(t,e,n);if(e.type==="text")return Pq(t,e)}function _q(t,e,n){const r=t.schema;let i=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=Qk,t.schema=i),t.ancestors.push(e);const s=xO(t,e.tagName,!1),o=Nq(t,e);let a=Zk(t,e);return wq.has(e.tagName)&&(a=a.filter(function(l){return typeof l=="string"?!z8(l):!0})),CO(t,o,s,e),Xk(o,a),t.ancestors.pop(),t.schema=r,t.create(e,s,o,n)}function Eq(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}Ic(t,e.position)}function Cq(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);Ic(t,e.position)}function xq(t,e,n){const r=t.schema;let i=r;e.name==="svg"&&r.space==="html"&&(i=Qk,t.schema=i),t.ancestors.push(e);const s=e.name===null?t.Fragment:xO(t,e.name,!0),o=Oq(t,e),a=Zk(t,e);return CO(t,o,s,e),Xk(o,a),t.ancestors.pop(),t.schema=r,t.create(e,s,o,n)}function Iq(t,e,n){const r={};return Xk(r,Zk(t,e)),t.create(e,t.Fragment,r,n)}function Pq(t,e){return e.value}function CO(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function Xk(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function Rq(t,e,n){return r;function r(i,s,o,a){const u=Array.isArray(o.children)?n:e;return a?u(s,o,a):u(s,o)}}function Aq(t,e){return n;function n(r,i,s,o){const a=Array.isArray(s.children),l=Jk(r);return e(i,s,o,a,{columnNumber:l?l.column-1:void 0,fileName:t,lineNumber:l?l.line:void 0},void 0)}}function Nq(t,e){const n={};let r,i;for(i in e.properties)if(i!=="children"&&Yk.call(e.properties,i)){const s=Dq(t,i,e.properties[i]);if(s){const[o,a]=s;t.tableCellAlignToStyle&&o==="align"&&typeof a=="string"&&Tq.has(e.tagName)?r=a:n[o]=a}}if(r){const s=n.style||(n.style={});s[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function Oq(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const s=r.data.estree.body[0];s.type;const o=s.expression;o.type;const a=o.properties[0];a.type,Object.assign(n,t.evaluater.evaluateExpression(a.argument))}else Ic(t,e.position);else{const i=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const a=r.value.data.estree.body[0];a.type,s=t.evaluater.evaluateExpression(a.expression)}else Ic(t,e.position);else s=r.value===null?!0:r.value;n[i]=s}return n}function Zk(t,e){const n=[];let r=-1;const i=t.passKeys?new Map:vq;for(;++r<e.children.length;){const s=e.children[r];let o;if(t.passKeys){const l=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(l){const u=i.get(l)||0;o=l+"-"+u,i.set(l,u+1)}}const a=EO(t,s,o);a!==void 0&&n.push(a)}return n}function Dq(t,e,n){const r=J8(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?F8(n):tq(n)),r.property==="style"){let i=typeof n=="object"?n:Lq(t,String(n));return t.stylePropertyNameCase==="css"&&(i=Mq(i)),["style",i]}return[t.elementAttributeNameCase==="react"&&r.space?Z8[r.property]||r.property:r.attribute,n]}}function Lq(t,e){const n={};try{gq(e,r)}catch(i){if(!t.ignoreInvalidStyle){const s=i,o=new on("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:s,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw o.file=t.filePath||void 0,o.url=_O+"#cannot-parse-style-attribute",o}}return n;function r(i,s){let o=i;o.slice(0,2)!=="--"&&(o.slice(0,4)==="-ms-"&&(o="ms-"+o.slice(4)),o=o.replace(kq,Fq)),n[o]=s}}function xO(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const i=e.split(".");let s=-1,o;for(;++s<i.length;){const a=UE(i[s])?{type:"Identifier",name:i[s]}:{type:"Literal",value:i[s]};o=o?{type:"MemberExpression",object:o,property:a,computed:!!(s&&a.type==="Literal"),optional:!1}:a}r=o}else r=UE(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const i=r.value;return Yk.call(t.components,i)?t.components[i]:i}if(t.evaluater)return t.evaluater.evaluateExpression(r);Ic(t)}function Ic(t,e){const n=new on("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=_O+"#cannot-handle-mdx-estrees-without-createevaluater",n}function Mq(t){const e={};let n;for(n in t)Yk.call(t,n)&&(e[Uq(n)]=t[n]);return e}function Uq(t){let e=t.replace(bq,jq);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function Fq(t,e){return e.toUpperCase()}function jq(t){return"-"+t.toLowerCase()}const qg={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Vq={};function Bq(t,e){const n=Vq,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return IO(t,r,i)}function IO(t,e,n){if($q(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return GE(t.children,e,n)}return Array.isArray(t)?GE(t,e,n):""}function GE(t,e,n){const r=[];let i=-1;for(;++i<t.length;)r[i]=IO(t[i],e,n);return r.join("")}function $q(t){return!!(t&&typeof t=="object")}const QE=document.createElement("i");function ew(t){const e="&"+t+";";QE.innerHTML=e;const n=QE.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function ai(t,e,n,r){const i=t.length;let s=0,o;if(e<0?e=-e>i?0:i+e:e=e>i?i:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);s<r.length;)o=r.slice(s,s+1e4),o.unshift(e,0),t.splice(...o),s+=1e4,e+=1e4}function tr(t,e){return t.length>0?(ai(t,t.length,0,e),t):e}const JE={}.hasOwnProperty;function zq(t){const e={};let n=-1;for(;++n<t.length;)qq(e,t[n]);return e}function qq(t,e){let n;for(n in e){const i=(JE.call(t,n)?t[n]:void 0)||(t[n]={}),s=e[n];let o;if(s)for(o in s){JE.call(i,o)||(i[o]=[]);const a=s[o];Hq(i[o],Array.isArray(a)?a:a?[a]:[])}}}function Hq(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);ai(t,0,0,r)}function PO(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function Va(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Yr=Qs(/[A-Za-z]/),$n=Qs(/[\dA-Za-z]/),Wq=Qs(/[#-'*+\--9=?A-Z^-~]/);function ib(t){return t!==null&&(t<32||t===127)}const sb=Qs(/\d/),Kq=Qs(/[\dA-Fa-f]/),Gq=Qs(/[!-/:-@[-`{-~]/);function fe(t){return t!==null&&t<-2}function Rn(t){return t!==null&&(t<0||t===32)}function Me(t){return t===-2||t===-1||t===32}const Qq=Qs(new RegExp("\\p{P}|\\p{S}","u")),Jq=Qs(/\s/);function Qs(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Pl(t){const e=[];let n=-1,r=0,i=0;for(;++n<t.length;){const s=t.charCodeAt(n);let o="";if(s===37&&$n(t.charCodeAt(n+1))&&$n(t.charCodeAt(n+2)))i=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const a=t.charCodeAt(n+1);s<56320&&a>56319&&a<57344?(o=String.fromCharCode(s,a),i=1):o="�"}else o=String.fromCharCode(s);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+i+1,o=""),i&&(n+=i,i=0)}return e.join("")+t.slice(r)}function Qe(t,e,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let s=0;return o;function o(l){return Me(l)?(t.enter(n),a(l)):e(l)}function a(l){return Me(l)&&s++<i?(t.consume(l),a):(t.exit(n),e(l))}}const Yq={tokenize:Xq};function Xq(t){const e=t.attempt(this.parser.constructs.contentInitial,r,i);let n;return e;function r(a){if(a===null){t.consume(a);return}return t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),Qe(t,e,"linePrefix")}function i(a){return t.enter("paragraph"),s(a)}function s(a){const l=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=l),n=l,o(a)}function o(a){if(a===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(a);return}return fe(a)?(t.consume(a),t.exit("chunkText"),s):(t.consume(a),o)}}const Zq={tokenize:eH},YE={tokenize:tH};function eH(t){const e=this,n=[];let r=0,i,s,o;return a;function a(T){if(r<n.length){const x=n[r];return e.containerState=x[1],t.attempt(x[0].continuation,l,u)(T)}return u(T)}function l(T){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,i&&w();const x=e.events.length;let I=x,R;for(;I--;)if(e.events[I][0]==="exit"&&e.events[I][1].type==="chunkFlow"){R=e.events[I][1].end;break}y(r);let C=x;for(;C<e.events.length;)e.events[C][1].end={...R},C++;return ai(e.events,I+1,0,e.events.slice(x)),e.events.length=C,u(T)}return a(T)}function u(T){if(r===n.length){if(!i)return h(T);if(i.currentConstruct&&i.currentConstruct.concrete)return g(T);e.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(YE,c,d)(T)}function c(T){return i&&w(),y(r),h(T)}function d(T){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,g(T)}function h(T){return e.containerState={},t.attempt(YE,p,g)(T)}function p(T){return r++,n.push([e.currentConstruct,e.containerState]),h(T)}function g(T){if(T===null){i&&w(),y(0),t.consume(T);return}return i=i||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:s}),m(T)}function m(T){if(T===null){k(t.exit("chunkFlow"),!0),y(0),t.consume(T);return}return fe(T)?(t.consume(T),k(t.exit("chunkFlow")),r=0,e.interrupt=void 0,a):(t.consume(T),m)}function k(T,x){const I=e.sliceStream(T);if(x&&I.push(null),T.previous=s,s&&(s.next=T),s=T,i.defineSkip(T.start),i.write(I),e.parser.lazy[T.start.line]){let R=i.events.length;for(;R--;)if(i.events[R][1].start.offset<o&&(!i.events[R][1].end||i.events[R][1].end.offset>o))return;const C=e.events.length;let _=C,P,N;for(;_--;)if(e.events[_][0]==="exit"&&e.events[_][1].type==="chunkFlow"){if(P){N=e.events[_][1].end;break}P=!0}for(y(r),R=C;R<e.events.length;)e.events[R][1].end={...N},R++;ai(e.events,_+1,0,e.events.slice(C)),e.events.length=R}}function y(T){let x=n.length;for(;x-- >T;){const I=n[x];e.containerState=I[1],I[0].exit.call(e,t)}n.length=T}function w(){i.write([null]),s=void 0,i=void 0,e.containerState._closeFlow=void 0}}function tH(t,e,n){return Qe(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function XE(t){if(t===null||Rn(t)||Jq(t))return 1;if(Qq(t))return 2}function tw(t,e,n){const r=[];let i=-1;for(;++i<t.length;){const s=t[i].resolveAll;s&&!r.includes(s)&&(e=s(e,n),r.push(s))}return e}const ob={name:"attention",resolveAll:nH,tokenize:rH};function nH(t,e){let n=-1,r,i,s,o,a,l,u,c;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;l=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const d={...t[r][1].end},h={...t[n][1].start};ZE(d,-l),ZE(h,l),o={type:l>1?"strongSequence":"emphasisSequence",start:d,end:{...t[r][1].end}},a={type:l>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:h},s={type:l>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},i={type:l>1?"strong":"emphasis",start:{...o.start},end:{...a.end}},t[r][1].end={...o.start},t[n][1].start={...a.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=tr(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=tr(u,[["enter",i,e],["enter",o,e],["exit",o,e],["enter",s,e]]),u=tr(u,tw(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=tr(u,[["exit",s,e],["enter",a,e],["exit",a,e],["exit",i,e]]),t[n][1].end.offset-t[n][1].start.offset?(c=2,u=tr(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):c=0,ai(t,r-1,n-r+3,u),n=r+u.length-c-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function rH(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=XE(r);let s;return o;function o(l){return s=l,t.enter("attentionSequence"),a(l)}function a(l){if(l===s)return t.consume(l),a;const u=t.exit("attentionSequence"),c=XE(l),d=!c||c===2&&i||n.includes(l),h=!i||i===2&&c||n.includes(r);return u._open=!!(s===42?d:d&&(i||!h)),u._close=!!(s===42?h:h&&(c||!d)),e(l)}}function ZE(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const iH={name:"autolink",tokenize:sH};function sH(t,e,n){let r=0;return i;function i(p){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),s}function s(p){return Yr(p)?(t.consume(p),o):p===64?n(p):u(p)}function o(p){return p===43||p===45||p===46||$n(p)?(r=1,a(p)):u(p)}function a(p){return p===58?(t.consume(p),r=0,l):(p===43||p===45||p===46||$n(p))&&r++<32?(t.consume(p),a):(r=0,u(p))}function l(p){return p===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.exit("autolink"),e):p===null||p===32||p===60||ib(p)?n(p):(t.consume(p),l)}function u(p){return p===64?(t.consume(p),c):Wq(p)?(t.consume(p),u):n(p)}function c(p){return $n(p)?d(p):n(p)}function d(p){return p===46?(t.consume(p),r=0,c):p===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(p),t.exit("autolinkMarker"),t.exit("autolink"),e):h(p)}function h(p){if((p===45||$n(p))&&r++<63){const g=p===45?h:d;return t.consume(p),g}return n(p)}}const dm={partial:!0,tokenize:oH};function oH(t,e,n){return r;function r(s){return Me(s)?Qe(t,i,"linePrefix")(s):i(s)}function i(s){return s===null||fe(s)?e(s):n(s)}}const RO={continuation:{tokenize:lH},exit:uH,name:"blockQuote",tokenize:aH};function aH(t,e,n){const r=this;return i;function i(o){if(o===62){const a=r.containerState;return a.open||(t.enter("blockQuote",{_container:!0}),a.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),s}return n(o)}function s(o){return Me(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function lH(t,e,n){const r=this;return i;function i(o){return Me(o)?Qe(t,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):s(o)}function s(o){return t.attempt(RO,e,n)(o)}}function uH(t){t.exit("blockQuote")}const AO={name:"characterEscape",tokenize:cH};function cH(t,e,n){return r;function r(s){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(s),t.exit("escapeMarker"),i}function i(s){return Gq(s)?(t.enter("characterEscapeValue"),t.consume(s),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(s)}}const NO={name:"characterReference",tokenize:dH};function dH(t,e,n){const r=this;let i=0,s,o;return a;function a(d){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(d),t.exit("characterReferenceMarker"),l}function l(d){return d===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(d),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),s=31,o=$n,c(d))}function u(d){return d===88||d===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(d),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),s=6,o=Kq,c):(t.enter("characterReferenceValue"),s=7,o=sb,c(d))}function c(d){if(d===59&&i){const h=t.exit("characterReferenceValue");return o===$n&&!ew(r.sliceSerialize(h))?n(d):(t.enter("characterReferenceMarker"),t.consume(d),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(d)&&i++<s?(t.consume(d),c):n(d)}}const e1={partial:!0,tokenize:hH},t1={concrete:!0,name:"codeFenced",tokenize:fH};function fH(t,e,n){const r=this,i={partial:!0,tokenize:I};let s=0,o=0,a;return l;function l(R){return u(R)}function u(R){const C=r.events[r.events.length-1];return s=C&&C[1].type==="linePrefix"?C[2].sliceSerialize(C[1],!0).length:0,a=R,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),c(R)}function c(R){return R===a?(o++,t.consume(R),c):o<3?n(R):(t.exit("codeFencedFenceSequence"),Me(R)?Qe(t,d,"whitespace")(R):d(R))}function d(R){return R===null||fe(R)?(t.exit("codeFencedFence"),r.interrupt?e(R):t.check(e1,m,x)(R)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),h(R))}function h(R){return R===null||fe(R)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),d(R)):Me(R)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Qe(t,p,"whitespace")(R)):R===96&&R===a?n(R):(t.consume(R),h)}function p(R){return R===null||fe(R)?d(R):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(R))}function g(R){return R===null||fe(R)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),d(R)):R===96&&R===a?n(R):(t.consume(R),g)}function m(R){return t.attempt(i,x,k)(R)}function k(R){return t.enter("lineEnding"),t.consume(R),t.exit("lineEnding"),y}function y(R){return s>0&&Me(R)?Qe(t,w,"linePrefix",s+1)(R):w(R)}function w(R){return R===null||fe(R)?t.check(e1,m,x)(R):(t.enter("codeFlowValue"),T(R))}function T(R){return R===null||fe(R)?(t.exit("codeFlowValue"),w(R)):(t.consume(R),T)}function x(R){return t.exit("codeFenced"),e(R)}function I(R,C,_){let P=0;return N;function N(re){return R.enter("lineEnding"),R.consume(re),R.exit("lineEnding"),A}function A(re){return R.enter("codeFencedFence"),Me(re)?Qe(R,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(re):D(re)}function D(re){return re===a?(R.enter("codeFencedFenceSequence"),L(re)):_(re)}function L(re){return re===a?(P++,R.consume(re),L):P>=o?(R.exit("codeFencedFenceSequence"),Me(re)?Qe(R,ae,"whitespace")(re):ae(re)):_(re)}function ae(re){return re===null||fe(re)?(R.exit("codeFencedFence"),C(re)):_(re)}}}function hH(t,e,n){const r=this;return i;function i(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s)}function s(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const Hg={name:"codeIndented",tokenize:mH},pH={partial:!0,tokenize:gH};function mH(t,e,n){const r=this;return i;function i(u){return t.enter("codeIndented"),Qe(t,s,"linePrefix",5)(u)}function s(u){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?l(u):fe(u)?t.attempt(pH,o,l)(u):(t.enter("codeFlowValue"),a(u))}function a(u){return u===null||fe(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),a)}function l(u){return t.exit("codeIndented"),e(u)}}function gH(t,e,n){const r=this;return i;function i(o){return r.parser.lazy[r.now().line]?n(o):fe(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):Qe(t,s,"linePrefix",5)(o)}function s(o){const a=r.events[r.events.length-1];return a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(o):fe(o)?i(o):n(o)}}const yH={name:"codeText",previous:bH,resolve:vH,tokenize:kH};function vH(t){let e=t.length-4,n=3,r,i;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)i===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(i=r):(r===e||t[r][1].type==="lineEnding")&&(t[i][1].type="codeTextData",r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),e-=r-i-2,r=i+2),i=void 0);return t}function bH(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function kH(t,e,n){let r=0,i,s;return o;function o(d){return t.enter("codeText"),t.enter("codeTextSequence"),a(d)}function a(d){return d===96?(t.consume(d),r++,a):(t.exit("codeTextSequence"),l(d))}function l(d){return d===null?n(d):d===32?(t.enter("space"),t.consume(d),t.exit("space"),l):d===96?(s=t.enter("codeTextSequence"),i=0,c(d)):fe(d)?(t.enter("lineEnding"),t.consume(d),t.exit("lineEnding"),l):(t.enter("codeTextData"),u(d))}function u(d){return d===null||d===32||d===96||fe(d)?(t.exit("codeTextData"),l(d)):(t.consume(d),u)}function c(d){return d===96?(t.consume(d),i++,c):i===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(d)):(s.type="codeTextData",u(d))}}class wH{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const i=n||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&lu(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),lu(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),lu(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);lu(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);lu(this.left,n.reverse())}}}function lu(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function OO(t){const e={};let n=-1,r,i,s,o,a,l,u;const c=new wH(t);for(;++n<c.length;){for(;n in e;)n=e[n];if(r=c.get(n),n&&r[1].type==="chunkFlow"&&c.get(n-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,TH(c,n)),n=e[n],u=!0);else if(r[1]._container){for(s=n,i=void 0;s--;)if(o=c.get(s),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(i&&(c.get(i)[1].type="lineEndingBlank"),o[1].type="lineEnding",i=s);else if(o[1].type!=="linePrefix")break;i&&(r[1].end={...c.get(i)[1].start},a=c.slice(i,n),a.unshift(r),c.splice(i,n-i+1,a))}}return ai(t,0,Number.POSITIVE_INFINITY,c.slice(0)),!u}function TH(t,e){const n=t.get(e)[1],r=t.get(e)[2];let i=e-1;const s=[],o=n._tokenizer||r.parser[n.contentType](n.start),a=o.events,l=[],u={};let c,d,h=-1,p=n,g=0,m=0;const k=[m];for(;p;){for(;t.get(++i)[1]!==p;);s.push(i),p._tokenizer||(c=r.sliceStream(p),p.next||c.push(null),d&&o.defineSkip(p.start),p._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(c),p._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),d=p,p=p.next}for(p=n;++h<a.length;)a[h][0]==="exit"&&a[h-1][0]==="enter"&&a[h][1].type===a[h-1][1].type&&a[h][1].start.line!==a[h][1].end.line&&(m=h+1,k.push(m),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(o.events=[],p?(p._tokenizer=void 0,p.previous=void 0):k.pop(),h=k.length;h--;){const y=a.slice(k[h],k[h+1]),w=s.pop();l.push([w,w+y.length-1]),t.splice(w,2,y)}for(l.reverse(),h=-1;++h<l.length;)u[g+l[h][0]]=g+l[h][1],g+=l[h][1]-l[h][0]-1;return u}const SH={resolve:EH,tokenize:CH},_H={partial:!0,tokenize:xH};function EH(t){return OO(t),t}function CH(t,e){let n;return r;function r(a){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),i(a)}function i(a){return a===null?s(a):fe(a)?t.check(_H,o,s)(a):(t.consume(a),i)}function s(a){return t.exit("chunkContent"),t.exit("content"),e(a)}function o(a){return t.consume(a),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function xH(t,e,n){const r=this;return i;function i(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Qe(t,s,"linePrefix")}function s(o){if(o===null||fe(o))return n(o);const a=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function DO(t,e,n,r,i,s,o,a,l){const u=l||Number.POSITIVE_INFINITY;let c=0;return d;function d(y){return y===60?(t.enter(r),t.enter(i),t.enter(s),t.consume(y),t.exit(s),h):y===null||y===32||y===41||ib(y)?n(y):(t.enter(r),t.enter(o),t.enter(a),t.enter("chunkString",{contentType:"string"}),m(y))}function h(y){return y===62?(t.enter(s),t.consume(y),t.exit(s),t.exit(i),t.exit(r),e):(t.enter(a),t.enter("chunkString",{contentType:"string"}),p(y))}function p(y){return y===62?(t.exit("chunkString"),t.exit(a),h(y)):y===null||y===60||fe(y)?n(y):(t.consume(y),y===92?g:p)}function g(y){return y===60||y===62||y===92?(t.consume(y),p):p(y)}function m(y){return!c&&(y===null||y===41||Rn(y))?(t.exit("chunkString"),t.exit(a),t.exit(o),t.exit(r),e(y)):c<u&&y===40?(t.consume(y),c++,m):y===41?(t.consume(y),c--,m):y===null||y===32||y===40||ib(y)?n(y):(t.consume(y),y===92?k:m)}function k(y){return y===40||y===41||y===92?(t.consume(y),m):m(y)}}function LO(t,e,n,r,i,s){const o=this;let a=0,l;return u;function u(p){return t.enter(r),t.enter(i),t.consume(p),t.exit(i),t.enter(s),c}function c(p){return a>999||p===null||p===91||p===93&&!l||p===94&&!a&&"_hiddenFootnoteSupport"in o.parser.constructs?n(p):p===93?(t.exit(s),t.enter(i),t.consume(p),t.exit(i),t.exit(r),e):fe(p)?(t.enter("lineEnding"),t.consume(p),t.exit("lineEnding"),c):(t.enter("chunkString",{contentType:"string"}),d(p))}function d(p){return p===null||p===91||p===93||fe(p)||a++>999?(t.exit("chunkString"),c(p)):(t.consume(p),l||(l=!Me(p)),p===92?h:d)}function h(p){return p===91||p===92||p===93?(t.consume(p),a++,d):d(p)}}function MO(t,e,n,r,i,s){let o;return a;function a(h){return h===34||h===39||h===40?(t.enter(r),t.enter(i),t.consume(h),t.exit(i),o=h===40?41:h,l):n(h)}function l(h){return h===o?(t.enter(i),t.consume(h),t.exit(i),t.exit(r),e):(t.enter(s),u(h))}function u(h){return h===o?(t.exit(s),l(o)):h===null?n(h):fe(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),Qe(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),c(h))}function c(h){return h===o||h===null||fe(h)?(t.exit("chunkString"),u(h)):(t.consume(h),h===92?d:c)}function d(h){return h===o||h===92?(t.consume(h),c):c(h)}}function zu(t,e){let n;return r;function r(i){return fe(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),n=!0,r):Me(i)?Qe(t,r,n?"linePrefix":"lineSuffix")(i):e(i)}}const IH={name:"definition",tokenize:RH},PH={partial:!0,tokenize:AH};function RH(t,e,n){const r=this;let i;return s;function s(p){return t.enter("definition"),o(p)}function o(p){return LO.call(r,t,a,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function a(p){return i=Va(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),p===58?(t.enter("definitionMarker"),t.consume(p),t.exit("definitionMarker"),l):n(p)}function l(p){return Rn(p)?zu(t,u)(p):u(p)}function u(p){return DO(t,c,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function c(p){return t.attempt(PH,d,d)(p)}function d(p){return Me(p)?Qe(t,h,"whitespace")(p):h(p)}function h(p){return p===null||fe(p)?(t.exit("definition"),r.parser.defined.push(i),e(p)):n(p)}}function AH(t,e,n){return r;function r(a){return Rn(a)?zu(t,i)(a):n(a)}function i(a){return MO(t,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(a)}function s(a){return Me(a)?Qe(t,o,"whitespace")(a):o(a)}function o(a){return a===null||fe(a)?e(a):n(a)}}const NH={name:"hardBreakEscape",tokenize:OH};function OH(t,e,n){return r;function r(s){return t.enter("hardBreakEscape"),t.consume(s),i}function i(s){return fe(s)?(t.exit("hardBreakEscape"),e(s)):n(s)}}const DH={name:"headingAtx",resolve:LH,tokenize:MH};function LH(t,e){let n=t.length-2,r=3,i,s;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},s={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},ai(t,r,n-r+1,[["enter",i,e],["enter",s,e],["exit",s,e],["exit",i,e]])),t}function MH(t,e,n){let r=0;return i;function i(c){return t.enter("atxHeading"),s(c)}function s(c){return t.enter("atxHeadingSequence"),o(c)}function o(c){return c===35&&r++<6?(t.consume(c),o):c===null||Rn(c)?(t.exit("atxHeadingSequence"),a(c)):n(c)}function a(c){return c===35?(t.enter("atxHeadingSequence"),l(c)):c===null||fe(c)?(t.exit("atxHeading"),e(c)):Me(c)?Qe(t,a,"whitespace")(c):(t.enter("atxHeadingText"),u(c))}function l(c){return c===35?(t.consume(c),l):(t.exit("atxHeadingSequence"),a(c))}function u(c){return c===null||c===35||Rn(c)?(t.exit("atxHeadingText"),a(c)):(t.consume(c),u)}}const UH=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],n1=["pre","script","style","textarea"],FH={concrete:!0,name:"htmlFlow",resolveTo:BH,tokenize:$H},jH={partial:!0,tokenize:qH},VH={partial:!0,tokenize:zH};function BH(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function $H(t,e,n){const r=this;let i,s,o,a,l;return u;function u(U){return c(U)}function c(U){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(U),d}function d(U){return U===33?(t.consume(U),h):U===47?(t.consume(U),s=!0,m):U===63?(t.consume(U),i=3,r.interrupt?e:M):Yr(U)?(t.consume(U),o=String.fromCharCode(U),k):n(U)}function h(U){return U===45?(t.consume(U),i=2,p):U===91?(t.consume(U),i=5,a=0,g):Yr(U)?(t.consume(U),i=4,r.interrupt?e:M):n(U)}function p(U){return U===45?(t.consume(U),r.interrupt?e:M):n(U)}function g(U){const be="CDATA[";return U===be.charCodeAt(a++)?(t.consume(U),a===be.length?r.interrupt?e:D:g):n(U)}function m(U){return Yr(U)?(t.consume(U),o=String.fromCharCode(U),k):n(U)}function k(U){if(U===null||U===47||U===62||Rn(U)){const be=U===47,mt=o.toLowerCase();return!be&&!s&&n1.includes(mt)?(i=1,r.interrupt?e(U):D(U)):UH.includes(o.toLowerCase())?(i=6,be?(t.consume(U),y):r.interrupt?e(U):D(U)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(U):s?w(U):T(U))}return U===45||$n(U)?(t.consume(U),o+=String.fromCharCode(U),k):n(U)}function y(U){return U===62?(t.consume(U),r.interrupt?e:D):n(U)}function w(U){return Me(U)?(t.consume(U),w):N(U)}function T(U){return U===47?(t.consume(U),N):U===58||U===95||Yr(U)?(t.consume(U),x):Me(U)?(t.consume(U),T):N(U)}function x(U){return U===45||U===46||U===58||U===95||$n(U)?(t.consume(U),x):I(U)}function I(U){return U===61?(t.consume(U),R):Me(U)?(t.consume(U),I):T(U)}function R(U){return U===null||U===60||U===61||U===62||U===96?n(U):U===34||U===39?(t.consume(U),l=U,C):Me(U)?(t.consume(U),R):_(U)}function C(U){return U===l?(t.consume(U),l=null,P):U===null||fe(U)?n(U):(t.consume(U),C)}function _(U){return U===null||U===34||U===39||U===47||U===60||U===61||U===62||U===96||Rn(U)?I(U):(t.consume(U),_)}function P(U){return U===47||U===62||Me(U)?T(U):n(U)}function N(U){return U===62?(t.consume(U),A):n(U)}function A(U){return U===null||fe(U)?D(U):Me(U)?(t.consume(U),A):n(U)}function D(U){return U===45&&i===2?(t.consume(U),Te):U===60&&i===1?(t.consume(U),ue):U===62&&i===4?(t.consume(U),Se):U===63&&i===3?(t.consume(U),M):U===93&&i===5?(t.consume(U),se):fe(U)&&(i===6||i===7)?(t.exit("htmlFlowData"),t.check(jH,ye,L)(U)):U===null||fe(U)?(t.exit("htmlFlowData"),L(U)):(t.consume(U),D)}function L(U){return t.check(VH,ae,ye)(U)}function ae(U){return t.enter("lineEnding"),t.consume(U),t.exit("lineEnding"),re}function re(U){return U===null||fe(U)?L(U):(t.enter("htmlFlowData"),D(U))}function Te(U){return U===45?(t.consume(U),M):D(U)}function ue(U){return U===47?(t.consume(U),o="",Q):D(U)}function Q(U){if(U===62){const be=o.toLowerCase();return n1.includes(be)?(t.consume(U),Se):D(U)}return Yr(U)&&o.length<8?(t.consume(U),o+=String.fromCharCode(U),Q):D(U)}function se(U){return U===93?(t.consume(U),M):D(U)}function M(U){return U===62?(t.consume(U),Se):U===45&&i===2?(t.consume(U),M):D(U)}function Se(U){return U===null||fe(U)?(t.exit("htmlFlowData"),ye(U)):(t.consume(U),Se)}function ye(U){return t.exit("htmlFlow"),e(U)}}function zH(t,e,n){const r=this;return i;function i(o){return fe(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):n(o)}function s(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function qH(t,e,n){return r;function r(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),t.attempt(dm,e,n)}}const HH={name:"htmlText",tokenize:WH};function WH(t,e,n){const r=this;let i,s,o;return a;function a(M){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(M),l}function l(M){return M===33?(t.consume(M),u):M===47?(t.consume(M),I):M===63?(t.consume(M),T):Yr(M)?(t.consume(M),_):n(M)}function u(M){return M===45?(t.consume(M),c):M===91?(t.consume(M),s=0,g):Yr(M)?(t.consume(M),w):n(M)}function c(M){return M===45?(t.consume(M),p):n(M)}function d(M){return M===null?n(M):M===45?(t.consume(M),h):fe(M)?(o=d,ue(M)):(t.consume(M),d)}function h(M){return M===45?(t.consume(M),p):d(M)}function p(M){return M===62?Te(M):M===45?h(M):d(M)}function g(M){const Se="CDATA[";return M===Se.charCodeAt(s++)?(t.consume(M),s===Se.length?m:g):n(M)}function m(M){return M===null?n(M):M===93?(t.consume(M),k):fe(M)?(o=m,ue(M)):(t.consume(M),m)}function k(M){return M===93?(t.consume(M),y):m(M)}function y(M){return M===62?Te(M):M===93?(t.consume(M),y):m(M)}function w(M){return M===null||M===62?Te(M):fe(M)?(o=w,ue(M)):(t.consume(M),w)}function T(M){return M===null?n(M):M===63?(t.consume(M),x):fe(M)?(o=T,ue(M)):(t.consume(M),T)}function x(M){return M===62?Te(M):T(M)}function I(M){return Yr(M)?(t.consume(M),R):n(M)}function R(M){return M===45||$n(M)?(t.consume(M),R):C(M)}function C(M){return fe(M)?(o=C,ue(M)):Me(M)?(t.consume(M),C):Te(M)}function _(M){return M===45||$n(M)?(t.consume(M),_):M===47||M===62||Rn(M)?P(M):n(M)}function P(M){return M===47?(t.consume(M),Te):M===58||M===95||Yr(M)?(t.consume(M),N):fe(M)?(o=P,ue(M)):Me(M)?(t.consume(M),P):Te(M)}function N(M){return M===45||M===46||M===58||M===95||$n(M)?(t.consume(M),N):A(M)}function A(M){return M===61?(t.consume(M),D):fe(M)?(o=A,ue(M)):Me(M)?(t.consume(M),A):P(M)}function D(M){return M===null||M===60||M===61||M===62||M===96?n(M):M===34||M===39?(t.consume(M),i=M,L):fe(M)?(o=D,ue(M)):Me(M)?(t.consume(M),D):(t.consume(M),ae)}function L(M){return M===i?(t.consume(M),i=void 0,re):M===null?n(M):fe(M)?(o=L,ue(M)):(t.consume(M),L)}function ae(M){return M===null||M===34||M===39||M===60||M===61||M===96?n(M):M===47||M===62||Rn(M)?P(M):(t.consume(M),ae)}function re(M){return M===47||M===62||Rn(M)?P(M):n(M)}function Te(M){return M===62?(t.consume(M),t.exit("htmlTextData"),t.exit("htmlText"),e):n(M)}function ue(M){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(M),t.exit("lineEnding"),Q}function Q(M){return Me(M)?Qe(t,se,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(M):se(M)}function se(M){return t.enter("htmlTextData"),o(M)}}const nw={name:"labelEnd",resolveAll:JH,resolveTo:YH,tokenize:XH},KH={tokenize:ZH},GH={tokenize:eW},QH={tokenize:tW};function JH(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",e+=i}}return t.length!==n.length&&ai(t,0,t.length,n),t}function YH(t,e){let n=t.length,r=0,i,s,o,a;for(;n--;)if(i=t[n][1],s){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;t[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(s=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(o=n);const l={type:t[s][1].type==="labelLink"?"link":"image",start:{...t[s][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[s][1].start},end:{...t[o][1].end}},c={type:"labelText",start:{...t[s+r+2][1].end},end:{...t[o-2][1].start}};return a=[["enter",l,e],["enter",u,e]],a=tr(a,t.slice(s+1,s+r+3)),a=tr(a,[["enter",c,e]]),a=tr(a,tw(e.parser.constructs.insideSpan.null,t.slice(s+r+4,o-3),e)),a=tr(a,[["exit",c,e],t[o-2],t[o-1],["exit",u,e]]),a=tr(a,t.slice(o+1)),a=tr(a,[["exit",l,e]]),ai(t,s,t.length,a),t}function XH(t,e,n){const r=this;let i=r.events.length,s,o;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){s=r.events[i][1];break}return a;function a(h){return s?s._inactive?d(h):(o=r.parser.defined.includes(Va(r.sliceSerialize({start:s.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(h),t.exit("labelMarker"),t.exit("labelEnd"),l):n(h)}function l(h){return h===40?t.attempt(KH,c,o?c:d)(h):h===91?t.attempt(GH,c,o?u:d)(h):o?c(h):d(h)}function u(h){return t.attempt(QH,c,d)(h)}function c(h){return e(h)}function d(h){return s._balanced=!0,n(h)}}function ZH(t,e,n){return r;function r(d){return t.enter("resource"),t.enter("resourceMarker"),t.consume(d),t.exit("resourceMarker"),i}function i(d){return Rn(d)?zu(t,s)(d):s(d)}function s(d){return d===41?c(d):DO(t,o,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(d)}function o(d){return Rn(d)?zu(t,l)(d):c(d)}function a(d){return n(d)}function l(d){return d===34||d===39||d===40?MO(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(d):c(d)}function u(d){return Rn(d)?zu(t,c)(d):c(d)}function c(d){return d===41?(t.enter("resourceMarker"),t.consume(d),t.exit("resourceMarker"),t.exit("resource"),e):n(d)}}function eW(t,e,n){const r=this;return i;function i(a){return LO.call(r,t,s,o,"reference","referenceMarker","referenceString")(a)}function s(a){return r.parser.defined.includes(Va(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(a):n(a)}function o(a){return n(a)}}function tW(t,e,n){return r;function r(s){return t.enter("reference"),t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),i}function i(s){return s===93?(t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),t.exit("reference"),e):n(s)}}const nW={name:"labelStartImage",resolveAll:nw.resolveAll,tokenize:rW};function rW(t,e,n){const r=this;return i;function i(a){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(a),t.exit("labelImageMarker"),s}function s(a){return a===91?(t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelImage"),o):n(a)}function o(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(a):e(a)}}const iW={name:"labelStartLink",resolveAll:nw.resolveAll,tokenize:sW};function sW(t,e,n){const r=this;return i;function i(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const Wg={name:"lineEnding",tokenize:oW};function oW(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Qe(t,e,"linePrefix")}}const Vf={name:"thematicBreak",tokenize:aW};function aW(t,e,n){let r=0,i;return s;function s(u){return t.enter("thematicBreak"),o(u)}function o(u){return i=u,a(u)}function a(u){return u===i?(t.enter("thematicBreakSequence"),l(u)):r>=3&&(u===null||fe(u))?(t.exit("thematicBreak"),e(u)):n(u)}function l(u){return u===i?(t.consume(u),r++,l):(t.exit("thematicBreakSequence"),Me(u)?Qe(t,a,"whitespace")(u):a(u))}}const yn={continuation:{tokenize:dW},exit:hW,name:"list",tokenize:cW},lW={partial:!0,tokenize:pW},uW={partial:!0,tokenize:fW};function cW(t,e,n){const r=this,i=r.events[r.events.length-1];let s=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,o=0;return a;function a(p){const g=r.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||p===r.containerState.marker:sb(p)){if(r.containerState.type||(r.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),p===42||p===45?t.check(Vf,n,u)(p):u(p);if(!r.interrupt||p===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),l(p)}return n(p)}function l(p){return sb(p)&&++o<10?(t.consume(p),l):(!r.interrupt||o<2)&&(r.containerState.marker?p===r.containerState.marker:p===41||p===46)?(t.exit("listItemValue"),u(p)):n(p)}function u(p){return t.enter("listItemMarker"),t.consume(p),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||p,t.check(dm,r.interrupt?n:c,t.attempt(lW,h,d))}function c(p){return r.containerState.initialBlankLine=!0,s++,h(p)}function d(p){return Me(p)?(t.enter("listItemPrefixWhitespace"),t.consume(p),t.exit("listItemPrefixWhitespace"),h):n(p)}function h(p){return r.containerState.size=s+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(p)}}function dW(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(dm,i,s);function i(a){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Qe(t,e,"listItemIndent",r.containerState.size+1)(a)}function s(a){return r.containerState.furtherBlankLines||!Me(a)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(a)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(uW,e,o)(a))}function o(a){return r.containerState._closeFlow=!0,r.interrupt=void 0,Qe(t,t.attempt(yn,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a)}}function fW(t,e,n){const r=this;return Qe(t,i,"listItemIndent",r.containerState.size+1);function i(s){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(s):n(s)}}function hW(t){t.exit(this.containerState.type)}function pW(t,e,n){const r=this;return Qe(t,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(s){const o=r.events[r.events.length-1];return!Me(s)&&o&&o[1].type==="listItemPrefixWhitespace"?e(s):n(s)}}const r1={name:"setextUnderline",resolveTo:mW,tokenize:gW};function mW(t,e){let n=t.length,r,i,s;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(i=n)}else t[n][1].type==="content"&&t.splice(n,1),!s&&t[n][1].type==="definition"&&(s=n);const o={type:"setextHeading",start:{...t[i][1].start},end:{...t[t.length-1][1].end}};return t[i][1].type="setextHeadingText",s?(t.splice(i,0,["enter",o,e]),t.splice(s+1,0,["exit",t[r][1],e]),t[r][1].end={...t[s][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function gW(t,e,n){const r=this;let i;return s;function s(u){let c=r.events.length,d;for(;c--;)if(r.events[c][1].type!=="lineEnding"&&r.events[c][1].type!=="linePrefix"&&r.events[c][1].type!=="content"){d=r.events[c][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||d)?(t.enter("setextHeadingLine"),i=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),a(u)}function a(u){return u===i?(t.consume(u),a):(t.exit("setextHeadingLineSequence"),Me(u)?Qe(t,l,"lineSuffix")(u):l(u))}function l(u){return u===null||fe(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const yW={tokenize:vW};function vW(t){const e=this,n=t.attempt(dm,r,t.attempt(this.parser.constructs.flowInitial,i,Qe(t,t.attempt(this.parser.constructs.flow,i,t.attempt(SH,i)),"linePrefix")));return n;function r(s){if(s===null){t.consume(s);return}return t.enter("lineEndingBlank"),t.consume(s),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function i(s){if(s===null){t.consume(s);return}return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const bW={resolveAll:FO()},kW=UO("string"),wW=UO("text");function UO(t){return{resolveAll:FO(t==="text"?TW:void 0),tokenize:e};function e(n){const r=this,i=this.parser.constructs[t],s=n.attempt(i,o,a);return o;function o(c){return u(c)?s(c):a(c)}function a(c){if(c===null){n.consume(c);return}return n.enter("data"),n.consume(c),l}function l(c){return u(c)?(n.exit("data"),s(c)):(n.consume(c),l)}function u(c){if(c===null)return!0;const d=i[c];let h=-1;if(d)for(;++h<d.length;){const p=d[h];if(!p.previous||p.previous.call(r,r.previous))return!0}return!1}}}function FO(t){return e;function e(n,r){let i=-1,s;for(;++i<=n.length;)s===void 0?n[i]&&n[i][1].type==="data"&&(s=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==s+2&&(n[s][1].end=n[i-1][1].end,n.splice(s+2,i-s-2),i=s+2),s=void 0);return t?t(n,r):n}}function TW(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],i=e.sliceStream(r);let s=i.length,o=-1,a=0,l;for(;s--;){const u=i[s];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)a++,o--;if(o)break;o=-1}else if(u===-2)l=!0,a++;else if(u!==-1){s++;break}}if(a){const u={type:n===t.length||l||a<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?o:r.start._bufferIndex+o,_index:r.start._index+s,line:r.end.line,column:r.end.column-a,offset:r.end.offset-a},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const SW={42:yn,43:yn,45:yn,48:yn,49:yn,50:yn,51:yn,52:yn,53:yn,54:yn,55:yn,56:yn,57:yn,62:RO},_W={91:IH},EW={[-2]:Hg,[-1]:Hg,32:Hg},CW={35:DH,42:Vf,45:[r1,Vf],60:FH,61:r1,95:Vf,96:t1,126:t1},xW={38:NO,92:AO},IW={[-5]:Wg,[-4]:Wg,[-3]:Wg,33:nW,38:NO,42:ob,60:[iH,HH],91:iW,92:[NH,AO],93:nw,95:ob,96:yH},PW={null:[ob,bW]},RW={null:[42,95]},AW={null:[]},NW=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:RW,contentInitial:_W,disable:AW,document:SW,flow:CW,flowInitial:EW,insideSpan:PW,string:xW,text:IW},Symbol.toStringTag,{value:"Module"}));function OW(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},s=[];let o=[],a=[];const l={attempt:C(I),check:C(R),consume:w,enter:T,exit:x,interrupt:C(R,{interrupt:!0})},u={code:null,containerState:{},defineSkip:m,events:[],now:g,parser:t,previous:null,sliceSerialize:h,sliceStream:p,write:d};let c=e.tokenize.call(u,l);return e.resolveAll&&s.push(e),u;function d(A){return o=tr(o,A),k(),o[o.length-1]!==null?[]:(_(e,0),u.events=tw(s,u.events,u),u.events)}function h(A,D){return LW(p(A),D)}function p(A){return DW(o,A)}function g(){const{_bufferIndex:A,_index:D,line:L,column:ae,offset:re}=r;return{_bufferIndex:A,_index:D,line:L,column:ae,offset:re}}function m(A){i[A.line]=A.column,N()}function k(){let A;for(;r._index<o.length;){const D=o[r._index];if(typeof D=="string")for(A=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===A&&r._bufferIndex<D.length;)y(D.charCodeAt(r._bufferIndex));else y(D)}}function y(A){c=c(A)}function w(A){fe(A)?(r.line++,r.column=1,r.offset+=A===-3?2:1,N()):A!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=A}function T(A,D){const L=D||{};return L.type=A,L.start=g(),u.events.push(["enter",L,u]),a.push(L),L}function x(A){const D=a.pop();return D.end=g(),u.events.push(["exit",D,u]),D}function I(A,D){_(A,D.from)}function R(A,D){D.restore()}function C(A,D){return L;function L(ae,re,Te){let ue,Q,se,M;return Array.isArray(ae)?ye(ae):"tokenize"in ae?ye([ae]):Se(ae);function Se($e){return ln;function ln(Br){const Gi=Br!==null&&$e[Br],pr=Br!==null&&$e.null,fi=[...Array.isArray(Gi)?Gi:Gi?[Gi]:[],...Array.isArray(pr)?pr:pr?[pr]:[]];return ye(fi)(Br)}}function ye($e){return ue=$e,Q=0,$e.length===0?Te:U($e[Q])}function U($e){return ln;function ln(Br){return M=P(),se=$e,$e.partial||(u.currentConstruct=$e),$e.name&&u.parser.constructs.disable.null.includes($e.name)?mt():$e.tokenize.call(D?Object.assign(Object.create(u),D):u,l,be,mt)(Br)}}function be($e){return A(se,M),re}function mt($e){return M.restore(),++Q<ue.length?U(ue[Q]):Te}}}function _(A,D){A.resolveAll&&!s.includes(A)&&s.push(A),A.resolve&&ai(u.events,D,u.events.length-D,A.resolve(u.events.slice(D),u)),A.resolveTo&&(u.events=A.resolveTo(u.events,u))}function P(){const A=g(),D=u.previous,L=u.currentConstruct,ae=u.events.length,re=Array.from(a);return{from:ae,restore:Te};function Te(){r=A,u.previous=D,u.currentConstruct=L,u.events.length=ae,a=re,N()}}function N(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function DW(t,e){const n=e.start._index,r=e.start._bufferIndex,i=e.end._index,s=e.end._bufferIndex;let o;if(n===i)o=[t[n].slice(r,s)];else{if(o=t.slice(n,i),r>-1){const a=o[0];typeof a=="string"?o[0]=a.slice(r):o.shift()}s>0&&o.push(t[i].slice(0,s))}return o}function LW(t,e){let n=-1;const r=[];let i;for(;++n<t.length;){const s=t[n];let o;if(typeof s=="string")o=s;else switch(s){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&i)continue;o=" ";break}default:o=String.fromCharCode(s)}i=s===-2,r.push(o)}return r.join("")}function MW(t){const r={constructs:zq([NW,...(t||{}).extensions||[]]),content:i(Yq),defined:[],document:i(Zq),flow:i(yW),lazy:{},string:i(kW),text:i(wW)};return r;function i(s){return o;function o(a){return OW(r,s,a)}}}function UW(t){for(;!OO(t););return t}const i1=/[\0\t\n\r]/g;function FW(){let t=1,e="",n=!0,r;return i;function i(s,o,a){const l=[];let u,c,d,h,p;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(o||void 0).decode(s)),d=0,e="",n&&(s.charCodeAt(0)===65279&&d++,n=void 0);d<s.length;){if(i1.lastIndex=d,u=i1.exec(s),h=u&&u.index!==void 0?u.index:s.length,p=s.charCodeAt(h),!u){e=s.slice(d);break}if(p===10&&d===h&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),d<h&&(l.push(s.slice(d,h)),t+=h-d),p){case 0:{l.push(65533),t++;break}case 9:{for(c=Math.ceil(t/4)*4,l.push(-2);t++<c;)l.push(-1);break}case 10:{l.push(-4),t=1;break}default:r=!0,t=1}d=h+1}return a&&(r&&l.push(-5),e&&l.push(e),l.push(null)),l}}const jW=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function VW(t){return t.replace(jW,BW)}function BW(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),s=i===120||i===88;return PO(n.slice(s?2:1),s?16:10)}return ew(n)||t}const jO={}.hasOwnProperty;function $W(t,e,n){return typeof e!="string"&&(n=e,e=void 0),zW(n)(UW(MW(n).document().write(FW()(t,e,!0))))}function zW(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(Fl),autolinkProtocol:P,autolinkEmail:P,atxHeading:s(Jo),blockQuote:s(pr),characterEscape:P,characterReference:P,codeFenced:s(fi),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:s(fi,o),codeText:s(Dl,o),codeTextData:P,data:P,codeFlowValue:P,definition:s(Ll),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:s(Ml),hardBreakEscape:s(Ul),hardBreakTrailing:s(Ul),htmlFlow:s(hd,o),htmlFlowData:P,htmlText:s(hd,o),htmlTextData:P,image:s(Lm),label:o,link:s(Fl),listItem:s(pd),listItemValue:h,listOrdered:s(Yo,d),listUnordered:s(Yo),paragraph:s(Mm),reference:U,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:s(Jo),strong:s(jl),thematicBreak:s(md)},exit:{atxHeading:l(),atxHeadingSequence:I,autolink:l(),autolinkEmail:Gi,autolinkProtocol:Br,blockQuote:l(),characterEscapeValue:N,characterReferenceMarkerHexadecimal:mt,characterReferenceMarkerNumeric:mt,characterReferenceValue:$e,characterReference:ln,codeFenced:l(k),codeFencedFence:m,codeFencedFenceInfo:p,codeFencedFenceMeta:g,codeFlowValue:N,codeIndented:l(y),codeText:l(re),codeTextData:N,data:N,definition:l(),definitionDestinationString:x,definitionLabelString:w,definitionTitleString:T,emphasis:l(),hardBreakEscape:l(D),hardBreakTrailing:l(D),htmlFlow:l(L),htmlFlowData:N,htmlText:l(ae),htmlTextData:N,image:l(ue),label:se,labelText:Q,lineEnding:A,link:l(Te),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:be,resourceDestinationString:M,resourceTitleString:Se,resource:ye,setextHeading:l(_),setextHeadingLineSequence:C,setextHeadingText:R,strong:l(),thematicBreak:l()}};VO(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(q){let Y={type:"root",children:[]};const de={stack:[Y],tokenStack:[],config:e,enter:a,exit:u,buffer:o,resume:c,data:n},_e=[];let Fe=-1;for(;++Fe<q.length;)if(q[Fe][1].type==="listOrdered"||q[Fe][1].type==="listUnordered")if(q[Fe][0]==="enter")_e.push(Fe);else{const Dn=_e.pop();Fe=i(q,Dn,Fe)}for(Fe=-1;++Fe<q.length;){const Dn=e[q[Fe][0]];jO.call(Dn,q[Fe][1].type)&&Dn[q[Fe][1].type].call(Object.assign({sliceSerialize:q[Fe][2].sliceSerialize},de),q[Fe][1])}if(de.tokenStack.length>0){const Dn=de.tokenStack[de.tokenStack.length-1];(Dn[1]||s1).call(de,void 0,Dn[0])}for(Y.position={start:ns(q.length>0?q[0][1].start:{line:1,column:1,offset:0}),end:ns(q.length>0?q[q.length-2][1].end:{line:1,column:1,offset:0})},Fe=-1;++Fe<e.transforms.length;)Y=e.transforms[Fe](Y)||Y;return Y}function i(q,Y,de){let _e=Y-1,Fe=-1,Dn=!1,Ln,Xn,Qi,hi;for(;++_e<=de;){const un=q[_e];switch(un[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{un[0]==="enter"?Fe++:Fe--,hi=void 0;break}case"lineEndingBlank":{un[0]==="enter"&&(Ln&&!hi&&!Fe&&!Qi&&(Qi=_e),hi=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:hi=void 0}if(!Fe&&un[0]==="enter"&&un[1].type==="listItemPrefix"||Fe===-1&&un[0]==="exit"&&(un[1].type==="listUnordered"||un[1].type==="listOrdered")){if(Ln){let Ji=_e;for(Xn=void 0;Ji--;){const Mn=q[Ji];if(Mn[1].type==="lineEnding"||Mn[1].type==="lineEndingBlank"){if(Mn[0]==="exit")continue;Xn&&(q[Xn][1].type="lineEndingBlank",Dn=!0),Mn[1].type="lineEnding",Xn=Ji}else if(!(Mn[1].type==="linePrefix"||Mn[1].type==="blockQuotePrefix"||Mn[1].type==="blockQuotePrefixWhitespace"||Mn[1].type==="blockQuoteMarker"||Mn[1].type==="listItemIndent"))break}Qi&&(!Xn||Qi<Xn)&&(Ln._spread=!0),Ln.end=Object.assign({},Xn?q[Xn][1].start:un[1].end),q.splice(Xn||_e,0,["exit",Ln,un[2]]),_e++,de++}if(un[1].type==="listItemPrefix"){const Ji={type:"listItem",_spread:!1,start:Object.assign({},un[1].start),end:void 0};Ln=Ji,q.splice(_e,0,["enter",Ji,un[2]]),_e++,de++,Qi=void 0,hi=!0}}}return q[Y][1]._spread=Dn,de}function s(q,Y){return de;function de(_e){a.call(this,q(_e),_e),Y&&Y.call(this,_e)}}function o(){this.stack.push({type:"fragment",children:[]})}function a(q,Y,de){this.stack[this.stack.length-1].children.push(q),this.stack.push(q),this.tokenStack.push([Y,de||void 0]),q.position={start:ns(Y.start),end:void 0}}function l(q){return Y;function Y(de){q&&q.call(this,de),u.call(this,de)}}function u(q,Y){const de=this.stack.pop(),_e=this.tokenStack.pop();if(_e)_e[0].type!==q.type&&(Y?Y.call(this,q,_e[0]):(_e[1]||s1).call(this,q,_e[0]));else throw new Error("Cannot close `"+q.type+"` ("+$u({start:q.start,end:q.end})+"): it’s not open");de.position.end=ns(q.end)}function c(){return Bq(this.stack.pop())}function d(){this.data.expectingFirstListItemValue=!0}function h(q){if(this.data.expectingFirstListItemValue){const Y=this.stack[this.stack.length-2];Y.start=Number.parseInt(this.sliceSerialize(q),10),this.data.expectingFirstListItemValue=void 0}}function p(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.lang=q}function g(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.meta=q}function m(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function k(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.value=q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function y(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.value=q.replace(/(\r?\n|\r)$/g,"")}function w(q){const Y=this.resume(),de=this.stack[this.stack.length-1];de.label=Y,de.identifier=Va(this.sliceSerialize(q)).toLowerCase()}function T(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.title=q}function x(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.url=q}function I(q){const Y=this.stack[this.stack.length-1];if(!Y.depth){const de=this.sliceSerialize(q).length;Y.depth=de}}function R(){this.data.setextHeadingSlurpLineEnding=!0}function C(q){const Y=this.stack[this.stack.length-1];Y.depth=this.sliceSerialize(q).codePointAt(0)===61?1:2}function _(){this.data.setextHeadingSlurpLineEnding=void 0}function P(q){const de=this.stack[this.stack.length-1].children;let _e=de[de.length-1];(!_e||_e.type!=="text")&&(_e=Vl(),_e.position={start:ns(q.start),end:void 0},de.push(_e)),this.stack.push(_e)}function N(q){const Y=this.stack.pop();Y.value+=this.sliceSerialize(q),Y.position.end=ns(q.end)}function A(q){const Y=this.stack[this.stack.length-1];if(this.data.atHardBreak){const de=Y.children[Y.children.length-1];de.position.end=ns(q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(Y.type)&&(P.call(this,q),N.call(this,q))}function D(){this.data.atHardBreak=!0}function L(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.value=q}function ae(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.value=q}function re(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.value=q}function Te(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const Y=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=Y,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function ue(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const Y=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=Y,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function Q(q){const Y=this.sliceSerialize(q),de=this.stack[this.stack.length-2];de.label=VW(Y),de.identifier=Va(Y).toLowerCase()}function se(){const q=this.stack[this.stack.length-1],Y=this.resume(),de=this.stack[this.stack.length-1];if(this.data.inReference=!0,de.type==="link"){const _e=q.children;de.children=_e}else de.alt=Y}function M(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.url=q}function Se(){const q=this.resume(),Y=this.stack[this.stack.length-1];Y.title=q}function ye(){this.data.inReference=void 0}function U(){this.data.referenceType="collapsed"}function be(q){const Y=this.resume(),de=this.stack[this.stack.length-1];de.label=Y,de.identifier=Va(this.sliceSerialize(q)).toLowerCase(),this.data.referenceType="full"}function mt(q){this.data.characterReferenceType=q.type}function $e(q){const Y=this.sliceSerialize(q),de=this.data.characterReferenceType;let _e;de?(_e=PO(Y,de==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):_e=ew(Y);const Fe=this.stack[this.stack.length-1];Fe.value+=_e}function ln(q){const Y=this.stack.pop();Y.position.end=ns(q.end)}function Br(q){N.call(this,q);const Y=this.stack[this.stack.length-1];Y.url=this.sliceSerialize(q)}function Gi(q){N.call(this,q);const Y=this.stack[this.stack.length-1];Y.url="mailto:"+this.sliceSerialize(q)}function pr(){return{type:"blockquote",children:[]}}function fi(){return{type:"code",lang:null,meta:null,value:""}}function Dl(){return{type:"inlineCode",value:""}}function Ll(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ml(){return{type:"emphasis",children:[]}}function Jo(){return{type:"heading",depth:0,children:[]}}function Ul(){return{type:"break"}}function hd(){return{type:"html",value:""}}function Lm(){return{type:"image",title:null,url:"",alt:null}}function Fl(){return{type:"link",title:null,url:"",children:[]}}function Yo(q){return{type:"list",ordered:q.type==="listOrdered",start:null,spread:q._spread,children:[]}}function pd(q){return{type:"listItem",spread:q._spread,checked:null,children:[]}}function Mm(){return{type:"paragraph",children:[]}}function jl(){return{type:"strong",children:[]}}function Vl(){return{type:"text",value:""}}function md(){return{type:"thematicBreak"}}}function ns(t){return{line:t.line,column:t.column,offset:t.offset}}function VO(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?VO(t,r):qW(t,r)}}function qW(t,e){let n;for(n in e)if(jO.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function s1(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+$u({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+$u({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+$u({start:e.start,end:e.end})+") is still open")}function HW(t){const e=this;e.parser=n;function n(r){return $W(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function WW(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function KW(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function GW(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(i.data={meta:e.meta}),t.patch(e,i),i=t.applyData(e,i),i={type:"element",tagName:"pre",properties:{},children:[i]},t.patch(e,i),i}function QW(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function JW(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function YW(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),i=Pl(r.toLowerCase()),s=t.footnoteOrder.indexOf(r);let o,a=t.footnoteCounts.get(r);a===void 0?(a=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=s+1,a+=1,t.footnoteCounts.set(r,a);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(a>1?"-"+a:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,l);const u={type:"element",tagName:"sup",properties:{},children:[l]};return t.patch(e,u),t.applyData(e,u)}function XW(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function ZW(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function BO(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const i=t.all(e),s=i[0];s&&s.type==="text"?s.value="["+s.value:i.unshift({type:"text",value:"["});const o=i[i.length-1];return o&&o.type==="text"?o.value+=r:i.push({type:"text",value:r}),i}function eK(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return BO(t,e);const i={src:Pl(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"img",properties:i,children:[]};return t.patch(e,s),t.applyData(e,s)}function tK(t,e){const n={src:Pl(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function nK(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function rK(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return BO(t,e);const i={href:Pl(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"a",properties:i,children:t.all(e)};return t.patch(e,s),t.applyData(e,s)}function iK(t,e){const n={href:Pl(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function sK(t,e,n){const r=t.all(e),i=n?oK(n):$O(e),s={},o=[];if(typeof e.checked=="boolean"){const c=r[0];let d;c&&c.type==="element"&&c.tagName==="p"?d=c:(d={type:"element",tagName:"p",properties:{},children:[]},r.unshift(d)),d.children.length>0&&d.children.unshift({type:"text",value:" "}),d.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let a=-1;for(;++a<r.length;){const c=r[a];(i||a!==0||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!i?o.push(...c.children):o.push(c)}const l=r[r.length-1];l&&(i||l.type!=="element"||l.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:s,children:o};return t.patch(e,u),t.applyData(e,u)}function oK(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=$O(n[r])}return e}function $O(t){const e=t.spread;return e??t.children.length>1}function aK(t,e){const n={},r=t.all(e);let i=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++i<r.length;){const o=r[i];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,s),t.applyData(e,s)}function lK(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function uK(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function cK(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function dK(t,e){const n=t.all(e),r=n.shift(),i=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),i.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},a=Jk(e.children[1]),l=TO(e.children[e.children.length-1]);a&&l&&(o.position={start:a,end:l}),i.push(o)}const s={type:"element",tagName:"table",properties:{},children:t.wrap(i,!0)};return t.patch(e,s),t.applyData(e,s)}function fK(t,e,n){const r=n?n.children:void 0,s=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,a=o?o.length:e.children.length;let l=-1;const u=[];for(;++l<a;){const d=e.children[l],h={},p=o?o[l]:void 0;p&&(h.align=p);let g={type:"element",tagName:s,properties:h,children:[]};d&&(g.children=t.all(d),t.patch(d,g),g=t.applyData(d,g)),u.push(g)}const c={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,c),t.applyData(e,c)}function hK(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const o1=9,a1=32;function pK(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),i=0;const s=[];for(;r;)s.push(l1(e.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(e);return s.push(l1(e.slice(i),i>0,!1)),s.join("")}function l1(t,e,n){let r=0,i=t.length;if(e){let s=t.codePointAt(r);for(;s===o1||s===a1;)r++,s=t.codePointAt(r)}if(n){let s=t.codePointAt(i-1);for(;s===o1||s===a1;)i--,s=t.codePointAt(i-1)}return i>r?t.slice(r,i):""}function mK(t,e){const n={type:"text",value:pK(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function gK(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const yK={blockquote:WW,break:KW,code:GW,delete:QW,emphasis:JW,footnoteReference:YW,heading:XW,html:ZW,imageReference:eK,image:tK,inlineCode:nK,linkReference:rK,link:iK,listItem:sK,list:aK,paragraph:lK,root:uK,strong:cK,table:dK,tableCell:hK,tableRow:fK,text:mK,thematicBreak:gK,toml:tf,yaml:tf,definition:tf,footnoteDefinition:tf};function tf(){}const zO=-1,fm=0,qu=1,Yh=2,rw=3,iw=4,sw=5,ow=6,qO=7,HO=8,u1=typeof self=="object"?self:globalThis,vK=(t,e)=>{const n=(i,s)=>(t.set(s,i),i),r=i=>{if(t.has(i))return t.get(i);const[s,o]=e[i];switch(s){case fm:case zO:return n(o,i);case qu:{const a=n([],i);for(const l of o)a.push(r(l));return a}case Yh:{const a=n({},i);for(const[l,u]of o)a[r(l)]=r(u);return a}case rw:return n(new Date(o),i);case iw:{const{source:a,flags:l}=o;return n(new RegExp(a,l),i)}case sw:{const a=n(new Map,i);for(const[l,u]of o)a.set(r(l),r(u));return a}case ow:{const a=n(new Set,i);for(const l of o)a.add(r(l));return a}case qO:{const{name:a,message:l}=o;return n(new u1[a](l),i)}case HO:return n(BigInt(o),i);case"BigInt":return n(Object(BigInt(o)),i);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:a}=new Uint8Array(o);return n(new DataView(a),o)}}return n(new u1[s](o),i)};return r},c1=t=>vK(new Map,t)(0),ra="",{toString:bK}={},{keys:kK}=Object,uu=t=>{const e=typeof t;if(e!=="object"||!t)return[fm,e];const n=bK.call(t).slice(8,-1);switch(n){case"Array":return[qu,ra];case"Object":return[Yh,ra];case"Date":return[rw,ra];case"RegExp":return[iw,ra];case"Map":return[sw,ra];case"Set":return[ow,ra];case"DataView":return[qu,n]}return n.includes("Array")?[qu,n]:n.includes("Error")?[qO,n]:[Yh,n]},nf=([t,e])=>t===fm&&(e==="function"||e==="symbol"),wK=(t,e,n,r)=>{const i=(o,a)=>{const l=r.push(o)-1;return n.set(a,l),l},s=o=>{if(n.has(o))return n.get(o);let[a,l]=uu(o);switch(a){case fm:{let c=o;switch(l){case"bigint":a=HO,c=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+l);c=null;break;case"undefined":return i([zO],o)}return i([a,c],o)}case qu:{if(l){let h=o;return l==="DataView"?h=new Uint8Array(o.buffer):l==="ArrayBuffer"&&(h=new Uint8Array(o)),i([l,[...h]],o)}const c=[],d=i([a,c],o);for(const h of o)c.push(s(h));return d}case Yh:{if(l)switch(l){case"BigInt":return i([l,o.toString()],o);case"Boolean":case"Number":case"String":return i([l,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const c=[],d=i([a,c],o);for(const h of kK(o))(t||!nf(uu(o[h])))&&c.push([s(h),s(o[h])]);return d}case rw:return i([a,o.toISOString()],o);case iw:{const{source:c,flags:d}=o;return i([a,{source:c,flags:d}],o)}case sw:{const c=[],d=i([a,c],o);for(const[h,p]of o)(t||!(nf(uu(h))||nf(uu(p))))&&c.push([s(h),s(p)]);return d}case ow:{const c=[],d=i([a,c],o);for(const h of o)(t||!nf(uu(h)))&&c.push(s(h));return d}}const{message:u}=o;return i([a,{name:l,message:u}],o)};return s},d1=(t,{json:e,lossy:n}={})=>{const r=[];return wK(!(e||n),!!e,new Map,r)(t),r},Xh=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?c1(d1(t,e)):structuredClone(t):(t,e)=>c1(d1(t,e));function TK(t,e){const n=[{type:"text",value:"↩"}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function SK(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function _K(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||TK,r=t.options.footnoteBackLabel||SK,i=t.options.footnoteLabel||"Footnotes",s=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},a=[];let l=-1;for(;++l<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[l]);if(!u)continue;const c=t.all(u),d=String(u.identifier).toUpperCase(),h=Pl(d.toLowerCase());let p=0;const g=[],m=t.footnoteCounts.get(d);for(;m!==void 0&&++p<=m;){g.length>0&&g.push({type:"text",value:" "});let w=typeof n=="string"?n:n(l,p);typeof w=="string"&&(w={type:"text",value:w}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+h+(p>1?"-"+p:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(l,p),className:["data-footnote-backref"]},children:Array.isArray(w)?w:[w]})}const k=c[c.length-1];if(k&&k.type==="element"&&k.tagName==="p"){const w=k.children[k.children.length-1];w&&w.type==="text"?w.value+=" ":k.children.push({type:"text",value:" "}),k.children.push(...g)}else c.push(...g);const y={type:"element",tagName:"li",properties:{id:e+"fn-"+h},children:t.wrap(c,!0)};t.patch(u,y),a.push(y)}if(a.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Xh(o),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(a,!0)},{type:"text",value:`
`}]}}const WO=function(t){if(t==null)return IK;if(typeof t=="function")return hm(t);if(typeof t=="object")return Array.isArray(t)?EK(t):CK(t);if(typeof t=="string")return xK(t);throw new Error("Expected function, string, or object as test")};function EK(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=WO(t[n]);return hm(r);function r(...i){let s=-1;for(;++s<e.length;)if(e[s].apply(this,i))return!0;return!1}}function CK(t){const e=t;return hm(n);function n(r){const i=r;let s;for(s in t)if(i[s]!==e[s])return!1;return!0}}function xK(t){return hm(e);function e(n){return n&&n.type===t}}function hm(t){return e;function e(n,r,i){return!!(PK(n)&&t.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function IK(){return!0}function PK(t){return t!==null&&typeof t=="object"&&"type"in t}const KO=[],RK=!0,f1=!1,AK="skip";function NK(t,e,n,r){let i;typeof e=="function"&&typeof n!="function"?(r=n,n=e):i=e;const s=WO(i),o=r?-1:1;a(t,void 0,[])();function a(l,u,c){const d=l&&typeof l=="object"?l:{};if(typeof d.type=="string"){const p=typeof d.tagName=="string"?d.tagName:typeof d.name=="string"?d.name:void 0;Object.defineProperty(h,"name",{value:"node ("+(l.type+(p?"<"+p+">":""))+")"})}return h;function h(){let p=KO,g,m,k;if((!e||s(l,u,c[c.length-1]||void 0))&&(p=OK(n(l,c)),p[0]===f1))return p;if("children"in l&&l.children){const y=l;if(y.children&&p[0]!==AK)for(m=(r?y.children.length:-1)+o,k=c.concat(y);m>-1&&m<y.children.length;){const w=y.children[m];if(g=a(w,m,k)(),g[0]===f1)return g;m=typeof g[1]=="number"?g[1]:m+o}}return p}}}function OK(t){return Array.isArray(t)?t:typeof t=="number"?[RK,t]:t==null?KO:[t]}function GO(t,e,n,r){let i,s,o;typeof e=="function"?(s=void 0,o=e,i=n):(s=e,o=n,i=r),NK(t,s,a,i);function a(l,u){const c=u[u.length-1],d=c?c.children.indexOf(l):void 0;return o(l,d,c)}}const ab={}.hasOwnProperty,DK={};function LK(t,e){const n=e||DK,r=new Map,i=new Map,s=new Map,o={...yK,...n.handlers},a={all:u,applyData:UK,definitionById:r,footnoteById:i,footnoteCounts:s,footnoteOrder:[],handlers:o,one:l,options:n,patch:MK,wrap:jK};return GO(t,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const d=c.type==="definition"?r:i,h=String(c.identifier).toUpperCase();d.has(h)||d.set(h,c)}}),a;function l(c,d){const h=c.type,p=a.handlers[h];if(ab.call(a.handlers,h)&&p)return p(a,c,d);if(a.options.passThrough&&a.options.passThrough.includes(h)){if("children"in c){const{children:m,...k}=c,y=Xh(k);return y.children=a.all(c),y}return Xh(c)}return(a.options.unknownHandler||FK)(a,c,d)}function u(c){const d=[];if("children"in c){const h=c.children;let p=-1;for(;++p<h.length;){const g=a.one(h[p],c);if(g){if(p&&h[p-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=h1(g.value)),!Array.isArray(g)&&g.type==="element")){const m=g.children[0];m&&m.type==="text"&&(m.value=h1(m.value))}Array.isArray(g)?d.push(...g):d.push(g)}}}return d}}function MK(t,e){t.position&&(e.position=yq(t))}function UK(t,e){let n=e;if(t&&t.data){const r=t.data.hName,i=t.data.hChildren,s=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&s&&Object.assign(n.properties,Xh(s)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function FK(t,e){const n=e.data||{},r="value"in e&&!(ab.call(n,"hProperties")||ab.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function jK(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function h1(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function p1(t,e){const n=LK(t,e),r=n.one(t,void 0),i=_K(n),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&s.children.push({type:"text",value:`
`},i),s}function VK(t,e){return t&&"run"in t?async function(n,r){const i=p1(n,{file:r,...e});await t.run(i,r)}:function(n,r){return p1(n,{file:r,...t||e})}}function m1(t){if(t)throw t}var Bf=Object.prototype.hasOwnProperty,QO=Object.prototype.toString,g1=Object.defineProperty,y1=Object.getOwnPropertyDescriptor,v1=function(e){return typeof Array.isArray=="function"?Array.isArray(e):QO.call(e)==="[object Array]"},b1=function(e){if(!e||QO.call(e)!=="[object Object]")return!1;var n=Bf.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&Bf.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var i;for(i in e);return typeof i>"u"||Bf.call(e,i)},k1=function(e,n){g1&&n.name==="__proto__"?g1(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},w1=function(e,n){if(n==="__proto__")if(Bf.call(e,n)){if(y1)return y1(e,n).value}else return;return e[n]},BK=function t(){var e,n,r,i,s,o,a=arguments[0],l=1,u=arguments.length,c=!1;for(typeof a=="boolean"&&(c=a,a=arguments[1]||{},l=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});l<u;++l)if(e=arguments[l],e!=null)for(n in e)r=w1(a,n),i=w1(e,n),a!==i&&(c&&i&&(b1(i)||(s=v1(i)))?(s?(s=!1,o=r&&v1(r)?r:[]):o=r&&b1(r)?r:{},k1(a,{name:n,newValue:t(c,o,i)})):typeof i<"u"&&k1(a,{name:n,newValue:i}));return a};const Kg=yp(BK);function lb(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function $K(){const t=[],e={run:n,use:r};return e;function n(...i){let s=-1;const o=i.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);a(null,...i);function a(l,...u){const c=t[++s];let d=-1;if(l){o(l);return}for(;++d<i.length;)(u[d]===null||u[d]===void 0)&&(u[d]=i[d]);i=u,c?zK(c,a)(...u):o(null,...u)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return t.push(i),e}}function zK(t,e){let n;return r;function r(...o){const a=t.length>o.length;let l;a&&o.push(i);try{l=t.apply(this,o)}catch(u){const c=u;if(a&&n)throw c;return i(c)}a||(l&&l.then&&typeof l.then=="function"?l.then(s,i):l instanceof Error?i(l):s(l))}function i(o,...a){n||(n=!0,e(o,...a))}function s(o){i(null,o)}}const Kr={basename:qK,dirname:HK,extname:WK,join:KK,sep:"/"};function qK(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');sd(t);let n=0,r=-1,i=t.length,s;if(e===void 0||e.length===0||e.length>t.length){for(;i--;)if(t.codePointAt(i)===47){if(s){n=i+1;break}}else r<0&&(s=!0,r=i+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,a=e.length-1;for(;i--;)if(t.codePointAt(i)===47){if(s){n=i+1;break}}else o<0&&(s=!0,o=i+1),a>-1&&(t.codePointAt(i)===e.codePointAt(a--)?a<0&&(r=i):(a=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function HK(t){if(sd(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function WK(t){sd(t);let e=t.length,n=-1,r=0,i=-1,s=0,o;for(;e--;){const a=t.codePointAt(e);if(a===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),a===46?i<0?i=e:s!==1&&(s=1):i>-1&&(s=-1)}return i<0||n<0||s===0||s===1&&i===n-1&&i===r+1?"":t.slice(i,n)}function KK(...t){let e=-1,n;for(;++e<t.length;)sd(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":GK(n)}function GK(t){sd(t);const e=t.codePointAt(0)===47;let n=QK(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function QK(t,e){let n="",r=0,i=-1,s=0,o=-1,a,l;for(;++o<=t.length;){if(o<t.length)a=t.codePointAt(o);else{if(a===47)break;a=47}if(a===47){if(!(i===o-1||s===1))if(i!==o-1&&s===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(l=n.lastIndexOf("/"),l!==n.length-1){l<0?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=o,s=0;continue}}else if(n.length>0){n="",r=0,i=o,s=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(i+1,o):n=t.slice(i+1,o),r=o-i-1;i=o,s=0}else a===46&&s>-1?s++:s=-1}return n}function sd(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const JK={cwd:YK};function YK(){return"/"}function ub(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function XK(t){if(typeof t=="string")t=new URL(t);else if(!ub(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return ZK(t)}function ZK(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(e)}const Gg=["history","path","basename","stem","extname","dirname"];class JO{constructor(e){let n;e?ub(e)?n={path:e}:typeof e=="string"||eG(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":JK.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Gg.length;){const s=Gg[r];s in n&&n[s]!==void 0&&n[s]!==null&&(this[s]=s==="history"?[...n[s]]:n[s])}let i;for(i in n)Gg.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?Kr.basename(this.path):void 0}set basename(e){Jg(e,"basename"),Qg(e,"basename"),this.path=Kr.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Kr.dirname(this.path):void 0}set dirname(e){T1(this.basename,"dirname"),this.path=Kr.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Kr.extname(this.path):void 0}set extname(e){if(Qg(e,"extname"),T1(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Kr.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){ub(e)&&(e=XK(e)),Jg(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Kr.basename(this.path,this.extname):void 0}set stem(e){Jg(e,"stem"),Qg(e,"stem"),this.path=Kr.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const i=this.message(e,n,r);throw i.fatal=!0,i}info(e,n,r){const i=this.message(e,n,r);return i.fatal=void 0,i}message(e,n,r){const i=new on(e,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Qg(t,e){if(t&&t.includes(Kr.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Kr.sep+"`")}function Jg(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function T1(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function eG(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const tG=function(t){const r=this.constructor.prototype,i=r[t],s=function(){return i.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},nG={}.hasOwnProperty;class aw extends tG{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=$K()}copy(){const e=new aw;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(Kg(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(Zg("data",this.frozen),this.namespace[e]=n,this):nG.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Zg("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(e,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=rf(e),r=this.parser||this.Parser;return Yg("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),Yg("process",this.parser||this.Parser),Xg("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(s,o){const a=rf(e),l=r.parse(a);r.run(l,a,function(c,d,h){if(c||!d||!h)return u(c);const p=d,g=r.stringify(p,h);sG(g)?h.value=g:h.result=g,u(c,h)});function u(c,d){c||!d?o(c):s?s(d):n(void 0,d)}}}processSync(e){let n=!1,r;return this.freeze(),Yg("processSync",this.parser||this.Parser),Xg("processSync",this.compiler||this.Compiler),this.process(e,i),_1("processSync","process",n),r;function i(s,o){n=!0,m1(s),r=o}}run(e,n,r){S1(e),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?s(void 0,r):new Promise(s);function s(o,a){const l=rf(n);i.run(e,l,u);function u(c,d,h){const p=d||e;c?a(c):o?o(p):r(void 0,p,h)}}}runSync(e,n){let r=!1,i;return this.run(e,n,s),_1("runSync","run",r),i;function s(o,a){m1(o),i=a,r=!0}}stringify(e,n){this.freeze();const r=rf(n),i=this.compiler||this.Compiler;return Xg("stringify",i),S1(e),i(e,r)}use(e,...n){const r=this.attachers,i=this.namespace;if(Zg("use",this.frozen),e!=null)if(typeof e=="function")l(e,n);else if(typeof e=="object")Array.isArray(e)?a(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(u){if(typeof u=="function")l(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[c,...d]=u;l(c,d)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");a(u.plugins),u.settings&&(i.settings=Kg(!0,i.settings,u.settings))}function a(u){let c=-1;if(u!=null)if(Array.isArray(u))for(;++c<u.length;){const d=u[c];s(d)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function l(u,c){let d=-1,h=-1;for(;++d<r.length;)if(r[d][0]===u){h=d;break}if(h===-1)r.push([u,...c]);else if(c.length>0){let[p,...g]=c;const m=r[h][1];lb(m)&&lb(p)&&(p=Kg(!0,m,p)),r[h]=[u,p,...g]}}}}const rG=new aw().freeze();function Yg(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function Xg(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function Zg(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function S1(t){if(!lb(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function _1(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function rf(t){return iG(t)?t:new JO(t)}function iG(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function sG(t){return typeof t=="string"||oG(t)}function oG(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const aG="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",E1=[],C1={allowDangerousHtml:!0},lG=/^(https?|ircs?|mailto|xmpp)$/i,uG=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function cG(t){const e=t.allowedElements,n=t.allowElement,r=t.children||"",i=t.className,s=t.components,o=t.disallowedElements,a=t.rehypePlugins||E1,l=t.remarkPlugins||E1,u=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...C1}:C1,c=t.skipHtml,d=t.unwrapDisallowed,h=t.urlTransform||dG,p=rG().use(HW).use(l).use(VK,u).use(a),g=new JO;typeof r=="string"&&(g.value=r);for(const w of uG)Object.hasOwn(t,w.from)&&(""+w.from+(w.to?"use `"+w.to+"` instead":"remove it")+aG+w.id,void 0);const m=p.parse(g);let k=p.runSync(m,g);return i&&(k={type:"element",tagName:"div",properties:{className:i},children:k.type==="root"?k.children:[k]}),GO(k,y),Sq(k,{Fragment:E.Fragment,components:s,ignoreInvalidStyle:!0,jsx:E.jsx,jsxs:E.jsxs,passKeys:!0,passNode:!0});function y(w,T,x){if(w.type==="raw"&&x&&typeof T=="number")return c?x.children.splice(T,1):x.children[T]={type:"text",value:w.value},T;if(w.type==="element"){let I;for(I in qg)if(Object.hasOwn(qg,I)&&Object.hasOwn(w.properties,I)){const R=w.properties[I],C=qg[I];(C===null||C.includes(w.tagName))&&(w.properties[I]=h(String(R||""),I,w))}}if(w.type==="element"){let I=e?!e.includes(w.tagName):o?o.includes(w.tagName):!1;if(!I&&n&&typeof T=="number"&&(I=!n(w,T,x)),I&&x&&typeof T=="number")return d&&w.children?x.children.splice(T,1,...w.children):x.children.splice(T,1),T}}}function dG(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),i=t.indexOf("/");return e===-1||i!==-1&&e>i||n!==-1&&e>n||r!==-1&&e>r||lG.test(t.slice(0,e))?t:""}function fG(){const{isLoading:t,chatbotMessages:e,getChatbotMessage:n,getChatHistory:r}=U8(),[i,s]=v.useState(!1),[o,a]=v.useState(""),[l,u]=v.useState("."),c=v.useRef(null),{t:d}=dr(),h=()=>{var m;(m=c.current)==null||m.scrollIntoView({behavior:"smooth"})};v.useEffect(()=>{r()},[]),v.useEffect(()=>{h()},[e]);const p=()=>{s(!i)};v.useEffect(()=>{let m=null;return t?m=setInterval(()=>{u(k=>k==="..."?".":k+".")},500):(u("."),m&&clearInterval(m)),()=>{m&&clearInterval(m)}},[t]);const g=async m=>{m.preventDefault(),o.trim()&&!t&&(a(""),await n(o.trim()))};return E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:`chat-container ${i?"active":""} z-50`,children:[E.jsxs("div",{className:"chat-header",children:[E.jsx("div",{className:"profile",children:E.jsx("span",{children:d("chatbot.name")})}),E.jsx("div",{className:"header-text",children:d("chatbot.header")})]}),E.jsxs("div",{className:"chat-messages",children:[e.map((m,k)=>E.jsx("div",{className:`message ${m.role==="user"?"user":"assistant"}`,children:E.jsx("div",{className:"message-content",children:E.jsx(cG,{children:m.content})})},k)),t&&E.jsx("div",{className:"message system",children:E.jsx("div",{className:"message-content",children:E.jsx("span",{className:"typing-indicator",children:l})})}),E.jsx("div",{ref:c})]}),E.jsx("div",{className:"chat-input",children:E.jsxs("form",{onSubmit:g,className:"flex w-full",children:[E.jsx("input",{type:"text",placeholder:d("chatbot.placeholder"),className:"message-input flex-1 p-2 mr-2 border border-gray-300 rounded-l-md",value:o,onChange:m=>a(m.target.value),disabled:t}),E.jsx("button",{type:"submit",className:`send-btn ${t?"disabled":""}`,disabled:t,children:d("chatbot.send")})]})}),E.jsx("div",{className:"live-chat-badge",children:E.jsx("span",{children:d("chatbot.footer")})})]}),E.jsxs("button",{className:`chat-toggle ${i?"active":""}`,onClick:p,children:[E.jsx("span",{className:"open-icon",children:"💬"}),E.jsx("span",{className:"close-icon",children:"✕"})]})]})}function hG(){const t=qi(),{logout:e}=Fr(),{t:n,i18n:r}=dr(),[i,s]=v.useState(localStorage.getItem("language")||"en"),[o,a]=v.useState(!1);v.useEffect(()=>{r.changeLanguage(i)},[r,i]);const l=()=>{e(),t("/")},u=[{icon:E.jsx(a8,{className:"w-5 h-5"}),label:n("meetingNotes"),path:"/dashboard"},{icon:E.jsx(Yv,{className:"w-5 h-5"}),label:n("upload_meeting"),path:"/dashboard/upload"},{icon:E.jsx(Bu,{className:"w-5 h-5"}),label:n("new_meeting"),path:"/dashboard/meeting"}],c=()=>{t("/dashboard/profile")},d=()=>{a(!o)};return E.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[E.jsx("div",{className:`${o&&"w-20"} min-w-[${o?"20px":"240px"}] bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 relative`,children:E.jsxs("div",{className:"flex flex-col h-full",children:[E.jsx("div",{className:"p-4 flex flex-col space-y-4",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx("h1",{className:`${o?"hidden":"text-xl"} font-semibold text-gray-900 dark:text-white`,children:n("dashboard")}),E.jsx("div",{onClick:d,className:"cursor-pointer transform translate-x-2 text-gray-700 dark:text-gray-200 p-2 rounded-full bg-white dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-300 flex justify-center items-center",children:o?E.jsx(e8,{className:"w-5 h-5 "}):E.jsx(n8,{className:"w-5 h-5 rounded-lg"})})]})}),E.jsx("nav",{className:"flex-1 p-4",children:E.jsx("ul",{className:"space-y-2",children:u.map(h=>E.jsx("li",{children:E.jsxs("button",{onClick:()=>t(h.path),className:"w-full flex items-center space-x-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[h.icon,!o&&E.jsx("span",{children:h.label})]})},h.path))})}),E.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:E.jsxs("button",{onClick:c,className:"w-full flex items-center space-x-3 px-4 py-2 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:[E.jsx(g8,{className:"w-5 h-5"}),!o&&E.jsx("span",{children:n("profile")})]})}),E.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:E.jsxs("button",{onClick:l,className:"w-full flex items-center space-x-3 px-4 py-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/50 rounded-lg transition-colors",children:[E.jsx(d8,{className:"w-5 h-5"}),!o&&E.jsx("span",{children:n("logout")})]})})]})}),E.jsx("div",{className:"flex-1 overflow-auto",children:E.jsx("main",{className:"p-8",children:E.jsx(FU,{})})}),E.jsx(fG,{})]})}function pG({onLoad:t}){const e=v.useRef(null),[n,r]=v.useState(!1);return v.useEffect(()=>{const i=()=>{if(e.current){const s=window.scrollY;e.current.style.transform=`translateY(${s*.5}px)`}};return window.addEventListener("scroll",i),()=>window.removeEventListener("scroll",i)},[]),v.useEffect(()=>{const i=new Image;i.src="https://images.unsplash.com/photo-1557804506-669a67965ba0?auto=format&fit=crop&q=80",i.onload=()=>{r(!0),t==null||t()}},[t]),E.jsxs("div",{className:"relative h-screen overflow-hidden",children:[E.jsx("div",{ref:e,className:`absolute inset-0 z-0 transition-opacity duration-1000 ${n?"opacity-100":"opacity-0"}`,style:{backgroundImage:"url(https://images.unsplash.com/photo-1557804506-669a67965ba0?auto=format&fit=crop&q=80)",backgroundSize:"cover",backgroundPosition:"center",transform:"translateZ(0)"}}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/60 to-black/30"})]})}var cb=new Map,sf=new WeakMap,x1=0,mG=void 0;function gG(t){return t?(sf.has(t)||(x1+=1,sf.set(t,x1.toString())),sf.get(t)):"0"}function yG(t){return Object.keys(t).sort().filter(e=>t[e]!==void 0).map(e=>`${e}_${e==="root"?gG(t.root):t[e]}`).toString()}function vG(t){const e=yG(t);let n=cb.get(e);if(!n){const r=new Map;let i;const s=new IntersectionObserver(o=>{o.forEach(a=>{var l;const u=a.isIntersecting&&i.some(c=>a.intersectionRatio>=c);t.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=u),(l=r.get(a.target))==null||l.forEach(c=>{c(u,a)})})},t);i=s.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),n={id:e,observer:s,elements:r},cb.set(e,n)}return n}function bG(t,e,n={},r=mG){if(typeof window.IntersectionObserver>"u"&&r!==void 0){const l=t.getBoundingClientRect();return e(r,{isIntersecting:r,target:t,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:i,observer:s,elements:o}=vG(n),a=o.get(t)||[];return o.has(t)||o.set(t,a),a.push(e),s.observe(t),function(){a.splice(a.indexOf(e),1),a.length===0&&(o.delete(t),s.unobserve(t)),o.size===0&&(s.disconnect(),cb.delete(i))}}function kG({threshold:t,delay:e,trackVisibility:n,rootMargin:r,root:i,triggerOnce:s,skip:o,initialInView:a,fallbackInView:l,onChange:u}={}){var c;const[d,h]=v.useState(null),p=v.useRef(u),[g,m]=v.useState({inView:!!a,entry:void 0});p.current=u,v.useEffect(()=>{if(o||!d)return;let T;return T=bG(d,(x,I)=>{m({inView:x,entry:I}),p.current&&p.current(x,I),I.isIntersecting&&s&&T&&(T(),T=void 0)},{root:i,rootMargin:r,threshold:t,trackVisibility:n,delay:e},l),()=>{T&&T()}},[Array.isArray(t)?t.toString():t,d,i,r,s,o,n,l,e]);const k=(c=g.entry)==null?void 0:c.target,y=v.useRef(void 0);!d&&k&&!s&&!o&&y.current!==k&&(y.current=k,m({inView:!!a,entry:void 0}));const w=[h,g.inView,g.entry];return w.ref=w[0],w.inView=w[1],w.entry=w[2],w}function wG(...t){return t.filter(Boolean).join(" ")}function of({icon:t,title:e,description:n,delay:r=0}){const{ref:i,inView:s}=kG({triggerOnce:!0,threshold:.1});return E.jsxs("div",{ref:i,className:wG("text-center transform transition-all duration-700",s?"opacity-100 translate-y-0":"opacity-0 translate-y-8"),style:{transitionDelay:`${r}ms`},children:[E.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-indigo-100 text-indigo-600 mb-6",children:t}),E.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:e}),E.jsx("p",{className:"text-gray-600",children:n})]})}function ey({number:t,title:e,description:n}){return E.jsxs("div",{className:"relative p-6 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[E.jsx("div",{className:"absolute -top-4 left-6 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold",children:t}),E.jsx("h3",{className:"text-xl font-semibold text-gray-900 mt-4 mb-4",children:e}),E.jsx("p",{className:"text-gray-600",children:n})]})}function TG(){const t=qi(),{t:e}=dr();return E.jsx("footer",{className:"bg-gray-900 text-gray-400 py-12",children:E.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[E.jsxs("div",{children:[E.jsxs("div",{className:"flex items-center space-x-2 text-white mb-4",children:[E.jsx(Bu,{className:"w-6 h-6"}),E.jsx("span",{className:"text-xl font-semibold",children:e("footer.title")})]}),E.jsx("p",{className:"text-sm",children:e("footer.description")})]}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-white font-semibold mb-4",children:e("footer.quickLinks")}),E.jsxs("ul",{className:"space-y-2",children:[E.jsx("li",{children:E.jsx("button",{onClick:()=>t("/login"),className:"hover:text-white transition-colors",children:e("footer.login")})}),E.jsx("li",{children:E.jsx("button",{onClick:()=>t("/login"),className:"hover:text-white transition-colors",children:e("footer.signUp")})})]})]}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-white font-semibold mb-4",children:e("footer.legal")}),E.jsxs("ul",{className:"space-y-2",children:[E.jsx("li",{children:E.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:e("footer.privacyPolicy")})}),E.jsx("li",{children:E.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:e("footer.termsOfService")})})]})]})]}),E.jsx("div",{className:"border-t border-gray-800 mt-12 pt-8 text-center text-sm",children:E.jsxs("p",{children:["© ",new Date().getFullYear()," ",e("footer.title"),". ",e("footer.copyright")]})})]})})}const YO=()=>{const t=qi(),{setGoogleUser:e}=Fr(),{t:n}=dr(),r=async()=>{try{const s=(await Rj(fz,hz)).user;console.log("User Info:",s),await e(s),t("/dashboard")}catch(i){console.error("Error during Google sign-in:",i)}};return E.jsx("div",{className:"flex justify-center",children:E.jsx("button",{onClick:r,className:"w-auto px-4 py-2 bg-blue-500 text-white font-semibold text-sm rounded-lg shadow-md hover:bg-blue-600 transition-colors",children:E.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[E.jsx("img",{src:"https://i.imgur.com/e4N5CDJ.png",alt:"Google logo",className:"w-5 h-5"}),E.jsx("span",{children:n("googleLogin")})]})})})};function SG(){const t=qi(),[e,n]=v.useState(!0),{user:r}=Fr(),{t:i}=dr();return E.jsxs(E.Fragment,{children:[E.jsx("div",{className:`fixed inset-0 bg-white z-50 flex items-center justify-center transition-opacity duration-500 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,children:E.jsxs("div",{className:"flex flex-col items-center",children:[E.jsx(Bu,{className:"w-12 h-12 text-indigo-600 animate-bounce"}),E.jsx("h2",{className:"mt-4 text-xl font-semibold text-gray-800",children:"Loading..."})]})}),E.jsxs("div",{className:`min-h-screen transition-opacity duration-500 ${e?"opacity-0":"opacity-100"}`,children:[E.jsx("nav",{className:"fixed top-0 left-0 right-0 bg-white/90 backdrop-blur-md z-50",children:E.jsx("div",{className:"container mx-auto px-4",children:E.jsxs("div",{className:"flex items-center justify-between h-16",children:[E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsx(Bu,{className:"w-6 h-6 text-indigo-600"}),E.jsx("span",{className:"text-xl font-semibold text-gray-900",children:i("appName")})]}),E.jsx("div",{className:"flex items-center space-x-4",children:r?E.jsx("button",{onClick:()=>t("/dashboard"),className:"w-auto px-4 py-2 bg-blue-500 text-white font-semibold text-sm rounded-lg shadow-md hover:bg-blue-600 transition-colors",children:i("dashboard")}):E.jsx(YO,{})})]})})}),E.jsxs("div",{className:"relative h-screen flex items-center justify-center",children:[E.jsx("div",{className:"absolute inset-0",children:E.jsx(pG,{onLoad:()=>n(!1)})}),E.jsxs("div",{className:"relative z-10 text-center px-4 max-w-4xl mx-auto",children:[E.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-white mb-6",children:i("title")}),E.jsx("p",{className:"text-xl text-gray-200 mb-8",children:i("description")})]})]}),E.jsx("div",{className:"bg-white py-24 px-4",children:E.jsxs("div",{className:"max-w-7xl mx-auto",children:[E.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-16",children:i("whyChoose")}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12",children:[E.jsx(of,{icon:E.jsx(Bu,{className:"w-8 h-8"}),title:i("feature1"),description:i("feature1Desc"),delay:0}),E.jsx(of,{icon:E.jsx(k8,{className:"w-8 h-8"}),title:i("feature2"),description:i("feature2Desc"),delay:200}),E.jsx(of,{icon:E.jsx(y8,{className:"w-8 h-8"}),title:i("feature3"),description:i("feature3Desc"),delay:400}),E.jsx(of,{icon:E.jsx(Kk,{className:"w-8 h-8"}),title:i("feature4"),description:i("feature4Desc"),delay:600})]})]})}),E.jsx("div",{className:"bg-gray-50 py-24 px-4",children:E.jsxs("div",{className:"max-w-7xl mx-auto",children:[E.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-16",children:i("howItWorks")}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12",children:[E.jsx(ey,{number:"1",title:i("uploadRecording"),description:i("uploadDescription")}),E.jsx(ey,{number:"2",title:i("aiProcessing"),description:i("aiProcessingDescription")}),E.jsx(ey,{number:"3",title:i("shareCollaborate"),description:i("shareCollaborateDescription")})]})]})}),E.jsx(TG,{})]})]})}function _G({onSearch:t}){const[e,n]=v.useState(""),[r,i]=v.useState(""),s=o=>{o.preventDefault(),e&&r&&t(e,r)};return E.jsxs("form",{onSubmit:s,className:"flex items-center gap-2 text-sm",children:[E.jsxs("div",{className:"relative",children:[E.jsx(Jv,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),E.jsx("input",{type:"date",value:e,onChange:o=>n(o.target.value),className:"pl-8 pr-2 py-1.5 border border-gray-300 rounded-md text-sm w-36"})]}),E.jsx("span",{className:"text-gray-500",children:"to"}),E.jsxs("div",{className:"relative",children:[E.jsx(Jv,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),E.jsx("input",{type:"date",value:r,onChange:o=>i(o.target.value),className:"pl-8 pr-2 py-1.5 border border-gray-300 rounded-md text-sm w-36"})]}),E.jsx("button",{type:"submit",className:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-sm rounded-md text-gray-700 bg-white hover:bg-gray-50",children:E.jsx(m8,{className:"w-4 h-4"})})]})}function EG({thumbnailUrl:t,duration:e}){return E.jsxs("div",{className:"relative aspect-video bg-gray-100 rounded-t-lg overflow-hidden",children:[t?E.jsx("img",{src:t,alt:"Meeting thumbnail",className:"w-full h-full object-cover"}):E.jsx("div",{className:"flex items-center justify-center h-full",children:E.jsx(h8,{className:"w-12 h-12 text-gray-400"})}),e&&E.jsx("div",{className:"absolute bottom-2 right-2 bg-black/75 text-white text-xs px-2 py-1 rounded",children:CG(e)})]})}function CG(t){const e=Math.floor(t),n=Math.floor(e/60),r=e%60;return`${String(n).padStart(2,"0")}:${String(r).padStart(2,"0")}`}function xG({meetingSummary:t,onClick:e,isSelected:n,toggleSelection:r,showCheckbox:i}){const s=o=>{o.stopPropagation(),r()};return E.jsxs("div",{onClick:i?s:e,className:`relative bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden cursor-pointer ${n?"ring-2 ring-indigo-500":""}`,children:[E.jsx(EG,{thumbnailUrl:t.thumbnailUrl,duration:t.transcription.duration}),E.jsxs("div",{className:"p-4",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:t.summary.title}),E.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:t.summary.tags.map(o=>E.jsx("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full text-sm font-medium",children:o},o))}),E.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[E.jsx(Jv,{className:"w-4 h-4 mr-1"}),E.jsx("time",{children:new Date(t.date).toLocaleDateString()})]})]}),i&&E.jsx("div",{className:"absolute top-2 right-2 p-2 rounded-full bg-white/90 shadow-sm",onClick:s,children:E.jsx("div",{className:`w-5 h-5 rounded-md border-2 flex items-center justify-center ${n?"border-indigo-500 bg-indigo-500":"border-gray-300"}`,children:n&&E.jsx(i8,{className:"w-4 h-4 text-white"})})})]})}function XO({title:t,onDelete:e}){return E.jsx("button",{onClick:e,className:`
            px-2.5 py-1.5 rounded-md border
            bg-white border-red-300
            text-red-600 dark:text-red-400 
            hover:bg-red-50 dark:hover:bg-red-900/50
        `,title:t,children:E.jsx(b8,{className:"w-4 h-4"})})}function IG({onSort:t,onSelectMode:e,selectedTags:n,availableTags:r,onTagsChange:i,onDelete:s}){const{t:o}=dr(),[a,l]=v.useState("desc"),[u,c]=v.useState(!1),[d,h]=v.useState(!1),p=v.useRef(null);v.useEffect(()=>{const T=x=>{p.current&&!p.current.contains(x.target)&&h(!1)};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]);const g=()=>{const T=a==="desc"?"asc":"desc";l(T),t(T)},m=()=>{c(!u),e(!u)},k=T=>{const x=n.includes(T)?n.filter(I=>I!==T):[...n,T];i(x)},y=()=>{i([])},w=()=>{s()};return E.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[E.jsx("button",{onClick:g,className:"inline-flex items-center px-2.5 py-1.5 bg-white hover:bg-gray-50 text-gray-700 rounded-md border border-gray-300 shadow-sm",title:o(a==="desc"?"newestFirst":"oldestFirst"),children:a==="desc"?E.jsx(t8,{className:"w-4 h-4"}):E.jsx(r8,{className:"w-4 h-4"})}),E.jsxs("div",{className:"relative",ref:p,children:[E.jsxs("button",{onClick:()=>h(!d),className:`inline-flex items-center px-2.5 py-1.5 rounded-md border shadow-sm ${n.length>0?"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,title:o("filterByTags"),children:[E.jsx(u8,{className:"w-4 h-4"}),n.length>0&&E.jsx("span",{className:"ml-1 text-xs",children:n.length})]}),d&&E.jsxs("div",{className:"absolute top-full right-0 mt-1 w-56 max-h-64 bg-white rounded-md shadow-lg border border-gray-200 overflow-hidden z-10",children:[E.jsxs("div",{className:"p-2 border-b border-gray-100 flex justify-between items-center",children:[E.jsx("span",{className:"text-sm font-medium text-gray-700",children:o("filterByTags")}),n.length>0&&E.jsx("button",{onClick:y,className:"text-xs text-gray-500 hover:text-gray-700",children:o("clearAll")})]}),E.jsx("div",{className:"overflow-y-auto max-h-48 p-2",children:E.jsx("div",{className:"space-y-1",children:r.map(T=>E.jsxs("label",{className:"flex items-center px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[E.jsx("input",{type:"checkbox",checked:n.includes(T),onChange:()=>k(T),className:"w-3.5 h-3.5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),E.jsx("span",{className:"ml-2 text-sm text-gray-600",children:T})]},T))})})]})]}),E.jsx("button",{onClick:m,className:`inline-flex items-center px-2.5 py-1.5 rounded-md border shadow-sm ${u?"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,title:o("selectMeetings"),children:E.jsx(s8,{className:"w-4 h-4"})}),u&&E.jsx(XO,{title:o("deleteMeetings"),onDelete:w})]})}const PG=v.createContext(null);function RG({children:t}){const[e,n]=v.useState(!1),[r,i]=v.useState([]),s=()=>{n(l=>!l),e&&i([])},o=l=>{i(u=>u.includes(l)?u.filter(c=>c!==l):[...u,l])},a=()=>{i([])};return E.jsx(PG.Provider,{value:{isSelectMode:e,selectedMeetings:r,toggleSelectMode:s,toggleMeetingSelection:o,clearSelection:a},children:t})}function AG(){const t=qi();Fr();const{meetingSummaries:e,sortMeetingSummaries:n,fetchMeetingSummaries:r,deleteMeetingSummary:i}=rd(),[s,o]=v.useState([]),[a,l]=v.useState(!1),[u,c]=v.useState({startDate:void 0,endDate:void 0}),[d,h]=v.useState([]),{t:p,i18n:g}=dr();v.useEffect(()=>{h([])},[a]);const m=x=>{h(I=>I.includes(x)?I.filter(R=>R!==x):[...I,x])},k=v.useMemo(()=>{const x=new Set;return e.forEach(I=>I.summary.tags.forEach(R=>x.add(R))),Array.from(x)},[e]),y=v.useMemo(()=>{var x=e;return u.startDate!==void 0&&u.endDate!==void 0&&(x=x.filter(I=>{const R=new Date(I.date);return R>=u.startDate&&R<=u.endDate})),s.length!==0&&(x=x.filter(I=>s.some(R=>I.summary.tags.includes(R)))),x},[e,s,u]),w=(x,I)=>{console.log(`Searching meetings from ${x} to ${I}`);const R=new Date(x),C=new Date(I);C.setHours(23,59,59,999),c({startDate:R,endDate:C})},T=()=>{d.length>0&&d.map(async x=>{await i(x)})};return E.jsxs("div",{children:[E.jsx("div",{className:"flex flex-col space-y-4 mb-6",children:E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx("div",{className:"flex justify-between items-center",children:E.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:p("meeting_notes")})}),E.jsxs("div",{className:"flex items-center justify-start space-x-4",children:[E.jsx(_G,{onSearch:w}),E.jsx(IG,{onSort:x=>n(x),onSelectMode:l,selectedTags:s,availableTags:k,onTagsChange:o,onDelete:T})]})]})}),E.jsx(RG,{children:E.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(x=>E.jsx(xG,{meetingSummary:x,onClick:()=>t(`/dashboard/meetingSummary/${x.id}`),isSelected:d.includes(x.id),showCheckbox:a,toggleSelection:()=>m(x.id)},x.id))})})]})}function ZO(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=ZO(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Rs(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=ZO(t))&&(r&&(r+=" "),r+=e);return r}function NG(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}NG(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var od=t=>typeof t=="number"&&!isNaN(t),Mo=t=>typeof t=="string",Fi=t=>typeof t=="function",OG=t=>Mo(t)||od(t),db=t=>Mo(t)||Fi(t)?t:null,DG=(t,e)=>t===!1||od(t)&&t>0?t:e,fb=t=>v.isValidElement(t)||Mo(t)||Fi(t)||od(t);function LG(t,e,n=300){let{scrollHeight:r,style:i}=t;requestAnimationFrame(()=>{i.minHeight="initial",i.height=r+"px",i.transition=`all ${n}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,n)})})}function MG({enter:t,exit:e,appendPosition:n=!1,collapse:r=!0,collapseDuration:i=300}){return function({children:s,position:o,preventExitTransition:a,done:l,nodeRef:u,isIn:c,playToast:d}){let h=n?`${t}--${o}`:t,p=n?`${e}--${o}`:e,g=v.useRef(0);return v.useLayoutEffect(()=>{let m=u.current,k=h.split(" "),y=w=>{w.target===u.current&&(d(),m.removeEventListener("animationend",y),m.removeEventListener("animationcancel",y),g.current===0&&w.type!=="animationcancel"&&m.classList.remove(...k))};m.classList.add(...k),m.addEventListener("animationend",y),m.addEventListener("animationcancel",y)},[]),v.useEffect(()=>{let m=u.current,k=()=>{m.removeEventListener("animationend",k),r?LG(m,l,i):l()};c||(a?k():(g.current=1,m.className+=` ${p}`,m.addEventListener("animationend",k)))},[c]),Je.createElement(Je.Fragment,null,s)}}function I1(t,e){return{content:eD(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function eD(t,e,n=!1){return v.isValidElement(t)&&!Mo(t.type)?v.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):Fi(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):t}function UG({closeToast:t,theme:e,ariaLabel:n="close"}){return Je.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:r=>{r.stopPropagation(),t(!0)},"aria-label":n},Je.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Je.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function FG({delay:t,isRunning:e,closeToast:n,type:r="default",hide:i,className:s,controlledProgress:o,progress:a,rtl:l,isIn:u,theme:c}){let d=i||o&&a===0,h={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};o&&(h.transform=`scaleX(${a})`);let p=Rs("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${c}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":l}),g=Fi(s)?s({rtl:l,type:r,defaultClassName:p}):Rs(p,s),m={[o&&a>=1?"onTransitionEnd":"onAnimationEnd"]:o&&a<1?null:()=>{u&&n()}};return Je.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":d},Je.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${c} Toastify__progress-bar--${r}`}),Je.createElement("div",{role:"progressbar","aria-hidden":d?"true":"false","aria-label":"notification timer",className:g,style:h,...m}))}var jG=1,tD=()=>`${jG++}`;function VG(t,e,n){let r=1,i=0,s=[],o=[],a=e,l=new Map,u=new Set,c=w=>(u.add(w),()=>u.delete(w)),d=()=>{o=Array.from(l.values()),u.forEach(w=>w())},h=({containerId:w,toastId:T,updateId:x})=>{let I=w?w!==t:t!==1,R=l.has(T)&&x==null;return I||R},p=(w,T)=>{l.forEach(x=>{var I;(T==null||T===x.props.toastId)&&((I=x.toggle)==null||I.call(x,w))})},g=w=>{var T,x;(x=(T=w.props)==null?void 0:T.onClose)==null||x.call(T,w.removalReason),w.isActive=!1},m=w=>{if(w==null)l.forEach(g);else{let T=l.get(w);T&&g(T)}d()},k=()=>{i-=s.length,s=[]},y=w=>{var T,x;let{toastId:I,updateId:R}=w.props,C=R==null;w.staleId&&l.delete(w.staleId),w.isActive=!0,l.set(I,w),d(),n(I1(w,C?"added":"updated")),C&&((x=(T=w.props).onOpen)==null||x.call(T))};return{id:t,props:a,observe:c,toggle:p,removeToast:m,toasts:l,clearQueue:k,buildToast:(w,T)=>{if(h(T))return;let{toastId:x,updateId:I,data:R,staleId:C,delay:_}=T,P=I==null;P&&i++;let N={...a,style:a.toastStyle,key:r++,...Object.fromEntries(Object.entries(T).filter(([D,L])=>L!=null)),toastId:x,updateId:I,data:R,isIn:!1,className:db(T.className||a.toastClassName),progressClassName:db(T.progressClassName||a.progressClassName),autoClose:T.isLoading?!1:DG(T.autoClose,a.autoClose),closeToast(D){l.get(x).removalReason=D,m(x)},deleteToast(){let D=l.get(x);if(D!=null){if(n(I1(D,"removed")),l.delete(x),i--,i<0&&(i=0),s.length>0){y(s.shift());return}d()}}};N.closeButton=a.closeButton,T.closeButton===!1||fb(T.closeButton)?N.closeButton=T.closeButton:T.closeButton===!0&&(N.closeButton=fb(a.closeButton)?a.closeButton:!0);let A={content:w,props:N,staleId:C};a.limit&&a.limit>0&&i>a.limit&&P?s.push(A):od(_)?setTimeout(()=>{y(A)},_):y(A)},setProps(w){a=w},setToggle:(w,T)=>{let x=l.get(w);x&&(x.toggle=T)},isToastActive:w=>{var T;return(T=l.get(w))==null?void 0:T.isActive},getSnapshot:()=>o}}var fn=new Map,Pc=[],hb=new Set,BG=t=>hb.forEach(e=>e(t)),nD=()=>fn.size>0;function $G(){Pc.forEach(t=>iD(t.content,t.options)),Pc=[]}var zG=(t,{containerId:e})=>{var n;return(n=fn.get(e||1))==null?void 0:n.toasts.get(t)};function rD(t,e){var n;if(e)return!!((n=fn.get(e))!=null&&n.isToastActive(t));let r=!1;return fn.forEach(i=>{i.isToastActive(t)&&(r=!0)}),r}function qG(t){if(!nD()){Pc=Pc.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||OG(t))fn.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=fn.get(t.containerId);e?e.removeToast(t.id):fn.forEach(n=>{n.removeToast(t.id)})}}var HG=(t={})=>{fn.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function iD(t,e){fb(t)&&(nD()||Pc.push({content:t,options:e}),fn.forEach(n=>{n.buildToast(t,e)}))}function WG(t){var e;(e=fn.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function sD(t,e){fn.forEach(n=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===n.id)&&n.toggle(t,e==null?void 0:e.id)})}function KG(t){let e=t.containerId||1;return{subscribe(n){let r=VG(e,t,BG);fn.set(e,r);let i=r.observe(n);return $G(),()=>{i(),fn.delete(e)}},setProps(n){var r;(r=fn.get(e))==null||r.setProps(n)},getSnapshot(){var n;return(n=fn.get(e))==null?void 0:n.getSnapshot()}}}function GG(t){return hb.add(t),()=>{hb.delete(t)}}function QG(t){return t&&(Mo(t.toastId)||od(t.toastId))?t.toastId:tD()}function ad(t,e){return iD(t,e),e.toastId}function pm(t,e){return{...e,type:e&&e.type||t,toastId:QG(e)}}function mm(t){return(e,n)=>ad(e,pm(t,n))}function Ue(t,e){return ad(t,pm("default",e))}Ue.loading=(t,e)=>ad(t,pm("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function JG(t,{pending:e,error:n,success:r},i){let s;e&&(s=Mo(e)?Ue.loading(e,i):Ue.loading(e.render,{...i,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=(u,c,d)=>{if(c==null){Ue.dismiss(s);return}let h={type:u,...o,...i,data:d},p=Mo(c)?{render:c}:c;return s?Ue.update(s,{...h,...p}):Ue(p.render,{...h,...p}),d},l=Fi(t)?t():t;return l.then(u=>a("success",r,u)).catch(u=>a("error",n,u)),l}Ue.promise=JG;Ue.success=mm("success");Ue.info=mm("info");Ue.error=mm("error");Ue.warning=mm("warning");Ue.warn=Ue.warning;Ue.dark=(t,e)=>ad(t,pm("default",{theme:"dark",...e}));function YG(t){qG(t)}Ue.dismiss=YG;Ue.clearWaitingQueue=HG;Ue.isActive=rD;Ue.update=(t,e={})=>{let n=zG(t,e);if(n){let{props:r,content:i}=n,s={delay:100,...r,...e,toastId:e.toastId||t,updateId:tD()};s.toastId!==t&&(s.staleId=t);let o=s.render||i;delete s.render,ad(o,s)}};Ue.done=t=>{Ue.update(t,{progress:1})};Ue.onChange=GG;Ue.play=t=>sD(!0,t);Ue.pause=t=>sD(!1,t);function XG(t){var e;let{subscribe:n,getSnapshot:r,setProps:i}=v.useRef(KG(t)).current;i(t);let s=(e=v.useSyncExternalStore(n,r,r))==null?void 0:e.slice();function o(a){if(!s)return[];let l=new Map;return t.newestOnTop&&s.reverse(),s.forEach(u=>{let{position:c}=u.props;l.has(c)||l.set(c,[]),l.get(c).push(u)}),Array.from(l,u=>a(u[0],u[1]))}return{getToastToRender:o,isToastActive:rD,count:s==null?void 0:s.length}}function ZG(t){let[e,n]=v.useState(!1),[r,i]=v.useState(!1),s=v.useRef(null),o=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:u,onClick:c,closeOnClick:d}=t;WG({id:t.toastId,containerId:t.containerId,fn:n}),v.useEffect(()=>{if(t.pauseOnFocusLoss)return h(),()=>{p()}},[t.pauseOnFocusLoss]);function h(){document.hasFocus()||y(),window.addEventListener("focus",k),window.addEventListener("blur",y)}function p(){window.removeEventListener("focus",k),window.removeEventListener("blur",y)}function g(C){if(t.draggable===!0||t.draggable===C.pointerType){w();let _=s.current;o.canCloseOnClick=!0,o.canDrag=!0,_.style.transition="none",t.draggableDirection==="x"?(o.start=C.clientX,o.removalDistance=_.offsetWidth*(t.draggablePercent/100)):(o.start=C.clientY,o.removalDistance=_.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function m(C){let{top:_,bottom:P,left:N,right:A}=s.current.getBoundingClientRect();C.nativeEvent.type!=="touchend"&&t.pauseOnHover&&C.clientX>=N&&C.clientX<=A&&C.clientY>=_&&C.clientY<=P?y():k()}function k(){n(!0)}function y(){n(!1)}function w(){o.didMove=!1,document.addEventListener("pointermove",x),document.addEventListener("pointerup",I)}function T(){document.removeEventListener("pointermove",x),document.removeEventListener("pointerup",I)}function x(C){let _=s.current;if(o.canDrag&&_){o.didMove=!0,e&&y(),t.draggableDirection==="x"?o.delta=C.clientX-o.start:o.delta=C.clientY-o.start,o.start!==C.clientX&&(o.canCloseOnClick=!1);let P=t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;_.style.transform=`translate3d(${P},0)`,_.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function I(){T();let C=s.current;if(o.canDrag&&o.didMove&&C){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){i(!0),t.closeToast(!0),t.collapseAll();return}C.style.transition="transform 0.2s, opacity 0.2s",C.style.removeProperty("transform"),C.style.removeProperty("opacity")}}let R={onPointerDown:g,onPointerUp:m};return a&&l&&(R.onMouseEnter=y,t.stacked||(R.onMouseLeave=k)),d&&(R.onClick=C=>{c&&c(C),o.canCloseOnClick&&u(!0)}),{playToast:k,pauseToast:y,isRunning:e,preventExitTransition:r,toastRef:s,eventHandlers:R}}var eQ=typeof window<"u"?v.useLayoutEffect:v.useEffect,gm=({theme:t,type:e,isLoading:n,...r})=>Je.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...r});function tQ(t){return Je.createElement(gm,{...t},Je.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function nQ(t){return Je.createElement(gm,{...t},Je.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function rQ(t){return Je.createElement(gm,{...t},Je.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function iQ(t){return Je.createElement(gm,{...t},Je.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function sQ(){return Je.createElement("div",{className:"Toastify__spinner"})}var pb={info:nQ,warning:tQ,success:rQ,error:iQ,spinner:sQ},oQ=t=>t in pb;function aQ({theme:t,type:e,isLoading:n,icon:r}){let i=null,s={theme:t,type:e};return r===!1||(Fi(r)?i=r({...s,isLoading:n}):v.isValidElement(r)?i=v.cloneElement(r,s):n?i=pb.spinner():oQ(e)&&(i=pb[e](s))),i}var lQ=t=>{let{isRunning:e,preventExitTransition:n,toastRef:r,eventHandlers:i,playToast:s}=ZG(t),{closeButton:o,children:a,autoClose:l,onClick:u,type:c,hideProgressBar:d,closeToast:h,transition:p,position:g,className:m,style:k,progressClassName:y,updateId:w,role:T,progress:x,rtl:I,toastId:R,deleteToast:C,isIn:_,isLoading:P,closeOnClick:N,theme:A,ariaLabel:D}=t,L=Rs("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":I},{"Toastify__toast--close-on-click":N}),ae=Fi(m)?m({rtl:I,position:g,type:c,defaultClassName:L}):Rs(L,m),re=aQ(t),Te=!!x||!l,ue={closeToast:h,type:c,theme:A},Q=null;return o===!1||(Fi(o)?Q=o(ue):v.isValidElement(o)?Q=v.cloneElement(o,ue):Q=UG(ue)),Je.createElement(p,{isIn:_,done:C,position:g,preventExitTransition:n,nodeRef:r,playToast:s},Je.createElement("div",{id:R,tabIndex:0,onClick:u,"data-in":_,className:ae,...i,style:k,ref:r,..._&&{role:T,"aria-label":D}},re!=null&&Je.createElement("div",{className:Rs("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!P})},re),eD(a,t,!e),Q,!t.customProgressBar&&Je.createElement(FG,{...w&&!Te?{key:`p-${w}`}:{},rtl:I,theme:A,delay:l,isRunning:e,isIn:_,closeToast:h,hide:d,type:c,className:y,controlledProgress:Te,progress:x||0})))},uQ=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),cQ=MG(uQ("bounce",!0)),dQ={position:"top-right",transition:cQ,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function fQ(t){let e={...dQ,...t},n=t.stacked,[r,i]=v.useState(!0),s=v.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=XG(e),{className:u,style:c,rtl:d,containerId:h,hotKeys:p}=e;function g(k){let y=Rs("Toastify__toast-container",`Toastify__toast-container--${k}`,{"Toastify__toast-container--rtl":d});return Fi(u)?u({position:k,rtl:d,defaultClassName:y}):Rs(y,db(u))}function m(){n&&(i(!0),Ue.play())}return eQ(()=>{var k;if(n){let y=s.current.querySelectorAll('[data-in="true"]'),w=12,T=(k=e.position)==null?void 0:k.includes("top"),x=0,I=0;Array.from(y).reverse().forEach((R,C)=>{let _=R;_.classList.add("Toastify__toast--stacked"),C>0&&(_.dataset.collapsed=`${r}`),_.dataset.pos||(_.dataset.pos=T?"top":"bot");let P=x*(r?.2:1)+(r?0:w*C);_.style.setProperty("--y",`${T?P:P*-1}px`),_.style.setProperty("--g",`${w}`),_.style.setProperty("--s",`${1-(r?I:0)}`),x+=_.offsetHeight,I+=.025})}},[r,l,n]),v.useEffect(()=>{function k(y){var w;let T=s.current;p(y)&&((w=T.querySelector('[tabIndex="0"]'))==null||w.focus(),i(!1),Ue.pause()),y.key==="Escape"&&(document.activeElement===T||T!=null&&T.contains(document.activeElement))&&(i(!0),Ue.play())}return document.addEventListener("keydown",k),()=>{document.removeEventListener("keydown",k)}},[p]),Je.createElement("section",{ref:s,className:"Toastify",id:h,onMouseEnter:()=>{n&&(i(!1),Ue.pause())},onMouseLeave:m,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((k,y)=>{let w=y.length?{...c}:{...c,pointerEvents:"none"};return Je.createElement("div",{tabIndex:-1,className:g(k),"data-stacked":n,style:w,key:`c-${k}`},y.map(({content:T,props:x})=>Je.createElement(lQ,{...x,stacked:n,collapseAll:m,isIn:a(x.toastId,x.containerId),key:`t-${x.key}`},T)))}))}function oD({message:t}){return DP.createPortal(E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg flex flex-col items-center space-y-4",children:[E.jsx("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin"}),E.jsx("p",{className:"text-gray-700",children:t})]})}),document.body)}function hQ(){const{t}=dr(),[e,n]=v.useState("."),r=qi(),{user:i}=Fr(),{isLoading:s,summarizeMeeting:o}=rd(),[a,l]=v.useState(!1),[u,c]=v.useState(null),d=()=>{Ue.success(t("upload_meeting_Btn.successNotification"),{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},h=()=>{Ue.error(t("upload_meeting_Btn.errorNotification"),{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},p=w=>{w.preventDefault(),l(!0)},g=()=>{l(!1)},m=w=>{w.preventDefault(),l(!1);const T=w.dataTransfer.files[0];T!=null&&T.type.startsWith("video/")&&c(T)},k=w=>{var x;const T=(x=w.target.files)==null?void 0:x[0];T&&c(T)},y=async()=>{if(u&&i)try{const w=await o({file:u});w===void 0?h():(d(),r(`/dashboard/meetingSummary/${w.summary.id}`))}catch(w){h(),console.error("Failed to upload the file:",w)}};return v.useEffect(()=>{let w=null;return s?w=setInterval(()=>{n(T=>T==="..."?"":T+".")},500):(n(""),w&&clearInterval(w)),()=>{w&&clearInterval(w)}},[s]),E.jsxs("div",{className:"max-w-2xl mx-auto",children:[E.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:t("upload_meeting_Btn.uploadMeetingRecording")}),E.jsxs("label",{onDragOver:p,onDragLeave:g,onDrop:m,className:`
          border-2 border-dashed rounded-lg p-12
          flex flex-col items-center justify-center
          ${a?"border-indigo-500 bg-indigo-50":"border-gray-300"}
          transition-colors
          hover:text-indigo-500 cursor-pointer
        `,children:[E.jsx(Yv,{className:"w-12 h-12 text-gray-400 mb-4"}),E.jsxs("div",{className:"text-gray-600 text-center mb-4",children:[t("upload_meeting_Btn.dragAndDrop"),E.jsx("div",{className:"text-indigo-600 hover:text-indigo-500 cursor-pointer",children:t("upload_meeting_Btn.browse")})]}),u&&E.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[E.jsx(l8,{className:"w-4 h-4"}),E.jsx("span",{children:u.name})]}),E.jsx("input",{type:"file",accept:"video/audio/*",onChange:k,className:"hidden"})]}),E.jsxs("button",{onClick:y,disabled:!u,className:`
          mt-6 w-full py-3 px-4 rounded-lg
          flex items-center justify-center space-x-2
          ${u?"bg-indigo-600 hover:bg-indigo-500 text-white":"bg-gray-100 text-gray-400 cursor-not-allowed"}
          transition-colors
        `,children:[E.jsx(Yv,{className:"w-5 h-5"}),E.jsx("span",{children:t("upload_meeting_Btn.uploadRecording")})]}),s&&E.jsx(oD,{message:t("uploadingAndGenerating")+e})]})}const pQ=v.forwardRef(({src:t},e)=>{const n=v.useRef(null),[r,i]=v.useState(!1),[s,o]=v.useState(0),[a,l]=v.useState(0);v.useImperativeHandle(e,()=>({play:()=>{var h;(h=n.current)==null||h.play(),i(!0)},pause:()=>{var h;(h=n.current)==null||h.pause(),i(!1)},seek:h=>{n.current&&(n.current.currentTime=h,o(h))}}));const u=()=>{n.current&&(r?n.current.pause():n.current.play(),i(!r))},c=()=>{n.current&&o(n.current.currentTime)},d=()=>{n.current&&l(n.current.duration)};return E.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg shadow-md",children:[E.jsx("audio",{ref:n,src:t,onTimeUpdate:c,onLoadedMetadata:d}),E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsx("button",{onClick:u,className:"text-gray-700",children:r?E.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})}):E.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11.25l-6-4.5v9l6-4.5z"}),E.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"currentColor",strokeWidth:"2"})]})}),E.jsx("div",{className:"flex-grow mx-4",children:E.jsx("input",{type:"range",min:"0",max:a,value:s,className:"w-full h-2 bg-gray-200 rounded-full appearance-none focus:outline-none",onChange:h=>{n.current&&(n.current.currentTime=Number(h.target.value),o(Number(h.target.value)))}})}),E.jsxs("span",{className:"text-gray-700 text-sm",children:[new Date(s*1e3).toISOString().substr(14,5)," / ",new Date(a*1e3).toISOString().substr(14,5)]})]})]})});function mQ({segments:t,onSegmentClick:e}){return E.jsx("div",{className:"space-y-4",children:t.map((n,r)=>E.jsxs("div",{onClick:()=>e==null?void 0:e(n.startTime),className:"p-3 hover:bg-gray-50 rounded cursor-pointer",children:[E.jsxs("div",{className:"text-sm text-gray-500 mb-1",children:[P1(n.startTime)," - ",P1(n.endTime)]}),E.jsx("p",{className:"text-gray-700",children:n.text})]},r))})}function P1(t){const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`}function gQ({message:t,onClose:e,onConfirm:n}){const{t:r}=dr();return DP.createPortal(E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[E.jsx("p",{className:"text-gray-800 text-lg mb-4",children:t}),E.jsxs("div",{className:"flex justify-end space-x-4",children:[E.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:r("cancel")}),E.jsx("button",{onClick:n,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:r("confirm")})]})]})}),document.body)}function yQ(){const{id:t}=SU(),e=qi(),n=v.useRef(null),r=v.useRef(null),[i,s]=v.useState("."),{isLoading:o,meetingSummaries:a,deleteMeetingSummary:l,summarizeMeeting:u}=rd(),[c,d]=v.useState(null),{t:h}=dr(),[p,g]=v.useState({open:!1,message:"",confirm:()=>{}}),m=(I,R)=>g({open:!0,message:I,confirm:R}),k=()=>g({open:!1,message:"",confirm:()=>{}});if(v.useEffect(()=>{console.log(t),console.log(a);const I=a.find(R=>R.id===t);if(I)d(I);else{const R=setInterval(()=>{const C=a.find(_=>_.id===t);C&&(d(C),clearInterval(R))},500)}},[t,a]),v.useEffect(()=>{let I=null;return o?I=setInterval(()=>{s(R=>R==="..."?"":R+".")},500):(s(""),I&&clearInterval(I)),()=>{I&&clearInterval(I)}},[o]),!c)return"Loading...";const y=I=>{n.current&&(n.current.currentTime=I,n.current.play()),r.current&&(r.current.seek(I),r.current.play())},w=()=>{m(h("confirmDelete"),T)},T=async()=>{var I=await l(c.id);I&&(e(-1),k())},x=async()=>{var I=c.srcUrl.split("/").pop();console.log(I);var R=await u({s3FileName:I,summaryId:c.id});R&&k()};return E.jsxs("div",{className:"relative",children:[E.jsxs("div",{className:"max-w-4xl mx-auto",children:[E.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:c.summary.title}),E.jsxs("div",{className:"flex justify-between mb-6",children:[E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsxs("div",{className:"flex items-center text-gray-600",children:[E.jsx(o8,{className:"w-4 h-4 mr-1"}),E.jsx("span",{children:new Date(c.date).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})]}),E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsx(v8,{className:"w-4 h-4 text-gray-600"}),E.jsx("div",{className:"flex gap-2",children:c.summary.tags.map(I=>E.jsx("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full text-sm",children:I},I))})]})]}),E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsx("button",{onClick:()=>m(h("confirmRegenerate"),x),className:`
              px-2.5 py-1.5 rounded-md border
              bg-white border-gray-300
              text-gray-600 dark:text-gray-400 
              hover:bg-gray-50 dark:hover:bg-gray-900/50
            `,title:h("regenerateMeetings"),children:E.jsx(p8,{className:"w-4 h-4"})}),E.jsx(XO,{title:h("deleteMeetings"),onDelete:w})]})]}),c.srcUrl.endsWith(".mp4")?E.jsx("div",{className:"bg-black aspect-video rounded-lg mb-8",children:E.jsx("video",{ref:n,className:"w-full h-full rounded-lg",controls:!0,poster:c.thumbnailUrl,src:c.srcUrl})}):null,E.jsxs("div",{className:"space-y-8",children:[E.jsxs("section",{children:[E.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:h("Summary")}),E.jsx("p",{className:"text-gray-600 bg-gray-50 p-4 rounded-lg",children:c.summary.content})]}),E.jsxs("section",{children:[E.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:h("Transcript")}),E.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:E.jsx(mQ,{segments:c.transcription.segments,onSegmentClick:y})})]})]}),c.srcUrl.endsWith(".mp3")?E.jsx("div",{className:"bottom-0 w-full left-0 mt-8",children:E.jsx(pQ,{ref:r,src:c.srcUrl})}):null]}),p.open&&E.jsx(gQ,{message:p.message,onClose:k,onConfirm:p.confirm}),o&&E.jsx(oD,{message:h("uploadingAndGenerating")+i})]})}function vQ(){const{user:t}=Fr();return E.jsx("div",{className:"flex items-center justify-between mb-8",children:E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx("div",{className:"relative",children:E.jsx("img",{src:t.avatarUrl||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:t.name,className:"w-16 h-16 rounded-full object-cover"})}),E.jsxs("div",{children:[E.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.name}),E.jsx("p",{className:"text-gray-500",children:t.email})]})]})})}class bQ{login(e){return rr.get("/line/login",{headers:{"X-User-Id":e}})}}const kQ=new bQ;function wQ(){const{user:t,updateUser:e}=Fr(),[n,r]=v.useState(t==null?void 0:t.preferences.lineNotification),{t:i,i18n:s}=dr(),{isDarkMode:o,toggleDarkMode:a}=bz(),[l,u]=v.useState(!1),[c,d]=v.useState(!1);console.log(t);const h=async()=>{const y=await kQ.login(t.id);y.data&&(window.location.href=y.data)},p=async()=>{const y={...t.preferences,lineNotification:null};console.log(y),e(y),console.log(t),r(null)},g=()=>{const y={...t.preferences.lineNotification,enabled:!t.preferences.lineNotification.enabled},w={...t.preferences,lineNotification:y};e(w),r(y),console.log(w)},m=y=>{s.changeLanguage(y),d(!1)},k=()=>{a();const y={...t.preferences,darkMode:!t.preferences.darkMode};e(y)};return E.jsxs("div",{className:"space-y-6",children:[E.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i("profile_settingsTitle")}),E.jsxs("div",{className:"relative",children:[E.jsxs("div",{className:"flex justify-between items-center w-full px-6 py-4 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer rounded-lg transition",onClick:()=>d(!c),children:[E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx(Kk,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),E.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-lg",children:i("language")})]}),E.jsxs("div",{className:"flex items-center space-x-2",children:[E.jsxs("div",{children:[" ",s.language==="en"?"English":"中文"]}),E.jsx(DE,{className:`w-6 h-6 text-gray-600 dark:text-gray-400 transition-transform ${c?"rotate-180":""}`})]})]}),c&&E.jsxs("div",{className:"absolute top-full right-0 mt-1 w-56 max-h-64 bg-white rounded-md shadow-lg border border-gray-200 overflow-hidden z-10",children:[E.jsx("button",{className:"px-6 w-full text-left text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 py-4 rounded-lg",onClick:()=>m("en"),children:"English"}),E.jsx("button",{className:"px-6 w-full text-left text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 py-4 rounded-lg",onClick:()=>m("zh"),children:"中文"})]})]}),E.jsxs("div",{className:"space-y-4",children:[n?E.jsxs("div",{children:[E.jsxs("div",{className:"flex justify-between items-center w-full px-6 py-4 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer rounded-lg transition",onClick:()=>u(!l),children:[E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx(ef,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),E.jsx("span",{className:"font-medium text-gray-900 dark:text-white text-lg",children:i("lineNotification.title")})]}),E.jsx("div",{className:"ml-auto",children:E.jsx(DE,{className:`w-6 h-6 text-gray-600 dark:text-gray-400 transition-transform ${l?"rotate-180":""}`})})]}),l&&E.jsxs("div",{className:"w-full bg-gray-50 dark:bg-gray-900 py-4 space-y-4",children:[E.jsxs("div",{className:"flex items-center justify-between py-2 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer px-6 rounded-lg",children:[E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx("div",{className:"text-gray-600 dark:text-gray-400 invisible",children:E.jsx(ef,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),E.jsxs("div",{children:[E.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:i("lineNotification.active")}),E.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i("lineNotification.activeDesc")})]})]}),E.jsx("button",{onClick:g,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${n.enabled?"bg-indigo-600":"bg-gray-200 dark:bg-gray-700"}`,children:E.jsx("span",{className:`absolute inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n.enabled?"translate-x-6":"translate-x-1"}`})})]}),E.jsxs("div",{className:"flex items-center space-x-3 justify-between px-6",children:[E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx("div",{className:"text-gray-600 dark:text-gray-400 invisible",children:E.jsx(ef,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),E.jsxs("div",{children:[E.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:i("lineNotification.lineId")}),E.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.uid})]})]}),E.jsx("div",{className:"relative flex items-center gap-2",children:E.jsx("button",{onClick:p,className:`
            border-2 border-green-500 text-green-500 rounded-lg 
            px-4 py-2 hover:bg-green-500 hover:text-white transition-all`,children:i("lineNotification.unbind")})})]})]})]}):E.jsx(SQ,{className:"px-6 py-4 bg-transparent rounded-lg transition",icon:E.jsx(ef,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),label:i("profile_settings.lineNotifications"),description:i("profile_settings.lineNotificationsDesc"),btnName:i("lineNotification.bind"),onClick:()=>h()}),E.jsx(TQ,{className:"px-6 py-4 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer rounded-lg transition",icon:E.jsx(f8,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),label:i("profile_settings.darkMode"),description:i("profile_settings.darkModeDesc"),checked:o,onChange:()=>k()})]})]})}function TQ({className:t,icon:e,label:n,description:r,checked:i,onChange:s}){return E.jsxs("div",{className:`flex items-center justify-between ${t}`,onClick:s,children:[E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:e}),E.jsxs("div",{children:[E.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:n}),E.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r})]})]}),E.jsx("div",{className:"relative",children:E.jsx("button",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${i?"bg-indigo-600":"bg-gray-200 dark:bg-gray-700"}`,children:E.jsx("span",{className:`absolute inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i?"translate-x-6":"translate-x-1"}`})})})]})}function SQ({className:t,icon:e,label:n,description:r,btnName:i,onClick:s}){return E.jsxs("div",{className:`flex items-center justify-between ${t}`,children:[E.jsxs("div",{className:"flex items-center space-x-3",children:[E.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:e}),E.jsxs("div",{children:[E.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:n}),E.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r})]})]}),E.jsx("div",{className:"relative",children:E.jsx("button",{onClick:s,className:`
            border-2 border-green-500 text-green-500 rounded-lg 
            px-4 py-2 hover:bg-green-500 hover:text-white transition-all
            `,children:i})})]})}function _Q(){return E.jsxs("div",{className:"max-w-4xl mx-auto",children:[E.jsx(vQ,{}),E.jsx(wQ,{})]})}function EQ(){const[t]=v.useState(""),{t:e,i18n:n}=dr(),r=s=>{n.changeLanguage(s)},i=s=>{s.preventDefault()};return E.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:E.jsxs("div",{className:"max-w-md w-full space-y-8 p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"flex justify-center",children:E.jsx(c8,{className:"h-12 w-12 text-indigo-600"})}),E.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900 dark:text-white",children:e("welcome_back")}),E.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:e("please_sign_in")})]}),E.jsxs("div",{className:"absolute top-4 right-4 flex items-center space-x-2",children:[E.jsx("button",{onClick:()=>r("en"),className:"text-gray-600 dark:text-gray-400",children:E.jsx(Kk,{className:"h-6 w-6"})}),E.jsxs("select",{onChange:s=>r(s.target.value),className:"mt-2 text-gray-600 dark:text-gray-400 bg-transparent border-none outline-none","aria-label":"Language selector",children:[E.jsx("option",{value:"en",children:"English"}),E.jsx("option",{value:"zh",children:"中文"})]})]}),E.jsxs("form",{className:"mt-8 space-y-6",onSubmit:i,children:[t&&E.jsx("div",{className:"bg-red-50 dark:bg-red-900/50 text-red-500 dark:text-red-400 p-3 rounded-md text-sm text-center",children:t}),E.jsx("div",{className:"flex justify-center",children:E.jsx(YO,{})})]})]})})}var R1={};function CQ(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var xQ=Object.defineProperty,IQ=(t,e,n)=>e in t?xQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,A1=(t,e,n)=>IQ(t,typeof e!="symbol"?e+"":e,n);let Tn=class{constructor(){A1(this,"_locking"),A1(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(i=>e=()=>{this._locks-=1,i()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}};function pt(t,e){if(!t)throw new Error(e)}const PQ=34028234663852886e22,RQ=-34028234663852886e22,AQ=4294967295,NQ=2147483647,OQ=-2147483648;function $f(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>NQ||t<OQ)throw new Error("invalid int 32: "+t)}function mb(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>AQ||t<0)throw new Error("invalid uint 32: "+t)}function aD(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>PQ||t<RQ))throw new Error("invalid float 32: "+t)}const lD=Symbol("@bufbuild/protobuf/enum-type");function DQ(t){const e=t[lD];return pt(e,"missing enum type on enum object"),e}function uD(t,e,n,r){t[lD]=cD(e,n.map(i=>({no:i.no,name:i.name,localName:t[i.no]})))}function cD(t,e,n){const r=Object.create(null),i=Object.create(null),s=[];for(const o of e){const a=dD(o);s.push(a),r[o.name]=a,i[o.no]=a}return{typeName:t,values:s,findName(o){return r[o]},findNumber(o){return i[o]}}}function LQ(t,e,n){const r={};for(const i of e){const s=dD(i);r[s.localName]=s.no,r[s.no]=s.localName}return uD(r,t,e),r}function dD(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class lw{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),i=r.runtime.bin,s=i.makeReadOptions(n);return i.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,n){const r=this.getType(),i=r.runtime.json,s=i.makeReadOptions(n);return i.readMessage(r,e,s,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(i){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(i instanceof Error?i.message:String(i)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,i=r.makeWriteOptions(e),s=i.writerFactory();return r.writeMessage(this,s,i),s.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,i=r.makeWriteOptions(e);return r.writeMessage(this,i)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function MQ(t,e,n,r){var i;const s=(i=r==null?void 0:r.localName)!==null&&i!==void 0?i:e.substring(e.lastIndexOf(".")+1),o={[s]:function(a){t.util.initFields(this),t.util.initPartial(a,this)}}[s];return Object.setPrototypeOf(o.prototype,new lw),Object.assign(o,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(a,l){return new o().fromBinary(a,l)},fromJson(a,l){return new o().fromJson(a,l)},fromJsonString(a,l){return new o().fromJsonString(a,l)},equals(a,l){return t.util.equals(o,a,l)}}),o}function UQ(){let t=0,e=0;for(let r=0;r<28;r+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<r,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function ty(t,e,n){for(let s=0;s<28;s=s+7){const o=t>>>s,a=!(!(o>>>7)&&e==0),l=(a?o|128:o)&255;if(n.push(l),!a)return}const r=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(n.push((i?r|128:r)&255),!!i){for(let s=3;s<31;s=s+7){const o=e>>>s,a=!!(o>>>7),l=(a?o|128:o)&255;if(n.push(l),!a)return}n.push(e>>>31&1)}}const zf=4294967296;function N1(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,i=0;function s(o,a){const l=Number(t.slice(o,a));i*=n,r=r*n+l,r>=zf&&(i=i+(r/zf|0),r=r%zf)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?hD(r,i):uw(r,i)}function FQ(t,e){let n=uw(t,e);const r=n.hi&2147483648;r&&(n=hD(n.lo,n.hi));const i=fD(n.lo,n.hi);return r?"-"+i:i}function fD(t,e){if({lo:t,hi:e}=jQ(t,e),e<=2097151)return String(zf*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,i=e>>16&65535;let s=n+r*6777216+i*6710656,o=r+i*8147497,a=i*2;const l=1e7;return s>=l&&(o+=Math.floor(s/l),s%=l),o>=l&&(a+=Math.floor(o/l),o%=l),a.toString()+O1(o)+O1(s)}function jQ(t,e){return{lo:t>>>0,hi:e>>>0}}function uw(t,e){return{lo:t|0,hi:e|0}}function hD(t,e){return e=~e,t?t=~t+1:e+=1,uw(t,e)}const O1=t=>{const e=String(t);return"0000000".slice(e.length)+e};function D1(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function VQ(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function BQ(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof R1!="object"||R1.BUF_BIGINT_DISABLE!=="1")){const i=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),o=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const u=typeof l=="bigint"?l:BigInt(l);if(u>s||u<i)throw new Error("int64 invalid: ".concat(l));return u},uParse(l){const u=typeof l=="bigint"?l:BigInt(l);if(u>a||u<o)throw new Error("uint64 invalid: ".concat(l));return u},enc(l){return t.setBigInt64(0,this.parse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(l){return t.setBigInt64(0,this.uParse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(l,u){return t.setInt32(0,l,!0),t.setInt32(4,u,!0),t.getBigInt64(0,!0)},uDec(l,u){return t.setInt32(0,l,!0),t.setInt32(4,u,!0),t.getBigUint64(0,!0)}}}const n=i=>pt(/^-?[0-9]+$/.test(i),"int64 invalid: ".concat(i)),r=i=>pt(/^[0-9]+$/.test(i),"uint64 invalid: ".concat(i));return{zero:"0",supported:!1,parse(i){return typeof i!="string"&&(i=i.toString()),n(i),i},uParse(i){return typeof i!="string"&&(i=i.toString()),r(i),i},enc(i){return typeof i!="string"&&(i=i.toString()),n(i),N1(i)},uEnc(i){return typeof i!="string"&&(i=i.toString()),r(i),N1(i)},dec(i,s){return FQ(i,s)},uDec(i,s){return fD(i,s)}}}const st=BQ();var G;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(G||(G={}));var Vs;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Vs||(Vs={}));function rs(t,e,n){if(e===n)return!0;if(t==G.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case G.UINT64:case G.FIXED64:case G.INT64:case G.SFIXED64:case G.SINT64:return e==n}return!1}function dl(t,e){switch(t){case G.BOOL:return!1;case G.UINT64:case G.FIXED64:case G.INT64:case G.SFIXED64:case G.SINT64:return e==0?st.zero:"0";case G.DOUBLE:case G.FLOAT:return 0;case G.BYTES:return new Uint8Array(0);case G.STRING:return"";default:return 0}}function pD(t,e){switch(t){case G.BOOL:return e===!1;case G.STRING:return e==="";case G.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var vt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(vt||(vt={}));class $Q{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let n=new Uint8Array(e),r=0;for(let i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(mb(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return $f(e),D1(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){aD(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){mb(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){$f(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return $f(e),e=(e<<1^e>>31)>>>0,D1(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=st.enc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),i=st.uEnc(e);return r.setInt32(0,i.lo,!0),r.setInt32(4,i.hi,!0),this.raw(n)}int64(e){let n=st.enc(e);return ty(n.lo,n.hi,this.buf),this}sint64(e){let n=st.enc(e),r=n.hi>>31,i=n.lo<<1^r,s=(n.hi<<1|n.lo>>>31)^r;return ty(i,s,this.buf),this}uint64(e){let n=st.uEnc(e);return ty(n.lo,n.hi,this.buf),this}}class zQ{constructor(e,n){this.varint64=UQ,this.uint32=VQ,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case vt.Varint:for(;this.buf[this.pos++]&128;);break;case vt.Bit64:this.pos+=4;case vt.Bit32:this.pos+=4;break;case vt.LengthDelimited:let i=this.uint32();this.pos+=i;break;case vt.StartGroup:for(;;){const[s,o]=this.tag();if(o===vt.EndGroup){if(n!==void 0&&s!==n)throw new Error("invalid end group tag");break}this.skip(o,s)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return st.dec(...this.varint64())}uint64(){return st.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,st.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return st.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return st.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function qQ(t,e,n,r){let i;return{typeName:e,extendee:n,get field(){if(!i){const s=typeof r=="function"?r():r;s.name=e.split(".").pop(),s.jsonName="[".concat(e,"]"),i=t.util.newFieldList([s]).list()[0]}return i},runtime:t}}function mD(t){const e=t.field.localName,n=Object.create(null);return n[e]=HQ(t),[n,()=>n[e]]}function HQ(t){const e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return dl(e.T,e.L);case"message":const n=e.T,r=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function WQ(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}let bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),ym=[];for(let t=0;t<bi.length;t++)ym[bi[t].charCodeAt(0)]=t;ym[45]=bi.indexOf("+");ym[95]=bi.indexOf("/");const gD={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,i=0,s,o=0;for(let a=0;a<t.length;a++){if(s=ym[t.charCodeAt(a)],s===void 0)switch(t[a]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=s,i=1;break;case 1:n[r++]=o<<2|(s&48)>>4,o=s,i=2;break;case 2:n[r++]=(o&15)<<4|(s&60)>>2,o=s,i=3;break;case 3:n[r++]=(o&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,i=0;for(let s=0;s<t.length;s++)switch(r=t[s],n){case 0:e+=bi[r>>2],i=(r&3)<<4,n=1;break;case 1:e+=bi[i|r>>4],i=(r&15)<<2,n=2;break;case 2:e+=bi[i|r>>6],e+=bi[r&63],n=0;break}return n&&(e+=bi[i],e+="=",n==1&&(e+="=")),e}};function KQ(t,e,n){vD(e,t);const r=e.runtime.bin.makeReadOptions(n),i=WQ(t.getType().runtime.bin.listUnknownFields(t),e.field),[s,o]=mD(e);for(const a of i)e.runtime.bin.readField(s,r.readerFactory(a.data),e.field,a.wireType,r);return o()}function GQ(t,e,n,r){vD(e,t);const i=e.runtime.bin.makeReadOptions(r),s=e.runtime.bin.makeWriteOptions(r);if(yD(t,e)){const u=t.getType().runtime.bin.listUnknownFields(t).filter(c=>c.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(const c of u)t.getType().runtime.bin.onUnknownField(t,c.no,c.wireType,c.data)}const o=s.writerFactory();let a=e.field;!a.opt&&!a.repeated&&(a.kind=="enum"||a.kind=="scalar")&&(a=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(a,n,o,s);const l=i.readerFactory(o.finish());for(;l.pos<l.len;){const[u,c]=l.tag(),d=l.skip(c,u);t.getType().runtime.bin.onUnknownField(t,u,c,d)}}function yD(t,e){const n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(r=>r.no==e.field.no)}function vD(t,e){pt(t.extendee.typeName==e.getType().typeName,"extension ".concat(t.typeName," can only be applied to message ").concat(t.extendee.typeName))}function bD(t,e){const n=t.localName;if(t.repeated)return e[n].length>0;if(t.oneof)return e[t.oneof.localName].case===n;switch(t.kind){case"enum":case"scalar":return t.opt||t.req?e[n]!==void 0:t.kind=="enum"?e[n]!==t.T.values[0].no:!pD(t.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function L1(t,e){const n=t.localName,r=!t.opt&&!t.req;if(t.repeated)e[n]=[];else if(t.oneof)e[t.oneof.localName]={case:void 0};else switch(t.kind){case"map":e[n]={};break;case"enum":e[n]=r?t.T.values[0].no:void 0;break;case"scalar":e[n]=r?dl(t.T,t.L):void 0;break;case"message":e[n]=void 0;break}}function wo(t,e){if(t===null||typeof t!="object"||!Object.getOwnPropertyNames(lw.prototype).every(r=>r in t&&typeof t[r]=="function"))return!1;const n=t.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function kD(t,e){return wo(e)||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}G.DOUBLE,G.FLOAT,G.INT64,G.UINT64,G.INT32,G.UINT32,G.BOOL,G.STRING,G.BYTES;const M1={ignoreUnknownFields:!1},U1={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function QQ(t){return t?Object.assign(Object.assign({},M1),t):M1}function JQ(t){return t?Object.assign(Object.assign({},U1),t):U1}const Zh=Symbol(),qf=Symbol();function YQ(){return{makeReadOptions:QQ,makeWriteOptions:JQ,readMessage(t,e,n,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(Gr(e)));r=r??new t;const i=new Map,s=n.typeRegistry;for(const[o,a]of Object.entries(e)){const l=t.fields.findJsonName(o);if(l){if(l.oneof){if(a===null&&l.kind=="scalar")continue;const u=i.get(l.oneof);if(u!==void 0)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(l.oneof.name,'" present: "').concat(u,'", "').concat(o,'"'));i.set(l.oneof,o)}F1(r,a,l,n,t)}else{let u=!1;if(s!=null&&s.findExtension&&o.startsWith("[")&&o.endsWith("]")){const c=s.findExtension(o.substring(1,o.length-1));if(c&&c.extendee.typeName==t.typeName){u=!0;const[d,h]=mD(c);F1(d,a,c.field,n,c),GQ(r,c,h(),n)}}if(!u&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(o,'" is unknown'))}}return r},writeMessage(t,e){const n=t.getType(),r={};let i;try{for(i of n.fields.byNumber()){if(!bD(i,t)){if(i.req)throw"required field not set";if(!e.emitDefaultValues||!ZQ(i))continue}const o=i.oneof?t[i.oneof.localName].value:t[i.localName],a=j1(i,o,e);a!==void 0&&(r[e.useProtoFieldName?i.name:i.jsonName]=a)}const s=e.typeRegistry;if(s!=null&&s.findExtensionFor)for(const o of n.runtime.bin.listUnknownFields(t)){const a=s.findExtensionFor(n.typeName,o.no);if(a&&yD(t,a)){const l=KQ(t,a,e),u=j1(a.field,l,e);u!==void 0&&(r[a.field.jsonName]=u)}}}catch(s){const o=i?"cannot encode field ".concat(n.typeName,".").concat(i.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),a=s instanceof Error?s.message:String(s);throw new Error(o+(a.length>0?": ".concat(a):""))}return r},readScalar(t,e,n){return Hu(t,e,n??Vs.BIGINT,!0)},writeScalar(t,e,n){if(e!==void 0&&(n||pD(t,e)))return Hf(t,e)},debug:Gr}}function Gr(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function F1(t,e,n,r,i){let s=n.localName;if(n.repeated){if(pt(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Gr(e)));const o=t[s];for(const a of e){if(a===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Gr(a)));switch(n.kind){case"message":o.push(n.T.fromJson(a,r));break;case"enum":const l=ny(n.T,a,r.ignoreUnknownFields,!0);l!==qf&&o.push(l);break;case"scalar":try{o.push(Hu(n.T,a,n.L,!0))}catch(u){let c="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Gr(a));throw u instanceof Error&&u.message.length>0&&(c+=": ".concat(u.message)),new Error(c)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Gr(e)));const o=t[s];for(const[a,l]of Object.entries(e)){if(l===null)throw new Error("cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: map value null"));let u;try{u=XQ(n.K,a)}catch(c){let d="cannot decode map key for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Gr(e));throw c instanceof Error&&c.message.length>0&&(d+=": ".concat(c.message)),new Error(d)}switch(n.V.kind){case"message":o[u]=n.V.T.fromJson(l,r);break;case"enum":const c=ny(n.V.T,l,r.ignoreUnknownFields,!0);c!==qf&&(o[u]=c);break;case"scalar":try{o[u]=Hu(n.V.T,l,Vs.BIGINT,!0)}catch(d){let h="cannot decode map value for field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Gr(e));throw d instanceof Error&&d.message.length>0&&(h+=": ".concat(d.message)),new Error(h)}break}}}else switch(n.oneof&&(t=t[n.oneof.localName]={case:s},s="value"),n.kind){case"message":const o=n.T;if(e===null&&o.typeName!="google.protobuf.Value")return;let a=t[s];wo(a)?a.fromJson(e,r):(t[s]=a=o.fromJson(e,r),o.fieldWrapper&&!n.oneof&&(t[s]=o.fieldWrapper.unwrapField(a)));break;case"enum":const l=ny(n.T,e,r.ignoreUnknownFields,!1);switch(l){case Zh:L1(n,t);break;case qf:break;default:t[s]=l;break}break;case"scalar":try{const u=Hu(n.T,e,n.L,!1);switch(u){case Zh:L1(n,t);break;default:t[s]=u;break}}catch(u){let c="cannot decode field ".concat(i.typeName,".").concat(n.name," from JSON: ").concat(Gr(e));throw u instanceof Error&&u.message.length>0&&(c+=": ".concat(u.message)),new Error(c)}break}}function XQ(t,e){if(t===G.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Hu(t,e,Vs.BIGINT,!0).toString()}function Hu(t,e,n,r){if(e===null)return r?dl(t,n):Zh;switch(t){case G.DOUBLE:case G.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const i=Number(e);if(Number.isNaN(i)||!Number.isFinite(i))break;return t==G.FLOAT&&aD(i),i;case G.INT32:case G.FIXED32:case G.SFIXED32:case G.SINT32:case G.UINT32:let s;if(typeof e=="number"?s=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(s=Number(e)),s===void 0)break;return t==G.UINT32||t==G.FIXED32?mb(s):$f(s),s;case G.INT64:case G.SFIXED64:case G.SINT64:if(typeof e!="number"&&typeof e!="string")break;const o=st.parse(e);return n?o.toString():o;case G.FIXED64:case G.UINT64:if(typeof e!="number"&&typeof e!="string")break;const a=st.uParse(e);return n?a.toString():a;case G.BOOL:if(typeof e!="boolean")break;return e;case G.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case G.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return gD.dec(e)}throw new Error}function ny(t,e,n,r){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:r?t.values[0].no:Zh;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const i=t.findName(e);if(i!==void 0)return i.no;if(n)return qf;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(Gr(e)))}function ZQ(t){return t.repeated||t.kind=="map"?!0:!(t.oneof||t.kind=="message"||t.opt||t.req)}function j1(t,e,n){if(t.kind=="map"){pt(typeof e=="object"&&e!=null);const r={},i=Object.entries(e);switch(t.V.kind){case"scalar":for(const[o,a]of i)r[o.toString()]=Hf(t.V.T,a);break;case"message":for(const[o,a]of i)r[o.toString()]=a.toJson(n);break;case"enum":const s=t.V.T;for(const[o,a]of i)r[o.toString()]=ry(s,a,n.enumAsInteger);break}return n.emitDefaultValues||i.length>0?r:void 0}if(t.repeated){pt(Array.isArray(e));const r=[];switch(t.kind){case"scalar":for(let i=0;i<e.length;i++)r.push(Hf(t.T,e[i]));break;case"enum":for(let i=0;i<e.length;i++)r.push(ry(t.T,e[i],n.enumAsInteger));break;case"message":for(let i=0;i<e.length;i++)r.push(e[i].toJson(n));break}return n.emitDefaultValues||r.length>0?r:void 0}switch(t.kind){case"scalar":return Hf(t.T,e);case"enum":return ry(t.T,e,n.enumAsInteger);case"message":return kD(t.T,e).toJson(n)}}function ry(t,e,n){var r;if(pt(typeof e=="number"),t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const i=t.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function Hf(t,e){switch(t){case G.INT32:case G.SFIXED32:case G.SINT32:case G.FIXED32:case G.UINT32:return pt(typeof e=="number"),e;case G.FLOAT:case G.DOUBLE:return pt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case G.STRING:return pt(typeof e=="string"),e;case G.BOOL:return pt(typeof e=="boolean"),e;case G.UINT64:case G.FIXED64:case G.INT64:case G.SFIXED64:case G.SINT64:return pt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case G.BYTES:return pt(e instanceof Uint8Array),gD.enc(e)}}const ia=Symbol("@bufbuild/protobuf/unknown-fields"),V1={readUnknownFields:!0,readerFactory:t=>new zQ(t)},B1={writeUnknownFields:!0,writerFactory:()=>new $Q};function eJ(t){return t?Object.assign(Object.assign({},V1),t):V1}function tJ(t){return t?Object.assign(Object.assign({},B1),t):B1}function nJ(){return{makeReadOptions:eJ,makeWriteOptions:tJ,listUnknownFields(t){var e;return(e=t[ia])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[ia]},writeUnknownFields(t,e){const r=t[ia];if(r)for(const i of r)e.tag(i.no,i.wireType).raw(i.data)},onUnknownField(t,e,n,r){const i=t;Array.isArray(i[ia])||(i[ia]=[]),i[ia].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r,i){const s=t.getType(),o=i?e.len:e.pos+n;let a,l;for(;e.pos<o&&([a,l]=e.tag(),!(i===!0&&l==vt.EndGroup));){const u=s.fields.find(a);if(!u){const c=e.skip(l,a);r.readUnknownFields&&this.onUnknownField(t,a,l,c);continue}$1(t,e,u,l,r)}if(i&&(l!=vt.EndGroup||a!==n))throw new Error("invalid end group tag")},readField:$1,writeMessage(t,e,n){const r=t.getType();for(const i of r.fields.byNumber()){if(!bD(i,t)){if(i.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(i.name," to binary: required field not set"));continue}const s=i.oneof?t[i.oneof.localName].value:t[i.localName];z1(i,s,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e},writeField(t,e,n,r){e!==void 0&&z1(t,e,n,r)}}}function $1(t,e,n,r,i){let{repeated:s,localName:o}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=o&&delete t.value,t.case=o,o="value"),n.kind){case"scalar":case"enum":const a=n.kind=="enum"?G.INT32:n.T;let l=ep;if(n.kind=="scalar"&&n.L>0&&(l=iJ),s){let h=t[o];if(r==vt.LengthDelimited&&a!=G.STRING&&a!=G.BYTES){let g=e.uint32()+e.pos;for(;e.pos<g;)h.push(l(e,a))}else h.push(l(e,a))}else t[o]=l(e,a);break;case"message":const u=n.T;s?t[o].push(Wf(e,new u,i,n)):wo(t[o])?Wf(e,t[o],i,n):(t[o]=Wf(e,new u,i,n),u.fieldWrapper&&!n.oneof&&!n.repeated&&(t[o]=u.fieldWrapper.unwrapField(t[o])));break;case"map":let[c,d]=rJ(n,e,i);t[o][c]=d;break}}function Wf(t,e,n,r){const i=e.getType().runtime.bin,s=r==null?void 0:r.delimited;return i.readMessage(e,t,s?r.no:t.uint32(),n,s),e}function rJ(t,e,n){const r=e.uint32(),i=e.pos+r;let s,o;for(;e.pos<i;){const[a]=e.tag();switch(a){case 1:s=ep(e,t.K);break;case 2:switch(t.V.kind){case"scalar":o=ep(e,t.V.T);break;case"enum":o=e.int32();break;case"message":o=Wf(e,new t.V.T,n,void 0);break}break}}if(s===void 0&&(s=dl(t.K,Vs.BIGINT)),typeof s!="string"&&typeof s!="number"&&(s=s.toString()),o===void 0)switch(t.V.kind){case"scalar":o=dl(t.V.T,Vs.BIGINT);break;case"enum":o=t.V.T.values[0].no;break;case"message":o=new t.V.T;break}return[s,o]}function iJ(t,e){const n=ep(t,e);return typeof n=="bigint"?n.toString():n}function ep(t,e){switch(e){case G.STRING:return t.string();case G.BOOL:return t.bool();case G.DOUBLE:return t.double();case G.FLOAT:return t.float();case G.INT32:return t.int32();case G.INT64:return t.int64();case G.UINT64:return t.uint64();case G.FIXED64:return t.fixed64();case G.BYTES:return t.bytes();case G.FIXED32:return t.fixed32();case G.SFIXED32:return t.sfixed32();case G.SFIXED64:return t.sfixed64();case G.SINT64:return t.sint64();case G.UINT32:return t.uint32();case G.SINT32:return t.sint32()}}function z1(t,e,n,r){pt(e!==void 0);const i=t.repeated;switch(t.kind){case"scalar":case"enum":let s=t.kind=="enum"?G.INT32:t.T;if(i)if(pt(Array.isArray(e)),t.packed)oJ(n,s,t.no,e);else for(const o of e)Wu(n,s,t.no,o);else Wu(n,s,t.no,e);break;case"message":if(i){pt(Array.isArray(e));for(const o of e)q1(n,r,t,o)}else q1(n,r,t,e);break;case"map":pt(typeof e=="object"&&e!=null);for(const[o,a]of Object.entries(e))sJ(n,r,t,o,a);break}}function sJ(t,e,n,r,i){t.tag(n.no,vt.LengthDelimited),t.fork();let s=r;switch(n.K){case G.INT32:case G.FIXED32:case G.UINT32:case G.SFIXED32:case G.SINT32:s=Number.parseInt(r);break;case G.BOOL:pt(r=="true"||r=="false"),s=r=="true";break}switch(Wu(t,n.K,1,s),n.V.kind){case"scalar":Wu(t,n.V.T,2,i);break;case"enum":Wu(t,G.INT32,2,i);break;case"message":pt(i!==void 0),t.tag(2,vt.LengthDelimited).bytes(i.toBinary(e));break}t.join()}function q1(t,e,n,r){const i=kD(n.T,r);n.delimited?t.tag(n.no,vt.StartGroup).raw(i.toBinary(e)).tag(n.no,vt.EndGroup):t.tag(n.no,vt.LengthDelimited).bytes(i.toBinary(e))}function Wu(t,e,n,r){pt(r!==void 0);let[i,s]=wD(e);t.tag(n,i)[s](r)}function oJ(t,e,n,r){if(!r.length)return;t.tag(n,vt.LengthDelimited).fork();let[,i]=wD(e);for(let s=0;s<r.length;s++)t[i](r[s]);t.join()}function wD(t){let e=vt.Varint;switch(t){case G.BYTES:case G.STRING:e=vt.LengthDelimited;break;case G.DOUBLE:case G.FIXED64:case G.SFIXED64:e=vt.Bit64;break;case G.FIXED32:case G.SFIXED32:case G.FLOAT:e=vt.Bit32;break}const n=G[t].toLowerCase();return[e,n]}function aJ(){return{setEnumType:uD,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const i=r.localName,s=e,o=t;if(o[i]!=null)switch(r.kind){case"oneof":const a=o[i].case;if(a===void 0)continue;const l=r.findField(a);let u=o[i].value;l&&l.kind=="message"&&!wo(u,l.T)?u=new l.T(u):l&&l.kind==="scalar"&&l.T===G.BYTES&&(u=cu(u)),s[i]={case:a,value:u};break;case"scalar":case"enum":let c=o[i];r.T===G.BYTES&&(c=r.repeated?c.map(cu):cu(c)),s[i]=c;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===G.BYTES)for(const[p,g]of Object.entries(o[i]))s[i][p]=cu(g);else Object.assign(s[i],o[i]);break;case"message":const h=r.V.T;for(const p of Object.keys(o[i])){let g=o[i][p];h.fieldWrapper||(g=new h(g)),s[i][p]=g}break}break;case"message":const d=r.T;if(r.repeated)s[i]=o[i].map(h=>wo(h,d)?h:new d(h));else{const h=o[i];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?s[i]=cu(h):s[i]=h:s[i]=wo(h,d)?h:new d(h)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const i=e[r.localName],s=n[r.localName];if(r.repeated){if(i.length!==s.length)return!1;switch(r.kind){case"message":return i.every((o,a)=>r.T.equals(o,s[a]));case"scalar":return i.every((o,a)=>rs(r.T,o,s[a]));case"enum":return i.every((o,a)=>rs(G.INT32,o,s[a]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":return r.T.equals(i,s);case"enum":return rs(G.INT32,i,s);case"scalar":return rs(r.T,i,s);case"oneof":if(i.case!==s.case)return!1;const o=r.findField(i.case);if(o===void 0)return!0;switch(o.kind){case"message":return o.T.equals(i.value,s.value);case"enum":return rs(G.INT32,i.value,s.value);case"scalar":return rs(o.T,i.value,s.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(s));switch(r.V.kind){case"message":const l=r.V.T;return a.every(c=>l.equals(i[c],s[c]));case"enum":return a.every(c=>rs(G.INT32,i[c],s[c]));case"scalar":const u=r.V.T;return a.every(c=>rs(u,i[c],s[c]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const i of e.fields.byMember()){const s=t[i.localName];let o;if(i.repeated)o=s.map(af);else if(i.kind=="map"){o=r[i.localName];for(const[a,l]of Object.entries(s))o[a]=af(l)}else i.kind=="oneof"?o=i.findField(s.case)?{case:s.case,value:af(s.value)}:{case:void 0}:o=af(s);r[i.localName]=o}for(const i of e.runtime.bin.listUnknownFields(t))e.runtime.bin.onUnknownField(r,i.no,i.wireType,i.data);return n}}}function af(t){if(t===void 0)return t;if(wo(t))return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function cu(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function lJ(t,e,n){return{syntax:t,json:YQ(),bin:nJ(),util:Object.assign(Object.assign({},aJ()),{newFieldList:e,initFields:n}),makeMessageType(r,i,s){return MQ(this,r,i,s)},makeEnum:LQ,makeEnumType:cD,getEnumType:DQ,makeExtension(r,i,s){return qQ(this,r,i,s)}}}class uJ{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function TD(t,e){const n=SD(t);return e?n:mJ(pJ(n))}function cJ(t){return TD(t,!1)}const dJ=SD;function SD(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let i=t.charAt(r);switch(i){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),e=!1;break;default:e&&(e=!1,i=i.toUpperCase()),n.push(i);break}}return n.join("")}const fJ=new Set(["constructor","toString","toJSON","valueOf"]),hJ=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),_D=t=>"".concat(t,"$"),pJ=t=>hJ.has(t)?_D(t):t,mJ=t=>fJ.has(t)?_D(t):t;class gJ{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=cJ(e)}addField(e){pt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function yJ(t,e){var n,r,i,s,o,a;const l=[];let u;for(const c of typeof t=="function"?t():t){const d=c;if(d.localName=TD(c.name,c.oneof!==void 0),d.jsonName=(n=c.jsonName)!==null&&n!==void 0?n:dJ(c.name),d.repeated=(r=c.repeated)!==null&&r!==void 0?r:!1,c.kind=="scalar"&&(d.L=(i=c.L)!==null&&i!==void 0?i:Vs.BIGINT),d.delimited=(s=c.delimited)!==null&&s!==void 0?s:!1,d.req=(o=c.req)!==null&&o!==void 0?o:!1,d.opt=(a=c.opt)!==null&&a!==void 0?a:!1,c.packed===void 0&&(d.packed=c.kind=="enum"||c.kind=="scalar"&&c.T!=G.BYTES&&c.T!=G.STRING),c.oneof!==void 0){const h=typeof c.oneof=="string"?c.oneof:c.oneof.name;(!u||u.name!=h)&&(u=new gJ(h)),d.oneof=u,u.addField(d)}l.push(d)}return l}const H=lJ("proto3",t=>new uJ(t,e=>yJ(e)),t=>{for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=dl(e.T,e.L);break}}});class kn extends lw{constructor(e){super(),this.seconds=st.zero,this.nanos=0,H.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(H.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=st.parse(i/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const i=(this.nanos+1e9).toString().substring(1);i.substring(3)==="000000"?r="."+i.substring(0,3)+"Z":i.substring(6)==="000"?r="."+i.substring(0,6)+"Z":r="."+i+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return kn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new kn({seconds:st.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new kn().fromBinary(e,n)}static fromJson(e,n){return new kn().fromJson(e,n)}static fromJsonString(e,n){return new kn().fromJsonString(e,n)}static equals(e,n){return H.util.equals(kn,e,n)}}kn.runtime=H;kn.typeName="google.protobuf.Timestamp";kn.fields=H.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const vJ=H.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:kn},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:bJ,repeated:!0},{no:5,name:"events",kind:"message",T:wJ,repeated:!0}]),bJ=H.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:kJ,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),kJ=H.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:kn},{no:3,name:"value",kind:"scalar",T:2}]),wJ=H.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:kn},{no:7,name:"normalized_end_timestamp",kind:"message",T:kn,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),Sr=H.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Yt=H.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),cw=H.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),_u=H.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Rc=H.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Cr=H.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),sa=H.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),TJ=H.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Qr=H.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),dw=H.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:tp,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:MD}]),tp=H.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),SJ=H.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:H.getEnumType(Yt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Ac=H.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:H.getEnumType(gb)},{no:4,name:"tracks",kind:"message",T:xa,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:SJ},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:H.getEnumType(np)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:H.getEnumType(Cr)}]),gb=H.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),np=H.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),Vn=H.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),_J=H.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:To,repeated:!0}]),xa=H.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:H.getEnumType(Sr)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:H.getEnumType(Yt)},{no:10,name:"layers",kind:"message",T:To,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:_J,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:H.getEnumType(Vn)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:MD},{no:19,name:"audio_features",kind:"enum",T:H.getEnumType(Qr),repeated:!0}]),To=H.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:H.getEnumType(cw)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),is=H.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:H.getEnumType(et)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:CD,oneof:"value"},{no:3,name:"speaker",kind:"message",T:EJ,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:xD,oneof:"value"},{no:7,name:"transcription",kind:"message",T:CJ,oneof:"value"},{no:8,name:"metrics",kind:"message",T:vJ,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:yb,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:ID,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:PD,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:RD,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:DJ,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:LJ,oneof:"value"}]),et=H.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),EJ=H.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:ED,repeated:!0}]),ED=H.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),CD=H.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0}]),xD=H.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),CJ=H.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:xJ,repeated:!0}]),xJ=H.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),yb=H.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),ID=H.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),PD=H.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),RD=H.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:AD,oneof:"value"}]),AD=H.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),ND=H.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),IJ=H.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:H.getEnumType(OD)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),OD=H.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),PJ=H.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:H.getEnumType(DD)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),DD=H.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),LD=H.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:H1},{no:2,name:"screen",kind:"message",T:H1},{no:3,name:"resume_connection",kind:"enum",T:H.getEnumType(Rc)},{no:4,name:"disabled_codecs",kind:"message",T:RJ},{no:5,name:"force_relay",kind:"enum",T:H.getEnumType(Rc)}]),H1=H.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:H.getEnumType(Rc)}]),RJ=H.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:tp,repeated:!0},{no:2,name:"publish",kind:"message",T:tp,repeated:!0}]),MD=H.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),AJ=H.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),NJ=H.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:H.getEnumType(AJ)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),OJ=H.makeMessageType("livekit.DataStream.FileHeader",()=>[{no:1,name:"file_name",kind:"scalar",T:9}],{localName:"DataStream_FileHeader"}),DJ=H.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:H.getEnumType(Vn)},{no:8,name:"extensions",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:NJ,oneof:"content_header"},{no:10,name:"file_header",kind:"message",T:OJ,oneof:"content_header"}],{localName:"DataStream_Header"}),LJ=H.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"complete",kind:"scalar",T:8},{no:5,name:"version",kind:"scalar",T:5},{no:6,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),_r=H.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),vb=H.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),MJ=H.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),UJ=H.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Uo,oneof:"message"},{no:2,name:"answer",kind:"message",T:Uo,oneof:"message"},{no:3,name:"trickle",kind:"message",T:fw,oneof:"message"},{no:4,name:"add_track",kind:"message",T:kb,oneof:"message"},{no:5,name:"mute",kind:"message",T:hw,oneof:"message"},{no:6,name:"subscription",kind:"message",T:vm,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:UD,oneof:"message"},{no:8,name:"leave",kind:"message",T:bm,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:jD,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:zD,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:qD,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Hr,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:VD,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:WD,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:FD,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:$J,oneof:"message"}]),W1=H.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:FJ,oneof:"message"},{no:2,name:"answer",kind:"message",T:Uo,oneof:"message"},{no:3,name:"offer",kind:"message",T:Uo,oneof:"message"},{no:4,name:"trickle",kind:"message",T:fw,oneof:"message"},{no:5,name:"update",kind:"message",T:BJ,oneof:"message"},{no:6,name:"track_published",kind:"message",T:pw,oneof:"message"},{no:8,name:"leave",kind:"message",T:bm,oneof:"message"},{no:9,name:"mute",kind:"message",T:hw,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:zJ,oneof:"message"},{no:11,name:"room_update",kind:"message",T:qJ,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:WJ,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:GJ,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:JJ,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:YJ,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:VJ,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:jJ,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:XJ,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:tY,oneof:"message"},{no:22,name:"request_response",kind:"message",T:nY,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:rY,oneof:"message"}]),bb=H.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),kb=H.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:H.getEnumType(Sr)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:H.getEnumType(Yt)},{no:9,name:"layers",kind:"message",T:To,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:bb,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:H.getEnumType(Vn)},{no:15,name:"stream",kind:"scalar",T:9}]),fw=H.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:H.getEnumType(_r)},{no:3,name:"final",kind:"scalar",T:8}]),hw=H.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),FJ=H.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:dw},{no:2,name:"participant",kind:"message",T:Ac},{no:3,name:"other_participants",kind:"message",T:Ac,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:BD,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:LD},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:IJ},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:tp,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),jJ=H.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:BD,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:LD}]),pw=H.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:xa}]),VJ=H.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Uo=H.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),BJ=H.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Ac,repeated:!0}]),vm=H.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:ND,repeated:!0}]),UD=H.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:H.getEnumType(cw)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),FD=H.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:H.getEnumType(Qr),repeated:!0}]),$J=H.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),bm=H.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:H.getEnumType(Cr)},{no:3,name:"action",kind:"enum",T:H.getEnumType(Ba)},{no:4,name:"regions",kind:"message",T:ZJ}]),Ba=H.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),jD=H.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:To,repeated:!0}]),VD=H.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),BD=H.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),zJ=H.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:ED,repeated:!0}]),qJ=H.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:dw}]),HJ=H.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:H.getEnumType(_u)},{no:3,name:"score",kind:"scalar",T:2}]),WJ=H.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:HJ,repeated:!0}]),KJ=H.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:H.getEnumType(vb)}]),GJ=H.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:KJ,repeated:!0}]),mw=H.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:H.getEnumType(cw)},{no:2,name:"enabled",kind:"scalar",T:8}]),QJ=H.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:mw,repeated:!0}]),JJ=H.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:mw,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:QJ,repeated:!0}]),$D=H.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),zD=H.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:$D,repeated:!0}]),YJ=H.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),qD=H.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Uo},{no:2,name:"subscription",kind:"message",T:vm},{no:3,name:"publish_tracks",kind:"message",T:pw,repeated:!0},{no:4,name:"data_channels",kind:"message",T:HD,repeated:!0},{no:5,name:"offer",kind:"message",T:Uo},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),HD=H.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:H.getEnumType(_r)}]),Hr=H.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:H.getEnumType(MJ),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),WD=H.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),XJ=H.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),ZJ=H.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:eY,repeated:!0}]),eY=H.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),tY=H.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:H.getEnumType(TJ)}]),nY=H.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:H.getEnumType(KD)},{no:3,name:"message",kind:"scalar",T:9}]),KD=H.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),rY=H.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function iY(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kf={exports:{}},sY=Kf.exports,K1;function oY(){return K1||(K1=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(sY,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function a(m,k){var y=m[k];if(typeof y.bind=="function")return y.bind(m);try{return Function.prototype.bind.call(y,m)}catch{return function(){return Function.prototype.apply.apply(y,[m,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?l:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function c(){for(var m=this.getLevel(),k=0;k<i.length;k++){var y=i[k];this[y]=k<m?e:this.methodFactory(y,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(c.call(this),this[m].apply(this,arguments))}}function h(m,k,y){return u(m)||d.apply(this,arguments)}function p(m,k){var y=this,w,T,x,I="loglevel";typeof m=="string"?I+=":"+m:typeof m=="symbol"&&(I=void 0);function R(A){var D=(i[A]||"silent").toUpperCase();if(!(typeof window===n||!I)){try{window.localStorage[I]=D;return}catch{}try{window.document.cookie=encodeURIComponent(I)+"="+D+";"}catch{}}}function C(){var A;if(!(typeof window===n||!I)){try{A=window.localStorage[I]}catch{}if(typeof A===n)try{var D=window.document.cookie,L=encodeURIComponent(I),ae=D.indexOf(L+"=");ae!==-1&&(A=/^([^;]+)/.exec(D.slice(ae+L.length+1))[1])}catch{}return y.levels[A]===void 0&&(A=void 0),A}}function _(){if(!(typeof window===n||!I)){try{window.localStorage.removeItem(I)}catch{}try{window.document.cookie=encodeURIComponent(I)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function P(A){var D=A;if(typeof D=="string"&&y.levels[D.toUpperCase()]!==void 0&&(D=y.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=y.levels.SILENT)return D;throw new TypeError("log.setLevel() called with invalid level: "+A)}y.name=m,y.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},y.methodFactory=k||h,y.getLevel=function(){return x??T??w},y.setLevel=function(A,D){return x=P(A),D!==!1&&R(x),c.call(y)},y.setDefaultLevel=function(A){T=P(A),C()||y.setLevel(A,!1)},y.resetLevel=function(){x=null,_(),c.call(y)},y.enableAll=function(A){y.setLevel(y.levels.TRACE,A)},y.disableAll=function(A){y.setLevel(y.levels.SILENT,A)},y.rebuild=function(){if(o!==y&&(w=P(o.getLevel())),c.call(y),o===y)for(var A in s)s[A].rebuild()},w=P(o?o.getLevel():"WARN");var N=C();N!=null&&(x=P(N)),c.call(y)}o=new p,o.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var y=s[k];return y||(y=s[k]=new p(k,o.methodFactory)),y};var g=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=g),o},o.getLoggers=function(){return s},o.default=o,o})}(Kf)),Kf.exports}var km=oY(),wb;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(wb||(wb={}));var Or;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Or||(Or={}));let Ee=km.getLogger("livekit");Object.values(Or).map(t=>km.getLogger(t));Ee.setDefaultLevel(wb.info);function ji(t){const e=km.getLogger(t);return e.setDefaultLevel(Ee.getLevel()),e}const aY=km.getLogger("lk-e2ee"),du=7e3,lY=[0,300,2*2*300,3*3*300,4*4*300,du,du,du,du,du];class uY{constructor(e){this._retryDelays=e!==void 0?[...e]:lY}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function F(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}function G1(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ha(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof G1=="function"?G1(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}var lf={exports:{}},Q1;function cY(){if(Q1)return lf.exports;Q1=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(I,R,C){return Function.prototype.apply.call(I,R,C)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(I){return Object.getOwnPropertyNames(I).concat(Object.getOwnPropertySymbols(I))}:n=function(I){return Object.getOwnPropertyNames(I)};function r(x){console&&console.warn&&console.warn(x)}var i=Number.isNaN||function(I){return I!==I};function s(){s.init.call(this)}lf.exports=s,lf.exports.once=y,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(x){if(typeof x!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof x)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(x){if(typeof x!="number"||x<0||i(x))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+x+".");o=x}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(I){if(typeof I!="number"||I<0||i(I))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+I+".");return this._maxListeners=I,this};function l(x){return x._maxListeners===void 0?s.defaultMaxListeners:x._maxListeners}s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(I){for(var R=[],C=1;C<arguments.length;C++)R.push(arguments[C]);var _=I==="error",P=this._events;if(P!==void 0)_=_&&P.error===void 0;else if(!_)return!1;if(_){var N;if(R.length>0&&(N=R[0]),N instanceof Error)throw N;var A=new Error("Unhandled error."+(N?" ("+N.message+")":""));throw A.context=N,A}var D=P[I];if(D===void 0)return!1;if(typeof D=="function")e(D,this,R);else for(var L=D.length,ae=g(D,L),C=0;C<L;++C)e(ae[C],this,R);return!0};function u(x,I,R,C){var _,P,N;if(a(R),P=x._events,P===void 0?(P=x._events=Object.create(null),x._eventsCount=0):(P.newListener!==void 0&&(x.emit("newListener",I,R.listener?R.listener:R),P=x._events),N=P[I]),N===void 0)N=P[I]=R,++x._eventsCount;else if(typeof N=="function"?N=P[I]=C?[R,N]:[N,R]:C?N.unshift(R):N.push(R),_=l(x),_>0&&N.length>_&&!N.warned){N.warned=!0;var A=new Error("Possible EventEmitter memory leak detected. "+N.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");A.name="MaxListenersExceededWarning",A.emitter=x,A.type=I,A.count=N.length,r(A)}return x}s.prototype.addListener=function(I,R){return u(this,I,R,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(I,R){return u(this,I,R,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(x,I,R){var C={fired:!1,wrapFn:void 0,target:x,type:I,listener:R},_=c.bind(C);return _.listener=R,C.wrapFn=_,_}s.prototype.once=function(I,R){return a(R),this.on(I,d(this,I,R)),this},s.prototype.prependOnceListener=function(I,R){return a(R),this.prependListener(I,d(this,I,R)),this},s.prototype.removeListener=function(I,R){var C,_,P,N,A;if(a(R),_=this._events,_===void 0)return this;if(C=_[I],C===void 0)return this;if(C===R||C.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete _[I],_.removeListener&&this.emit("removeListener",I,C.listener||R));else if(typeof C!="function"){for(P=-1,N=C.length-1;N>=0;N--)if(C[N]===R||C[N].listener===R){A=C[N].listener,P=N;break}if(P<0)return this;P===0?C.shift():m(C,P),C.length===1&&(_[I]=C[0]),_.removeListener!==void 0&&this.emit("removeListener",I,A||R)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(I){var R,C,_;if(C=this._events,C===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[I]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete C[I]),this;if(arguments.length===0){var P=Object.keys(C),N;for(_=0;_<P.length;++_)N=P[_],N!=="removeListener"&&this.removeAllListeners(N);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=C[I],typeof R=="function")this.removeListener(I,R);else if(R!==void 0)for(_=R.length-1;_>=0;_--)this.removeListener(I,R[_]);return this};function h(x,I,R){var C=x._events;if(C===void 0)return[];var _=C[I];return _===void 0?[]:typeof _=="function"?R?[_.listener||_]:[_]:R?k(_):g(_,_.length)}s.prototype.listeners=function(I){return h(this,I,!0)},s.prototype.rawListeners=function(I){return h(this,I,!1)},s.listenerCount=function(x,I){return typeof x.listenerCount=="function"?x.listenerCount(I):p.call(x,I)},s.prototype.listenerCount=p;function p(x){var I=this._events;if(I!==void 0){var R=I[x];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function g(x,I){for(var R=new Array(I),C=0;C<I;++C)R[C]=x[C];return R}function m(x,I){for(;I+1<x.length;I++)x[I]=x[I+1];x.pop()}function k(x){for(var I=new Array(x.length),R=0;R<I.length;++R)I[R]=x[R].listener||x[R];return I}function y(x,I){return new Promise(function(R,C){function _(N){x.removeListener(I,P),C(N)}function P(){typeof x.removeListener=="function"&&x.removeListener("error",_),R([].slice.call(arguments))}T(x,I,P,{once:!0}),I!=="error"&&w(x,_,{once:!0})})}function w(x,I,R){typeof x.on=="function"&&T(x,"error",I,R)}function T(x,I,R,C){if(typeof x.on=="function")C.once?x.once(I,R):x.on(I,R);else if(typeof x.addEventListener=="function")x.addEventListener(I,function _(P){C.once&&x.removeEventListener(I,_),R(P)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof x)}return lf.exports}var ci=cY();let GD=!0,QD=!0;function Gf(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseInt(r[n],10)}function Go(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,a){if(o!==e)return i.apply(this,arguments);const l=u=>{const c=n(u);c&&(a.handleEvent?a.handleEvent(c):a(c))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,l),i.apply(this,[o,l])};const s=r.removeEventListener;r.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const l=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function dY(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(GD=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function fY(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(QD=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function JD(){if(typeof window=="object"){if(GD)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function gw(t,e){QD&&console.warn(t+" is deprecated, please use "+e+" instead.")}function hY(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=Gf(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Gf(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Gf(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function J1(t){return Object.prototype.toString.call(t)==="[object Object]"}function YD(t){return J1(t)?Object.keys(t).reduce(function(e,n){const r=J1(t[n]),i=r?YD(t[n]):t[n],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[n]:i})},{}):t}function Tb(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Tb(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(i=>{Tb(t,t.get(i),n)})}))}function Y1(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&s.push(o)}),s.forEach(o=>{t.forEach(a=>{a.type===r&&a.trackId===o.id&&Tb(t,a,i)})}),i}const X1=JD;function XD(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const l={};return Object.keys(a).forEach(u=>{if(u==="require"||u==="advanced"||u==="mediaSource")return;const c=typeof a[u]=="object"?a[u]:{ideal:a[u]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const d=function(h,p){return h?h+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(c.ideal!==void 0){l.optional=l.optional||[];let h={};typeof c.ideal=="number"?(h[d("min",u)]=c.ideal,l.optional.push(h),h={},h[d("max",u)]=c.ideal,l.optional.push(h)):(h[d("",u)]=c.ideal,l.optional.push(h))}c.exact!==void 0&&typeof c.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[d("",u)]=c.exact):["min","max"].forEach(h=>{c[h]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[d(h,u)]=c[h])})}),a.advanced&&(l.optional=(l.optional||[]).concat(a.advanced)),l},i=function(a,l){if(e.version>=61)return l(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const u=function(c,d,h){d in c&&!(h in c)&&(c[h]=c[d],delete c[d])};a=JSON.parse(JSON.stringify(a)),u(a.audio,"autoGainControl","googAutoGainControl"),u(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let u=a.video.facingMode;u=u&&(typeof u=="object"?u:{ideal:u});const c=e.version<66;if(u&&(u.exact==="user"||u.exact==="environment"||u.ideal==="user"||u.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete a.video.facingMode;let d;if(u.exact==="environment"||u.ideal==="environment"?d=["back","rear"]:(u.exact==="user"||u.ideal==="user")&&(d=["front"]),d)return n.mediaDevices.enumerateDevices().then(h=>{h=h.filter(g=>g.kind==="videoinput");let p=h.find(g=>d.some(m=>g.label.toLowerCase().includes(m)));return!p&&h.length&&d.includes("back")&&(p=h[h.length-1]),p&&(a.video.deviceId=u.exact?{exact:p.deviceId}:{ideal:p.deviceId}),a.video=r(a.video),X1("chrome: "+JSON.stringify(a)),l(a)})}a.video=r(a.video)}return X1("chrome: "+JSON.stringify(a)),l(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,l,u){i(a,c=>{n.webkitGetUserMedia(c,l,d=>{u&&u(s(d))})})};if(n.getUserMedia=o.bind(n),n.mediaDevices.getUserMedia){const a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(l){return i(l,u=>a(u).then(c=>{if(u.audio&&!c.getAudioTracks().length||u.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(s(c))))}}}function ZD(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function eL(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):s={track:i.track};const o=new Event("track");o.track=i.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(i=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.id):s={track:i};const o=new Event("track");o.track=i,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Go(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function tL(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,l){let u=i.apply(this,arguments);return u||(u=e(this,a),this._senders.push(u)),u};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const l=this._senders.indexOf(a);l!==-1&&this._senders.splice(l,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(l=>l.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function nL(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(o=>o._pc=this),s});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>Y1(o,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=n.apply(this,[]);return i.forEach(s=>s._pc=this),i}),Go(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>Y1(s,i.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let i,s,o;return this.getSenders().forEach(a=>{a.track===r&&(i?o=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(s?o=!0:s=a),a.track===r)),o||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function rL(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(l)===-1&&this._shimmedLocalStreams[a.id].push(l):this._shimmedLocalStreams[a.id]=[a,l],l};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(u=>{if(this.getSenders().find(d=>d.track===u))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();n.apply(this,arguments);const l=this.getSenders().filter(u=>a.indexOf(u)===-1);this._shimmedLocalStreams[o.id]=[o].concat(l)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const i=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const l=this._shimmedLocalStreams[a].indexOf(o);l!==-1&&this._shimmedLocalStreams[a].splice(l,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function iL(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return rL(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const c=n.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(d=>this._reverseStreams[d.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(d=>{if(this.getSenders().find(p=>p.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const d=new t.MediaStream(c.getTracks());this._streams[c.id]=d,this._reverseStreams[d.id]=c,c=d}r.apply(this,[c])};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},t.RTCPeerConnection.prototype.addTrack=function(c,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(m=>m===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const g=this._streams[d.id];if(g)g.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([c]);this._streams[d.id]=m,this._reverseStreams[m.id]=d,this.addStream(m)}return this.getSenders().find(m=>m.track===c)};function s(u,c){let d=c.sdp;return Object.keys(u._reverseStreams||[]).forEach(h=>{const p=u._reverseStreams[h],g=u._streams[p.id];d=d.replace(new RegExp(g.id,"g"),p.id)}),new RTCSessionDescription({type:c.type,sdp:d})}function o(u,c){let d=c.sdp;return Object.keys(u._reverseStreams||[]).forEach(h=>{const p=u._reverseStreams[h],g=u._streams[p.id];d=d.replace(new RegExp(p.id,"g"),g.id)}),new RTCSessionDescription({type:c.type,sdp:d})}["createOffer","createAnswer"].forEach(function(u){const c=t.RTCPeerConnection.prototype[u],d={[u](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[g=>{const m=s(this,g);h[0].apply(null,[m])},g=>{h[1]&&h[1].apply(null,g)},arguments[2]]):c.apply(this,arguments).then(g=>s(this,g))}};t.RTCPeerConnection.prototype[u]=d[u]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const u=l.get.apply(this);return u.type===""?u:s(this,u)}}),t.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let h;Object.keys(this._streams).forEach(p=>{this._streams[p].getTracks().find(m=>c.track===m)&&(h=this._streams[p])}),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Sb(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],i={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=i[n]})}function sL(t,e){Go(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var Z1=Object.freeze({__proto__:null,fixNegotiationNeeded:sL,shimAddTrackRemoveTrack:iL,shimAddTrackRemoveTrackWithNative:rL,shimGetSendersWithDtmf:tL,shimGetUserMedia:XD,shimMediaStream:ZD,shimOnTrack:eL,shimPeerConnection:Sb,shimSenderReceiverGetStats:nL});function oL(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(i,s,o){gw("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(i).then(s,o)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const i=function(o,a,l){a in o&&!(l in o)&&(o[l]=o[a],delete o[a])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const a=o.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function pY(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function aL(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function _b(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=t.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=o[i]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return r.apply(this,[s||null]).then(l=>{if(e.version<53&&!o)try{l.forEach(u=>{u.type=n[u.type]||u.type})}catch(u){if(u.name!=="TypeError")throw u;l.forEach((c,d)=>{l.set(d,Object.assign({},c,{type:n[c.type]||c.type}))})}return l}).then(o,a)}}function lL(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const i=n.apply(this,arguments);return i._pc=this,i}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function uL(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Go(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function cL(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){gw("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function dL(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function fL(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function hL(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function pL(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function mL(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var eC=Object.freeze({__proto__:null,shimAddTransceiver:fL,shimCreateAnswer:mL,shimCreateOffer:pL,shimGetDisplayMedia:pY,shimGetParameters:hL,shimGetUserMedia:oL,shimOnTrack:aL,shimPeerConnection:_b,shimRTCDataChannel:dL,shimReceiverGetStats:uL,shimRemoveStream:cL,shimSenderGetStats:lL});function gL(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return s&&s.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function yL(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function vL(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(u,c){const d=arguments.length>=2?arguments[2]:arguments[0],h=n.apply(this,[d]);return c?(h.then(u,c),Promise.resolve()):h},e.createAnswer=function(u,c){const d=arguments.length>=2?arguments[2]:arguments[0],h=r.apply(this,[d]);return c?(h.then(u,c),Promise.resolve()):h};let a=function(l,u,c){const d=i.apply(this,[l]);return c?(d.then(u,c),Promise.resolve()):d};e.setLocalDescription=a,a=function(l,u,c){const d=s.apply(this,[l]);return c?(d.then(u,c),Promise.resolve()):d},e.setRemoteDescription=a,a=function(l,u,c){const d=o.apply(this,[l]);return c?(d.then(u,c),Promise.resolve()):d},e.addIceCandidate=a}function bL(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=i=>r(kL(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function kL(t){return t&&t.video!==void 0?Object.assign({},t,{video:YD(t.video)}):t}function wL(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let o=0;o<r.iceServers.length;o++){let a=r.iceServers[o];a.urls===void 0&&a.url?(gw("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(r.iceServers[o])}r.iceServers=s}return new e(r,i)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function TL(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function SL(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function _L(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var tC=Object.freeze({__proto__:null,shimAudioContext:_L,shimCallbacksAPI:vL,shimConstraints:kL,shimCreateOfferLegacy:SL,shimGetUserMedia:bL,shimLocalStreamsAPI:gL,shimRTCIceServerUrls:wL,shimRemoteStreamsAPI:yL,shimTrackEventTransceiver:TL}),iy={exports:{}},nC;function mY(){return nC||(nC=1,function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const i=n.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const s=n.type;return r.push("typ"),r.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const i=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let i;const s=n.substring(n.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)i=s[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(n){let r="",i=n.payloadType;if(n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(o=>{n.parameters[o]!==void 0?s.push(o+"="+n.parameters[o]):s.push(o)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",i=n.payloadType;return n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),i={ssrc:parseInt(n.substring(7,r),10)},s=n.indexOf(":",r);return s>-1?(i.attribute=n.substring(r+1,s),i.value=n.substring(s+1)):i.attribute=n.substring(r+1),i},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let i="a=setup:"+r+`\r
`;return n.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const i=e.matchPrefix(n+r,"a=ice-ufrag:")[0],s=e.matchPrefix(n+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");r.profile=s[2];for(let a=3;a<s.length;a++){const l=s[a],u=e.matchPrefix(n,"a=rtpmap:"+l+" ")[0];if(u){const c=e.parseRtpMap(u),d=e.matchPrefix(n,"a=fmtp:"+l+" ");switch(c.parameters=d.length?e.parseFmtp(d[0]):{},c.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(c.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{o.forEach(l=>{a.rtcpFeedback.find(c=>c.type===l.type&&c.parameter===l.parameter)||a.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(n,r){let i="";i+="m="+n+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let s=0;return r.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(n){const r=[],i=e.parseRtpParameters(n),s=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(n,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),l=a.length>0&&a[0].ssrc;let u;const c=e.matchPrefix(n,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(g=>parseInt(g,10)));c.length>0&&c[0].length>1&&c[0][0]===l&&(u=c[0][1]),i.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let p={ssrc:l,codecPayloadType:parseInt(h.parameters.apt,10)};l&&u&&(p.rtx={ssrc:u}),r.push(p),s&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:l,mechanism:o?"red+ulpfec":"red"},r.push(p))}}),r.length===0&&l&&r.push({ssrc:l});let d=e.matchPrefix(n,"b=");return d.length&&(d[0].indexOf("b=TIAS:")===0?d=parseInt(d[0].substring(7),10):d[0].indexOf("b=AS:")===0?d=parseInt(d[0].substring(5),10)*1e3*.95-50*40*8:d=void 0,r.forEach(h=>{h.maxBitrate=d})),r},e.parseRtcpParameters=function(n){const r={},i=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const o=e.matchPrefix(n,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const i=e.matchPrefix(n,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),i=e.matchPrefix(n,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const o=e.matchPrefix(n,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const a=e.matchPrefix(n,"a=sctpmap:");if(a.length>0){const l=a[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,r){let i=[];return n.protocol!=="DTLS/SCTP"?i=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,i){let s;const o=r!==void 0?r:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const i=e.splitLines(n);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const i=e.splitLines(n)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(n){const i=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},t.exports=e}(iy)),iy.exports}var EL=mY(),$a=iY(EL),gY=CQ({__proto__:null,default:$a},[EL]);function Qf(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=$a.parseCandidate(r.candidate);for(const o in s)o in i||Object.defineProperty(i,o,{value:s[o]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,Go(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Eb(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Go(t,"icecandidate",e=>{if(e.candidate){const n=$a.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Jf(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(a){if(!a||!a.sdp)return!1;const l=$a.splitSections(a.sdp);return l.shift(),l.some(u=>{const c=$a.parseMLine(u);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},r=function(a){const l=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const u=parseInt(l[1],10);return u!==u?-1:u},i=function(a){let l=65536;return e.browser==="firefox"&&(e.version<57?a===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},s=function(a,l){let u=65536;e.browser==="firefox"&&e.version===57&&(u=65535);const c=$a.matchPrefix(a.sdp,"a=max-message-size:");return c.length>0?u=parseInt(c[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(u=2147483637),u},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const l=r(arguments[0]),u=i(l),c=s(arguments[0],l);let d;u===0&&c===0?d=Number.POSITIVE_INFINITY:u===0||c===0?d=Math.max(u,c):d=Math.min(u,c);const h={};Object.defineProperty(h,"maxMessageSize",{get(){return d}}),this._sctp=h}return o.apply(this,arguments)}}function Yf(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const a=arguments[0],l=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const i=n.apply(this,arguments);return e(i,this),i},Go(t,"datachannel",r=>(e(r.channel,r.target),r))}function Cb(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",i);s.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function xb(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&i instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return n.apply(this,arguments)}}function Xf(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Zf(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return n.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?n.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>n.apply(this,[o]))})}var yY=Object.freeze({__proto__:null,removeExtmapAllowMixed:xb,shimAddIceCandidateNullOrEmpty:Xf,shimConnectionState:Cb,shimMaxMessageSize:Jf,shimParameterlessSetLocalDescription:Zf,shimRTCIceCandidate:Qf,shimRTCIceCandidateRelayProtocol:Eb,shimSendThrowTypeError:Yf});function vY(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=JD,r=hY(t),i={browserDetails:r,commonShim:yY,extractVersion:Gf,disableLog:dY,disableWarnings:fY,sdp:gY};switch(r.browser){case"chrome":if(!Z1||!Sb||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Z1,Xf(t,r),Zf(t),XD(t,r),ZD(t),Sb(t,r),eL(t),iL(t,r),tL(t),nL(t),sL(t,r),Qf(t),Eb(t),Cb(t),Jf(t,r),Yf(t),xb(t,r);break;case"firefox":if(!eC||!_b||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=eC,Xf(t,r),Zf(t),oL(t,r),_b(t,r),aL(t),cL(t),lL(t),uL(t),dL(t),fL(t),hL(t),pL(t),mL(t),Qf(t),Cb(t),Jf(t,r),Yf(t);break;case"safari":if(!tC||!e.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=tC,Xf(t,r),Zf(t),wL(t),SL(t),vL(t),gL(t),yL(t),TL(t),bL(t),_L(t),Qf(t),Eb(t),Jf(t,r),Yf(t),xb(t,r);break;default:n("Unsupported browser!");break}return i}vY({window:typeof window>"u"?void 0:window});const bY=10,uf="lk_e2ee",kY="LKFrameEncryptionKey",wY={sharedKey:!1,ratchetSalt:kY,ratchetWindowSize:8,failureTolerance:bY,keyringSize:16};var As;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(As||(As={}));var rC;(function(t){t.KeyRatcheted="keyRatcheted"})(rC||(rC={}));var vs;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(vs||(vs={}));var iC;(function(t){t.Error="cryptorError"})(iC||(iC={}));function TY(){return SY()||Ib()}function Ib(){return typeof window.RTCRtpScriptTransform<"u"}function SY(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class Mie extends ci.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r)=>{Ee.debug("key ratcheted event received",{material:n,keyIndex:r})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},wY),e),this.on(As.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const i={key:e,participantIdentity:n,keyIndex:r};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),i),this.emit(As.SetKey,i)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(As.RatchetRequest,e,n)}}class Qo extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}var Oe;(function(t){t[t.NotAllowed=0]="NotAllowed",t[t.ServerUnreachable=1]="ServerUnreachable",t[t.InternalError=2]="InternalError",t[t.Cancelled=3]="Cancelled",t[t.LeaveRequest=4]="LeaveRequest"})(Oe||(Oe={}));class He extends Qo{constructor(e,n,r,i){super(1,e),this.status=r,this.reason=n,this.context=i}}class yw extends Qo{constructor(e){super(21,e??"device is unsupported")}}class ki extends Qo{constructor(e){super(20,e??"track is invalid")}}class _Y extends Qo{constructor(e){super(10,e??"unsupported server")}}class Et extends Qo{constructor(e){super(12,e??"unexpected connection state")}}class Pb extends Qo{constructor(e){super(13,e??"unable to negotiate")}}class sC extends Qo{constructor(e,n){super(15,e),this.reason=n}}var Nc;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(Nc||(Nc={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(Nc||(Nc={}));var oC;(function(t){t[t.InvalidKey=0]="InvalidKey",t[t.MissingKey=1]="MissingKey",t[t.InternalError=2]="InternalError"})(oC||(oC={}));var V;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.ParticipantAttributesChanged="participantAttributesChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged",t.ChatMessage="chatMessage",t.LocalTrackSubscribed="localTrackSubscribed",t.MetricsReceived="metricsReceived"})(V||(V={}));var B;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded",t.AttributesChanged="attributesChanged",t.LocalTrackSubscribed="localTrackSubscribed",t.ChatMessage="chatMessage"})(B||(B={}));var ne;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackSubscribed="localTrackSubscribed",t.Offline="offline",t.SignalRequestResponse="signalRequestResponse"})(ne||(ne={}));var ee;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed",t.TrackProcessorUpdate="trackProcessorUpdate",t.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",t.TranscriptionReceived="transcriptionReceived",t.TimeSyncUpdate="timeSyncUpdate"})(ee||(ee={}));function vw(t,e,n){var r,i,s;e===void 0&&(e=50),n===void 0&&(n={});var o=(r=n.isImmediate)!=null&&r,a=(i=n.callback)!=null&&i,l=n.maxWait,u=Date.now(),c=[];function d(){if(l!==void 0){var p=Date.now()-u;if(p+e>=l)return l-p}return e}var h=function(){var p=[].slice.call(arguments),g=this;return new Promise(function(m,k){var y=o&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,u=Date.now(),!o){var T=t.apply(g,p);a&&a(T),c.forEach(function(x){return(0,x.resolve)(T)}),c=[]}},d()),y){var w=t.apply(g,p);return a&&a(w),m(w)}c.push({resolve:m,reject:k})})};return h.cancel=function(p){s!==void 0&&clearTimeout(s),c.forEach(function(g){return(0,g.reject)(p)}),c=[]},h}const EY=/version\/(\d+(\.?_?\d+)+)/i;let sy;function li(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(sy===void 0||e){const r=CY.find(i=>{let{test:s}=i;return s.test(n)});sy=r==null?void 0:r.describe(n)}return sy}const CY=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:eh(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:oy(t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:eh(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0,osVersion:oy(t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:eh(EY,t),os:t.includes("mobile/")?"iOS":"macOS",osVersion:oy(t)}}}];function eh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}function oy(t){return t.includes("mac os")?eh(/\(.+?(\d+_\d+(:?_\d+)?)/,t,1).replace(/_/g,"."):void 0}var xY="2.8.0";const IY=xY,PY=15;class Vt{}Vt.setTimeout=function(){return setTimeout(...arguments)};Vt.setInterval=function(){return setInterval(...arguments)};Vt.clearTimeout=function(){return clearTimeout(...arguments)};Vt.clearInterval=function(){return clearInterval(...arguments)};class Be{constructor(e,n,r,i,s){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&r!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:r,maxFramerate:i,priority:s};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const RY=["vp8","h264"],AY=["vp8","h264","vp9","av1"];function NY(t){return!!RY.find(e=>e===t)}var Rb;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:24e3},t.music={maxBitrate:48e3},t.musicStereo={maxBitrate:64e3},t.musicHighQuality={maxBitrate:96e3},t.musicHighQualityStereo={maxBitrate:128e3}})(Rb||(Rb={}));const Oc={h90:new Be(160,90,9e4,20),h180:new Be(320,180,16e4,20),h216:new Be(384,216,18e4,20),h360:new Be(640,360,45e4,20),h540:new Be(960,540,8e5,25),h720:new Be(1280,720,17e5,30),h1080:new Be(1920,1080,3e6,30),h1440:new Be(2560,1440,5e6,30),h2160:new Be(3840,2160,8e6,30)},Ab={h120:new Be(160,120,7e4,20),h180:new Be(240,180,125e3,20),h240:new Be(320,240,14e4,20),h360:new Be(480,360,33e4,20),h480:new Be(640,480,5e5,20),h540:new Be(720,540,6e5,25),h720:new Be(960,720,13e5,30),h1080:new Be(1440,1080,23e5,30),h1440:new Be(1920,1440,38e5,30)},bw={h360fps3:new Be(640,360,2e5,3,"medium"),h360fps15:new Be(640,360,4e5,15,"medium"),h720fps5:new Be(1280,720,8e5,5,"medium"),h720fps15:new Be(1280,720,15e5,15,"medium"),h720fps30:new Be(1280,720,2e6,30,"medium"),h1080fps15:new Be(1920,1080,25e5,15,"medium"),h1080fps30:new Be(1920,1080,5e6,30,"medium"),original:new Be(0,0,7e6,30,"medium")};function OY(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const DY=5e3,fu=[];var or;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH"})(or||(or={}));class $ extends ci.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=$.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Ee,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),DY):this.handleAppVisibilityChanged()},this.log=ji((i=r.loggerName)!==null&&i!==void 0?i:Or.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=$.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),qe(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===$.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===$.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(fu.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&fu.splice(fu.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Ia(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),i=r.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(i?ee.AudioPlaybackStarted:ee.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(i?ee.AudioPlaybackFailed:ee.VideoPlaybackFailed,s):s.name==="AbortError"?Ee.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):Ee.warn("could not playback ".concat(i?"audio":"video"),s),i&&e&&r.some(o=>o.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ee.ElementAttached,e),e}detach(e){try{if(e){za(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ee.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{za(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(ee.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=ji(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),fu.forEach(r=>{r.parentElement||(n=!1)}),n&&fu.push(e)}}handleAppVisibilityChanged(){return F(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===$.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Sn()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Sn()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Ia(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(i=>{n.removeTrack(i)}),n.addTrack(t)),(!Bs()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Bs()||fl())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function za(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(u){u.Audio="audio",u.Video="video",u.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(u){u.Camera="camera",u.Microphone="microphone",u.ScreenShare="screen_share",u.ScreenShareAudio="screen_share_audio",u.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(u){u.Active="active",u.Paused="paused",u.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function i(u){switch(u){case e.Audio:return Sr.AUDIO;case e.Video:return Sr.VIDEO;default:return Sr.DATA}}t.kindToProto=i;function s(u){switch(u){case Sr.AUDIO:return e.Audio;case Sr.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=s;function o(u){switch(u){case n.Camera:return Yt.CAMERA;case n.Microphone:return Yt.MICROPHONE;case n.ScreenShare:return Yt.SCREEN_SHARE;case n.ScreenShareAudio:return Yt.SCREEN_SHARE_AUDIO;default:return Yt.UNKNOWN}}t.sourceToProto=o;function a(u){switch(u){case Yt.CAMERA:return n.Camera;case Yt.MICROPHONE:return n.Microphone;case Yt.SCREEN_SHARE:return n.ScreenShare;case Yt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=a;function l(u){switch(u){case vb.ACTIVE:return r.Active;case vb.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=l})($);function CL(t,e,n){var r,i,s,o,a;const{optionsWithoutProcessor:l,audioProcessor:u,videoProcessor:c}=kw(t??{}),d=(r=OY(l))!==null&&r!==void 0?r:{};return d.audio===!0&&(d.audio={}),d.video===!0&&(d.video={}),d.audio&&(Nb(d.audio,e),(i=(o=d.audio).deviceId)!==null&&i!==void 0||(o.deviceId="default"),u&&(d.audio.processor=u)),d.video&&(Nb(d.video,n),(s=(a=d.video).deviceId)!==null&&s!==void 0||(a.deviceId="default"),c&&(d.video.processor=c)),d}function Nb(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function wm(t){var e,n,r,i;const s={};if(t.video)if(typeof t.video=="object"){const o={},a=o,l=t.video;Object.keys(l).forEach(u=>{switch(u){case"resolution":Nb(a,l.resolution);break;default:a[u]=l[u]}}),s.video=o,(e=(r=s.video).deviceId)!==null&&e!==void 0||(r.deviceId="default")}else s.video=t.video?{deviceId:"default"}:!1;else s.video=!1;return t.audio?typeof t.audio=="object"?(s.audio=t.audio,(n=(i=s.audio).deviceId)!==null&&n!==void 0||(i.deviceId="default")):s.audio={deviceId:"default"}:s.audio=!1,s}function LY(t){return F(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=xL();if(r){const i=r.createAnalyser();i.fftSize=2048;const s=i.frequencyBinCount,o=new Uint8Array(s);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield Rr(n),i.getByteTimeDomainData(o);const l=o.some(u=>u!==128&&u!==0);return r.close(),!l}return!1}()})}function xL(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function aC(t){return t===$.Source.Microphone?"audioinput":t===$.Source.Camera?"videoinput":void 0}function MY(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Bs()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio,preferCurrentTab:t.preferCurrentTab}}function th(t){return t.split("/")[1].toLowerCase()}function UY(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new pw({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function qe(t){return t instanceof $?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?qe(t.track):{})}}function FY(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function jY(t,e){var n;t===void 0&&(t={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(t)],i={};for(const s of r)t[s]!==e[s]&&(i[s]=(n=e[s])!==null&&n!==void 0?n:"");return i}function kw(t){const e=Object.assign({},t);let n,r;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:r,optionsWithoutProcessor:e}}const VY="|",lC="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function BY(t){const e=t.split(VY);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function Rr(t){return F(this,void 0,void 0,function*(){return new Promise(e=>Vt.setTimeout(e,t))})}function Ob(){return"addTransceiver"in RTCPeerConnection.prototype}function Db(){return"addTrack"in RTCPeerConnection.prototype}function $Y(){if(!("getCapabilities"in RTCRtpSender)||Bs())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function zY(){if(!("getCapabilities"in RTCRtpSender)||fl())return!1;if(Bs()){const n=li();if(n!=null&&n.version&&Fo(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Ku(t){return t==="av1"||t==="vp9"}function Lb(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}function qY(){return typeof RTCPeerConnection>"u"?!1:Ob()||Db()}function fl(){var t;return((t=li())===null||t===void 0?void 0:t.name)==="Firefox"}function Bs(){var t;return((t=li())===null||t===void 0?void 0:t.name)==="Safari"}function HY(){const t=li();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function IL(){var t,e;return Sn()?(e=(t=navigator.userAgentData)===null||t===void 0?void 0:t.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function WY(){const t=li(),e="17.2";if(t)return t.name!=="Safari"&&t.os!=="iOS"||t.os==="iOS"&&t.osVersion&&Fo(e,t.osVersion)>=0?!0:t.name==="Safari"&&Fo(e,t.version)>=0}function Sn(){return typeof document<"u"}function Vi(){return navigator.product=="ReactNative"}function Mb(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function PL(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function RL(){if(!Vi())return;let t=PL();if(t)return t.platform}function uC(){if(Sn())return window.devicePixelRatio;if(Vi()){let t=PL();if(t)return t.devicePixelRatio}return 1}function Fo(t,e){const n=t.split("."),r=e.split("."),i=Math.min(n.length,r.length);for(let s=0;s<i;++s){const o=parseInt(n[s],10),a=parseInt(r[s],10);if(o>a)return 1;if(o<a)return-1;if(s===i-1&&o===a)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function KY(t){for(const e of t)e.target.handleResize(e)}function GY(t){for(const e of t)e.target.handleVisibilityChanged(e)}let ay=null;const cC=()=>(ay||(ay=new ResizeObserver(KY)),ay);let ly=null;const dC=()=>(ly||(ly=new IntersectionObserver(GY,{root:null,rootMargin:"0px"})),ly);function QY(){var t;const e=new PJ({sdk:DD.JS,protocol:PY,version:IY});return Vi()&&(e.os=(t=RL())!==null&&t!==void 0?t:""),e}function fC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=document.createElement("canvas");i.width=t,i.height=e;const s=i.getContext("2d");s==null||s.fillRect(0,0,i.width,i.height),r&&s&&(s.beginPath(),s.arc(t/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const o=i.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}let hu;function uy(){if(!hu){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[hu]=r.stream.getAudioTracks(),!hu)throw Error("Could not get empty media stream audio track");hu.enabled=!1}return hu.clone()}class AL{constructor(e,n){this.onFinally=n,this.promise=new Promise((r,i)=>F(this,void 0,void 0,function*(){this.resolve=r,this.reject=i,e&&(yield e(r,i))})).finally(()=>{var r;return(r=this.onFinally)===null||r===void 0?void 0:r.call(this)})}}function JY(t){return AY.includes(t)}function So(t){if(typeof t=="string"||typeof t=="number")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function YY(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function hC(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}function XY(t,e){return t.segments.map(n=>{let{id:r,text:i,language:s,startTime:o,endTime:a,final:l}=n;var u;const c=(u=e.get(r))!==null&&u!==void 0?u:Date.now(),d=Date.now();return l?e.delete(r):e.set(r,c),{id:r,text:i,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(a.toString()),final:l,language:s,firstReceivedTime:c,lastReceivedTime:d}})}function ZY(t){const{id:e,timestamp:n,message:r,editTimestamp:i}=t;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:i?Number.parseInt(i.toString()):void 0,message:r}}function pC(t){switch(t.reason){case Oe.LeaveRequest:return t.context;case Oe.Cancelled:return Cr.CLIENT_INITIATED;case Oe.NotAllowed:return Cr.USER_REJECTED;case Oe.ServerUnreachable:return Cr.JOIN_FAILURE;default:return Cr.UNKNOWN_REASON}}const cy="default";class Nt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new Nt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return F(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;if(((s=Nt.userMediaPromiseMap)===null||s===void 0?void 0:s.size)>0){Ee.debug("awaiting getUserMedia promise");try{n?yield Nt.userMediaPromiseMap.get(n):yield Promise.all(Nt.userMediaPromiseMap.values())}catch{Ee.warn("error waiting for media permissons")}}let o=yield navigator.mediaDevices.enumerateDevices();if(i&&!(Bs()&&r.hasDeviceInUse(n))&&(o.filter(l=>l.kind===n).length===0||o.some(l=>{const u=l.label==="",c=n?l.kind===n:!0;return u&&c}))){const l={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:"default"}},u=yield navigator.mediaDevices.getUserMedia(l);o=yield navigator.mediaDevices.enumerateDevices(),u.getTracks().forEach(c=>{c.stop()})}return r._previousDevices=o,n&&(o=o.filter(a=>a.kind===n)),o}()})}normalizeDeviceId(e,n,r){return F(this,void 0,void 0,function*(){if(n!==cy)return n;const i=yield this.getDevices(e),s=i.find(a=>a.deviceId===cy);if(!s){Ee.warn("could not reliably determine default device");return}const o=i.find(a=>a.deviceId!==cy&&a.groupId===(r??s.groupId));if(!o){Ee.warn("could not reliably determine default device");return}return o==null?void 0:o.deviceId})}hasDeviceInUse(e){return e?Nt.userMediaPromiseMap.has(e):Nt.userMediaPromiseMap.size>0}}Nt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Nt.userMediaPromiseMap=new Map;const eX=1e3;class _o extends ${get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(e,n,s),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=vw(()=>F(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>F(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ee.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new Tn,this.pauseUpstreamLock=new Tn,this.processorLock=new Tn,this.restartLock=new Tn,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==$.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return F(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(i=>{za(this._mediaStreamTrack,i)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let r;if(this.processor&&e){const i=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Ia(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),r=this.processor.processedTrack}finally{i()}}this.sender&&(yield this.sender.replaceTrack(r??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(i=>{Ia(r??e,i)}))})}waitForDimensions(){return F(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eX;return function*(){var r;if(e.kind===$.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=li())===null||r===void 0?void 0:r.os)==="iOS"&&(yield Rr(10));const i=Date.now();for(;Date.now()-i<n;){const s=e.dimensions;if(s)return s;yield Rr(50)}throw new ki("unable to get track dimensions after timeout")}()})}setDeviceId(e){return F(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===So(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),So(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return F(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===$.Source.ScreenShare)return;const{deviceId:r,groupId:i}=e._mediaStreamTrack.getSettings(),s=e.kind===$.Kind.Audio?"audioinput":"videoinput";return n?Nt.getInstance().normalizeDeviceId(s,r,i):r}()})}mute(){return F(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return F(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return F(this,void 0,void 0,function*(){if(!this.sender)throw new ki("unable to replace an unpublished track");let r,i;return typeof n=="boolean"?r=n:n!==void 0&&(r=n.userProvidedTrack,i=n.stopProcessor),this.providedByUser=r??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return F(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.restartLock.lock();try{e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const r={audio:!1,video:!1};this.kind===$.Kind.Video?r.video=e:r.audio=e,this.attachedElements.forEach(o=>{za(this.mediaStreamTrack,o)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const s=(yield navigator.mediaDevices.getUserMedia(r)).getTracks()[0];return s.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(s),this._constraints=e,this.emit(ee.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ee.Muted:ee.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),IL()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return F(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ee.UpstreamPaused,this);const n=li();if((n==null?void 0:n.name)==="Safari"&&Fo(n.version,"12.0")<0)throw new yw("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return F(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ee.UpstreamResumed,this),yield this.sender.replaceTrack(this.mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){return F(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return F(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var s;const o=yield r.processorLock.lock();try{r.log.debug("setting up processor",r.logContext);const a=document.createElement(r.kind),l={kind:r.kind,track:r._mediaStreamTrack,element:a,audioContext:r.audioContext};if(yield n.init(l),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.stopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Ia(r._mediaStreamTrack,a),a.muted=!0,a.play().catch(u=>r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:u}))),r.processor=n,r.processorElement=a,r.processor.processedTrack){for(const u of r.attachedElements)u!==r.processorElement&&i&&(za(r._mediaStreamTrack,u),Ia(r.processor.processedTrack,u));yield(s=r.sender)===null||s===void 0?void 0:s.replaceTrack(r.processor.processedTrack)}r.emit(ee.TrackProcessorUpdate,r.processor)}finally{o()}}()})}getProcessor(){return this.processor}stopProcessor(){return F(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,i;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,n||((i=e.processorElement)===null||i===void 0||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(ee.TrackProcessorUpdate))}()})}}class tX extends ci.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,i;const{kind:s,data:o}=n.data;switch(s){case"error":Ee.error(o.error.message),this.emit(vs.EncryptionError,o.error);break;case"initAck":o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)});break;case"enable":if(o.enabled&&this.keyProvider.getKeys().forEach(a=>{this.postKey(a)}),this.encryptionEnabled!==o.enabled&&o.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(vs.ParticipantEncryptionStatusChanged,o.enabled,this.room.localParticipant),this.encryptionEnabled=o.enabled;else if(o.participantIdentity){const a=(i=this.room)===null||i===void 0?void 0:i.getParticipantByIdentity(o.participantIdentity);if(!a)throw TypeError("couldn't set encryption status, participant not found".concat(o.participantIdentity));this.emit(vs.ParticipantEncryptionStatusChanged,o.enabled,a)}break;case"ratchetKey":this.keyProvider.emit(As.KeyRatcheted,o.material,o.keyIndex);break}},this.onWorkerError=n=>{Ee.error("e2ee worker encountered an error:",{error:n.error}),this.emit(vs.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!TY())throw new yw("tried to setup end-to-end encryption on an unsupported browser");if(Ee.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:aY.getLevel()}};this.worker&&(Ee.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Ee.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Ee.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ne.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(V.TrackPublished,(r,i)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Vn.NONE,i.identity)),e.on(V.ConnectionStateChanged,r=>{r===Ie.Connected&&e.remoteParticipants.forEach(i=>{i.trackPublications.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==Vn.NONE,i.identity)})})}).on(V.TrackUnsubscribed,(r,i,s)=>{var o;const a={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:r.mediaStreamID}};(o=this.worker)===null||o===void 0||o.postMessage(a)}).on(V.TrackSubscribed,(r,i,s)=>{this.setupE2EEReceiver(r,s.identity,i.trackInfo)}).on(V.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(B.LocalTrackPublished,r=>F(this,void 0,void 0,function*(){this.setupE2EESender(r.track,r.track.sender)})),n.on(As.SetKey,r=>this.postKey(r)).on(As.RatchetRequest,(r,i)=>this.postRatchetRequest(r,i))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:i}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:n,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!(r!=null&&r.mimeType)||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?th(r.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof _o)||!n){n||Ee.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,i){return F(this,void 0,void 0,function*(){if(this.worker){if(Ib()){const s={kind:"decode",participantIdentity:r,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(uf in e&&i){const l={kind:"updateCodec",data:{trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(l);return}let s=e.writableStream,o=e.readableStream;if(!s||!o){const l=e.createEncodedStreams();e.writableStream=l.writable,s=l.writable,e.readableStream=l.readable,o=l.readable}const a={kind:"decode",data:{readableStream:o,writableStream:s,trackId:n,codec:i,participantIdentity:r}};this.worker.postMessage(a,[o,s])}e[uf]=!0}})}handleSender(e,n,r){var i;if(!(uf in e||!this.worker)){if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Ib()){Ee.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{Ee.info("initialize encoded streams");const s=e.createEncodedStreams(),o={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o,[s.readable,s.writable])}e[uf]=!0}}}var Gu;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Gu||(Gu={}));class nX{constructor(){this.pendingTasks=new Map,this.taskMutex=new Tn,this.nextTaskIndex=0}run(e){return F(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Gu.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Gu.RUNNING,yield e()}finally{n.status=Gu.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return F(this,void 0,void 0,function*(){return this.run(()=>F(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const rX=["syncState","trickle","offer","answer","simulate","leave"];function iX(t){const e=rX.indexOf(t.case)>=0;return Ee.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var nt;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(nt||(nt={}));class ww{get currentState(){return this.state}get isDisconnected(){return this.state===nt.DISCONNECTING||this.state===nt.DISCONNECTED}get isEstablishingConnection(){return this.state===nt.CONNECTING||this.state===nt.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=nt.DISCONNECTED,this.log=Ee,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=ji((r=n.loggerName)!==null&&r!==void 0?r:Or.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new nX,this.queuedRequests=[],this.closingLock=new Tn,this.connectionLock=new Tn,this.state=nt.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,i){return F(this,void 0,void 0,function*(){return this.state=nt.CONNECTING,this.options=r,yield this.connect(e,n,r,i)})}reconnect(e,n,r,i){return F(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=nt.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:i}))})}connect(e,n,r,i){this.connectOptions=r,e=YY(e),e=e.replace(/\/$/,""),e+="/rtc";const s=QY(),o=sX(n,s,r);return new Promise((a,l)=>F(this,void 0,void 0,function*(){const u=yield this.connectionLock.lock();try{const c=()=>F(this,void 0,void 0,function*(){this.close(),clearTimeout(d),l(new He("room connection has been cancelled (signal)",Oe.Cancelled))}),d=setTimeout(()=>{this.close(),l(new He("room connection has timed out (signal)",Oe.ServerUnreachable))},r.websocketTimeout);i!=null&&i.aborted&&c(),i==null||i.addEventListener("abort",c),this.log.debug("connecting to ".concat(e+o),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(d)},this.ws.onerror=h=>F(this,void 0,void 0,function*(){if(this.state!==nt.CONNECTED){this.state=nt.DISCONNECTED,clearTimeout(d);try{const p=yield fetch("http".concat(e.substring(2),"/validate").concat(o));if(p.status.toFixed(0).startsWith("4")){const g=yield p.text();l(new He(g,Oe.NotAllowed,p.status))}else l(new He("Internal error",Oe.InternalError,p.status))}catch{l(new He("server was not reachable",Oe.ServerUnreachable))}return}this.handleWSError(h)}),this.ws.onmessage=h=>F(this,void 0,void 0,function*(){var p,g,m;let k;if(typeof h.data=="string"){const y=JSON.parse(h.data);k=W1.fromJson(y,{ignoreUnknownFields:!0})}else if(h.data instanceof ArrayBuffer)k=W1.fromBinary(new Uint8Array(h.data));else{this.log.error("could not decode websocket message: ".concat(typeof h.data),this.logContext);return}if(this.state!==nt.CONNECTED){let y=!1;if(((p=k.message)===null||p===void 0?void 0:p.case)==="join"?(this.state=nt.CONNECTED,i==null||i.removeEventListener("abort",c),this.pingTimeoutDuration=k.message.value.pingTimeout,this.pingIntervalDuration=k.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),a(k.message.value)):this.state===nt.RECONNECTING&&k.message.case!=="leave"?(this.state=nt.CONNECTED,i==null||i.removeEventListener("abort",c),this.startPingInterval(),((g=k.message)===null||g===void 0?void 0:g.case)==="reconnect"?a(k.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),a(void 0),y=!0)):this.isEstablishingConnection&&k.message.case==="leave"?l(new He("Received leave request while trying to (re)connect",Oe.LeaveRequest,void 0,k.message.value.reason)):r.reconnect||l(new He("did not receive join response, got ".concat((m=k.message)===null||m===void 0?void 0:m.case," instead"),Oe.InternalError)),!y)return}this.signalLatency&&(yield Rr(this.signalLatency)),this.handleSignalResponse(k)}),this.ws.onclose=h=>{this.isEstablishingConnection&&l(new He("Websocket got closed during a (re)connection attempt",Oe.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:h.reason,code:h.code,wasClean:h.wasClean,state:this.state})),this.handleOnClose(h.reason)}}finally{u()}}))}close(){return F(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=nt.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const i=new Promise(s=>{e.ws?e.ws.onclose=()=>{s()}:s()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([i,Rr(250)])),e.ws=void 0}}finally{n&&(e.state=nt.DISCONNECTED),r()}}()})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:rp(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:rp(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new fw({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new hw({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return F(this,arguments,void 0,function(r,i){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const a=s.getNextRequestId();return yield s.sendRequest({case:"updateMetadata",value:new VD({requestId:a,metadata:r,name:i,attributes:o})}),a}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new jD({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new zD({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:st.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new WD({timestamp:st.parse(Date.now()),rtt:st.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new FD({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new bm({reason:Cr.CLIENT_INITIATED,action:Ba.DISCONNECT})})}sendRequest(e){return F(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!i&&!iX(n)&&r.state===nt.RECONNECTING){r.queuedRequests.push(()=>F(r,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(i||(yield r.requestQueue.flush()),r.signalLatency&&(yield Rr(r.signalLatency)),!r.ws||r.ws.readyState!==r.ws.OPEN){r.log.error("cannot send signal request before connected, type: ".concat(n==null?void 0:n.case),r.logContext);return}const o=new UJ({message:n});try{r.useJSON?r.ws.send(o.toJsonString()):r.ws.send(o.toBinary())}catch(a){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:a}))}}()})}handleSignalResponse(e){var n,r;const i=e.message;if(i==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(i.case==="answer"){const o=mC(i.value);this.onAnswer&&this.onAnswer(o)}else if(i.case==="offer"){const o=mC(i.value);this.onOffer&&this.onOffer(o)}else if(i.case==="trickle"){const o=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(o,i.value.target)}else i.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=i.value.participants)!==null&&n!==void 0?n:[]):i.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):i.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=i.value.speakers)!==null&&r!==void 0?r:[]):i.case==="leave"?this.onLeave&&this.onLeave(i.value):i.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):i.case==="roomUpdate"?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):i.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(i.value):i.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):i.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):i.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):i.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(i.value):i.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):i.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(i.value):i.case==="pong"||(i.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):i.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(i.value):i.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return F(this,void 0,void 0,function*(){if(this.state===nt.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Vt.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Vt.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Vt.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Vt.clearInterval(this.pingInterval)}}function mC(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function rp(t){return new Uo({sdp:t.sdp,type:t.type})}function sX(t,e,n){var r;const i=new URLSearchParams;return i.set("access_token",t),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk",Vi()?"reactnative":"js"),i.set("version",e.version),i.set("protocol",e.protocol.toString()),e.deviceModel&&i.set("device_model",e.deviceModel),e.os&&i.set("os",e.os),e.osVersion&&i.set("os_version",e.osVersion),e.browser&&i.set("browser",e.browser),e.browserVersion&&i.set("browser_version",e.browserVersion),n.adaptiveStream&&i.set("adaptive_stream","1"),n.reconnectReason&&i.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var yr={},dy={},fy={exports:{}},gC;function Tw(){if(gC)return fy.exports;gC=1;var t=fy.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(t).forEach(function(e){var n=t[e];n.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),fy.exports}var yC;function oX(){return yC||(yC=1,function(t){var e=function(a){return String(Number(a))===a?Number(a):a},n=function(a,l,u,c){if(c&&!u)l[c]=e(a[1]);else for(var d=0;d<u.length;d+=1)a[d+1]!=null&&(l[u[d]]=e(a[d+1]))},r=function(a,l,u){var c=a.name&&a.names;a.push&&!l[a.push]?l[a.push]=[]:c&&!l[a.name]&&(l[a.name]={});var d=a.push?{}:c?l[a.name]:l;n(u.match(a.reg),d,a.names,a.name),a.push&&l[a.push].push(d)},i=Tw(),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var l={},u=[],c=l;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(d){var h=d[0],p=d.slice(2);h==="m"&&(u.push({rtp:[],fmtp:[]}),c=u[u.length-1]);for(var g=0;g<(i[h]||[]).length;g+=1){var m=i[h][g];if(m.reg.test(p))return r(m,c,p)}}),l.media=u,l};var o=function(a,l){var u=l.split(/=(.+)/,2);return u.length===2?a[u[0]]=e(u[1]):u.length===1&&l.length>1&&(a[u[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var l=[],u=a.split(" ").map(e),c=0;c<u.length;c+=3)l.push({component:u[c],ip:u[c+1],port:u[c+2]});return l},t.parseImageAttributes=function(a){return a.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(l){return l.split(",").map(function(u){var c,d=!1;return u[0]!=="~"?c=e(u):(c=e(u.substring(1,u.length)),d=!0),{scid:c,paused:d}})})}}(dy)),dy}var hy,vC;function aX(){if(vC)return hy;vC=1;var t=Tw(),e=/%[sdv%]/g,n=function(o){var a=1,l=arguments,u=l.length;return o.replace(e,function(c){if(a>=u)return c;var d=l[a];switch(a+=1,c){case"%%":return"%";case"%s":return String(d);case"%d":return Number(d);case"%v":return""}})},r=function(o,a,l){var u=a.format instanceof Function?a.format(a.push?l:l[a.name]):a.format,c=[o+"="+u];if(a.names)for(var d=0;d<a.names.length;d+=1){var h=a.names[d];a.name?c.push(l[a.name][h]):c.push(l[a.names[d]])}else c.push(l[a.name]);return n.apply(null,c)},i=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];return hy=function(o,a){a=a||{},o.version==null&&(o.version=0),o.name==null&&(o.name=" "),o.media.forEach(function(d){d.payloads==null&&(d.payloads="")});var l=a.outerOrder||i,u=a.innerOrder||s,c=[];return l.forEach(function(d){t[d].forEach(function(h){h.name in o&&o[h.name]!=null?c.push(r(d,h,o)):h.push in o&&o[h.push]!=null&&o[h.push].forEach(function(p){c.push(r(d,h,p))})})}),o.media.forEach(function(d){c.push(r("m",t.m[0],d)),u.forEach(function(h){t[h].forEach(function(p){p.name in d&&d[p.name]!=null?c.push(r(h,p,d)):p.push in d&&d[p.push]!=null&&d[p.push].forEach(function(g){c.push(r(h,p,g))})})})}),c.join(`\r
`)+`\r
`},hy}var bC;function lX(){if(bC)return yr;bC=1;var t=oX(),e=aX(),n=Tw();return yr.grammar=n,yr.write=e,yr.parse=t.parse,yr.parseParams=t.parseParams,yr.parseFmtpConfig=t.parseFmtpConfig,yr.parsePayloads=t.parsePayloads,yr.parseRemoteCandidates=t.parseRemoteCandidates,yr.parseImageAttributes=t.parseImageAttributes,yr.parseSimulcastStreamList=t.parseSimulcastStreamList,yr}var ss=lX();const uX=.7,cX=20,qa={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class kC extends ci.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=Ee,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=vw(i=>F(this,void 0,void 0,function*(){this.emit(qa.NegotiationStarted);try{yield this.createAndSendOffer()}catch(s){if(i)i(s);else throw s}}),cX),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ji((r=n.loggerName)!==null&&r!==void 0?r:Or.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC()}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return F(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return F(this,void 0,void 0,function*(){var n;let r;if(e.type==="offer"){let{stereoMids:i,nackMids:s}=dX(e);this.remoteStereoMids=i,this.remoteNackMids=s}else if(e.type==="answer"){const i=ss.parse((n=e.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(o=>{if(!o.transceiver||s.mid!=o.transceiver.mid)return!1;let a=0;if(s.rtp.some(u=>u.codec.toUpperCase()===o.codec.toUpperCase()?(a=u.payload,!0):!1),a===0)return!0;let l=!1;for(const u of s.fmtp)if(u.payload===a){u.config=u.config.split(";").filter(c=>!c.includes("maxaveragebitrate")).join(";"),o.maxbr>0&&(u.config+=";maxaveragebitrate=".concat(o.maxbr*1e3)),l=!0;break}return l||o.maxbr>0&&s.fmtp.push({payload:a,config:"maxaveragebitrate=".concat(o.maxbr*1e3)}),!0})}),r=ss.write(i)}yield this.setMungedSDP(e,r,!0),this.pendingCandidates.forEach(i=>{this.pc.addIceCandidate(i)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(qa.NegotiationComplete),e.sdp&&ss.parse(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(qa.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){return F(this,void 0,void 0,function*(){var n;if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const r=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:r.sdp},this.logContext));const i=ss.parse((n=r.sdp)!==null&&n!==void 0?n:"");i.media.forEach(s=>{TC(s),s.type==="audio"?wC(s,[],[]):s.type==="video"&&this.trackBitrates.some(o=>{if(!s.msid||!o.cid||!s.msid.includes(o.cid))return!1;let a=0;if(s.rtp.some(u=>u.codec.toUpperCase()===o.codec.toUpperCase()?(a=u.payload,!0):!1),a===0||(Ku(o.codec)&&this.ensureVideoDDExtensionForSVC(s,i),o.codec!=="av1"))return!0;const l=Math.round(o.maxbr*uX);for(const u of s.fmtp)if(u.payload===a){u.config.includes("x-google-start-bitrate")||(u.config+=";x-google-start-bitrate=".concat(l));break}return!0})}),yield this.setMungedSDP(r,ss.write(i)),this.onOffer(r)})}createAndSetAnswer(){return F(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),r=ss.parse((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(i=>{TC(i),i.type==="audio"&&wC(i,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,ss.write(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Et("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Et("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return F(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const r=new Map,i=new Map;if((yield this._pc.getStats()).forEach(a=>{switch(a.type){case"transport":n=a.selectedCandidatePairId;break;case"candidate-pair":n===""&&a.selected&&(n=a.id),r.set(a.id,a);break;case"remote-candidate":i.set(a.id,"".concat(a.address,":").concat(a.port));break}}),n==="")return;const o=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(o!==void 0)return i.get(o)})}setMungedSDP(e,n,r){return F(this,void 0,void 0,function*(){if(n){const i=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:n})),e.sdp=i}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(i){let s="unknown error";i instanceof Error?s=i.message:typeof i=="string"&&(s=i);const o={error:s,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(o.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:o})),new Pb(s)}})}ensureVideoDDExtensionForSVC(e,n){var r,i;if(!((r=e.ext)===null||r===void 0?void 0:r.some(o=>o.uri===lC))){if(this.ddExtID===0){let o=0;n.media.forEach(a=>{var l;a.type==="video"&&((l=a.ext)===null||l===void 0||l.forEach(u=>{u.value>o&&(o=u.value)}))}),this.ddExtID=o+1}(i=e.ext)===null||i===void 0||i.push({value:this.ddExtID,uri:lC})}}}function wC(t,e,n){let r=0;t.rtp.some(i=>i.codec==="opus"?(r=i.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(i=>i.payload===r&&i.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(i=>i.payload===r?(i.config.includes("stereo=1")||(i.config+=";stereo=1"),!0):!1))}function dX(t){var e;const n=[],r=[],i=ss.parse((e=t.sdp)!==null&&e!==void 0?e:"");let s=0;return i.media.forEach(o=>{var a;o.type==="audio"&&(o.rtp.some(l=>l.codec==="opus"?(s=l.payload,!0):!1),!((a=o.rtcpFb)===null||a===void 0)&&a.some(l=>l.payload===s&&l.type==="nack")&&r.push(o.mid),o.fmtp.some(l=>l.payload===s?(l.config.includes("sprop-stereo=1")&&n.push(o.mid),!0):!1))}),{stereoMids:n,nackMids:r}}function TC(t){if(t.connection){const e=t.connection.ip.indexOf(":")>=0;(t.connection.version===4&&e||t.connection.version===6&&!e)&&(t.connection.ip="0.0.0.0",t.connection.version=4)}}const Ub="vp8",fX={audioPreset:Rb.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:bw.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Ub,backupCodec:!0},NL={deviceId:"default",autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},OL={deviceId:"default",resolution:Oc.h720.resolution},hX={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new uY,disconnectOnPageLeave:!0,webAudioMix:!1},Sw={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var ft;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(ft||(ft={}));class pX{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var i;this.peerConnectionTimeout=Sw.peerConnectionTimeout,this.log=Ee,this.updateState=()=>{var s;const o=this.state,a=this.requiredTransports.map(l=>l.getConnectionState());a.every(l=>l==="connected")?this.state=ft.CONNECTED:a.some(l=>l==="failed")?this.state=ft.FAILED:a.some(l=>l==="connecting")?this.state=ft.CONNECTING:a.every(l=>l==="closed")?this.state=ft.CLOSED:a.some(l=>l==="closed")?this.state=ft.CLOSING:a.every(l=>l==="new")&&(this.state=ft.NEW),o!==this.state&&(this.log.debug("pc state change: from ".concat(ft[o]," to ").concat(ft[this.state]),this.logContext),(s=this.onStateChange)===null||s===void 0||s.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=ji((i=r.loggerName)!==null&&i!==void 0?i:Or.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n,this.publisher=new kC(e,r),this.subscriber=new kC(e,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=s=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,s,_r.PUBLISHER)},this.subscriber.onIceCandidate=s=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,s,_r.SUBSCRIBER)},this.subscriber.onDataChannel=s=>{var o;(o=this.onDataChannel)===null||o===void 0||o.call(this,s)},this.subscriber.onTrack=s=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,s)},this.publisher.onOffer=s=>{var o;(o=this.onPublisherOffer)===null||o===void 0||o.call(this,s)},this.state=ft.NEW,this.connectionLock=new Tn,this.remoteOfferLock=new Tn}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return F(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return F(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return F(this,void 0,void 0,function*(){n===_r.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return F(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const n=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()}finally{n()}})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return F(this,void 0,void 0,function*(){var r;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(s=>this.ensureTransportConnected(s,e,n)))}finally{i()}})}negotiate(e){return F(this,void 0,void 0,function*(){return new Promise((n,r)=>F(this,void 0,void 0,function*(){const i=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(i),r("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(qa.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(qa.NegotiationComplete,()=>{clearTimeout(i),n()})}),yield this.publisher.negotiate(o=>{clearTimeout(i),r(o)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===_r.PUBLISHER?this.publisher.getConnectedAddress():e===_r.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return F(this,arguments,void 0,function(r,i){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((l,u)=>F(s,void 0,void 0,function*(){const c=()=>{this.log.warn("abort transport connection",this.logContext),Vt.clearTimeout(d),u(new He("room connection has been cancelled",Oe.Cancelled))};i!=null&&i.signal.aborted&&c(),i==null||i.signal.addEventListener("abort",c);const d=Vt.setTimeout(()=>{i==null||i.signal.removeEventListener("abort",c),u(new He("could not establish pc connection",Oe.InternalError))},o);for(;this.state!==ft.CONNECTED;)if(yield Rr(50),i!=null&&i.signal.aborted){u(new He("room connection has been cancelled",Oe.Cancelled));return}Vt.clearTimeout(d),i==null||i.signal.removeEventListener("abort",c),l()}))}()})}}const _w=2e3;function Tm(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}class Ut extends _o{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,$.Kind.Audio,n,r,s),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>F(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}o&&this.prevStats&&(this._currentBitrate=Tm(o,this.prevStats)),this.prevStats=o}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(ee.AudioTrackFeatureUpdate,this,Qr.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(ee.AudioTrackFeatureUpdate,this,Qr.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===$.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==So(this._constraints.deviceId);return this.source===$.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return F(this,void 0,void 0,function*(){let n;if(e){const r=wm({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return F(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){Sn()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},_w)))}setProcessor(e){return F(this,void 0,void 0,function*(){var n;const r=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const i={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(i),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(ee.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return F(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(i=>{i.type==="outbound-rtp"&&(r={type:"audio",streamId:i.id,packetsSent:i.packetsSent,packetsLost:i.packetsLost,bytesSent:i.bytesSent,timestamp:i.timestamp,roundTripTime:i.roundTripTime,jitter:i.jitter})}),r})}checkForSilence(){return F(this,void 0,void 0,function*(){const e=yield LY(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(ee.AudioSilenceDetected)),e})}}function DL(t,e,n){switch(t.kind){case"audio":return new Ut(t,e,!1,void 0,n);case"video":return new Jt(t,e,!1,n);default:throw new ki("unsupported track type: ".concat(t.kind))}}const mX=Object.values(Oc),gX=Object.values(Ab),yX=Object.values(bw),vX=[Oc.h180,Oc.h360],bX=[Ab.h180,Ab.h360],kX=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,i;return new Be(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((i=n.fps)!==null&&i!==void 0?i:30))))),n.fps,t.encoding.priority)}),Fb=["q","h","f"];function jb(t,e,n,r){var i,s;let o=r==null?void 0:r.videoEncoding;t&&(o=r==null?void 0:r.screenShareEncoding);const a=r==null?void 0:r.simulcast,l=r==null?void 0:r.scalabilityMode,u=r==null?void 0:r.videoCodec;if(!o&&!a&&!l||!e||!n)return[{}];o||(o=TX(t,e,n,u),Ee.debug("using video encoding",o));const c=o.maxFramerate,d=new Be(e,n,o.maxBitrate,o.maxFramerate,o.priority);if(l&&Ku(u)){const g=new LL(l),m=[];if(g.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));const k=li();if(Bs()||Vi()||(k==null?void 0:k.name)==="Chrome"&&Fo(k==null?void 0:k.version,"113")<0){const y=g.suffix=="h"?2:3;for(let w=0;w<g.spatial;w+=1)m.push({rid:Fb[2-w],maxBitrate:o.maxBitrate/Math.pow(y,w),maxFramerate:d.encoding.maxFramerate});m[0].scalabilityMode=l}else m.push({maxBitrate:o.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:l});return d.encoding.priority&&(m[0].priority=d.encoding.priority,m[0].networkPriority=d.encoding.priority),Ee.debug("using svc encoding",{encodings:m}),m}if(!a)return[o];let h=[];t?h=(i=_C(r==null?void 0:r.screenShareSimulcastLayers))!==null&&i!==void 0?i:SC(t,d):h=(s=_C(r==null?void 0:r.videoSimulcastLayers))!==null&&s!==void 0?s:SC(t,d);let p;if(h.length>0){const g=h[0];h.length>1&&([,p]=h);const m=Math.max(e,n);if(m>=960&&p)return py(e,n,[g,p,d],c);if(m>=480)return py(e,n,[g,d],c)}return py(e,n,[d])}function wX(t,e,n){var r,i,s,o;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Ee.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const a=t.mediaStreamTrack.getSettings(),l=(r=a.width)!==null&&r!==void 0?r:(i=t.dimensions)===null||i===void 0?void 0:i.width,u=(s=a.height)!==null&&s!==void 0?s:(o=t.dimensions)===null||o===void 0?void 0:o.height;return jb(t.source===$.Source.ScreenShare,l,u,n)}function TX(t,e,n,r){const i=SX(t,e,n);let{encoding:s}=i[0];const o=Math.max(e,n);for(let a=0;a<i.length;a+=1){const l=i[a];if(s=l.encoding,l.width>=o)break}if(r)switch(r){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function SX(t,e,n){if(t)return yX;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?mX:gX}function SC(t,e){if(t)return kX(e);const{width:n,height:r}=e,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?vX:bX}function py(t,e,n,r){const i=[];if(n.forEach((s,o)=>{if(o>=Fb.length)return;const a=Math.min(t,e),u={rid:Fb[o],scaleResolutionDownBy:Math.max(1,a/Math.min(s.width,s.height)),maxBitrate:s.encoding.maxBitrate},c=r&&s.encoding.maxFramerate?Math.min(r,s.encoding.maxFramerate):s.encoding.maxFramerate;c&&(u.maxFramerate=c);const d=fl()||o===0;s.encoding.priority&&d&&(u.priority=s.encoding.priority,u.networkPriority=s.encoding.priority),i.push(u)}),Vi()&&RL()==="ios"){let s;i.forEach(a=>{s?a.maxFramerate&&a.maxFramerate>s&&(s=a.maxFramerate):s=a.maxFramerate});let o=!0;i.forEach(a=>{var l;a.maxFramerate!=s&&(o&&(o=!1,Ee.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Ee.info('Setting framerate of encoding "'.concat((l=a.rid)!==null&&l!==void 0?l:"",'" to ').concat(s)),a.maxFramerate=s)})}return i}function _C(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:i}=n;return r.maxBitrate>i.maxBitrate?1:r.maxBitrate<i.maxBitrate?-1:r.maxBitrate===i.maxBitrate&&r.maxFramerate&&i.maxFramerate?r.maxFramerate>i.maxFramerate?1:-1:0})}class LL{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function _X(t){return t.source===$.Source.ScreenShare||t.constraints.height&&So(t.constraints.height)>=1080?"maintain-resolution":"balanced"}const EX=5e3;class Jt extends _o{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3?arguments[3]:void 0;super(e,$.Kind.Video,n,r,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>F(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(a){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:a}));return}const o=new Map(s.map(a=>[a.rid,a]));if(this.prevStats){let a=0;o.forEach((l,u)=>{var c;const d=(c=this.prevStats)===null||c===void 0?void 0:c.get(u);a+=Tm(l,d)}),this._currentBitrate=a}this.prevStats=o}),this.senderLock=new Tn}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!Sn())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},_w))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return F(this,void 0,void 0,function*(){var n,r,i,s,o;yield e.pauseUpstream.call(this);try{for(var a=!0,l=ha(this.simulcastCodecs.values()),u;u=yield l.next(),n=u.done,!n;a=!0)s=u.value,a=!1,yield(o=s.sender)===null||o===void 0?void 0:o.replaceTrack(null)}catch(c){r={error:c}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return F(this,void 0,void 0,function*(){var n,r,i,s,o;yield e.resumeUpstream.call(this);try{for(var a=!0,l=ha(this.simulcastCodecs.values()),u;u=yield l.next(),n=u.done,!n;a=!0){s=u.value,a=!1;const c=s;yield(o=c.sender)===null||o===void 0?void 0:o.replaceTrack(c.mediaStreamTrack)}}catch(c){r={error:c}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===$.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return F(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===$.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return F(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(i=>{var s;if(i.type==="outbound-rtp"){const o={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,framesPerSecond:i.framesPerSecond,framesSent:i.framesSent,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationDurations:i.qualityLimitationDurations,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges,rid:(s=i.rid)!==null&&s!==void 0?s:i.id,retransmittedPacketsSent:i.retransmittedPacketsSent,targetBitrate:i.targetBitrate,timestamp:i.timestamp},a=r.get(i.remoteId);a&&(o.jitter=a.jitter,o.packetsLost=a.packetsLost,o.roundTripTime=a.roundTripTime),n.push(o)}}),n.sort((i,s)=>{var o,a;return((o=s.frameWidth)!==null&&o!==void 0?o:0)-((a=i.frameWidth)!==null&&a!==void 0?a:0)}),n})}setPublishingQuality(e){const n=[];for(let r=or.LOW;r<=or.HIGH;r+=1)n.push(new mw({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}restartTrack(e){return F(this,void 0,void 0,function*(){var n,r,i,s;let o;if(e){const c=wm({video:e});typeof c.video!="boolean"&&(o=c.video)}yield this.restart(o);try{for(var a=!0,l=ha(this.simulcastCodecs.values()),u;u=yield l.next(),n=u.done,!n;a=!0){s=u.value,a=!1;const c=s;c.sender&&(c.mediaStreamTrack=this.mediaStreamTrack.clone(),yield c.sender.replaceTrack(c.mediaStreamTrack))}}catch(c){r={error:c}}finally{try{!a&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return F(this,arguments,void 0,function(r){var i=this;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o,a,l,u,c,d;if(yield n.setProcessor.call(i,r,s),!((c=i.processor)===null||c===void 0)&&c.processedTrack)try{for(var h=!0,p=ha(i.simulcastCodecs.values()),g;g=yield p.next(),o=g.done,!o;h=!0)u=g.value,h=!1,yield(d=u.sender)===null||d===void 0?void 0:d.replaceTrack(i.processor.processedTrack)}catch(m){a={error:m}}finally{try{!h&&!o&&(l=p.return)&&(yield l.call(p))}finally{if(a)throw a.error}}}()})}setDegradationPreference(e){return F(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},EX))}setPublishingCodecs(e){return F(this,void 0,void 0,function*(){var n,r,i,s,o,a,l;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const u=[];try{for(n=!0,r=ha(e);i=yield r.next(),s=i.done,!s;n=!0){l=i.value,n=!1;const c=l;if(!this.codec||this.codec===c.codec)yield this.setPublishingLayers(c.qualities);else{const d=this.simulcastCodecs.get(c.codec);if(this.log.debug("try setPublishingCodec for ".concat(c.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:d})),!d||!d.sender){for(const h of c.qualities)if(h.enabled){u.push(c.codec);break}}else d.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(c.codec),this.logContext),yield EC(d.sender,d.encodings,c.qualities,this.senderLock,this.log,this.logContext))}}}catch(c){o={error:c}}finally{try{!n&&!s&&(a=r.return)&&(yield a.call(r))}finally{if(o)throw o.error}}return u})}setPublishingLayers(e){return F(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield EC(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),IL()&&this.isInBackground&&this.source===$.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function EC(t,e,n,r,i,s){return F(this,void 0,void 0,function*(){const o=yield r.lock();i.debug("setPublishingLayersForSender",Object.assign(Object.assign({},s),{sender:t,qualities:n,senderEncodings:e}));try{const a=t.getParameters(),{encodings:l}=a;if(!l)return;if(l.length!==e.length){i.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},s),{encodings:l,senderEncodings:e}));return}let u=!1;!1&&l[0].scalabilityMode||l.forEach((d,h)=>{var p;let g=(p=d.rid)!==null&&p!==void 0?p:"";g===""&&(g="q");const m=ML(g),k=n.find(y=>y.quality===m);k&&d.active!==k.enabled&&(u=!0,d.active=k.enabled,i.debug("setting layer ".concat(k.quality," to ").concat(d.active?"enabled":"disabled"),s),fl()&&(k.enabled?(d.scaleResolutionDownBy=e[h].scaleResolutionDownBy,d.maxBitrate=e[h].maxBitrate,d.maxFrameRate=e[h].maxFrameRate):(d.scaleResolutionDownBy=4,d.maxBitrate=10,d.maxFrameRate=2)))}),u&&(a.encodings=l,i.debug("setting encodings",Object.assign(Object.assign({},s),{encodings:a.encodings})),yield t.setParameters(a))}finally{o()}})}function ML(t){switch(t){case"f":return or.HIGH;case"h":return or.MEDIUM;case"q":return or.LOW;default:return or.HIGH}}function CC(t,e,n,r){if(!n)return[new To({quality:or.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const i=n[0].scalabilityMode,s=new LL(i),o=[],a=s.suffix=="h"?1.5:2,l=s.suffix=="h"?2:3;for(let u=0;u<s.spatial;u+=1)o.push(new To({quality:Math.min(or.HIGH,s.spatial-1)-u,width:Math.ceil(t/Math.pow(a,u)),height:Math.ceil(e/Math.pow(a,u)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(l,u)):0,ssrc:0}));return o}return n.map(i=>{var s,o,a;const l=(s=i.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let u=ML((o=i.rid)!==null&&o!==void 0?o:"");return new To({quality:u,width:Math.ceil(t/l),height:Math.ceil(e/l),bitrate:(a=i.maxBitrate)!==null&&a!==void 0?a:0,ssrc:0})})}const xC="_lossy",IC="_reliable",CX=2*1e3,my="leave-reconnect";var vr;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(vr||(vr={}));class xX extends ci.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Sw.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=vr.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Ee,this.handleDataChannel=r=>F(this,[r],void 0,function(i){var s=this;let{channel:o}=i;return function*(){if(o){if(o.label===IC)s.reliableDCSub=o;else if(o.label===xC)s.lossyDCSub=o;else return;s.log.debug("on data channel ".concat(o.id,", ").concat(o.label),s.logContext),o.onmessage=s.handleDataMessage}}()}),this.handleDataMessage=r=>F(this,void 0,void 0,function*(){var i,s;const o=yield this.dataProcessLock.lock();try{let a;if(r.data instanceof ArrayBuffer)a=r.data;else if(r.data instanceof Blob)a=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const l=is.fromBinary(new Uint8Array(a));((i=l.value)===null||i===void 0?void 0:i.case)==="speaker"?this.emit(ne.ActiveSpeakersUpdate,l.value.value.speakers):(((s=l.value)===null||s===void 0?void 0:s.case)==="user"&&PX(l,l.value.value),this.emit(ne.DataPacketReceived,l))}finally{o()}}),this.handleDataError=r=>{const s=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:o}=r.error;this.log.error("DataChannel error on ".concat(s,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:o}))}else this.log.error("Unknown DataChannel error on ".concat(s),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const s=r.currentTarget.maxRetransmits===0?et.LOSSY:et.RELIABLE;this.updateAndEmitDCBufferStatus(s)},this.handleDisconnect=(r,i)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(ne.Disconnected),this.close()},o=Date.now()-this.reconnectStart;let a=this.getNextRetryDelay({elapsedMs:o,retryCount:this.reconnectAttempts});if(a===null){s(o);return}r===my&&(a=0),this.log.debug("reconnecting in ".concat(a,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Vt.setTimeout(()=>this.attemptReconnect(i).finally(()=>this.reconnectTimeout=void 0),a)},this.waitForRestarted=()=>new Promise((r,i)=>{this.pcState===vr.Connected&&r();const s=()=>{this.off(ne.Disconnected,o),r()},o=()=>{this.off(ne.Restarted,s),i()};this.once(ne.Restarted,s),this.once(ne.Disconnected,o)}),this.updateAndEmitDCBufferStatus=r=>{const i=this.isBufferStatusLow(r);typeof i<"u"&&i!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,i),this.emit(ne.DCBufferStatusChanged,i,r))},this.isBufferStatusLow=r=>{const i=this.dataChannelForKind(r);if(i)return i.bufferedAmount<=i.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===nt.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(sa.RR_SIGNAL_DISCONNECTED))},this.log=ji((n=e.loggerName)!==null&&n!==void 0?n:Or.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new ww(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Tn,this.dataProcessLock=new Tn,this.dcBufferStatus=new Map([[et.LOSSY,!0],[et.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(ne.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(ne.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(ne.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(ne.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(ne.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(ne.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(ne.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(ne.SignalRequestResponse,r)}get logContext(){var e,n,r,i,s,o,a,l;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(i=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.sid,participant:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||o===void 0?void 0:o.identity,pID:(l=(a=this.latestJoinResponse)===null||a===void 0?void 0:a.participant)===null||l===void 0?void 0:l.sid}}join(e,n,r,i){return F(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,n,r,i);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),(!this.subscriberPrimary||s.fastPublish)&&this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof He&&s.reason===Oe.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,i);throw s}})}close(){return F(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(ne.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return F(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return F(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ki("a track with the same ID has already been published");return new Promise((n,r)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new He("publication of local track timed out, no response from server",Oe.InternalError))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(i),n(s)},reject:()=>{clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return F(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return F(this,void 0,void 0,function*(){var n,r;if(this.pcManager&&this.pcManager.currentState!==ft.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const i=this.makeRTCConfiguration(e);this.pcManager=new pX(i,e.subscriberPrimary,this.loggerOptions),this.emit(ne.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(s,o)=>{this.client.sendIceCandidate(s,o)},this.pcManager.onPublisherOffer=s=>{this.client.sendOffer(s)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(s,o,a)=>F(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(s),this.logContext),["closed","disconnected","failed"].includes(o)&&(this.publisherConnectionPromise=void 0),s===ft.CONNECTED){const c=this.pcState===vr.New;this.pcState=vr.Connected,c&&this.emit(ne.Connected,e)}else s===ft.FAILED&&this.pcState===vr.Connected&&(this.pcState=vr.Disconnected,this.handleDisconnect("peerconnection failed",a==="failed"?sa.RR_SUBSCRIBER_FAILED:sa.RR_PUBLISHER_FAILED));const l=this.client.isDisconnected||this.client.currentState===nt.RECONNECTING,u=[ft.FAILED,ft.CLOSING,ft.CLOSED].includes(s);l&&u&&!this._isClosed&&this.emit(ne.Offline)}),this.pcManager.onTrack=s=>{this.emit(ne.MediaTrackAdded,s.track,s.streams[0],s.receiver)},IX((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>F(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>F(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(ne.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(ne.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(ne.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ne.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",sa.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case Ba.DISCONNECT:this.emit(ne.Disconnected,e==null?void 0:e.reason),this.close();break;case Ba.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(my);break;case Ba.RESUME:this.handleDisconnect(my)}}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const i=[];e.iceServers.forEach(s=>{const o={urls:s.urls};s.username&&(o.username=s.username),s.credential&&(o.credential=s.credential),i.push(o)}),r.iceServers=i}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Rc.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(xC,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(IC,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,r){return F(this,void 0,void 0,function*(){if(Ob())return yield this.createTransceiverRTCRtpSender(e,n,r);if(Db())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Et("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,i){return F(this,void 0,void 0,function*(){if(Ob())return this.createSimulcastTransceiverSender(e,n,r,i);if(Db())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Et("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Et("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),e instanceof Jt&&(e.codec=n.videoCodec);const s={direction:"sendonly",streams:i};return r&&(s.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s)).sender})}createSimulcastTransceiverSender(e,n,r,i){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Et("publisher is closed");const s={direction:"sendonly"};i&&(s.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,s);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Et("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return F(this,void 0,void 0,function*(){var n,r,i;if(!this._isClosed){if(this.attemptingReconnect){Ee.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Rc.DISABLED||((i=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&i!==void 0?i:ft.NEW)===ft.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let o=!0;s instanceof Et?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),o=!1):s instanceof oa||(this.fullReconnectOnNext=!0),o?this.handleDisconnect("reconnect",sa.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(ne.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return F(this,void 0,void 0,function*(){var n,r,i;try{if(!this.url||!this.token)throw new Et("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(ne.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new oa;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(o){throw o instanceof He&&o.reason===Oe.NotAllowed?new Et("could not reconnect, token might be expired"):new oa}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(ne.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==nt.CONNECTED)throw new oa("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(ne.Restarted)}catch(s){const o=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(o){yield this.restartConnection(o);return}else throw(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),s}})}resumeConnection(e){return F(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new Et("could not reconnect, url or token not saved");if(!this.pcManager)throw new Et("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(ne.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let s="";throw i instanceof Error&&(s=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof He&&i.reason===Oe.NotAllowed?new Et("could not reconnect, token might be expired"):i instanceof He&&i.reason===Oe.LeaveRequest?i:new oa(s)}if(this.emit(ne.SignalResumed),r){const i=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(i)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==nt.CONNECTED)throw new oa("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(ne.Resumed)})}waitForPCInitialConnection(e,n){return F(this,void 0,void 0,function*(){if(!this.pcManager)throw new Et("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return F(this,void 0,void 0,function*(){this.pcState=vr.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Rr(CX),!this.pcManager)throw new Et("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=vr.Connected}catch(e){throw this.pcState=vr.Disconnected,new He("could not establish PC connection, ".concat(e.message),Oe.InternalError)}})}sendDataPacket(e,n){return F(this,void 0,void 0,function*(){const r=e.toBinary();yield this.ensurePublisherConnected(n);const i=this.dataChannelForKind(n);i&&i.send(r),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){return F(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var s;if(!r.pcManager)throw new Et("PC manager is closed");const o=i?r.pcManager.subscriber:r.pcManager.publisher,a=i?"Subscriber":"Publisher";if(!o)throw new He("".concat(a," connection not set"),Oe.InternalError);let l=!1;!i&&!r.dataChannelForKind(n,i)&&(r.createDataChannels(),l=!0),!l&&!i&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(l=!0),l&&r.negotiate();const u=r.dataChannelForKind(n,i);if((u==null?void 0:u.readyState)==="open")return;const c=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<c;){if(o.isICEConnected&&((s=r.dataChannelForKind(n,i))===null||s===void 0?void 0:s.readyState)==="open")return;yield Rr(50)}throw new He("could not establish ".concat(a," connection, state: ").concat(o.getICEConnectionState()),Oe.InternalError)}()})}ensurePublisherConnected(e){return F(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==ft.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return F(this,void 0,void 0,function*(){return new Promise((e,n)=>F(this,void 0,void 0,function*(){if(!this.pcManager){n(new Pb("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,i=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(ne.Closing,i),this.pcManager.publisher.once(qa.RTPVideoPayloadTypes,s=>{const o=new Map;s.forEach(a=>{const l=a.codec.toLowerCase();JY(l)&&o.set(a.payload,l)}),this.emit(ne.RTPVideoMapUpdate,o)});try{yield this.pcManager.negotiate(r),e()}catch(s){s instanceof Pb&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",sa.RR_UNKNOWN),n(s)}finally{this.off(ne.Closing,i)}}))})}dataChannelForKind(e,n){if(n){if(e===et.LOSSY)return this.lossyDCSub;if(e===et.RELIABLE)return this.reliableDCSub}else{if(e===et.LOSSY)return this.lossyDC;if(e===et.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,i;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const s=this.pcManager.subscriber.getLocalDescription(),o=this.pcManager.subscriber.getRemoteDescription(),a=(i=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&i!==void 0?i:!0,l=new Array,u=new Array;e.forEach(c=>{c.isDesired!==a&&l.push(c.trackSid),c.isEnabled||u.push(c.trackSid)}),this.client.sendSyncState(new qD({answer:s?rp({sdp:s.sdp,type:s.type}):void 0,offer:o?rp({sdp:o.sdp,type:o.type}):void 0,subscription:new vm({trackSids:l,subscribe:!a,participantTracks:[]}),publishTracks:UY(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:u}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,i)=>{(r==null?void 0:r.id)!==void 0&&r.id!==null&&e.push(new HD({label:r.label,id:r.id,target:i}))};return n(this.dataChannelForKind(et.LOSSY),_r.PUBLISHER),n(this.dataChannelForKind(et.RELIABLE),_r.PUBLISHER),n(this.dataChannelForKind(et.LOSSY,!0),_r.SUBSCRIBER),n(this.dataChannelForKind(et.RELIABLE,!0),_r.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Vt.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Sn()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Sn()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class oa extends Error{}function IX(t){return t!==void 0&&t>13}function PX(t,e){const n=t.participantIdentity?t.participantIdentity:e.participantIdentity;t.participantIdentity=n,e.participantIdentity=n;const r=t.destinationIdentities.length!==0?t.destinationIdentities:e.destinationIdentities;t.destinationIdentities=r,e.destinationIdentities=r}class PC{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Mb(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return F(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(i=>i.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),Ee.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return F(this,void 0,void 0,function*(){const n=yield fetch("".concat(RX(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new He("Could not fetch region settings: ".concat(n.statusText),n.status===401?Oe.NotAllowed:Oe.InternalError,n.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function RX(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class dt extends Error{constructor(e,n,r){super(n),this.code=e,this.message=AC(n,dt.MAX_MESSAGE_BYTES),this.data=r?AC(r,dt.MAX_DATA_BYTES):void 0}static fromProto(e){return new dt(e.code,e.message,e.data)}toProto(){return new AD({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new dt(dt.ErrorCode[e],dt.ErrorMessage[e],n)}}dt.MAX_MESSAGE_BYTES=256;dt.MAX_DATA_BYTES=15360;dt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};dt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const RC=15360;function Vb(t){return new TextEncoder().encode(t).length}function AC(t,e){if(Vb(t)<=e)return t;let n=0,r=t.length;const i=new TextEncoder;for(;n<r;){const s=Math.floor((n+r+1)/2);i.encode(t.slice(0,s)).length<=e?n=s:r=s-1}return t.slice(0,n)}class UL extends ${constructor(e,n,r,i,s){super(e,r,s),this.sid=n,this.receiver=i}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ee.Muted:ee.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(ee.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return F(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),_w)),FY()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(r){const{timestamp:i,rtpTimestamp:s}=r;s&&this.rtpTimestamp!==s&&(this.emit(ee.TimeSyncUpdate,{timestamp:i,rtpTimestamp:s}),this.rtpTimestamp=s)}};e()}}class Ha extends UL{constructor(e,n,r,i,s,o){super(e,n,$.Kind.Audio,r,o),this.monitorReceiver=()=>F(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=Tm(a,this.prevStats)),this.prevStats=a}),this.audioContext=i,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Vi()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Vi())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return F(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(Lb(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Lb(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(i=>{r.connect(i),r=i}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ee.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(i=>{this.emit(ee.AudioPlaybackFailed,i)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return F(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const gy=100;class Qu extends UL{constructor(e,n,r,i,s){super(e,n,$.Kind.Video,r,s),this.elementInfos=[],this.monitorReceiver=()=>F(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=Tm(o,this.prevStats)),this.prevStats=o}),this.debouncedHandleResize=vw(()=>{this.updateDimensions()},gy),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?za(this._mediaStreamTrack,n):Ia(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new AX(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return F(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",i=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(r=s.codecId,n={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&i.set(s.id,s)}),n&&r!==""&&i.get(r)&&(n.mimeType=i.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return F(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((a,l)=>Math.max(a,l.visibilityChangedAt||0),0),i=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,s=this.elementInfos.some(a=>a.pictureInPicture),o=this.elementInfos.some(a=>a.visible)&&!i||s;if(this.lastVisible!==o){if(!o&&Date.now()-r<gy){Vt.setTimeout(()=>{this.updateVisibility()},gy);return}this.lastVisible=o,this.emit(ee.VisibilityChanged,o,this)}}updateDimensions(){var e,n;let r=0,i=0;const s=this.getPixelDensity();for(const o of this.elementInfos){const a=o.width()*s,l=o.height()*s;a+l>r+i&&(r=a,i=l)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===i||(this.lastDimensions={width:r,height:i},this.emit(ee.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?uC():n||(uC()>2?2:1)}}class AX{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var i;const{target:s,isIntersecting:o}=r;s===this.element&&(this.isIntersecting=o,this.isPiP=pu(this.element),this.visibilityChangedAt=Date.now(),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this))},this.onEnterPiP=()=>{var r,i,s;(i=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP),this.isPiP=pu(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=pu(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??Bb(e),this.isPiP=Sn()&&pu(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,r;this.isIntersecting=Bb(this.element),this.isPiP=pu(this.element),this.element.handleResize=()=>{var i;(i=this.handleResize)===null||i===void 0||i.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,dC().observe(this.element),cC().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,r,i,s;(e=dC())===null||e===void 0||e.unobserve(this.element),(n=cC())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(s=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||s===void 0||s.removeEventListener("pagehide",this.onLeavePiP)}}function pu(t){var e,n;return document.pictureInPictureElement===t?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Bb(t,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Bb(t,e){const n=e||window;let r=t.offsetTop,i=t.offsetLeft;const s=t.offsetWidth,o=t.offsetHeight,{hidden:a}=t,{display:l}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,r+=t.offsetTop,i+=t.offsetLeft;return r<n.pageYOffset+n.innerHeight&&i<n.pageXOffset+n.innerWidth&&r+o>n.pageYOffset&&i+s>n.pageXOffset&&!a&&l!=="none"}class ls extends ci.EventEmitter{constructor(e,n,r,i){var s;super(),this.metadataMuted=!1,this.encryption=Vn.NONE,this.log=Ee,this.handleMuted=()=>{this.emit(ee.Muted)},this.handleUnmuted=()=>{this.emit(ee.Unmuted)},this.log=ji((s=i==null?void 0:i.loggerName)!==null&&s!==void 0?s:Or.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=$.Source.Unknown}setTrack(e){this.track&&(this.track.off(ee.Muted,this.handleMuted),this.track.off(ee.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ee.Muted,this.handleMuted),e.on(ee.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),qe(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Vn.NONE}get audioTrack(){if(this.track instanceof Ut||this.track instanceof Ha)return this.track}get videoTrack(){if(this.track instanceof Jt||this.track instanceof Qu)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=$.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===$.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(ls);class Dc extends ls{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ee.Ended)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&this.track.off(ee.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(ee.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){return F(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return F(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return F(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return F(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(this.track instanceof Ut){const n=this.track.getSourceTrackSettings(),r=new Set;return n.autoGainControl&&r.add(Qr.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&r.add(Qr.TF_ECHO_CANCELLATION),n.noiseSuppression&&r.add(Qr.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&r.add(Qr.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(Qr.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(Qr.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}var ir;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(ir||(ir={}));function NX(t){switch(t){case _u.EXCELLENT:return ir.Excellent;case _u.GOOD:return ir.Good;case _u.POOR:return ir.Poor;case _u.LOST:return ir.Lost;default:return ir.Unknown}}class FL extends ci.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===np.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,r,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:np.STANDARD;var l;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ir.Unknown,this.log=Ee,this.log=ji((l=o==null?void 0:o.loggerName)!==null&&l!==void 0?l:Or.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=a,this._attributes=s??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication($.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication($.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication($.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(B.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(B.ParticipantNameChanged,e)}_setAttributes(e){const n=jY(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(B.AttributesChanged,n)}setPermissions(e){var n,r,i,s,o,a;const l=this.permissions,u=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((i=this.permissions)===null||i===void 0?void 0:i.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((o=this.permissions)===null||o===void 0?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((c,d)=>{var h;return c!==((h=this.permissions)===null||h===void 0?void 0:h.canPublishSources[d])})||e.canSubscribeMetrics!==((a=this.permissions)===null||a===void 0?void 0:a.canSubscribeMetrics);return this.permissions=e,u&&this.emit(B.ParticipantPermissionsChanged,l),u}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(B.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=NX(e),n!==this._connectionQuality&&this.emit(B.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>(n.track instanceof Ha||n.track instanceof Ut)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ee.Muted,()=>{this.emit(B.TrackMuted,e)}),e.on(ee.Unmuted,()=>{this.emit(B.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case $.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case $.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function OX(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new $D({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}class NC extends FL{constructor(e,n,r,i){super(e,n,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Vn.NONE,this.enabledPublishVideoCodecs=[],this.rpcHandlers=new Map,this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new AL)},this.handleReconnected=()=>{var s,o;(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||o===void 0||o.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(a=>this.log.warn(a.message,this.logContext)),(o=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||o===void 0||o.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=s=>{const{requestId:o,reason:a,message:l}=s,u=this.pendingSignalRequests.get(o);u&&(a!==KD.OK&&u.reject(new sC(l,a)),this.pendingSignalRequests.delete(o))},this.handleDataPacket=s=>{switch(s.value.case){case"rpcRequest":let o=s.value.value;this.handleIncomingRpcRequest(s.participantIdentity,o.id,o.method,o.payload,o.responseTimeoutMs,o.version);break;case"rpcResponse":let a=s.value.value,l=null,u=null;a.value.case==="payload"?l=a.value.value:a.value.case==="error"&&(u=dt.fromProto(a.value.value)),this.handleIncomingRpcResponse(a.requestId,l,u);break;case"rpcAck":let c=s.value.value;this.handleIncomingRpcAck(c.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>OX(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,o)=>{if(o===void 0&&(o=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),qe(s)));return}this.engine.updateMuteStatus(s.sid,o)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),qe(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),qe(s))),this.onTrackMuted(s,s.isMuted)},this.onTrackFeatureUpdate=s=>{const o=this.audioTrackPublications.get(s.sid);if(!o){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(s.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(o.trackSid,o.getTrackFeatures())},this.handleSubscribedQualityUpdate=s=>F(this,void 0,void 0,function*(){var o,a,l,u,c,d;if(!(!((c=this.roomOptions)===null||c===void 0)&&c.dynacast))return;const h=this.videoTrackPublications.get(s.trackSid);if(!h){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(s.subscribedCodecs.length>0){if(!h.videoTrack)return;const k=yield h.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var p=!0,g=ha(k),m;m=yield g.next(),o=m.done,!o;p=!0){u=m.value,p=!1;const y=u;NY(y)&&(this.log.debug("publish ".concat(y," for ").concat(h.videoTrack.sid),Object.assign(Object.assign({},this.logContext),qe(h))),yield this.publishAdditionalCodecForTrack(h.videoTrack,y,h.options))}}catch(y){a={error:y}}finally{try{!p&&!o&&(l=g.return)&&(yield l.call(g))}finally{if(a)throw a.error}}}else s.subscribedQualities.length>0&&(yield(d=h.videoTrack)===null||d===void 0?void 0:d.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const o=this.trackPublications.get(s.trackSid);if(!o){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(o.track)},this.handleTrackEnded=s=>F(this,void 0,void 0,function*(){if(s.source===$.Source.ScreenShare||s.source===$.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),qe(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof Ut||s instanceof Jt)try{if(Sn())try{const o=yield navigator==null?void 0:navigator.permissions.query({name:s.source===$.Source.Camera?"camera":"microphone"});if(o&&o.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),qe(s))),o.onchange=()=>{o.state!=="denied"&&(s.isMuted||s.restartTrack(),o.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),qe(s))),s instanceof Ut?yield s.restartTrack({deviceId:"default"}):yield s.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),qe(s))),yield s.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=i,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Vn.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(ne.RemoteMute,(n,r)=>{const i=this.trackPublications.get(n);!i||!i.track||(r?i.mute():i.unmute())}),this.engine.on(ne.Connected,this.handleReconnected).on(ne.SignalRestarted,this.handleReconnected).on(ne.SignalResumed,this.handleReconnected).on(ne.Restarting,this.handleReconnecting).on(ne.Resuming,this.handleReconnecting).on(ne.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ne.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ne.Disconnected,this.handleDisconnected).on(ne.SignalRequestResponse,this.handleSignalRequestResponse).on(ne.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return F(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return F(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return F(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return F(this,arguments,void 0,function(n){var r=this;let{metadata:i,name:s,attributes:o}=n;return function*(){return new Promise((a,l)=>F(r,void 0,void 0,function*(){var u,c;try{let d=!1;const h=yield this.engine.client.sendUpdateLocalMetadata((u=i??this.metadata)!==null&&u!==void 0?u:"",(c=s??this.name)!==null&&c!==void 0?c:"",o),p=performance.now();for(this.pendingSignalRequests.set(h,{resolve:a,reject:g=>{l(g),d=!0},values:{name:s,metadata:i,attributes:o}});performance.now()-p<5e3&&!d;){if((!s||this.name===s)&&(!i||this.metadata===i)&&(!o||Object.entries(o).every(g=>{let[m,k]=g;return this.attributes[m]===k||k===""&&!this.attributes[m]}))){this.pendingSignalRequests.delete(h),a();return}yield Rr(50)}l(new sC("Request to update local metadata timed out","TimeoutError"))}catch(d){d instanceof Error&&l(d)}}))}()})}setCameraEnabled(e,n,r){return this.setTrackEnabled($.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled($.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled($.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(B.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return F(this,void 0,void 0,function*(){this.encryptionType=e?Vn.GCM:Vn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,i){return F(this,void 0,void 0,function*(){var s,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let a=this.getTrackPublication(e);if(n)if(a)yield a.unmute();else{let l;if(this.pendingPublishing.has(e)){const u=yield this.waitForPendingPublicationOfSource(e);return u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield u==null?void 0:u.unmute(),u}this.pendingPublishing.add(e);try{switch(e){case $.Source.Camera:l=yield this.createTracks({video:(s=r)!==null&&s!==void 0?s:!0});break;case $.Source.Microphone:l=yield this.createTracks({audio:(o=r)!==null&&o!==void 0?o:!0});break;case $.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},r));break;default:throw new ki(e)}}catch(u){throw l==null||l.forEach(c=>{c.stop()}),u instanceof Error&&this.emit(B.MediaDevicesError,u),u}try{const u=[];for(const d of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),qe(d))),u.push(this.publishTrack(d,i));[a]=yield Promise.all(u)}catch(u){throw l==null||l.forEach(c=>{c.stop()}),u}finally{this.pendingPublishing.delete(e)}}else if(!(a!=null&&a.track)&&this.pendingPublishing.has(e)&&(a=yield this.waitForPendingPublicationOfSource(e),a||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),a&&a.track)if(e===$.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const l=this.getTrackPublication($.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return F(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has($.Source.Camera)||this.pendingPublishing.has($.Source.Microphone))){this.pendingPublishing.add($.Source.Camera),this.pendingPublishing.add($.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete($.Source.Camera),this.pendingPublishing.delete($.Source.Microphone)}}})}createTracks(e){return F(this,void 0,void 0,function*(){var n,r;e??(e={});const{audioProcessor:i,videoProcessor:s,optionsWithoutProcessor:o}=kw(e),a=CL(o,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults),l=wm(a);let u;try{u=yield navigator.mediaDevices.getUserMedia(l)}catch(c){throw c instanceof Error&&(l.audio&&(this.microphoneError=c),l.video&&(this.cameraError=c)),c}return l.audio&&(this.microphoneError=void 0,this.emit(B.AudioStreamAcquired)),l.video&&(this.cameraError=void 0),Promise.all(u.getTracks().map(c=>F(this,void 0,void 0,function*(){const d=c.kind==="audio";d?a.audio:a.video;let h;const p=d?l.audio:l.video;typeof p!="boolean"&&(h=p);const g=DL(c,h,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return g.kind===$.Kind.Video?g.source=$.Source.Camera:g.kind===$.Kind.Audio&&(g.source=$.Source.Microphone,g.setAudioContext(this.audioContext)),g.mediaStream=u,g instanceof Ut&&i?yield g.setProcessor(i):g instanceof Jt&&s&&(yield g.setProcessor(s)),g})))})}createScreenTracks(e){return F(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new yw("getDisplayMedia not supported");e.resolution===void 0&&!HY()&&(e.resolution=bw.h1080fps30.resolution);const n=MY(e),r=yield navigator.mediaDevices.getDisplayMedia(n),i=r.getVideoTracks();if(i.length===0)throw new ki("no video track found");const s=new Jt(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=$.Source.ScreenShare,e.contentHint&&(s.mediaStreamTrack.contentHint=e.contentHint);const o=[s];if(r.getAudioTracks().length>0){this.emit(B.AudioStreamAcquired);const a=new Ut(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=$.Source.ScreenShareAudio,o.push(a)}return o})}publishTrack(e,n){return F(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return F(this,arguments,void 0,function(r,i){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var a,l,u,c;r instanceof Ut&&r.setAudioContext(s.audioContext),yield(a=s.reconnectFuture)===null||a===void 0?void 0:a.promise,s.republishPromise&&!o&&(yield s.republishPromise),r instanceof _o&&s.pendingPublishPromises.has(r)&&(yield s.pendingPublishPromises.get(r));let d;if(r instanceof MediaStreamTrack)d=r.getConstraints();else{d=r.constraints;let y;switch(r.source){case $.Source.Microphone:y="audioinput";break;case $.Source.Camera:y="videoinput"}y&&s.activeDeviceMap.has(y)&&(d=Object.assign(Object.assign({},d),{deviceId:s.activeDeviceMap.get(y)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new Ut(r,d,!0,s.audioContext,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;case"video":r=new Jt(r,d,!0,{loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});break;default:throw new ki("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:s.roomOptions.loggerName,loggerContextCb:()=>s.logContext});let h;if(s.trackPublications.forEach(y=>{y.track&&y.track===r&&(h=y)}),h)return s.log.warn("track has already been published, skipping",Object.assign(Object.assign({},s.logContext),qe(h))),h;const p="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,g=(l=i==null?void 0:i.forceStereo)!==null&&l!==void 0?l:p;g&&(i||(i={}),i.dtx===void 0&&s.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},s.logContext),qe(r))),i.red===void 0&&s.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(u=i.dtx)!==null&&u!==void 0||(i.dtx=!1),(c=i.red)!==null&&c!==void 0||(i.red=!1));const m=Object.assign(Object.assign({},s.roomOptions.publishDefaults),i);!WY()&&s.roomOptions.e2ee&&(s.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},s.logContext)),m.simulcast=!1),m.source&&(r.source=m.source);const k=s.publish(r,m,g);s.pendingPublishPromises.set(r,k);try{return yield k}catch(y){throw y}finally{s.pendingPublishPromises.delete(r)}}()})}publish(e,n,r){return F(this,void 0,void 0,function*(){var i,s,o,a,l,u,c,d,h,p;Array.from(this.trackPublications.values()).find(I=>e instanceof _o&&I.source===e.source)&&e.source!==$.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),qe(e))),n.stopMicTrackOnMute&&e instanceof Ut&&(e.stopOnMute=!0),e.source===$.Source.ScreenShare&&fl()&&(n.simulcast=!1),n.videoCodec==="av1"&&!$Y()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!zY()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Ub),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(I=>n.videoCodec===th(I.mime))||(n.videoCodec=th(this.enabledPublishVideoCodecs[0].mime)));const m=n.videoCodec;e.on(ee.Muted,this.onTrackMuted),e.on(ee.Unmuted,this.onTrackUnmuted),e.on(ee.Ended,this.handleTrackEnded),e.on(ee.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ee.UpstreamResumed,this.onTrackUpstreamResumed),e.on(ee.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const k=new kb({cid:e.mediaStreamTrack.id,name:n.name,type:$.kindToProto(e.kind),muted:e.isMuted,source:$.sourceToProto(e.source),disableDtx:!(!((i=n.dtx)!==null&&i!==void 0)||i),encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((s=n.red)!==null&&s!==void 0)||s),stream:n==null?void 0:n.stream});let y;if(e.kind===$.Kind.Video){let I={width:0,height:0};try{I=yield e.waitForDimensions()}catch{const C=(a=(o=this.roomOptions.videoCaptureDefaults)===null||o===void 0?void 0:o.resolution)!==null&&a!==void 0?a:Oc.h720.resolution;I={width:C.width,height:C.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),qe(e)),{dims:I}))}k.width=I.width,k.height=I.height,e instanceof Jt&&(Ku(m)&&(e.source===$.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),qe(e))))),n.scalabilityMode=(l=n.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),k.simulcastCodecs=[new bb({codec:m,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Ub}),n.backupCodec&&m!==n.backupCodec.codec&&k.encryption===Vn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),k.simulcastCodecs.push(new bb({codec:n.backupCodec.codec,cid:""})))),y=jb(e.source===$.Source.ScreenShare,k.width,k.height,n),k.layers=CC(k.width,k.height,y,Ku(n.videoCodec))}else e.kind===$.Kind.Audio&&(y=[{maxBitrate:(u=n.audioPreset)===null||u===void 0?void 0:u.maxBitrate,priority:(d=(c=n.audioPreset)===null||c===void 0?void 0:c.priority)!==null&&d!==void 0?d:"high",networkPriority:(p=(h=n.audioPreset)===null||h===void 0?void 0:h.priority)!==null&&p!==void 0?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Et("cannot publish track when not connected");const w=()=>F(this,void 0,void 0,function*(){var I,R,C;if(!this.engine.pcManager)throw new Et("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,y),e instanceof Jt&&((I=n.degradationPreference)!==null&&I!==void 0||(n.degradationPreference=_X(e)),e.setDegradationPreference(n.degradationPreference)),y)if(fl()&&e.kind===$.Kind.Audio){let _;for(const P of this.engine.pcManager.publisher.getTransceivers())if(P.sender===e.sender){_=P;break}_&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:_,codec:"opus",maxbr:!((R=y[0])===null||R===void 0)&&R.maxBitrate?y[0].maxBitrate/1e3:0})}else e.codec&&Ku(e.codec)&&(!((C=y[0])===null||C===void 0)&&C.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:k.cid,codec:e.codec,maxbr:y[0].maxBitrate/1e3});yield this.engine.negotiate()});let T;if(this.enabledPublishVideoCodecs.length>0)T=(yield Promise.all([this.engine.addTrack(k),w()]))[0];else{T=yield this.engine.addTrack(k);let I;if(T.codecs.forEach(R=>{I===void 0&&(I=R.mimeType)}),I&&e.kind===$.Kind.Video){const R=th(I);R!==m&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),qe(e)),{codec:R})),n.videoCodec=R,y=jb(e.source===$.Source.ScreenShare,k.width,k.height,n))}yield w()}const x=new Dc(e.kind,T,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return x.options=n,e.sid=T.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:y,trackInfo:T})),e instanceof Jt?e.startMonitor(this.engine.client):e instanceof Ut&&e.startMonitor(),this.addTrackPublication(x),this.emit(B.LocalTrackPublished,x),x})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){return F(this,void 0,void 0,function*(){var i;if(this.encryptionType!==Vn.NONE)return;let s;if(this.trackPublications.forEach(p=>{p.track&&p.track===e&&(s=p)}),!s)throw new ki("track is not published");if(!(e instanceof Jt))throw new ki("track is not a video track");const o=Object.assign(Object.assign({},(i=this.roomOptions)===null||i===void 0?void 0:i.publishDefaults),r),a=wX(e,n,o);if(!a){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),qe(e)));return}const l=e.addSimulcastTrack(n,a);if(!l)return;const u=new kb({cid:l.mediaStreamTrack.id,type:$.kindToProto(e.kind),muted:e.isMuted,source:$.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:l.mediaStreamTrack.id}]});if(u.layers=CC(u.width,u.height,a),!this.engine||this.engine.isClosed)throw new Et("cannot publish track when not connected");const c=()=>F(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,l,o,a),yield this.engine.negotiate()}),h=(yield Promise.all([this.engine.addTrack(u),c()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:h}))})}unpublishTrack(e,n){return F(this,void 0,void 0,function*(){var r,i;if(e instanceof _o){const u=this.pendingPublishPromises.get(e);u&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),qe(e))),yield u)}const s=this.getPublicationForTrack(e),o=s?qe(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));return}e=s.track,e.off(ee.Muted,this.onTrackMuted),e.off(ee.Unmuted,this.onTrackUnmuted),e.off(ee.Ended,this.handleTrackEnded),e.off(ee.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ee.UpstreamResumed,this.onTrackUpstreamResumed),e.off(ee.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(i=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&i!==void 0?i:!0),n?e.stop():e.stopMonitor();let a=!1;const l=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<ft.FAILED&&l)try{for(const u of this.engine.pcManager.publisher.getTransceivers())u.sender===l&&(u.direction="inactive",a=!0);if(this.engine.removeTrack(l)&&(a=!0),e instanceof Jt){for(const[,u]of e.simulcastCodecs)u.sender&&(this.engine.removeTrack(u.sender)&&(a=!0),u.sender=void 0);e.simulcastCodecs.clear()}}catch(u){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:u}))}switch(this.trackPublications.delete(s.trackSid),s.kind){case $.Kind.Audio:this.audioTrackPublications.delete(s.trackSid);break;case $.Kind.Video:this.videoTrackPublications.delete(s.trackSid);break}return this.emit(B.LocalTrackUnpublished,s),s.setTrack(void 0),a&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return F(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>r instanceof Dc)})}republishAllTracks(e){return F(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((s,o)=>F(r,void 0,void 0,function*(){try{const a=[];this.trackPublications.forEach(l=>{l.track&&(n&&(l.options=Object.assign(Object.assign({},l.options),n)),a.push(l))}),yield Promise.all(a.map(l=>F(this,void 0,void 0,function*(){const u=l.track;yield this.unpublishTrack(u,!1),i&&!u.isMuted&&u.source!==$.Source.ScreenShare&&u.source!==$.Source.ScreenShareAudio&&(u instanceof Ut||u instanceof Jt)&&!u.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:l.trackSid})),yield u.restartTrack()),yield this.publishOrRepublishTrack(u,l.options,!0)}))),s()}catch(a){o(a)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return F(this,arguments,void 0,function(n){var r=this;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const s=i.reliable?et.RELIABLE:et.LOSSY,o=i.destinationIdentities,a=i.topic,l=new is({kind:s,value:{case:"user",value:new CD({participantIdentity:r.identity,payload:n,destinationIdentities:o,topic:a})}});yield r.engine.sendDataPacket(l,s)}()})}publishDtmf(e,n){return F(this,void 0,void 0,function*(){const r=new is({kind:et.RELIABLE,value:{case:"sipDtmf",value:new xD({code:e,digit:n})}});yield this.engine.sendDataPacket(r,et.RELIABLE)})}sendChatMessage(e){return F(this,void 0,void 0,function*(){const n={id:crypto.randomUUID(),message:e,timestamp:Date.now()},r=new is({value:{case:"chatMessage",value:new yb(Object.assign(Object.assign({},n),{timestamp:st.parse(n.timestamp)}))}});return yield this.engine.sendDataPacket(r,et.RELIABLE),this.emit(B.ChatMessage,n),n})}editChatMessage(e,n){return F(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),i=new is({value:{case:"chatMessage",value:new yb(Object.assign(Object.assign({},r),{timestamp:st.parse(r.timestamp),editTimestamp:st.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,et.RELIABLE),this.emit(B.ChatMessage,r),r})}performRpc(e){return F(this,arguments,void 0,function(n){var r=this;let{destinationIdentity:i,method:s,payload:o,responseTimeout:a=1e4}=n;return function*(){return new Promise((u,c)=>F(r,void 0,void 0,function*(){var d,h,p,g;if(Vb(o)>RC){c(dt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((h=(d=this.engine.latestJoinResponse)===null||d===void 0?void 0:d.serverInfo)===null||h===void 0)&&h.version&&Fo((g=(p=this.engine.latestJoinResponse)===null||p===void 0?void 0:p.serverInfo)===null||g===void 0?void 0:g.version,"1.8.0")<0){c(dt.builtIn("UNSUPPORTED_SERVER"));return}const m=crypto.randomUUID();yield this.publishRpcRequest(i,m,s,o,a-2e3);const k=setTimeout(()=>{this.pendingAcks.delete(m),c(dt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(m),clearTimeout(y)},2e3);this.pendingAcks.set(m,{resolve:()=>{clearTimeout(k)},participantIdentity:i});const y=setTimeout(()=>{this.pendingResponses.delete(m),c(dt.builtIn("RESPONSE_TIMEOUT"))},a);this.pendingResponses.set(m,{resolve:(w,T)=>{clearTimeout(y),this.pendingAcks.has(m)&&(console.warn("RPC response received before ack",m),this.pendingAcks.delete(m),clearTimeout(k)),T?c(T):u(w??"")},participantIdentity:i})}))}()})}registerRpcMethod(e,n){this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,r){const i=this.pendingResponses.get(e);i?(i.resolve(n,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}handleIncomingRpcRequest(e,n,r,i,s,o){return F(this,void 0,void 0,function*(){if(yield this.publishRpcAck(e,n),o!==1){yield this.publishRpcResponse(e,n,null,dt.builtIn("UNSUPPORTED_VERSION"));return}const a=this.rpcHandlers.get(r);if(!a){yield this.publishRpcResponse(e,n,null,dt.builtIn("UNSUPPORTED_METHOD"));return}let l=null,u=null;try{const c=yield a({requestId:n,callerIdentity:e,payload:i,responseTimeout:s});Vb(c)>RC?(l=dt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):u=c}catch(c){c instanceof dt?l=c:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),c),l=dt.builtIn("APPLICATION_ERROR"))}yield this.publishRpcResponse(e,n,u,l)})}publishRpcRequest(e,n,r,i,s){return F(this,void 0,void 0,function*(){const o=new is({destinationIdentities:[e],kind:et.RELIABLE,value:{case:"rpcRequest",value:new ID({id:n,method:r,payload:i,responseTimeoutMs:s,version:1})}});yield this.engine.sendDataPacket(o,et.RELIABLE)})}publishRpcResponse(e,n,r,i){return F(this,void 0,void 0,function*(){const s=new is({destinationIdentities:[e],kind:et.RELIABLE,value:{case:"rpcResponse",value:new RD({requestId:n,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:r??""}})}});yield this.engine.sendDataPacket(s,et.RELIABLE)})}publishRpcAck(e,n){return F(this,void 0,void 0,function*(){const r=new is({destinationIdentities:[e],kind:et.RELIABLE,value:{case:"rpcAck",value:new PD({requestId:n})}});yield this.engine.sendDataPacket(r,et.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:r,resolve:i}]of this.pendingResponses)r===e&&(i(null,dt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var r,i;const s=this.trackPublications.get(n.sid);if(s){const o=s.isMuted||((i=(r=s.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&i!==void 0?i:!1);o!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),qe(s)),{mutedOnServer:o})),this.engine.client.sendMuteTrack(n.sid,o))}}),!0)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(r=>{const i=r.track;i&&(e instanceof MediaStreamTrack?(i instanceof Ut||i instanceof Jt)&&i.mediaStreamTrack===e&&(n=r):e===i&&(n=r))}),n}waitForPendingPublicationOfSource(e){return F(this,void 0,void 0,function*(){const r=Date.now();for(;Date.now()<r+1e4;){const i=Array.from(this.pendingPublishPromises.entries()).find(s=>{let[o]=s;return o.source===e});if(i)return i[1];yield Rr(20)}})}}class Lc extends ls{constructor(e,n,r,i){super(e,n.sid,n.name,i),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=or.HIGH,this.handleEnded=s=>{this.setTrack(void 0),this.emit(ee.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensions=s,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new vm({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new ND({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ee.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?ls.SubscriptionStatus.Unsubscribed:super.isSubscribed?ls.SubscriptionStatus.Subscribed:ls.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?ls.PermissionStatus.Allowed:ls.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.videoDimensions)===null||r===void 0?void 0:r.height)===e.height||(this.track instanceof Qu&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof Qu&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(ee.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(ee.VisibilityChanged,this.handleVisibilityChange),i.off(ee.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(ee.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ee.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ee.VisibilityChanged,this.handleVisibilityChange),e.on(ee.Ended,this.handleEnded),this.emit(ee.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ee.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ee.Muted:ee.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ee.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ee.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===$.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof Qu&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new UD({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=or.HIGH,this.emit(ee.UpdateSettings,e)}}class ip extends FL{static fromParticipantInfo(e,n,r){return new ip(e,n.sid,n.identity,n.name,n.metadata,n.attributes,r,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,r,i,s,o,a){let l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:np.STANDARD;super(n,r||"",i,s,o,a,l),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ee.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),qe(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ee.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ee.SubscriptionPermissionChanged,n=>{this.emit(B.TrackSubscriptionPermissionChanged,e,n)}),e.on(ee.SubscriptionStatusChanged,n=>{this.emit(B.TrackSubscriptionStatusChanged,e,n)}),e.on(ee.Subscribed,n=>{this.emit(B.TrackSubscribed,n,e)}),e.on(ee.Unsubscribed,n=>{this.emit(B.TrackUnsubscribed,n,e)}),e.on(ee.SubscriptionFailed,n=>{this.emit(B.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrackPublication(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,i,s,o){let a=this.getTrackPublicationBySid(n);if(a||n.startsWith("TR")||this.trackPublications.forEach(c=>{!a&&e.kind===c.kind.toString()&&(a=c)}),!a){if(o===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(B.TrackSubscriptionFailed,n);return}o===void 0&&(o=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,i,s,o-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),qe(a))),this.emit(B.TrackSubscriptionFailed,n);return}const l=e.kind==="video";let u;return l?u=new Qu(e,n,i,s):u=new Ha(e,n,i,this.audioContext,this.audioOutput),u.source=a.source,u.isMuted=a.isMuted,u.setMediaStream(r),u.start(),a.setTrack(u),this.volumeMap.has(a.source)&&u instanceof Ha&&u.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(i=>{var s,o;let a=this.getTrackPublicationBySid(i.sid);if(a)a.updateInfo(i);else{const l=$.kindFromProto(i.type);if(!l)return;a=new Lc(l,i,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(o=this.loggerOptions)===null||o===void 0?void 0:o.loggerName}),a.updateInfo(i),r.set(i.sid,a);const u=Array.from(this.trackPublications.values()).find(c=>c.source===(a==null?void 0:a.source));u&&a.source!==$.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(a.source),Object.assign(Object.assign({},this.logContext),{oldTrack:qe(u),newTrack:qe(a)})),this.addTrackPublication(a)}n.set(i.sid,a)}),this.trackPublications.forEach(i=>{n.has(i.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),qe(i))),this.unpublishTrack(i.trackSid,!0))}),r.forEach(i=>{this.emit(B.TrackPublished,i)}),!0}unpublishTrack(e,n){const r=this.trackPublications.get(e);if(!r)return;const{track:i}=r;switch(i&&(i.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case $.Kind.Audio:this.audioTrackPublications.delete(e);break;case $.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(B.TrackUnpublished,r)}setAudioOutput(e){return F(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(r=>{var i;r.track instanceof Ha&&n.push(r.track.setSinkId((i=e.deviceId)!==null&&i!==void 0?i:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var Ie;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting"})(Ie||(Ie={}));const DX=4*1e3;class Bi extends ci.EventEmitter{constructor(e){var n,r,i,s;if(super(),n=this,this.state=Ie.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Ee,this.bufferedEvents=[],this.isResuming=!1,this.connect=(o,a,l)=>F(this,void 0,void 0,function*(){var u;if(!qY())throw Vi()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const c=yield this.disconnectLock.lock();if(this.state===Ie.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(Ie.Connecting),((u=this.regionUrlProvider)===null||u===void 0?void 0:u.getServerUrl().toString())!==o&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Mb(new URL(o))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new PC(o,a):this.regionUrlProvider.updateToken(a),this.regionUrlProvider.fetchRegionSettings().then(p=>{var g;(g=this.regionUrlProvider)===null||g===void 0||g.setServerReportedRegions(p)}).catch(p=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:p}))}));const d=(p,g,m)=>F(this,void 0,void 0,function*(){var k,y;this.abortController&&this.abortController.abort();const w=new AbortController;this.abortController=w,c==null||c();try{yield this.attemptConnection(m??o,a,l,w),this.abortController=void 0,p()}catch(T){if(this.regionUrlProvider&&T instanceof He&&T.reason!==Oe.Cancelled&&T.reason!==Oe.NotAllowed){let x=null;try{x=yield this.regionUrlProvider.getNextBestRegionUrl((k=this.abortController)===null||k===void 0?void 0:k.signal)}catch(I){if(I instanceof He&&(I.status===401||I.reason===Oe.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),g(I);return}}x&&!(!((y=this.abortController)===null||y===void 0)&&y.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(T.message,". Retrying with another region: ").concat(x),this.logContext),this.recreateEngine(),yield d(p,g,x)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,pC(T)),g(T))}else{let x=Cr.UNKNOWN_REASON;T instanceof He&&(x=pC(T)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,x),g(T)}}}),h=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new AL((p,g)=>{d(p,g,h)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(o,a,l,u,c,d)=>F(this,void 0,void 0,function*(){var h,p,g;const m=yield l.join(o,a,{autoSubscribe:u.autoSubscribe,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:u.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:u.websocketTimeout},d.signal);let k=m.serverInfo;if(k||(k={version:m.serverVersion,region:m.serverRegion}),this.serverInfo=k,this.log.debug("connected to Livekit Server ".concat(Object.entries(k).map(y=>{let[w,T]=y;return"".concat(w,": ").concat(T)}).join(", ")),{room:(h=m.room)===null||h===void 0?void 0:h.name,roomSid:(p=m.room)===null||p===void 0?void 0:p.sid,identity:(g=m.participant)===null||g===void 0?void 0:g.identity}),!k.version)throw new _Y("unknown server version");return k.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),c.dynacast=!1),m}),this.applyJoinResponse=o=>{const a=o.participant;if(this.localParticipant.sid=a.sid,this.localParticipant.identity=a.identity,this.localParticipant.setEnabledPublishCodecs(o.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(o.sifTrailer)}catch(l){this.log.error(l instanceof Error?l.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:l}))}this.handleParticipantUpdates([a,...o.otherParticipants]),o.room&&this.handleRoomUpdate(o.room)},this.attemptConnection=(o,a,l,u)=>F(this,void 0,void 0,function*(){var c,d;this.state===Ie.Reconnecting||this.isResuming||!((c=this.engine)===null||c===void 0)&&c.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((d=this.regionUrlProvider)===null||d===void 0)&&d.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Sw),l),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const h=yield this.connectSignal(o,a,this.engine,this.connOptions,this.options,u);this.applyJoinResponse(h),this.setupLocalParticipantEvents(),this.emit(V.SignalConnected)}catch(h){yield this.engine.close(),this.recreateEngine();const p=new He("could not establish signal connection",Oe.ServerUnreachable);throw h instanceof Error&&(p.message="".concat(p.message,": ").concat(h.message)),h instanceof He&&(p.reason=h.reason,p.status=h.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:h})),p}if(u.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new He("Connection attempt aborted",Oe.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,u)}catch(h){throw yield this.engine.close(),this.recreateEngine(),h}Sn()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Sn()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ie.Connected),this.emit(V.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return F(n,[...a],void 0,function(){var u=this;let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var d,h,p,g;const m=yield u.disconnectLock.lock();try{if(u.state===Ie.Disconnected){u.log.debug("already disconnected",u.logContext);return}u.log.info("disconnect from room",Object.assign({},u.logContext)),(u.state===Ie.Connecting||u.state===Ie.Reconnecting||u.isResuming)&&(u.log.warn("abort connection attempt",u.logContext),(d=u.abortController)===null||d===void 0||d.abort(),(p=(h=u.connectFuture)===null||h===void 0?void 0:h.reject)===null||p===void 0||p.call(h,new He("Client initiated disconnect",Oe.Cancelled)),u.connectFuture=void 0),!((g=u.engine)===null||g===void 0)&&g.client.isDisconnected||(yield u.engine.client.sendLeave()),u.engine&&(yield u.engine.close()),u.handleDisconnect(c,Cr.CLIENT_INITIATED),u.engine=void 0}finally{m()}}()})},this.onPageLeave=()=>F(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>F(this,void 0,void 0,function*(){const o=[],a=li();if(a&&a.os==="iOS"){const l="livekit-dummy-audio-el";let u=document.getElementById(l);if(!u){u=document.createElement("audio"),u.id=l,u.autoplay=!0,u.hidden=!0;const c=uy();c.enabled=!0;const d=new MediaStream([c]);u.srcObject=d,document.addEventListener("visibilitychange",()=>{u&&(u.srcObject=document.hidden?null:d,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(u),this.once(V.Disconnected,()=>{u==null||u.remove(),u=null})}o.push(u)}this.remoteParticipants.forEach(l=>{l.audioTrackPublications.forEach(u=>{u.track&&u.track.attachedElements.forEach(c=>{o.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...o.map(l=>(l.muted=!1,l.play()))]),this.handleAudioPlaybackStarted()}catch(l){throw this.handleAudioPlaybackFailed(l),l}}),this.startVideo=()=>F(this,void 0,void 0,function*(){const o=[];for(const a of this.remoteParticipants.values())a.videoTrackPublications.forEach(l=>{var u;(u=l.track)===null||u===void 0||u.attachedElements.forEach(c=>{o.includes(c)||o.push(c)})});yield Promise.all(o.map(a=>a.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(a=>{a.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const o of this.remoteParticipants.values())this.handleParticipantDisconnected(o.identity,o);this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(V.Reconnecting)},this.handleSignalRestarted=o=>F(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(o.serverRegion),Object.assign(Object.assign({},this.logContext),{region:o.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(o);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(a){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:a}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:o.serverRegion}))}catch{return}this.setAndEmitConnectionState(Ie.Connected),this.emit(V.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=o=>{o.forEach(a=>{var l;if(a.identity===this.localParticipant.identity){this.localParticipant.updateInfo(a);return}a.identity===""&&(a.identity=(l=this.sidToIdentity.get(a.sid))!==null&&l!==void 0?l:"");let u=this.remoteParticipants.get(a.identity);a.state===gb.DISCONNECTED?this.handleParticipantDisconnected(a.identity,u):u=this.getOrCreateParticipant(a.identity,a)})},this.handleActiveSpeakersUpdate=o=>{const a=[],l={};o.forEach(u=>{if(l[u.sid]=!0,u.sid===this.localParticipant.sid)this.localParticipant.audioLevel=u.level,this.localParticipant.setIsSpeaking(!0),a.push(this.localParticipant);else{const c=this.getRemoteParticipantBySid(u.sid);c&&(c.audioLevel=u.level,c.setIsSpeaking(!0),a.push(c))}}),l[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(u=>{l[u.sid]||(u.audioLevel=0,u.setIsSpeaking(!1))}),this.activeSpeakers=a,this.emitWhenConnected(V.ActiveSpeakersChanged,a)},this.handleSpeakersChanged=o=>{const a=new Map;this.activeSpeakers.forEach(u=>{const c=this.remoteParticipants.get(u.identity);c&&c.sid!==u.sid||a.set(u.sid,u)}),o.forEach(u=>{let c=this.getRemoteParticipantBySid(u.sid);u.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=u.level,c.setIsSpeaking(u.active),u.active?a.set(u.sid,c):a.delete(u.sid))});const l=Array.from(a.values());l.sort((u,c)=>c.audioLevel-u.audioLevel),this.activeSpeakers=l,this.emitWhenConnected(V.ActiveSpeakersChanged,l)},this.handleStreamStateUpdate=o=>{o.streamStates.forEach(a=>{const l=this.getRemoteParticipantBySid(a.participantSid);if(!l)return;const u=l.getTrackPublicationBySid(a.trackSid);if(!u||!u.track)return;const c=$.streamStateFromProto(a.state);c!==u.track.streamState&&(u.track.streamState=c,l.emit(B.TrackStreamStateChanged,u,u.track.streamState),this.emitWhenConnected(V.TrackStreamStateChanged,u,u.track.streamState,l))})},this.handleSubscriptionPermissionUpdate=o=>{const a=this.getRemoteParticipantBySid(o.participantSid);if(!a)return;const l=a.getTrackPublicationBySid(o.trackSid);l&&l.setAllowed(o.allowed)},this.handleSubscriptionError=o=>{const a=Array.from(this.remoteParticipants.values()).find(u=>u.trackPublications.has(o.trackSid));if(!a)return;const l=a.getTrackPublicationBySid(o.trackSid);l&&l.setSubscriptionError(o.err)},this.handleDataPacket=o=>{const a=this.remoteParticipants.get(o.participantIdentity);o.value.case==="user"?this.handleUserPacket(a,o.value.value,o.kind):o.value.case==="transcription"?this.handleTranscription(a,o.value.value):o.value.case==="sipDtmf"?this.handleSipDtmf(a,o.value.value):o.value.case==="chatMessage"?this.handleChatMessage(a,o.value.value):o.value.case==="metrics"&&this.handleMetrics(o.value.value,a)},this.handleUserPacket=(o,a,l)=>{this.emit(V.DataReceived,a.payload,o,l,a.topic),o==null||o.emit(B.DataReceived,a.payload,l)},this.handleSipDtmf=(o,a)=>{this.emit(V.SipDTMFReceived,a,o),o==null||o.emit(B.SipDTMFReceived,a)},this.bufferedSegments=new Map,this.handleTranscription=(o,a)=>{const l=a.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(a.transcribedParticipantIdentity),u=l==null?void 0:l.trackPublications.get(a.trackId),c=XY(a,this.transcriptionReceivedTimes);u==null||u.emit(ee.TranscriptionReceived,c),l==null||l.emit(B.TranscriptionReceived,c,u),this.emit(V.TranscriptionReceived,c,l,u)},this.handleChatMessage=(o,a)=>{const l=ZY(a);this.emit(V.ChatMessage,l,o)},this.handleMetrics=(o,a)=>{this.emit(V.MetricsReceived,o,a)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(V.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=o=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:o})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(V.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(V.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(V.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>F(this,void 0,void 0,function*(){var o,a;const l=Nt.getInstance().previousDevices,u=yield Nt.getInstance().getDevices(void 0,!1),c=li();if((c==null?void 0:c.name)==="Chrome"&&c.os!=="iOS")for(let h of u){const p=l.find(g=>g.deviceId===h.deviceId);p&&p.label!==""&&p.kind===h.kind&&p.label!==h.label&&this.getActiveDevice(h.kind)==="default"&&this.emit(V.ActiveDeviceChanged,h.kind,h.deviceId)}const d=["audiooutput","audioinput","videoinput"];for(let h of d){const p=u.filter(m=>m.kind===h),g=this.getActiveDevice(h);if(g===((o=l.filter(m=>m.kind===h)[0])===null||o===void 0?void 0:o.deviceId)&&p.length>0&&((a=p[0])===null||a===void 0?void 0:a.deviceId)!==g){yield this.switchActiveDevice(h,p[0].deviceId);continue}h==="audioinput"&&!Bs()||h==="videoinput"||p.length>0&&!p.find(m=>m.deviceId===this.getActiveDevice(h))&&(yield this.switchActiveDevice(h,p[0].deviceId))}this.emit(V.MediaDevicesChanged)}),this.handleRoomUpdate=o=>{const a=this.roomInfo;this.roomInfo=o,a&&a.metadata!==o.metadata&&this.emitWhenConnected(V.RoomMetadataChanged,o.metadata),(a==null?void 0:a.activeRecording)!==o.activeRecording&&this.emitWhenConnected(V.RecordingStatusChanged,o.activeRecording)},this.handleConnectionQualityUpdate=o=>{o.updates.forEach(a=>{if(a.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(a.quality);return}const l=this.getRemoteParticipantBySid(a.participantSid);l&&l.setConnectionQuality(a.quality)})},this.onLocalParticipantMetadataChanged=o=>{this.emit(V.ParticipantMetadataChanged,o,this.localParticipant)},this.onLocalParticipantNameChanged=o=>{this.emit(V.ParticipantNameChanged,o,this.localParticipant)},this.onLocalAttributesChanged=o=>{this.emit(V.ParticipantAttributesChanged,o,this.localParticipant)},this.onLocalTrackMuted=o=>{this.emit(V.TrackMuted,o,this.localParticipant)},this.onLocalTrackUnmuted=o=>{this.emit(V.TrackUnmuted,o,this.localParticipant)},this.onTrackProcessorUpdate=o=>{var a;(a=o==null?void 0:o.onPublish)===null||a===void 0||a.call(o,this)},this.onLocalTrackPublished=o=>F(this,void 0,void 0,function*(){var a,l,u,c,d,h;(a=o.track)===null||a===void 0||a.on(ee.TrackProcessorUpdate,this.onTrackProcessorUpdate),(l=o.track)===null||l===void 0||l.on(ee.Restarted,this.onLocalTrackRestarted),(d=(c=(u=o.track)===null||u===void 0?void 0:u.getProcessor())===null||c===void 0?void 0:c.onPublish)===null||d===void 0||d.call(c,this),this.emit(V.LocalTrackPublished,o,this.localParticipant),o.track instanceof Ut&&(yield o.track.checkForSilence())&&this.emit(V.LocalAudioSilenceDetected,o);const p=yield(h=o.track)===null||h===void 0?void 0:h.getDeviceId(!1),g=aC(o.source);g&&p&&p!==this.localParticipant.activeDeviceMap.get(g)&&(this.localParticipant.activeDeviceMap.set(g,p),this.emit(V.ActiveDeviceChanged,g,p))}),this.onLocalTrackUnpublished=o=>{var a,l;(a=o.track)===null||a===void 0||a.off(ee.TrackProcessorUpdate,this.onTrackProcessorUpdate),(l=o.track)===null||l===void 0||l.off(ee.Restarted,this.onLocalTrackRestarted),this.emit(V.LocalTrackUnpublished,o,this.localParticipant)},this.onLocalTrackRestarted=o=>F(this,void 0,void 0,function*(){const a=yield o.getDeviceId(!1),l=aC(o.source);l&&a&&a!==this.localParticipant.activeDeviceMap.get(l)&&(this.log.debug("local track restarted, setting ".concat(l," ").concat(a," active"),this.logContext),this.localParticipant.activeDeviceMap.set(l,a),this.emit(V.ActiveDeviceChanged,l,a))}),this.onLocalConnectionQualityChanged=o=>{this.emit(V.ConnectionQualityChanged,o,this.localParticipant)},this.onMediaDevicesError=o=>{this.emit(V.MediaDevicesError,o)},this.onLocalParticipantPermissionsChanged=o=>{this.emit(V.ParticipantPermissionsChanged,o,this.localParticipant)},this.onLocalChatMessageSent=o=>{this.emit(V.ChatMessage,o,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},hX),e),this.log=ji((r=this.options.loggerName)!==null&&r!==void 0?r:Or.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},NL),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},OL),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},fX),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Tn,this.localParticipant=new NC("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",So(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",So(this.options.audioCaptureDefaults.deviceId)),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&this.switchActiveDevice("audiooutput",So(this.options.audioOutput.deviceId)).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),Sn()){const o=new AbortController;(s=navigator.mediaDevices)===null||s===void 0||s.addEventListener("devicechange",this.handleDeviceChange,{signal:o.signal}),Bi.cleanupRegistry&&Bi.cleanupRegistry.register(this,()=>{o.abort()})}}setE2EEEnabled(e){return F(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new tX(this.options.e2ee),this.e2eeManager.on(vs.ParticipantEncryptionStatusChanged,(n,r)=>{r instanceof NC&&(this.isE2EEEnabled=n),this.emit(V.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(vs.EncryptionError,n=>this.emit(V.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return F(this,void 0,void 0,function*(){return this.state===Ie.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const r=i=>{i.sid!==""&&(this.engine.off(ne.RoomUpdate,r),e(i.sid))};this.engine.on(ne.RoomUpdate,r),this.once(V.Disconnected,()=>{this.engine.off(ne.RoomUpdate,r),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new xX(this.options),this.engine.on(ne.ParticipantUpdate,this.handleParticipantUpdates).on(ne.RoomUpdate,this.handleRoomUpdate).on(ne.SpeakersChanged,this.handleSpeakersChanged).on(ne.StreamStateChanged,this.handleStreamStateUpdate).on(ne.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ne.SubscriptionError,this.handleSubscriptionError).on(ne.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ne.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(ne.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ne.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ne.DataPacketReceived,this.handleDataPacket).on(ne.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ie.SignalReconnecting)&&this.emit(V.SignalReconnecting)}).on(ne.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ie.Connected)&&this.emit(V.Reconnected)}).on(ne.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Ie.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(ne.Restarting,this.handleRestarting).on(ne.SignalRestarted,this.handleSignalRestarted).on(ne.Offline,()=>{this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(V.Reconnecting)}).on(ne.DCBufferStatusChanged,(e,n)=>{this.emit(V.DCBufferStatusChanged,e,n)}).on(ne.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:i}=r;return i===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(B.LocalTrackSubscribed,n),this.emitWhenConnected(V.LocalTrackSubscribed,n,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Nt.getInstance().getDevices(e,n)}prepareConnection(e,n){return F(this,void 0,void 0,function*(){if(this.state===Ie.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Mb(new URL(e))&&n){this.regionUrlProvider=new PC(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Ie.Disconnected&&(this.regionUrl=r,yield fetch(hC(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(hC(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return F(this,void 0,void 0,function*(){let r=()=>{},i;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":i=new Hr({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":i=new Hr({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":i=new Hr({scenario:{case:"serverLeave",value:!0}});break;case"migration":i=new Hr({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>F(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Hr({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>F(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),i=new Hr({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":i=new Hr({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>F(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new bm({reason:Cr.CLIENT_INITIATED,action:Ba.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");i=new Hr({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break;case"leave-full-reconnect":i=new Hr({scenario:{case:"leaveRequestFullReconnect",value:!0}})}i&&(yield this.engine.client.sendSimulateScenario(i),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return F(this,arguments,void 0,function(r,i){var s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var a,l,u,c,d,h,p;let g=!0,m=!1;const k=o?{exact:i}:i;if(r==="audioinput"){m=s.localParticipant.audioTrackPublications.size===0;const y=(a=s.getActiveDevice(r))!==null&&a!==void 0?a:s.options.audioCaptureDefaults.deviceId;s.options.audioCaptureDefaults.deviceId=k;const w=Array.from(s.localParticipant.audioTrackPublications.values()).filter(T=>T.source===$.Source.Microphone);try{g=(yield Promise.all(w.map(T=>{var x;return(x=T.audioTrack)===null||x===void 0?void 0:x.setDeviceId(k)}))).every(T=>T===!0)}catch(T){throw s.options.audioCaptureDefaults.deviceId=y,T}}else if(r==="videoinput"){m=s.localParticipant.videoTrackPublications.size===0;const y=(l=s.getActiveDevice(r))!==null&&l!==void 0?l:s.options.videoCaptureDefaults.deviceId;s.options.videoCaptureDefaults.deviceId=k;const w=Array.from(s.localParticipant.videoTrackPublications.values()).filter(T=>T.source===$.Source.Camera);try{g=(yield Promise.all(w.map(T=>{var x;return(x=T.videoTrack)===null||x===void 0?void 0:x.setDeviceId(k)}))).every(T=>T===!0)}catch(T){throw s.options.videoCaptureDefaults.deviceId=y,T}}else if(r==="audiooutput"){if(!Lb()&&!s.options.webAudioMix||s.options.webAudioMix&&s.audioContext&&!("setSinkId"in s.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");s.options.webAudioMix&&(i=(u=yield Nt.getInstance().normalizeDeviceId("audiooutput",i))!==null&&u!==void 0?u:""),(c=(p=s.options).audioOutput)!==null&&c!==void 0||(p.audioOutput={});const y=(d=s.getActiveDevice(r))!==null&&d!==void 0?d:s.options.audioOutput.deviceId;s.options.audioOutput.deviceId=i;try{s.options.webAudioMix&&((h=s.audioContext)===null||h===void 0||h.setSinkId(i)),yield Promise.all(Array.from(s.remoteParticipants.values()).map(w=>w.setAudioOutput({deviceId:i})))}catch(w){throw s.options.audioOutput.deviceId=y,w}}return m&&(s.localParticipant.activeDeviceMap.set(r,i),s.emit(V.ActiveDeviceChanged,r,i)),g}()})}setupLocalParticipantEvents(){this.localParticipant.on(B.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(B.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(B.AttributesChanged,this.onLocalAttributesChanged).on(B.TrackMuted,this.onLocalTrackMuted).on(B.TrackUnmuted,this.onLocalTrackUnmuted).on(B.LocalTrackPublished,this.onLocalTrackPublished).on(B.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(B.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(B.MediaDevicesError,this.onMediaDevicesError).on(B.AudioStreamAcquired,this.startAudio).on(B.ChatMessage,this.onLocalChatMessageSent).on(B.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===Ie.Connecting||this.state===Ie.Reconnecting){const c=()=>{this.onTrackAdded(e,n,r),d()},d=()=>{this.off(V.Reconnected,c),this.off(V.Connected,c),this.off(V.Disconnected,d)};this.once(V.Reconnected,c),this.once(V.Connected,c),this.once(V.Disconnected,d);return}if(this.state===Ie.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const i=BY(n.id),s=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=Array.from(this.remoteParticipants.values()).find(c=>c.sid===s);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}let u;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?u=this.options.adaptiveStream:u={}),l.addSubscribedMediaTrack(e,a,n,r,u)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==Ie.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(i=>{i.trackPublications.forEach(s=>{i.unpublishTrack(s.trackSid)})}),this.localParticipant.trackPublications.forEach(i=>{var s,o,a;i.track&&this.localParticipant.unpublishTrack(i.track,e),e?((s=i.track)===null||s===void 0||s.detach(),(o=i.track)===null||o===void 0||o.stop()):(a=i.track)===null||a===void 0||a.stopMonitor()}),this.localParticipant.off(B.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(B.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(B.AttributesChanged,this.onLocalAttributesChanged).off(B.TrackMuted,this.onLocalTrackMuted).off(B.TrackUnmuted,this.onLocalTrackUnmuted).off(B.LocalTrackPublished,this.onLocalTrackPublished).off(B.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(B.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(B.MediaDevicesError,this.onMediaDevicesError).off(B.AudioStreamAcquired,this.startAudio).off(B.ChatMessage,this.onLocalChatMessageSent).off(B.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Sn()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ie.Disconnected),this.emit(V.Disconnected,n)}}}handleParticipantDisconnected(e,n){var r;this.remoteParticipants.delete(e),n&&(n.trackPublications.forEach(i=>{n.unpublishTrack(i.trackSid,!0)}),this.emit(V.ParticipantDisconnected,n),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(n.identity))}acquireAudioContext(){return F(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=xL())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(i){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:i}))}this.options.webAudioMix&&this.remoteParticipants.forEach(i=>i.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(V.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let i;return n?i=ip.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):i=new ip(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&i.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),i}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const i=this.remoteParticipants.get(e);return n&&i.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),i}const r=this.createParticipant(e,n);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(V.ParticipantConnected,r),r.on(B.TrackPublished,i=>{this.emitWhenConnected(V.TrackPublished,i,r)}).on(B.TrackSubscribed,(i,s)=>{i.kind===$.Kind.Audio?(i.on(ee.AudioPlaybackStarted,this.handleAudioPlaybackStarted),i.on(ee.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):i.kind===$.Kind.Video&&(i.on(ee.VideoPlaybackFailed,this.handleVideoPlaybackFailed),i.on(ee.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(V.TrackSubscribed,i,s,r)}).on(B.TrackUnpublished,i=>{this.emit(V.TrackUnpublished,i,r)}).on(B.TrackUnsubscribed,(i,s)=>{this.emit(V.TrackUnsubscribed,i,s,r)}).on(B.TrackSubscriptionFailed,i=>{this.emit(V.TrackSubscriptionFailed,i,r)}).on(B.TrackMuted,i=>{this.emitWhenConnected(V.TrackMuted,i,r)}).on(B.TrackUnmuted,i=>{this.emitWhenConnected(V.TrackUnmuted,i,r)}).on(B.ParticipantMetadataChanged,i=>{this.emitWhenConnected(V.ParticipantMetadataChanged,i,r)}).on(B.ParticipantNameChanged,i=>{this.emitWhenConnected(V.ParticipantNameChanged,i,r)}).on(B.AttributesChanged,i=>{this.emitWhenConnected(V.ParticipantAttributesChanged,i,r)}).on(B.ConnectionQualityChanged,i=>{this.emitWhenConnected(V.ConnectionQualityChanged,i,r)}).on(B.ParticipantPermissionsChanged,i=>{this.emitWhenConnected(V.ParticipantPermissionsChanged,i,r)}).on(B.TrackSubscriptionStatusChanged,(i,s)=>{this.emitWhenConnected(V.TrackSubscriptionStatusChanged,i,s,r)}).on(B.TrackSubscriptionFailed,(i,s)=>{this.emit(V.TrackSubscriptionFailed,i,r,s)}).on(B.TrackSubscriptionPermissionChanged,(i,s)=>{this.emitWhenConnected(V.TrackSubscriptionPermissionChanged,i,s,r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,i)=>(r.push(...i.getTrackPublications()),r),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&n instanceof Lc&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Vt.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Cr.STATE_MISMATCH))):e=0},DX)}clearConnectionReconcile(){this.connectionReconcileInterval&&Vt.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(V.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(this.state===Ie.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===Ie.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return F(this,void 0,void 0,function*(){var n,r;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new dw({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:st.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Ac({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(V.SignalConnected),this.emit(V.Connected),this.setAndEmitConnectionState(Ie.Connected),i.video){const o=new Dc($.Kind.Video,new xa({source:Yt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Sr.AUDIO,name:"video-dummy"}),new Jt(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:fC(160*((n=s.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(B.LocalTrackPublished,o)}if(i.audio){const o=new Dc($.Kind.Audio,new xa({source:Yt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Sr.AUDIO}),new Ut(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:uy(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(o),this.localParticipant.emit(B.LocalTrackPublished,o)}for(let o=0;o<s.count-1;o+=1){let a=new Ac({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(o),state:gb.ACTIVE,tracks:[],joinedAt:st.parse(Date.now())});const l=this.getOrCreateParticipant(a.identity,a);if(s.video){const u=fC(160*((r=s.aspectRatios[o%s.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),c=new xa({source:Yt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:Sr.AUDIO});l.addSubscribedMediaTrack(u,c.sid,new MediaStream([u]),new RTCRtpReceiver),a.tracks=[...a.tracks,c]}if(s.audio){const u=uy(),c=new xa({source:Yt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:Sr.AUDIO});l.addSubscribedMediaTrack(u,c.sid,new MediaStream([u]),new RTCRtpReceiver),a.tracks=[...a.tracks,c]}l.updateInfo(a)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(e!==V.ActiveSpeakersChanged){const s=jL(r).filter(o=>o!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s}))}return super.emit(e,...r)}}Bi.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{t()});function jL(t){return t.map(e=>{if(e)return Array.isArray(e)?jL(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var wr;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(wr||(wr={}));class Rl extends ci.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=wr.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Bi(r.roomOptions),this.connectOptions=r.connectOptions,r.errorsAsWarnings&&(this.errorsAsWarnings=r.errorsAsWarnings)}run(e){return F(this,void 0,void 0,function*(){if(this.status!==wr.IDLE)throw Error("check is running already");this.setStatus(wr.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==wr.SKIPPED&&this.setStatus(this.isSuccess()?wr.SUCCESS:wr.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return F(this,void 0,void 0,function*(){return this.room.state===Ie.Connected?this.room:(yield this.room.connect(this.url,this.token,this.connectOptions),this.room)})}disconnect(){return F(this,void 0,void 0,function*(){this.room&&this.room.state!==Ie.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(wr.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function Ew(t){return F(this,void 0,void 0,function*(){var e,n;t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio={deviceId:"default"}),(n=t.video)!==null&&n!==void 0||(t.video={deviceId:"default"});const{audioProcessor:r,videoProcessor:i}=kw(t),s=CL(t,NL,OL),o=wm(s),a=navigator.mediaDevices.getUserMedia(o);t.audio&&(Nt.userMediaPromiseMap.set("audioinput",a),a.catch(()=>Nt.userMediaPromiseMap.delete("audioinput"))),t.video&&(Nt.userMediaPromiseMap.set("videoinput",a),a.catch(()=>Nt.userMediaPromiseMap.delete("videoinput")));const l=yield a;return Promise.all(l.getTracks().map(u=>F(this,void 0,void 0,function*(){const c=u.kind==="audio";c?s.audio:s.video;let d;const h=c?o.audio:o.video;typeof h!="boolean"&&(d=h),d?d.deviceId=u.getSettings().deviceId:d={deviceId:u.getSettings().deviceId};const p=DL(u,d);return p.kind===$.Kind.Video?p.source=$.Source.Camera:p.kind===$.Kind.Audio&&(p.source=$.Source.Microphone),p.mediaStream=l,p instanceof Ut&&r?yield p.setProcessor(r):p instanceof Jt&&i&&(yield p.setProcessor(i)),p})))})}function LX(t){return F(this,void 0,void 0,function*(){return(yield Ew({audio:!1,video:t}))[0]})}function MX(t){return F(this,void 0,void 0,function*(){return(yield Ew({audio:t,video:!1}))[0]})}class UX extends Rl{get description(){return"Can publish audio"}perform(){return F(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield MX();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,3e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="audio"||!o.kind&&o.mediaType==="audio")&&(s=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class FX extends Rl{get description(){return"Can publish video"}perform(){return F(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield LX();n.localParticipant.publishTrack(r),yield new Promise(o=>setTimeout(o,5e3));const i=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!i)throw new Error("Could not get RTCStats");let s=0;if(i.forEach(o=>{o.type==="outbound-rtp"&&(o.kind==="video"||!o.kind&&o.mediaType==="video")&&(s+=o.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class jX extends Rl{get description(){return"Resuming connection after interruption"}perform(){return F(this,void 0,void 0,function*(){var e;const n=yield this.connect();let r=!1,i=!1,s;const o=new Promise(u=>{setTimeout(u,5e3),s=u}),a=()=>{r=!0};n.on(V.SignalReconnecting,a).on(V.Reconnecting,a).on(V.Reconnected,()=>{i=!0,s(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const l=n.engine.client.onClose;if(l&&l(""),yield o,r){if(!i||n.state!==Ie.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class VX extends Rl{get description(){return"Can connect via TURN"}perform(){return F(this,void 0,void 0,function*(){var e,n;const r=new ww,i=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,o=!1,a=!1;for(let l of i.iceServers)for(let u of l.urls)u.startsWith("turn:")?(o=!0,a=!0):u.startsWith("turns:")&&(o=!0,a=!0,s=!0),u.startsWith("stun:")&&(a=!0);a?o&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||o?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(l=>setTimeout(l,0)))})}}class BX extends Rl{get description(){return"Establishing WebRTC connection"}perform(){return F(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(V.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(i,s)=>{if(i.candidate){const o=new RTCIceCandidate(i);let a="".concat(o.protocol," ").concat(o.address,":").concat(o.port," ").concat(o.type);o.address&&($X(o.address)?a+=" (private)":o.protocol==="tcp"&&o.tcpType==="passive"?(e=!0,a+=" (passive)"):o.protocol==="udp"&&(n=!0)),this.appendMessage(a)}r&&r(i,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=i=>{i instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(i.errorCode," ").concat(i.errorText," ").concat(i.url))})});try{yield this.connect(),Ee.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function $X(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class zX extends Rl{get description(){return"Connecting to signal connection via WebSocket"}perform(){return F(this,void 0,void 0,function*(){var e,n,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let i=new ww;const s=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===OD.Cloud&&(!((n=s.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=s.serverInfo)===null||r===void 0?void 0:r.region)),yield i.close()})}}class Uie extends ci.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:wr.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==wr.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return F(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token,this.options),i=o=>{this.updateCheck(n,o)};r.on("update",i);const s=yield r.run();return r.off("update",i),s})}checkWebsocket(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(zX)})}checkWebRTC(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(BX)})}checkTURN(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(VX)})}checkReconnect(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(jX)})}checkPublishAudio(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(UX)})}checkPublishVideo(){return F(this,void 0,void 0,function*(){return this.createAndRunCheck(FX)})}}function VL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const r=t instanceof _o?t.mediaStreamTrack:t,i=r.getSettings();let s={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in i){const o=i.facingMode;Ee.trace("rawFacingMode",{rawFacingMode:o}),o&&typeof o=="string"&&WX(o)&&(s={facingMode:o,confidence:"high"})}if(["low","medium"].includes(s.confidence)){Ee.trace("Try to get facing mode from device label: (".concat(r.label,")"));const o=HX(r.label);o!==void 0&&(s=o)}return s}const OC=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),qX=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function HX(t){var e;const n=t.trim().toLowerCase();if(n!=="")return OC.has(n)?OC.get(n):(e=Array.from(qX.entries()).find(r=>{let[i]=r;return n.includes(i)}))===null||e===void 0?void 0:e[1]}function WX(t){return t===void 0||["user","environment","left","right"].includes(t)}const $b=Math.min,Wa=Math.max,sp=Math.round,$s=t=>({x:t,y:t}),KX={left:"right",right:"left",bottom:"top",top:"bottom"},GX={start:"end",end:"start"};function DC(t,e,n){return Wa(t,$b(e,n))}function Sm(t,e){return typeof t=="function"?t(e):t}function jo(t){return t.split("-")[0]}function _m(t){return t.split("-")[1]}function BL(t){return t==="x"?"y":"x"}function $L(t){return t==="y"?"height":"width"}function Em(t){return["top","bottom"].includes(jo(t))?"y":"x"}function zL(t){return BL(Em(t))}function QX(t,e,n){n===void 0&&(n=!1);const r=_m(t),i=zL(t),s=$L(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=op(o)),[o,op(o)]}function JX(t){const e=op(t);return[zb(t),e,zb(e)]}function zb(t){return t.replace(/start|end/g,e=>GX[e])}function YX(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function XX(t,e,n,r){const i=_m(t);let s=YX(jo(t),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(zb)))),s}function op(t){return t.replace(/left|right|bottom|top/g,e=>KX[e])}function ZX(t){return{top:0,right:0,bottom:0,left:0,...t}}function eZ(t){return typeof t!="number"?ZX(t):{top:t,right:t,bottom:t,left:t}}function ap(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function LC(t,e,n){let{reference:r,floating:i}=t;const s=Em(e),o=zL(e),a=$L(o),l=jo(e),u=s==="y",c=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let p;switch(l){case"top":p={x:c,y:r.y-i.height};break;case"bottom":p={x:c,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-i.width,y:d};break;default:p={x:r.x,y:r.y}}switch(_m(e)){case"start":p[o]-=h*(n&&u?-1:1);break;case"end":p[o]+=h*(n&&u?-1:1);break}return p}const tZ=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:c,y:d}=LC(u,r,l),h=r,p={},g=0;for(let m=0;m<a.length;m++){const{name:k,fn:y}=a[m],{x:w,y:T,data:x,reset:I}=await y({x:c,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:p,rects:u,platform:o,elements:{reference:t,floating:e}});c=w??c,d=T??d,p={...p,[k]:{...p[k],...x}},I&&g<=50&&(g++,typeof I=="object"&&(I.placement&&(h=I.placement),I.rects&&(u=I.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):I.rects),{x:c,y:d}=LC(u,h,l)),m=-1)}return{x:c,y:d,placement:h,strategy:i,middlewareData:p}};async function qL(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=Sm(e,t),g=eZ(p),m=a[h?d==="floating"?"reference":"floating":d],k=ap(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(m)))==null||n?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),y=d==="floating"?{...o.floating,x:r,y:i}:o.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),T=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},x=ap(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:w,strategy:l}):y);return{top:(k.top-x.top+g.top)/T.y,bottom:(x.bottom-k.bottom+g.bottom)/T.y,left:(k.left-x.left+g.left)/T.x,right:(x.right-k.right+g.right)/T.x}}const nZ=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:m=!0,...k}=Sm(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const y=jo(i),w=jo(a)===a,T=await(l.isRTL==null?void 0:l.isRTL(u.floating)),x=h||(w||!m?[op(a)]:JX(a));!h&&g!=="none"&&x.push(...XX(a,m,g,T));const I=[a,...x],R=await qL(e,k),C=[];let _=((r=s.flip)==null?void 0:r.overflows)||[];if(c&&C.push(R[y]),d){const D=QX(i,o,T);C.push(R[D[0]],R[D[1]])}if(_=[..._,{placement:i,overflows:C}],!C.every(D=>D<=0)){var P,N;const D=(((P=s.flip)==null?void 0:P.index)||0)+1,L=I[D];if(L)return{data:{index:D,overflows:_},reset:{placement:L}};let ae=(N=_.filter(re=>re.overflows[0]<=0).sort((re,Te)=>re.overflows[1]-Te.overflows[1])[0])==null?void 0:N.placement;if(!ae)switch(p){case"bestFit":{var A;const re=(A=_.map(Te=>[Te.placement,Te.overflows.filter(ue=>ue>0).reduce((ue,Q)=>ue+Q,0)]).sort((Te,ue)=>Te[1]-ue[1])[0])==null?void 0:A[0];re&&(ae=re);break}case"initialPlacement":ae=a;break}if(i!==ae)return{reset:{placement:ae}}}return{}}}};async function rZ(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=jo(n),a=_m(n),l=Em(n)==="y",u=["left","top"].includes(o)?-1:1,c=s&&l?-1:1,d=Sm(e,t);let{mainAxis:h,crossAxis:p,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof g=="number"&&(p=a==="end"?g*-1:g),l?{x:p*c,y:h*u}:{x:h*u,y:p*c}}const iZ=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:o,middlewareData:a}=e,l=await rZ(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:o}}}}},sZ=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:k=>{let{x:y,y:w}=k;return{x:y,y:w}}},...l}=Sm(t,e),u={x:n,y:r},c=await qL(e,l),d=Em(jo(i)),h=BL(d);let p=u[h],g=u[d];if(s){const k=h==="y"?"top":"left",y=h==="y"?"bottom":"right",w=p+c[k],T=p-c[y];p=DC(w,p,T)}if(o){const k=d==="y"?"top":"left",y=d==="y"?"bottom":"right",w=g+c[k],T=g-c[y];g=DC(w,g,T)}const m=a.fn({...e,[h]:p,[d]:g});return{...m,data:{x:m.x-n,y:m.y-r}}}}};function Cm(){return typeof window<"u"}function Al(t){return HL(t)?(t.nodeName||"").toLowerCase():"#document"}function Kn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Hi(t){var e;return(e=(HL(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function HL(t){return Cm()?t instanceof Node||t instanceof Kn(t).Node:!1}function Dr(t){return Cm()?t instanceof Element||t instanceof Kn(t).Element:!1}function ui(t){return Cm()?t instanceof HTMLElement||t instanceof Kn(t).HTMLElement:!1}function MC(t){return!Cm()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Kn(t).ShadowRoot}function ld(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Lr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function oZ(t){return["table","td","th"].includes(Al(t))}function xm(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Cw(t){const e=xw(),n=Dr(t)?Lr(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function aZ(t){let e=zs(t);for(;ui(e)&&!hl(e);){if(Cw(e))return e;if(xm(e))return null;e=zs(e)}return null}function xw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function hl(t){return["html","body","#document"].includes(Al(t))}function Lr(t){return Kn(t).getComputedStyle(t)}function Im(t){return Dr(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function zs(t){if(Al(t)==="html")return t;const e=t.assignedSlot||t.parentNode||MC(t)&&t.host||Hi(t);return MC(e)?e.host:e}function WL(t){const e=zs(t);return hl(e)?t.ownerDocument?t.ownerDocument.body:t.body:ui(e)&&ld(e)?e:WL(e)}function KL(t,e,n){var r;e===void 0&&(e=[]);const i=WL(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),o=Kn(i);return s?(qb(o),e.concat(o,o.visualViewport||[],ld(i)?i:[],[])):e.concat(i,KL(i,[]))}function qb(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function GL(t){const e=Lr(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=ui(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=sp(n)!==s||sp(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function QL(t){return Dr(t)?t:t.contextElement}function Ka(t){const e=QL(t);if(!ui(e))return $s(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=GL(e);let o=(s?sp(n.width):n.width)/r,a=(s?sp(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const lZ=$s(0);function JL(t){const e=Kn(t);return!xw()||!e.visualViewport?lZ:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function uZ(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Kn(t)?!1:e}function Mc(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=QL(t);let o=$s(1);e&&(r?Dr(r)&&(o=Ka(r)):o=Ka(t));const a=uZ(s,n,r)?JL(s):$s(0);let l=(i.left+a.x)/o.x,u=(i.top+a.y)/o.y,c=i.width/o.x,d=i.height/o.y;if(s){const h=Kn(s),p=r&&Dr(r)?Kn(r):r;let g=h,m=qb(g);for(;m&&r&&p!==g;){const k=Ka(m),y=m.getBoundingClientRect(),w=Lr(m),T=y.left+(m.clientLeft+parseFloat(w.paddingLeft))*k.x,x=y.top+(m.clientTop+parseFloat(w.paddingTop))*k.y;l*=k.x,u*=k.y,c*=k.x,d*=k.y,l+=T,u+=x,g=Kn(m),m=qb(g)}}return ap({width:c,height:d,x:l,y:u})}function cZ(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const s=i==="fixed",o=Hi(r),a=e?xm(e.floating):!1;if(r===o||a&&s)return n;let l={scrollLeft:0,scrollTop:0},u=$s(1);const c=$s(0),d=ui(r);if((d||!d&&!s)&&((Al(r)!=="body"||ld(o))&&(l=Im(r)),ui(r))){const h=Mc(r);u=Ka(r),c.x=h.x+r.clientLeft,c.y=h.y+r.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x,y:n.y*u.y-l.scrollTop*u.y+c.y}}function dZ(t){return Array.from(t.getClientRects())}function Hb(t,e){const n=Im(t).scrollLeft;return e?e.left+n:Mc(Hi(t)).left+n}function fZ(t){const e=Hi(t),n=Im(t),r=t.ownerDocument.body,i=Wa(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Wa(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+Hb(t);const a=-n.scrollTop;return Lr(r).direction==="rtl"&&(o+=Wa(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:a}}function hZ(t,e){const n=Kn(t),r=Hi(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const u=xw();(!u||u&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a,y:l}}function pZ(t,e){const n=Mc(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=ui(t)?Ka(t):$s(1),o=t.clientWidth*s.x,a=t.clientHeight*s.y,l=i*s.x,u=r*s.y;return{width:o,height:a,x:l,y:u}}function UC(t,e,n){let r;if(e==="viewport")r=hZ(t,n);else if(e==="document")r=fZ(Hi(t));else if(Dr(e))r=pZ(e,n);else{const i=JL(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return ap(r)}function YL(t,e){const n=zs(t);return n===e||!Dr(n)||hl(n)?!1:Lr(n).position==="fixed"||YL(n,e)}function mZ(t,e){const n=e.get(t);if(n)return n;let r=KL(t,[]).filter(a=>Dr(a)&&Al(a)!=="body"),i=null;const s=Lr(t).position==="fixed";let o=s?zs(t):t;for(;Dr(o)&&!hl(o);){const a=Lr(o),l=Cw(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&i&&["absolute","fixed"].includes(i.position)||ld(o)&&!l&&YL(t,o))?r=r.filter(u=>u!==o):i=a,o=zs(o)}return e.set(t,r),r}function gZ(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?xm(e)?[]:mZ(e,this._c):[].concat(n),r],o=s[0],a=s.reduce((l,u)=>{const c=UC(e,u,i);return l.top=Wa(c.top,l.top),l.right=$b(c.right,l.right),l.bottom=$b(c.bottom,l.bottom),l.left=Wa(c.left,l.left),l},UC(e,o,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function yZ(t){const{width:e,height:n}=GL(t);return{width:e,height:n}}function vZ(t,e,n){const r=ui(e),i=Hi(e),s=n==="fixed",o=Mc(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=$s(0);if(r||!r&&!s)if((Al(e)!=="body"||ld(i))&&(a=Im(e)),r){const p=Mc(e,!0,s,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else i&&(l.x=Hb(i));let u=0,c=0;if(i&&!r&&!s){const p=i.getBoundingClientRect();c=p.top+a.scrollTop,u=p.left+a.scrollLeft-Hb(i,p)}const d=o.left+a.scrollLeft-l.x-u,h=o.top+a.scrollTop-l.y-c;return{x:d,y:h,width:o.width,height:o.height}}function yy(t){return Lr(t).position==="static"}function FC(t,e){if(!ui(t)||Lr(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Hi(t)===n&&(n=n.ownerDocument.body),n}function XL(t,e){const n=Kn(t);if(xm(t))return n;if(!ui(t)){let i=zs(t);for(;i&&!hl(i);){if(Dr(i)&&!yy(i))return i;i=zs(i)}return n}let r=FC(t,e);for(;r&&oZ(r)&&yy(r);)r=FC(r,e);return r&&hl(r)&&yy(r)&&!Cw(r)?n:r||aZ(t)||n}const bZ=async function(t){const e=this.getOffsetParent||XL,n=this.getDimensions,r=await n(t.floating);return{reference:vZ(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function kZ(t){return Lr(t).direction==="rtl"}const wZ={convertOffsetParentRelativeRectToViewportRelativeRect:cZ,getDocumentElement:Hi,getClippingRect:gZ,getOffsetParent:XL,getElementRects:bZ,getClientRects:dZ,getDimensions:yZ,getScale:Ka,isElement:Dr,isRTL:kZ},TZ=iZ,SZ=sZ,_Z=nZ,EZ=(t,e,n)=>{const r=new Map,i={platform:wZ,...n},s={...i.platform,_c:r};return tZ(t,e,{...i,platform:s})};var Eu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZL(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var e2={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(Eu,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function a(m,k){var y=m[k];if(typeof y.bind=="function")return y.bind(m);try{return Function.prototype.bind.call(y,m)}catch{return function(){return Function.prototype.apply.apply(y,[m,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?l:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function c(){for(var m=this.getLevel(),k=0;k<i.length;k++){var y=i[k];this[y]=k<m?e:this.methodFactory(y,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(c.call(this),this[m].apply(this,arguments))}}function h(m,k,y){return u(m)||d.apply(this,arguments)}function p(m,k){var y=this,w,T,x,I="loglevel";typeof m=="string"?I+=":"+m:typeof m=="symbol"&&(I=void 0);function R(A){var D=(i[A]||"silent").toUpperCase();if(!(typeof window===n||!I)){try{window.localStorage[I]=D;return}catch{}try{window.document.cookie=encodeURIComponent(I)+"="+D+";"}catch{}}}function C(){var A;if(!(typeof window===n||!I)){try{A=window.localStorage[I]}catch{}if(typeof A===n)try{var D=window.document.cookie,L=encodeURIComponent(I),ae=D.indexOf(L+"=");ae!==-1&&(A=/^([^;]+)/.exec(D.slice(ae+L.length+1))[1])}catch{}return y.levels[A]===void 0&&(A=void 0),A}}function _(){if(!(typeof window===n||!I)){try{window.localStorage.removeItem(I)}catch{}try{window.document.cookie=encodeURIComponent(I)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function P(A){var D=A;if(typeof D=="string"&&y.levels[D.toUpperCase()]!==void 0&&(D=y.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=y.levels.SILENT)return D;throw new TypeError("log.setLevel() called with invalid level: "+A)}y.name=m,y.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},y.methodFactory=k||h,y.getLevel=function(){return x??T??w},y.setLevel=function(A,D){return x=P(A),D!==!1&&R(x),c.call(y)},y.setDefaultLevel=function(A){T=P(A),C()||y.setLevel(A,!1)},y.resetLevel=function(){x=null,_(),c.call(y)},y.enableAll=function(A){y.setLevel(y.levels.TRACE,A)},y.disableAll=function(A){y.setLevel(y.levels.SILENT,A)},y.rebuild=function(){if(o!==y&&(w=P(o.getLevel())),c.call(y),o===y)for(var A in s)s[A].rebuild()},w=P(o?o.getLevel():"WARN");var N=C();N!=null&&(x=P(N)),c.call(y)}o=new p,o.getLogger=function(m){if(typeof m!="symbol"&&typeof m!="string"||m==="")throw new TypeError("You must supply a name when creating a logger.");var k=s[m];return k||(k=s[m]=new p(m,o.methodFactory)),k};var g=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=g),o},o.getLoggers=function(){return s},o.default=o,o})})(e2);var CZ=e2.exports;const xZ=ZL(CZ);var Wb=function(t,e){return Wb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Wb(t,e)};function Wi(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Wb(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function IZ(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(a,l)}u((r=r.apply(t,[])).next())})}function t2(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(n=0)),n;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){n.label=u[1];break}if(u[0]===6&&n.label<s[1]){n.label=s[1],s=u;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(u);break}s[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(c){u=[6,c],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function pl(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ml(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function Uc(t,e,n){if(arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}function Ga(t){return this instanceof Ga?(this.v=t,this):new Ga(t)}function PZ(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(p){return function(g){return Promise.resolve(g).then(p,d)}}function a(p,g){r[p]&&(i[p]=function(m){return new Promise(function(k,y){s.push([p,m,k,y])>1||l(p,m)})},g&&(i[p]=g(i[p])))}function l(p,g){try{u(r[p](g))}catch(m){h(s[0][3],m)}}function u(p){p.value instanceof Ga?Promise.resolve(p.value.v).then(c,d):h(s[0][2],p)}function c(p){l("next",p)}function d(p){l("throw",p)}function h(p,g){p(g),s.shift(),s.length&&l(s[0][0],s[0][1])}}function RZ(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof pl=="function"?pl(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}}function Ye(t){return typeof t=="function"}function Iw(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var vy=Iw(function(t){return function(e){t(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function lp(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var ud=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=pl(o),l=a.next();!l.done;l=a.next()){var u=l.value;u.remove(this)}}catch(m){e={error:m}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else o.remove(this);var c=this.initialTeardown;if(Ye(c))try{c()}catch(m){s=m instanceof vy?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=pl(d),p=h.next();!p.done;p=h.next()){var g=p.value;try{jC(g)}catch(m){s=s??[],m instanceof vy?s=Uc(Uc([],ml(s)),ml(m.errors)):s.push(m)}}}catch(m){r={error:m}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}if(s)throw new vy(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)jC(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&lp(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&lp(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),n2=ud.EMPTY;function r2(t){return t instanceof ud||t&&"closed"in t&&Ye(t.remove)&&Ye(t.add)&&Ye(t.unsubscribe)}function jC(t){Ye(t)?t():t.unsubscribe()}var AZ={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},NZ={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Uc([t,e],ml(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function i2(t){NZ.setTimeout(function(){throw t})}function up(){}function nh(t){t()}var Pw=function(t){Wi(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,r2(n)&&n.add(r)):r.destination=LZ,r}return e.create=function(n,r,i){return new Kb(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(ud),OZ=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){cf(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){cf(r)}else cf(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){cf(n)}},t}(),Kb=function(t){Wi(e,t);function e(n,r,i){var s=t.call(this)||this,o;return Ye(n)||!n?o={next:n??void 0,error:r??void 0,complete:i??void 0}:o=n,s.destination=new OZ(o),s}return e}(Pw);function cf(t){i2(t)}function DZ(t){throw t}var LZ={closed:!0,next:up,error:DZ,complete:up},Rw=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Aw(t){return t}function MZ(t){return t.length===0?Aw:t.length===1?t[0]:function(e){return t.reduce(function(n,r){return r(n)},e)}}var Dt=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,s=FZ(e)?e:new Kb(e,n,r);return nh(function(){var o=i,a=o.operator,l=o.source;s.add(a?a.call(s,l):l?i._subscribe(s):i._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=VC(n),new n(function(i,s){var o=new Kb({next:function(a){try{e(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Rw]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return MZ(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=VC(e),new e(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},t.create=function(e){return new t(e)},t}();function VC(t){var e;return(e=t??AZ.Promise)!==null&&e!==void 0?e:Promise}function UZ(t){return t&&Ye(t.next)&&Ye(t.error)&&Ye(t.complete)}function FZ(t){return t&&t instanceof Pw||UZ(t)&&r2(t)}function jZ(t){return Ye(t==null?void 0:t.lift)}function hr(t){return function(e){if(jZ(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mr(t,e,n,r,i){return new VZ(t,e,n,r,i)}var VZ=function(t){Wi(e,t);function e(n,r,i,s,o,a){var l=t.call(this,n)||this;return l.onFinalize=o,l.shouldUnsubscribe=a,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:t.prototype._next,l._error=s?function(u){try{s(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=i?function(){try{i()}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(Pw),BZ=Iw(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),qs=function(t){Wi(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new BC(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new BZ},e.prototype.next=function(n){var r=this;nh(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=pl(r.currentObservers),a=o.next();!a.done;a=o.next()){var l=a.value;l.next(n)}}catch(u){i={error:u}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;nh(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;nh(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,s=i.hasError,o=i.isStopped,a=i.observers;return s||o?n2:(this.currentObservers=null,a.push(n),new ud(function(){r.currentObservers=null,lp(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,s=r.thrownError,o=r.isStopped;i?n.error(s):o&&n.complete()},e.prototype.asObservable=function(){var n=new Dt;return n.source=this,n},e.create=function(n,r){return new BC(n,r)},e}(Dt),BC=function(t){Wi(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:n2},e}(qs),s2=function(t){Wi(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,s=n._value;if(r)throw i;return this._throwIfClosed(),s},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(qs),$Z={now:function(){return Date.now()},delegate:void 0},zZ=function(t){Wi(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e}(ud),$C={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,Uc([t,e],ml(n)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},qZ=function(t){Wi(e,t);function e(n,r){var i=t.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var s=this.id,o=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(o,s,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,r),this},e.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),$C.setInterval(n.flush.bind(n,this),i)},e.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&$C.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var i=!1,s;try{this.work(n)}catch(o){i=!0,s=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,s=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,lp(s,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(zZ),zC=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=$Z.now,t}(),HZ=function(t){Wi(e,t);function e(n,r){r===void 0&&(r=zC.now);var i=t.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},e}(zC),WZ=new HZ(qZ),KZ=new Dt(function(t){return t.complete()});function GZ(t){return t&&Ye(t.schedule)}function o2(t){return t[t.length-1]}function Pm(t){return GZ(o2(t))?t.pop():void 0}function QZ(t,e){return typeof o2(t)=="number"?t.pop():e}var Nw=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function a2(t){return Ye(t==null?void 0:t.then)}function l2(t){return Ye(t[Rw])}function u2(t){return Symbol.asyncIterator&&Ye(t==null?void 0:t[Symbol.asyncIterator])}function c2(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function JZ(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var d2=JZ();function f2(t){return Ye(t==null?void 0:t[d2])}function h2(t){return PZ(this,arguments,function(){var e,n,r,i;return t2(this,function(s){switch(s.label){case 0:e=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Ga(e.read())];case 3:return n=s.sent(),r=n.value,i=n.done,i?[4,Ga(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Ga(r)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function p2(t){return Ye(t==null?void 0:t.getReader)}function di(t){if(t instanceof Dt)return t;if(t!=null){if(l2(t))return YZ(t);if(Nw(t))return XZ(t);if(a2(t))return ZZ(t);if(u2(t))return m2(t);if(f2(t))return eee(t);if(p2(t))return tee(t)}throw c2(t)}function YZ(t){return new Dt(function(e){var n=t[Rw]();if(Ye(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function XZ(t){return new Dt(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function ZZ(t){return new Dt(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,i2)})}function eee(t){return new Dt(function(e){var n,r;try{for(var i=pl(t),s=i.next();!s.done;s=i.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function m2(t){return new Dt(function(e){nee(t,e).catch(function(n){return e.error(n)})})}function tee(t){return m2(h2(t))}function nee(t,e){var n,r,i,s;return IZ(this,void 0,void 0,function(){var o,a;return t2(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=RZ(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Ns(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function g2(t,e){return e===void 0&&(e=0),hr(function(n,r){n.subscribe(Mr(r,function(i){return Ns(r,t,function(){return r.next(i)},e)},function(){return Ns(r,t,function(){return r.complete()},e)},function(i){return Ns(r,t,function(){return r.error(i)},e)}))})}function y2(t,e){return e===void 0&&(e=0),hr(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function ree(t,e){return di(t).pipe(y2(e),g2(e))}function iee(t,e){return di(t).pipe(y2(e),g2(e))}function see(t,e){return new Dt(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function oee(t,e){return new Dt(function(n){var r;return Ns(n,e,function(){r=t[d2](),Ns(n,e,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return Ye(r==null?void 0:r.return)&&r.return()}})}function v2(t,e){if(!t)throw new Error("Iterable cannot be null");return new Dt(function(n){Ns(n,e,function(){var r=t[Symbol.asyncIterator]();Ns(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function aee(t,e){return v2(h2(t),e)}function lee(t,e){if(t!=null){if(l2(t))return ree(t,e);if(Nw(t))return see(t,e);if(a2(t))return iee(t,e);if(u2(t))return v2(t,e);if(f2(t))return oee(t,e);if(p2(t))return aee(t,e)}throw c2(t)}function Ow(t,e){return e?lee(t,e):di(t)}function qC(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Pm(t);return Ow(t,n)}function uee(t){return t instanceof Date&&!isNaN(t)}var cee=Iw(function(t){return function(e){e===void 0&&(e=null),t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function dee(t,e){var n=uee(t)?{first:t}:typeof t=="number"?{each:t}:t,r=n.first,i=n.each,s=n.with,o=s===void 0?fee:s,a=n.scheduler,l=a===void 0?WZ:a,u=n.meta,c=u===void 0?null:u;if(r==null&&i==null)throw new TypeError("No timeout provided.");return hr(function(d,h){var p,g,m=null,k=0,y=function(w){g=Ns(h,l,function(){try{p.unsubscribe(),di(o({meta:c,lastValue:m,seen:k})).subscribe(h)}catch(T){h.error(T)}},w)};p=d.subscribe(Mr(h,function(w){g==null||g.unsubscribe(),k++,h.next(m=w),i>0&&y(i)},void 0,void 0,function(){g!=null&&g.closed||g==null||g.unsubscribe(),m=null})),!k&&y(r!=null?typeof r=="number"?r:+r-l.now():i)})}function fee(t){throw new cee(t)}function _t(t,e){return hr(function(n,r){var i=0;n.subscribe(Mr(r,function(s){r.next(t.call(e,s,i++))}))})}var hee=Array.isArray;function pee(t,e){return hee(e)?t.apply(void 0,Uc([],ml(e))):t(e)}function mee(t){return _t(function(e){return pee(t,e)})}function gee(t,e,n,r,i,s,o,a){var l=[],u=0,c=0,d=!1,h=function(){d&&!l.length&&!u&&e.complete()},p=function(m){return u<r?g(m):l.push(m)},g=function(m){u++;var k=!1;di(n(m,c++)).subscribe(Mr(e,function(y){e.next(y)},function(){k=!0},void 0,function(){if(k)try{u--;for(var y=function(){var w=l.shift();o||g(w)};l.length&&u<r;)y();h()}catch(w){e.error(w)}}))};return t.subscribe(Mr(e,p,function(){d=!0,h()})),function(){}}function Dw(t,e,n){return n===void 0&&(n=1/0),Ye(e)?Dw(function(r,i){return _t(function(s,o){return e(r,s,i,o)})(di(t(r,i)))},n):(typeof e=="number"&&(n=e),hr(function(r,i){return gee(r,i,t,n)}))}function b2(t){return t===void 0&&(t=1/0),Dw(Aw,t)}function yee(){return b2(1)}function cp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return yee()(Ow(t,Pm(t)))}var vee=["addListener","removeListener"],bee=["addEventListener","removeEventListener"],kee=["on","off"];function Gb(t,e,n,r){if(Ye(n)&&(r=n,n=void 0),r)return Gb(t,e,n).pipe(mee(r));var i=ml(See(t)?bee.map(function(a){return function(l){return t[a](e,l,n)}}):wee(t)?vee.map(HC(t,e)):Tee(t)?kee.map(HC(t,e)):[],2),s=i[0],o=i[1];if(!s&&Nw(t))return Dw(function(a){return Gb(a,e,n)})(di(t));if(!s)throw new TypeError("Invalid event target");return new Dt(function(a){var l=function(){for(var u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];return a.next(1<u.length?u:u[0])};return s(l),function(){return o(l)}})}function HC(t,e){return function(n){return function(r){return t[n](e,r)}}}function wee(t){return Ye(t.addListener)&&Ye(t.removeListener)}function Tee(t){return Ye(t.on)&&Ye(t.off)}function See(t){return Ye(t.addEventListener)&&Ye(t.removeEventListener)}function _ee(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Pm(t),r=QZ(t,1/0),i=t;return i.length?i.length===1?di(i[0]):b2(r)(Ow(i,n)):KZ}function Lw(t,e){return hr(function(n,r){var i=0;n.subscribe(Mr(r,function(s){return t.call(e,s,i++)&&r.next(s)}))})}function Eee(t,e,n,r,i){return function(s,o){var a=n,l=e,u=0;s.subscribe(Mr(o,function(c){var d=u++;l=a?t(l,c,d):(a=!0,c),o.next(l)},i))}}function Cee(t,e){return e===void 0&&(e=Aw),t=t??xee,hr(function(n,r){var i,s=!0;n.subscribe(Mr(r,function(o){var a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function xee(t,e){return t===e}function Iee(t){return hr(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function Pee(t,e){return hr(Eee(t,e,arguments.length>=2,!0))}function Ree(t){return hr(function(e,n){var r=!1,i=Mr(n,function(){i==null||i.unsubscribe(),r=!0},up);di(t).subscribe(i),e.subscribe(Mr(n,function(s){return r&&n.next(s)}))})}function Vr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Pm(t);return hr(function(r,i){(n?cp(t,r,n):cp(t,r)).subscribe(i)})}function WC(t){return hr(function(e,n){di(t).subscribe(Mr(n,function(){return n.complete()},up)),!n.closed&&e.subscribe(n)})}var Aee=Object.defineProperty,Nee=Object.defineProperties,Oee=Object.getOwnPropertyDescriptors,KC=Object.getOwnPropertySymbols,Dee=Object.prototype.hasOwnProperty,Lee=Object.prototype.propertyIsEnumerable,GC=(t,e,n)=>e in t?Aee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ho=(t,e)=>{for(var n in e||(e={}))Dee.call(e,n)&&GC(t,n,e[n]);if(KC)for(var n of KC(e))Lee.call(e,n)&&GC(t,n,e[n]);return t},df=(t,e)=>Nee(t,Oee(e)),Qn=(t,e,n)=>new Promise((r,i)=>{var s=l=>{try{a(n.next(l))}catch(u){i(u)}},o=l=>{try{a(n.throw(l))}catch(u){i(u)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,o);a((n=n.apply(t,e)).next())}),k2="lk";function An(t){return typeof t>"u"?!1:Mee(t)||Uee(t)}function Mee(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function Uee(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function Fc(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function nn(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(Fc(t))return`${t.participant.identity}_${t.source}_placeholder`;if(An(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function w2(t,e){return typeof e>"u"?!1:An(t)?e.some(n=>n.participant.identity===t.participant.identity&&An(n)&&n.publication.trackSid===t.publication.trackSid):Fc(t)?e.some(n=>n.participant.identity===t.participant.identity&&Fc(n)&&n.source===t.source):!1}function Fee(t,e){return Fc(t)&&An(e)&&e.participant.identity===t.participant.identity&&e.source===t.source}function jee(){const t=document.createElement("p");t.style.width="100%",t.style.height="200px";const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);const n=t.offsetWidth;e.style.overflow="scroll";let r=t.offsetWidth;return n===r&&(r=e.clientWidth),document.body.removeChild(e),n-r}function Vee(t,e){return Qn(this,null,function*(){const{x:n,y:r}=yield EZ(t,e,{placement:"top",middleware:[TZ(6),_Z(),SZ({padding:5})]});return{x:n,y:r}})}function Bee(t,e){return!t.contains(e.target)}var $ee=[V.ConnectionStateChanged,V.RoomMetadataChanged,V.ActiveSpeakersChanged,V.ConnectionQualityChanged,V.ParticipantConnected,V.ParticipantDisconnected,V.ParticipantPermissionsChanged,V.ParticipantMetadataChanged,V.ParticipantNameChanged,V.ParticipantAttributesChanged,V.TrackMuted,V.TrackUnmuted,V.TrackPublished,V.TrackUnpublished,V.TrackStreamStateChanged,V.TrackSubscriptionFailed,V.TrackSubscriptionPermissionChanged,V.TrackSubscriptionStatusChanged],zee=[...$ee,V.LocalTrackPublished,V.LocalTrackUnpublished];B.TrackPublished,B.TrackUnpublished,B.TrackMuted,B.TrackUnmuted,B.TrackStreamStateChanged,B.TrackSubscribed,B.TrackUnsubscribed,B.TrackSubscriptionPermissionChanged,B.TrackSubscriptionFailed,B.LocalTrackPublished,B.LocalTrackUnpublished;var qee=[B.ConnectionQualityChanged,B.IsSpeakingChanged,B.ParticipantMetadataChanged,B.ParticipantPermissionsChanged,B.TrackMuted,B.TrackUnmuted,B.TrackPublished,B.TrackUnpublished,B.TrackStreamStateChanged,B.TrackSubscriptionFailed,B.TrackSubscriptionPermissionChanged,B.TrackSubscriptionStatusChanged];[...qee,B.LocalTrackPublished,B.LocalTrackUnpublished];var Ce=xZ.getLogger("lk-components-js");Ce.setDefaultLevel("WARN");var Hee=[{columns:1,rows:1},{columns:1,rows:2,orientation:"portrait"},{columns:2,rows:1,orientation:"landscape"},{columns:2,rows:2,minWidth:560},{columns:3,rows:3,minWidth:700},{columns:4,rows:4,minWidth:960},{columns:5,rows:5,minWidth:1100}];function T2(t,e,n,r){if(t.length<1)throw new Error("At least one grid layout definition must be provided.");const i=Wee(t);if(n<=0||r<=0)return i[0];let s=0;const o=n/r>1?"landscape":"portrait";let a=i.find((l,u,c)=>{s=u;const d=c.findIndex((h,p)=>{const g=!h.orientation||h.orientation===o,m=p>u,k=h.maxTiles===l.maxTiles;return m&&k&&g})!==-1;return l.maxTiles>=e&&!d});if(a===void 0)if(a=i[i.length-1],a)Ce.warn(`No layout found for: participantCount: ${e}, width/height: ${n}/${r} fallback to biggest available layout (${a}).`);else throw new Error("No layout or fallback layout found.");if((n<a.minWidth||r<a.minHeight)&&s>0){const l=i[s-1];a=T2(i.slice(0,s),l.maxTiles,n,r)}return a}function Wee(t){return[...t].map(e=>{var n,r;return{name:`${e.columns}x${e.rows}`,columns:e.columns,rows:e.rows,maxTiles:e.columns*e.rows,minWidth:(n=e.minWidth)!=null?n:0,minHeight:(r=e.minHeight)!=null?r:0,orientation:e.orientation}}).sort((e,n)=>e.maxTiles!==n.maxTiles?e.maxTiles-n.maxTiles:e.minWidth!==0||n.minWidth!==0?e.minWidth-n.minWidth:e.minHeight!==0||n.minHeight!==0?e.minHeight-n.minHeight:0)}var S2=[],_2={showChat:!1,unreadMessages:0,showSettings:!1};function E2(t){return typeof t=="object"}function C2(t){return Array.isArray(t)&&t.filter(E2).length>0}function Kee(t,e){return e.audioLevel-t.audioLevel}function Gee(t,e){return t.isSpeaking===e.isSpeaking?0:t.isSpeaking?-1:1}function Qee(t,e){var n,r,i,s;return t.lastSpokeAt!==void 0||e.lastSpokeAt!==void 0?((r=(n=e.lastSpokeAt)==null?void 0:n.getTime())!=null?r:0)-((s=(i=t.lastSpokeAt)==null?void 0:i.getTime())!=null?s:0):0}function Qb(t,e){var n,r,i,s;return((r=(n=t.joinedAt)==null?void 0:n.getTime())!=null?r:0)-((s=(i=e.joinedAt)==null?void 0:i.getTime())!=null?s:0)}function Jee(t,e){return An(t)?An(e)?0:-1:An(e)?1:0}function Yee(t,e){const n=t.participant.isCameraEnabled,r=e.participant.isCameraEnabled;return n!==r?n?-1:1:0}function Xee(t){const e=[],n=[],r=[],i=[];t.forEach(a=>{a.participant.isLocal&&a.source===$.Source.Camera?e.push(a):a.source===$.Source.ScreenShare?n.push(a):a.source===$.Source.Camera?r.push(a):i.push(a)});const s=Zee(n),o=ete(r);return[...e,...s,...o,...i]}function Zee(t){const e=[],n=[];return t.forEach(r=>{r.participant.isLocal?e.push(r):n.push(r)}),e.sort((r,i)=>Qb(r.participant,i.participant)),n.sort((r,i)=>Qb(r.participant,i.participant)),[...n,...e]}function ete(t){const e=[],n=[];return t.forEach(r=>{r.participant.isLocal?e.push(r):n.push(r)}),n.sort((r,i)=>r.participant.isSpeaking&&i.participant.isSpeaking?Kee(r.participant,i.participant):r.participant.isSpeaking!==i.participant.isSpeaking?Gee(r.participant,i.participant):r.participant.lastSpokeAt!==i.participant.lastSpokeAt?Qee(r.participant,i.participant):An(r)!==An(i)?Jee(r,i):r.participant.isCameraEnabled!==i.participant.isCameraEnabled?Yee(r,i):Qb(r.participant,i.participant)),[...e,...n]}function tte(t,e){return t.reduce((n,r,i)=>i%e===0?[...n,[r]]:[...n.slice(0,-1),[...n.slice(-1)[0],r]],[])}function QC(t,e){const n=Math.max(t.length,e.length);return new Array(n).fill([]).map((r,i)=>[t[i],e[i]])}function dp(t,e,n){return t.filter(r=>!e.map(i=>n(i)).includes(n(r)))}function Jb(t){return t.map(e=>typeof e=="string"||typeof e=="number"?`${e}`:nn(e))}function nte(t,e){return{dropped:dp(t,e,nn),added:dp(e,t,nn)}}function rte(t){return t.added.length!==0||t.dropped.length!==0}function Yb(t,e){const n=e.findIndex(r=>nn(r)===nn(t));if(n===-1)throw new Error(`Element not part of the array: ${nn(t)} not in ${Jb(e)}`);return n}function ite(t,e,n){const r=Yb(t,n),i=Yb(e,n);return n.splice(r,1,e),n.splice(i,1,t),n}function ste(t,e){const n=Yb(t,e);return e.splice(n,1),e}function ote(t,e){return[...e,t]}function by(t,e){return tte(t,e)}function ate(t,e,n){let r=lte(t,e);if(r.length<e.length){const o=dp(e,r,nn);r=[...r,...o]}const i=by(r,n),s=by(e,n);if(QC(i,s).forEach(([o,a],l)=>{if(o&&a){const u=by(r,n)[l],c=nte(u,a);rte(c)&&(Ce.debug(`Detected visual changes on page: ${l}, current: ${Jb(o)}, next: ${Jb(a)}`,{changes:c}),c.added.length===c.dropped.length&&QC(c.added,c.dropped).forEach(([d,h])=>{if(d&&h)r=ite(d,h,r);else throw new Error(`For a swap action we need a addition and a removal one is missing: ${d}, ${h}`)}),c.added.length===0&&c.dropped.length>0&&c.dropped.forEach(d=>{r=ste(d,r)}),c.added.length>0&&c.dropped.length===0&&c.added.forEach(d=>{r=ote(d,r)}))}}),r.length>e.length){const o=dp(r,e,nn);r=r.filter(a=>!o.map(nn).includes(nn(a)))}return r}function lte(t,e){return t.map(n=>e.find(i=>nn(n)===nn(i)||typeof n!="number"&&Fc(n)&&An(i)&&Fee(n,i))??n)}function Nn(t){return`${k2}-${t}`}function ute(t){const e=Xb(t),n=x2(t.participant).pipe(_t(()=>Xb(t)),Vr(e));return{className:Nn(t.source===$.Source.Camera||t.source===$.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function Xb(t){if(An(t))return t.publication;{const{source:e,name:n,participant:r}=t;if(e&&n)return r.getTrackPublications().find(i=>i.source===e&&i.trackName===n);if(n)return r.getTrackPublicationByName(n);if(e)return r.getTrackPublication(e);throw new Error("At least one of source and name needs to be defined")}}function Mw(t,...e){return new Dt(n=>{const r=()=>{n.next(t)};return e.forEach(i=>{t.on(i,r)}),()=>{e.forEach(i=>{t.off(i,r)})}}).pipe(Vr(t))}function cd(t,e){return new Dt(n=>{const r=(...i)=>{n.next(i)};return t.on(e,r),()=>{t.off(e,r)}})}function cte(t){return cd(t,V.ConnectionStateChanged).pipe(_t(([e])=>e),Vr(t.state))}function dte(t,e,n=!0){var r;const i=()=>Qn(this,null,function*(){try{const a=yield Bi.getLocalDevices(t,n);s.next(a)}catch(a){e==null||e(a)}}),s=new qs,o=s.pipe(Iee(()=>{var a;(a=navigator==null?void 0:navigator.mediaDevices)==null||a.removeEventListener("devicechange",i)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(r=navigator==null?void 0:navigator.mediaDevices)==null||r.addEventListener("devicechange",i)}return cp(Bi.getLocalDevices(t,n).catch(a=>(e==null||e(a),[])),o)}function fte(t){return cd(t,V.DataReceived)}function hte(t){return cd(t,V.ChatMessage)}function pte(t){return Mw(t,V.AudioPlaybackStatusChanged).pipe(_t(e=>({canPlayAudio:e.canPlaybackAudio})))}function mte(t){return Mw(t,V.VideoPlaybackStatusChanged).pipe(_t(e=>({canPlayVideo:e.canPlaybackVideo})))}function gte(t,e){return cd(t,V.ActiveDeviceChanged).pipe(Lw(([n])=>n===e),_t(([n,r])=>(Ce.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:r}),r)))}function yte(t,e){return cd(t,V.ParticipantEncryptionStatusChanged).pipe(Lw(([,n])=>(e==null?void 0:e.identity)===(n==null?void 0:n.identity)||!n&&(e==null?void 0:e.identity)===t.localParticipant.identity),_t(([n])=>n),Vr(e!=null&&e.isLocal?e.isE2EEEnabled:!!(e!=null&&e.isEncrypted)))}function Uw(t,...e){return new Dt(n=>{const r=()=>{n.next(t)};return e.forEach(i=>{t.on(i,r)}),()=>{e.forEach(i=>{t.off(i,r)})}}).pipe(Vr(t))}function x2(t){return Uw(t,B.TrackMuted,B.TrackUnmuted,B.ParticipantPermissionsChanged,B.TrackPublished,B.TrackUnpublished,B.LocalTrackPublished,B.LocalTrackUnpublished,B.MediaDevicesError,B.TrackSubscriptionStatusChanged).pipe(_t(e=>{const{isMicrophoneEnabled:n,isCameraEnabled:r,isScreenShareEnabled:i}=e,s=e.getTrackPublication($.Source.Microphone),o=e.getTrackPublication($.Source.Camera);return{isCameraEnabled:r,isMicrophoneEnabled:n,isScreenShareEnabled:i,cameraTrack:o,microphoneTrack:s,participant:e}}))}function vte(t){return t?Uw(t,B.ParticipantMetadataChanged,B.ParticipantNameChanged).pipe(_t(({name:e,identity:n,metadata:r})=>({name:e,identity:n,metadata:r})),Vr({name:t.name,identity:t.identity,metadata:t.metadata})):void 0}function bte(t){return Fw(t,B.ConnectionQualityChanged).pipe(_t(([e])=>e),Vr(t.connectionQuality))}function Fw(t,e){return new Dt(n=>{const r=(...i)=>{n.next(i)};return t.on(e,r),()=>{t.off(e,r)}})}function I2(t){var e,n,r,i;return Uw(t.participant,B.TrackMuted,B.TrackUnmuted,B.TrackSubscribed,B.TrackUnsubscribed,B.LocalTrackPublished,B.LocalTrackUnpublished).pipe(_t(s=>{var o,a;const l=(o=t.publication)!=null?o:s.getTrackPublication(t.source);return(a=l==null?void 0:l.isMuted)!=null?a:!0}),Vr((i=(r=(e=t.publication)==null?void 0:e.isMuted)!=null?r:(n=t.participant.getTrackPublication(t.source))==null?void 0:n.isMuted)!=null?i:!0))}function kte(t){return Fw(t,B.IsSpeakingChanged).pipe(_t(([e])=>e))}function wte(t){return Fw(t,B.ParticipantPermissionsChanged).pipe(_t(()=>t.permissions),Vr(t.permissions))}function Tte(t,e,n,r,i){const{localParticipant:s}=e,o=(c,d)=>{let h=!1;switch(c){case $.Source.Camera:h=d.isCameraEnabled;break;case $.Source.Microphone:h=d.isMicrophoneEnabled;break;case $.Source.ScreenShare:h=d.isScreenShareEnabled;break}return h},a=x2(s).pipe(_t(c=>o(t,c.participant)),Vr(o(t,s))),l=new qs,u=(c,d)=>Qn(this,null,function*(){try{switch(d??(d=n),l.next(!0),t){case $.Source.Camera:return yield s.setCameraEnabled(c??!s.isCameraEnabled,d,r),s.isCameraEnabled;case $.Source.Microphone:return yield s.setMicrophoneEnabled(c??!s.isMicrophoneEnabled,d,r),s.isMicrophoneEnabled;case $.Source.ScreenShare:return yield s.setScreenShareEnabled(c??!s.isScreenShareEnabled,d,r),s.isScreenShareEnabled;default:throw new TypeError("Tried to toggle unsupported source")}}catch(h){if(i&&h instanceof Error){i==null||i(h);return}else throw h}finally{l.next(!1)}});return{className:Nn("button"),toggle:u,enabledObserver:a,pendingObserver:l.asObservable()}}function Ste(){let t=!1;const e=new qs,n=new qs,r=i=>Qn(this,null,function*(){n.next(!0),t=i??!t,e.next(t),n.next(!1)});return{className:Nn("button"),toggle:r,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function _te(t,e,n){const r=new s2(void 0),i=gte(e,t),s=(o,...a)=>Qn(this,[o,...a],function*(l,u={}){var c,d,h;if(e){Ce.debug(`Switching active device of kind "${t}" with id ${l}.`),yield e.switchActiveDevice(t,l,u.exact);const p=(c=e.getActiveDevice(t))!=null?c:l;p!==l&&l!=="default"&&Ce.info(`We tried to select the device with id (${l}), but the browser decided to select the device with id (${p}) instead.`);let g;t==="audioinput"?g=(d=e.localParticipant.getTrackPublication($.Source.Microphone))==null?void 0:d.track:t==="videoinput"&&(g=(h=e.localParticipant.getTrackPublication($.Source.Camera))==null?void 0:h.track);const m=l==="default"&&!g||l==="default"&&(g==null?void 0:g.mediaStreamTrack.label.startsWith("Default"));r.next(m?l:p)}});return{className:Nn("media-device-select"),activeDeviceObservable:i,setActiveMediaDevice:s}}function Ete(t){const e=n=>{t.disconnect(n)};return{className:Nn("disconnect-button"),disconnect:e}}function Cte(t){const e=Nn("connection-quality"),n=bte(t);return{className:e,connectionQualityObserver:n}}function xte(t){let e="track-muted-indicator-camera";switch(t.source){case $.Source.Camera:e="track-muted-indicator-camera";break;case $.Source.Microphone:e="track-muted-indicator-microphone";break}const n=Nn(e),r=I2(t);return{className:n,mediaMutedObserver:r}}function Ite(t){return{className:"lk-participant-name",infoObserver:vte(t)}}function Pte(){return{className:Nn("participant-tile")}}var JC={CHAT:"lk-chat-topic",CHAT_UPDATE:"lk-chat-update-topic"};function Zb(t,e){return Qn(this,arguments,function*(n,r,i={}){const{reliable:s,destinationIdentities:o,topic:a}=i;yield n.publishData(r,{destinationIdentities:o,topic:a,reliable:s})})}function Rte(t,e,n){const r=Array.isArray(e)?e:[e],i=fte(t).pipe(Lw(([,,,a])=>e===void 0||a!==void 0&&r.includes(a)),_t(([a,l,,u])=>({payload:a,topic:u,from:l})));let s;const o=new Dt(a=>{s=a});return{messageObservable:i,isSendingObservable:o,send:(a,...l)=>Qn(this,[a,...l],function*(u,c={}){s.next(!0);try{yield Zb(t.localParticipant,u,ho({topic:r[0]},c))}finally{s.next(!1)}})}}function Ate(t){return{chatObservable:hte(t),send:e=>Qn(this,null,function*(){return yield t.localParticipant.sendChatMessage(e)}),edit:(e,n)=>Qn(this,null,function*(){return yield t.localParticipant.editChatMessage(e,n)})}}var Nte=new TextEncoder,Ote=new TextDecoder,ff=new Map,Dte=t=>Nte.encode(JSON.stringify(t)),Lte=t=>JSON.parse(Ote.decode(t));function Mte(t,e){var n,r;const i=new qs,s=()=>{var _,P,N;return((_=t.serverInfo)==null?void 0:_.edition)===1||!!((P=t.serverInfo)!=null&&P.version)&&Fo((N=t.serverInfo)==null?void 0:N.version,"1.17.2")>0},{messageDecoder:o,messageEncoder:a,channelTopic:l,updateChannelTopic:u}=e??{},c=l??JC.CHAT,d=u??JC.CHAT_UPDATE;let h=!1;ff.has(t)||(h=!0);const p=(n=ff.get(t))!=null?n:new Map,g=(r=p.get(c))!=null?r:new qs;if(p.set(c,g),ff.set(t,p),h){const{messageObservable:_}=Rte(t,[c,d]);_.pipe(WC(i)).subscribe(g)}const{chatObservable:m,send:k}=Ate(t),y=o??Lte,w=_ee(g.pipe(_t(_=>{const P=y(_.payload),N=df(ho({},P),{from:_.from});if(!Ute(N))return N})),m.pipe(_t(([_,P])=>df(ho({},_),{from:P})))).pipe(Pee((_,P)=>{var N;if(!P)return _;if("id"in P&&_.find(A=>{var D,L;return((D=A.from)==null?void 0:D.identity)===((L=P.from)==null?void 0:L.identity)&&A.id===P.id})){const A=_.findIndex(D=>D.id===P.id);if(A>-1){const D=_[A];_[A]=df(ho({},P),{timestamp:D.timestamp,editTimestamp:(N=P.editTimestamp)!=null?N:P.timestamp})}return[..._]}return[..._,P]},[]),WC(i)),T=new s2(!1),x=a??Dte,I=_=>Qn(this,null,function*(){T.next(!0);try{const P=yield k(_),N=x(df(ho({},P),{ignore:s()}));return yield Zb(t.localParticipant,N,{reliable:!0,topic:c}),P}finally{T.next(!1)}}),R=(_,P)=>Qn(this,null,function*(){const N=Date.now(),A=typeof P=="string"?{id:P,message:"",timestamp:N}:P;T.next(!0);try{const D=yield t.localParticipant.editChatMessage(_,A),L=x(D);return yield Zb(t.localParticipant,L,{topic:d,reliable:!0}),D}finally{T.next(!1)}});function C(){i.next(),i.complete(),ff.delete(t)}return t.once(V.Disconnected,C),{messageObservable:w,isSendingObservable:T,send:I,update:R}}function Ute(t){return t.ignore==!0}function Fte(){const t=e=>Qn(this,null,function*(){Ce.info("Start Audio for room: ",e),yield e.startAudio()});return{className:Nn("start-audio-button"),roomAudioPlaybackAllowedObservable:pte,handleStartAudioPlayback:t}}function jte(){const t=e=>Qn(this,null,function*(){Ce.info("Start Video for room: ",e),yield e.startVideo()});return{className:Nn("start-audio-button"),roomVideoPlaybackAllowedObservable:mte,handleStartVideoPlayback:t}}function Vte(){return{className:[Nn("button"),Nn("chat-toggle")].join(" ")}}function Bte(){return{className:[Nn("button"),Nn("focus-toggle-button")].join(" ")}}function $te(){return{className:"lk-room-container"}}function YC(t,e,n=!0){const r=[t.localParticipant,...Array.from(t.remoteParticipants.values())],i=[];return r.forEach(s=>{e.forEach(o=>{const a=Array.from(s.trackPublications.values()).filter(l=>l.source===o&&(!n||l.track)).map(l=>({participant:s,publication:l,source:l.source}));i.push(...a)})}),{trackReferences:i,participants:r}}function zte(t,e,n){var r,i;const s=(r=n.additionalRoomEvents)!=null?r:zee,o=(i=n.onlySubscribed)!=null?i:!0,a=Array.from(new Set([V.ParticipantConnected,V.ParticipantDisconnected,V.ConnectionStateChanged,V.LocalTrackPublished,V.LocalTrackUnpublished,V.TrackPublished,V.TrackUnpublished,V.TrackSubscriptionStatusChanged,...s]).values());return Mw(t,...a).pipe(_t(l=>{const u=YC(l,e,o);return Ce.debug(`TrackReference[] was updated. (length ${u.trackReferences.length})`,u),u}),Vr(YC(t,e,o)))}function qte(t,e=1e3){if(t===null)return qC(!1);const n=Gb(t,"mousemove",{passive:!0}).pipe(_t(()=>!0)),r=n.pipe(dee({each:e,with:()=>cp(qC(!1),r.pipe(Ree(n)))}),Cee());return r}function Hte(t,e){if(typeof localStorage>"u"){Ce.error("Local storage is not available.");return}try{if(e){const n=Object.fromEntries(Object.entries(e).filter(([,r])=>r!==""));localStorage.setItem(t,JSON.stringify(n))}}catch(n){Ce.error(`Error setting item to local storage: ${n}`)}}function Wte(t){if(typeof localStorage>"u"){Ce.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){Ce.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Ce.error(`Error getting item from local storage: ${e}`);return}}function Kte(t){return{load:()=>Wte(t),save:e=>Hte(t,e)}}var Gte=`${k2}-user-choices`,pa={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"default",audioDeviceId:"default",username:""},{load:Qte,save:Jte}=Kte(Gte);function Yte(t,e=!1){e!==!0&&Jte(t)}function Xte(t,e=!1){var n,r,i,s,o;const a={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:pa.videoEnabled,audioEnabled:(r=t==null?void 0:t.audioEnabled)!=null?r:pa.audioEnabled,videoDeviceId:(i=t==null?void 0:t.videoDeviceId)!=null?i:pa.videoDeviceId,audioDeviceId:(s=t==null?void 0:t.audioDeviceId)!=null?s:pa.audioDeviceId,username:(o=t==null?void 0:t.username)!=null?o:pa.username};if(e)return a;{const l=Qte();return ho(ho({},a),l??{})}}function P2(t,e){if(e.msg==="show_chat")return{...t,showChat:!0,unreadMessages:0};if(e.msg==="hide_chat")return{...t,showChat:!1};if(e.msg==="toggle_chat"){const n={...t,showChat:!t.showChat};return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?{...t,unreadMessages:e.count}:e.msg==="toggle_settings"?{...t,showSettings:!t.showSettings}:{...t}}function R2(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:{...t}}const Rm=v.createContext(void 0);function Zte(){const t=v.useContext(Rm);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function ene(t){const e=dd();if(t??(t=e),!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function tne(){const[t,e]=v.useReducer(R2,S2),[n,r]=v.useReducer(P2,_2);return{pin:{dispatch:e,state:t},widget:{dispatch:r,state:n}}}function nne(t){const[e,n]=v.useReducer(R2,S2),[r,i]=v.useReducer(P2,_2);return t??{pin:{dispatch:n,state:e},widget:{dispatch:i,state:r}}}function dd(){return v.useContext(Rm)}const jw=v.createContext(void 0);function Am(){return v.useContext(jw)}function Nl(t){const e=Am(),n=t??e;if(!n)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return n}const A2=v.createContext(void 0);function N2(){return v.useContext(A2)}function fd(t){const e=N2(),n=Am(),r=t??e??(n==null?void 0:n.participant);if(!r)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return r}const Vw=v.createContext(void 0);function Nm(){const t=v.useContext(Vw);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function Om(){return v.useContext(Vw)}function Ol(t){const e=Om(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}const O2=v.createContext(void 0);function rne(t){return v.useContext(O2)}var XC={};function D2(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=D2(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function L2(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=D2(t))&&(r&&(r+=" "),r+=e);return r}function ine(...t){return(...e)=>{for(const n of t)if(typeof n=="function")try{n(...e)}catch(r){console.error(r)}}}function Ki(...t){const e={...t[0]};for(let n=1;n<t.length;n++){const r=t[n];for(const i in r){const s=e[i],o=r[i];typeof s=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=ine(s,o):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof o=="string"?e[i]=L2(s,o):e[i]=o!==void 0?o:s}}return e}function sne(t){return t!==void 0}function Js(...t){return Ki(...t.filter(sne))}function one(t,e,n){return v.Children.map(t,r=>v.isValidElement(r)&&v.Children.only(t)?(r.props.class&&(e??(e={}),e.class=L2(r.props.class,e.class),e.style={...r.props.style,...e.style}),v.cloneElement(r,{...e,key:n})):r)}function ane(t){var e,n;if(typeof window<"u"&&typeof process<"u"&&(((e=process==null?void 0:XC)==null?void 0:e.NODE_ENV)==="dev"||((n=process==null?void 0:XC)==null?void 0:n.NODE_ENV)==="development")){const r=document.querySelector(".lk-room-container");r&&!getComputedStyle(r).getPropertyValue("--lk-has-imported-styles")&&Ce.warn("It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.")}}function M2(t,e){return t==="processor"&&e&&typeof e=="object"&&"name"in e?e.name:t==="e2ee"&&e?"e2ee-enabled":e}const lne={connect:!0,audio:!1,video:!1};function une(t){const{token:e,serverUrl:n,options:r,room:i,connectOptions:s,connect:o,audio:a,video:l,screen:u,onConnected:c,onDisconnected:d,onError:h,onMediaDeviceFailure:p,onEncryptionError:g,simulateParticipants:m,...k}={...lne,...t};r&&i&&Ce.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[y,w]=v.useState(),T=v.useRef(o);v.useEffect(()=>{w(i??new Bi(r))},[i,JSON.stringify(r,M2)]);const x=v.useMemo(()=>{const{className:I}=$te();return Ki(k,{className:I})},[k]);return v.useEffect(()=>{if(!y)return;const I=()=>{const N=y.localParticipant;Ce.debug("trying to publish local tracks"),Promise.all([N.setMicrophoneEnabled(!!a,typeof a!="boolean"?a:void 0),N.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),N.setScreenShareEnabled(!!u,typeof u!="boolean"?u:void 0)]).catch(A=>{Ce.warn(A),h==null||h(A)})},R=N=>{const A=Nc.getFailure(N);p==null||p(A)},C=N=>{g==null||g(N)},_=N=>{d==null||d(N)},P=()=>{c==null||c()};return y.on(V.SignalConnected,I).on(V.MediaDevicesError,R).on(V.EncryptionError,C).on(V.Disconnected,_).on(V.Connected,P),()=>{y.off(V.SignalConnected,I).off(V.MediaDevicesError,R).off(V.EncryptionError,C).off(V.Disconnected,_).off(V.Connected,P)}},[y,a,l,u,h,g,p,c,d]),v.useEffect(()=>{if(y){if(m){y.simulateParticipants({participants:{count:m},publish:{audio:!0,useRealTracks:!0}});return}if(o){if(T.current=!0,Ce.debug("connecting"),!e){Ce.debug("no token yet");return}if(!n){Ce.warn("no livekit url provided"),h==null||h(Error("no livekit url provided"));return}y.connect(n,e,s).catch(I=>{Ce.warn(I),T.current===!0&&(h==null||h(I))})}else Ce.debug("disconnecting because connect is false"),T.current=!1,y.disconnect()}},[o,e,JSON.stringify(s),y,h,n,m]),v.useEffect(()=>{if(y)return()=>{Ce.info("disconnecting on onmount"),y.disconnect()}},[y]),{room:y,htmlProps:x}}const cne=v.forwardRef(function(t,e){const{room:n,htmlProps:r}=une(t);return v.createElement("div",{ref:e,...r},n&&v.createElement(Vw.Provider,{value:n},v.createElement(O2.Provider,{value:t.featureFlags},t.children)))}),dne=t=>{const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),e};function fne(t,e){const n=pne(),r=dne(e);return v.useLayoutEffect(()=>{let i=!1;const s=t.current;if(!s)return;function o(a,l){i||r.current(a,l)}return n==null||n.subscribe(s,o),()=>{i=!0,n==null||n.unsubscribe(s,o)}},[t.current,n,r]),n==null?void 0:n.observer}function hne(){let t=!1,e=[];const n=new Map;if(typeof window>"u")return;const r=new ResizeObserver((i,s)=>{e=e.concat(i),t||window.requestAnimationFrame(()=>{const o=new Set;for(let a=0;a<e.length;a++){if(o.has(e[a].target))continue;o.add(e[a].target);const l=n.get(e[a].target);l==null||l.forEach(u=>u(e[a],s))}e=[],t=!1}),t=!0});return{observer:r,subscribe(i,s){r.observe(i);const o=n.get(i)??[];o.push(s),n.set(i,o)},unsubscribe(i,s){const o=n.get(i)??[];if(o.length===1){r.unobserve(i),n.delete(i);return}const a=o.indexOf(s);a!==-1&&o.splice(a,1),n.set(i,o)}}}let ZC;const pne=()=>ZC||(ZC=hne()),U2=t=>{const[e,n]=v.useState({width:0,height:0});v.useLayoutEffect(()=>{if(t.current){const{width:i,height:s}=t.current.getBoundingClientRect();n({width:i,height:s})}},[t.current]);const r=v.useCallback(i=>n(i.contentRect),[]);return fne(t,r),e};function On(t,e,n=!0){const[r,i]=v.useState(e);return v.useEffect(()=>{if(n&&i(e),typeof window>"u"||!t)return;const s=t.subscribe(i);return()=>s.unsubscribe()},[t,n]),r}function mne(t={}){const e=fd(t.participant),{className:n,connectionQualityObserver:r}=v.useMemo(()=>Cte(e),[e]),i=On(r,ir.Unknown);return{className:n,quality:i}}function Bw(t){const e=Ol(t),n=v.useMemo(()=>cte(e),[e]);return On(n,e.state)}function gne(t){const e=Nm(),n=Bw(e);return{buttonProps:v.useMemo(()=>{const{className:r,disconnect:i}=Ete(e);return Ki(t,{className:r,onClick:()=>i(t.stopTracks??!0),disabled:n===Ie.Disconnected})},[e,t,n])}}function yne(t){if(t.publication instanceof Dc){const e=t.publication.track;if(e){const{facingMode:n}=VL(e);return n}}return"undefined"}function vne({trackRef:t,props:e}){const n=Nl(t),r=dd(),{className:i}=v.useMemo(()=>Bte(),[]),s=v.useMemo(()=>w2(n,r==null?void 0:r.pin.state),[n,r==null?void 0:r.pin.state]);return{mergedProps:v.useMemo(()=>Ki(e,{className:i,onClick:o=>{var a,l,u,c,d;(a=e.onClick)==null||a.call(e,o),s?(u=r==null?void 0:(l=r.pin).dispatch)==null||u.call(l,{msg:"clear_pin"}):(d=r==null?void 0:(c=r.pin).dispatch)==null||d.call(c,{msg:"set_pin",trackReference:n})}}),[e,i,n,s,r==null?void 0:r.pin]),inFocus:s}}function bne(t,e,n={}){const r=n.gridLayouts??Hee,{width:i,height:s}=U2(t),o=T2(r,e,i,s);return v.useEffect(()=>{t.current&&o&&(t.current.style.setProperty("--lk-col-count",o==null?void 0:o.columns.toString()),t.current.style.setProperty("--lk-row-count",o==null?void 0:o.rows.toString()))},[t,o]),{layout:o,containerWidth:i,containerHeight:s}}function ex(t,e={}){var n,r;const i=typeof t=="string"?e.participant:t.participant,s=fd(i),o=typeof t=="string"?{participant:s,source:t}:t,[a,l]=v.useState(!!((n=o.publication)!=null&&n.isMuted||(r=s.getTrackPublication(o.source))!=null&&r.isMuted));return v.useEffect(()=>{const u=I2(o).subscribe(l);return()=>u.unsubscribe()},[nn(o)]),a}function kne(t){const e=fd(t),n=v.useMemo(()=>kte(e),[e]);return On(n,e.isSpeaking)}function wne(){const t=Nm(),e=v.useMemo(()=>wte(t.localParticipant),[t]);return On(e,t.localParticipant.permissions)}function Tne({kind:t,room:e,track:n,requestPermissions:r,onError:i}){const s=Om(),o=v.useMemo(()=>e??s??new Bi,[e,s]),a=v.useMemo(()=>dte(t,i,r),[t,r,i]),l=On(a,[]),[u,c]=v.useState((o==null?void 0:o.getActiveDevice(t))??"default"),{className:d,activeDeviceObservable:h,setActiveMediaDevice:p}=v.useMemo(()=>_te(t,o),[t,o,n]);return v.useEffect(()=>{const g=h.subscribe(m=>{m&&(Ce.info("setCurrentDeviceId",m),c(m))});return()=>{g==null||g.unsubscribe()}},[h]),{devices:l,className:d,activeDeviceId:u,setActiveMediaDevice:p}}function F2(t,e,n={}){const r=v.useRef([]),i=v.useRef(-1),s=e!==i.current,o=typeof n.customSortFunction=="function"?n.customSortFunction(t):Xee(t);let a=[...o];if(s===!1)try{a=ate(r.current,o,e)}catch(l){Ce.error("Error while running updatePages(): ",l)}return s?r.current=o:r.current=a,i.current=e,a}function Sne(t,e){const[n,r]=v.useState(1),i=Math.max(Math.ceil(e.length/t),1);n>i&&r(i);const s=n*t,o=s-t,a=c=>{r(d=>c==="next"?d===i?d:d+1:d===1?d:d-1)},l=c=>{c>i?r(i):c<1?r(1):r(c)},u=F2(e,t).slice(o,s);return{totalPageCount:i,nextPage:()=>a("next"),prevPage:()=>a("previous"),setPage:l,firstItemIndex:o,lastItemIndex:s,tracks:u,currentPage:n}}function _ne({trackRef:t,onParticipantClick:e,disableSpeakingIndicator:n,htmlProps:r}){const i=Nl(t),s=v.useMemo(()=>{const{className:h}=Pte();return Ki(r,{className:h,onClick:p=>{var g;if((g=r.onClick)==null||g.call(r,p),typeof e=="function"){const m=i.publication??i.participant.getTrackPublication(i.source);e({participant:i.participant,track:m})}}})},[r,e,i.publication,i.source,i.participant]),o=i.participant.getTrackPublication($.Source.Microphone),a=v.useMemo(()=>({participant:i.participant,source:$.Source.Microphone,publication:o}),[o,i.participant]),l=ex(i),u=ex(a),c=kne(i.participant),d=yne(i);return{elementProps:{"data-lk-audio-muted":u,"data-lk-video-muted":l,"data-lk-speaking":n===!0?!1:c,"data-lk-local-participant":i.participant.isLocal,"data-lk-source":i.source,"data-lk-facing-mode":d,...s}}}function Ene(t){return t=ene(t),v.useMemo(()=>(t==null?void 0:t.pin.state)!==void 0&&t.pin.state.length>=1?t.pin.state:[],[t.pin.state])}function Cne({room:t,props:e}){const n=Ol(t),{className:r,roomAudioPlaybackAllowedObservable:i,handleStartAudioPlayback:s}=v.useMemo(()=>Fte(),[]),o=v.useMemo(()=>i(n),[n,i]),{canPlayAudio:a}=On(o,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:v.useMemo(()=>Ki(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayAudio:a}}function xne({room:t,props:e}){const n=Ol(t),{className:r,roomVideoPlaybackAllowedObservable:i,handleStartVideoPlayback:s}=v.useMemo(()=>jte(),[]),o=v.useMemo(()=>i(n),[n,i]),{canPlayVideo:a}=On(o,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:v.useMemo(()=>Ki(e,{className:r,onClick:()=>{s(n)},style:{display:a?"none":"block"}}),[e,r,a,s,n]),canPlayVideo:a}}function Ine(t,e={}){const n=v.useRef(null),r=v.useRef(null),i=e.minSwipeDistance??50,s=l=>{r.current=null,n.current=l.targetTouches[0].clientX},o=l=>{r.current=l.targetTouches[0].clientX},a=v.useCallback(()=>{if(!n.current||!r.current)return;const l=n.current-r.current,u=l>i,c=l<-i;u&&e.onLeftSwipe&&e.onLeftSwipe(),c&&e.onRightSwipe&&e.onRightSwipe()},[i,e]);v.useEffect(()=>{const l=t.current;return l&&(l.addEventListener("touchstart",s,{passive:!0}),l.addEventListener("touchmove",o,{passive:!0}),l.addEventListener("touchend",a,{passive:!0})),()=>{l&&(l.removeEventListener("touchstart",s),l.removeEventListener("touchmove",o),l.removeEventListener("touchend",a))}},[t,a])}function Pne({props:t}){const{dispatch:e,state:n}=Zte().widget,{className:r}=v.useMemo(()=>Vte(),[]);return{mergedProps:v.useMemo(()=>Ki(t,{className:r,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,r,e,n])}}function Rne(t){var e,n;const r=Nl(t),{className:i,mediaMutedObserver:s}=v.useMemo(()=>xte(r),[nn(r)]);return{isMuted:On(s,!!((e=r.publication)!=null&&e.isMuted||(n=r.participant.getTrackPublication(r.source))!=null&&n.isMuted)),className:i}}function Ane({source:t,onChange:e,initialState:n,captureOptions:r,publishOptions:i,onDeviceError:s,...o}){var a;const l=Om(),u=(a=l==null?void 0:l.localParticipant)==null?void 0:a.getTrackPublication(t),c=v.useRef(!1),{toggle:d,className:h,pendingObserver:p,enabledObserver:g}=v.useMemo(()=>l?Tte(t,l,r,i,s):Ste(),[l,t,JSON.stringify(r),i]),m=On(p,!1),k=On(g,n??!!(u!=null&&u.isEnabled));v.useEffect(()=>{e==null||e(k,c.current),c.current=!1},[k,e]),v.useEffect(()=>{n!==void 0&&(Ce.debug("forcing initial toggle state",t,n),d(n))},[]);const y=v.useMemo(()=>Ki(o,{className:h}),[o,h]),w=v.useCallback(T=>{var x;c.current=!0,d().catch(()=>c.current=!1),(x=o.onClick)==null||x.call(o,T)},[o,d]);return{toggle:d,enabled:k,pending:m,track:u,buttonProps:{...y,"aria-pressed":k,"data-lk-source":t,"data-lk-enabled":k,disabled:m,onClick:w}}}function j2(t=[$.Source.Camera,$.Source.Microphone,$.Source.ScreenShare,$.Source.ScreenShareAudio,$.Source.Unknown],e={}){const n=Ol(e.room),[r,i]=v.useState([]),[s,o]=v.useState([]),a=v.useMemo(()=>t.map(l=>E2(l)?l.source:l),[JSON.stringify(t)]);return v.useEffect(()=>{const l=zte(n,a,{additionalRoomEvents:e.updateOnlyOn,onlySubscribed:e.onlySubscribed}).subscribe(({trackReferences:u,participants:c})=>{Ce.debug("setting track bundles",u,c),i(u),o(c)});return()=>l.unsubscribe()},[n,JSON.stringify(e.onlySubscribed),JSON.stringify(e.updateOnlyOn),JSON.stringify(t)]),v.useMemo(()=>{if(C2(t)){const l=One(t,s),u=Array.from(r);return s.forEach(c=>{l.has(c.identity)&&(l.get(c.identity)??[]).forEach(d=>{if(r.find(({participant:p,publication:g})=>c.identity===p.identity&&g.source===d))return;Ce.debug(`Add ${d} placeholder for participant ${c.identity}.`);const h={participant:c,source:d};u.push(h)})}),u}else return r},[r,s,t])}function Nne(t,e){const n=new Set(t);for(const r of e)n.delete(r);return n}function One(t,e){const n=new Map;if(C2(t)){const r=t.filter(i=>i.withPlaceholder).map(i=>i.source);e.forEach(i=>{const s=i.getTrackPublications().map(a=>{var l;return(l=a.track)==null?void 0:l.source}).filter(a=>a!==void 0),o=Array.from(Nne(new Set(r),new Set(s)));o.length>0&&n.set(i.identity,o)})}return n}function Dne(t){const e=Nm(),n=Bw(e),r=v.useMemo(()=>n===Ie.Disconnected,[n]),i=v.useMemo(()=>Mte(e,t),[e,t,r]),s=On(i.isSendingObservable,!1),o=On(i.messageObservable,[]);return{send:i.send,update:i.update,chatMessages:o,isSending:s}}function V2(t={}){const[e,n]=v.useState(Xte(t.defaults,t.preventLoad??!1)),r=v.useCallback(l=>{n(u=>({...u,audioEnabled:l}))},[]),i=v.useCallback(l=>{n(u=>({...u,videoEnabled:l}))},[]),s=v.useCallback(l=>{n(u=>({...u,audioDeviceId:l}))},[]),o=v.useCallback(l=>{n(u=>({...u,videoDeviceId:l}))},[]),a=v.useCallback(l=>{n(u=>({...u,username:l}))},[]);return v.useEffect(()=>{Yte(e,t.preventSave??!1)},[e,t.preventSave]),{userChoices:e,saveAudioInputEnabled:r,saveVideoInputEnabled:i,saveAudioInputDeviceId:s,saveVideoInputDeviceId:o,saveUsername:a}}function Lne(t,e={}){const n=fd(t),r=Ol(e.room),i=v.useMemo(()=>yte(r,n),[r,n]);return On(i,n.isLocal?n.isE2EEEnabled:!!(n!=null&&n.isEncrypted))}const B2=v.forwardRef(function(t,e){const{mergedProps:n}=Pne({props:t});return v.createElement("button",{ref:e,...n},t.children)}),Mne=v.forwardRef(function(t,e){const{buttonProps:n}=gne(t);return v.createElement("button",{ref:e,...n},t.children)}),Une=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},v.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),v.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),Fne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},v.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),jne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",...t},v.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),Vne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none",...t},v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),tx=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},v.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})),Bne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},v.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},v.createElement("path",{d:"M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9"}))),$ne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),zne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},v.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M4 6.104V4a4 4 0 1 1 8 0v2.104c1.154.326 2 1.387 2 2.646v4.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-4.5c0-1.259.846-2.32 2-2.646ZM5.5 4a2.5 2.5 0 0 1 5 0v2h-5V4Z",clipRule:"evenodd"})),qne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},v.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),v.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),Hne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},v.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),v.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),Wne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),Kne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("g",{opacity:.25},v.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),Gne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("g",{opacity:.25},v.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),v.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),Qne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},v.createElement("g",{opacity:.25},v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),v.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),$2=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),Jne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},v.createElement("g",{fill:"currentColor"},v.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),v.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),nx=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0Z",clipRule:"evenodd"}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 12a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 8 12Z",clipRule:"evenodd",opacity:.7}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 1.072a.75.75 0 0 1 .274 1.024l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 12 1.072Z",clipRule:"evenodd"}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 11.464a.75.75 0 0 1 .274 1.025l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 6 11.464Z",clipRule:"evenodd",opacity:.6}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 4a.75.75 0 0 1-.274 1.025l-2.165 1.25a.75.75 0 1 1-.75-1.3l2.165-1.25A.75.75 0 0 1 14.928 4Z",clipRule:"evenodd"}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 10a.75.75 0 0 1-.275 1.024l-2.165 1.25a.75.75 0 0 1-.75-1.298l2.165-1.25A.75.75 0 0 1 4.536 10Z",clipRule:"evenodd",opacity:.5}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 16 8Z",clipRule:"evenodd"}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 8Z",clipRule:"evenodd",opacity:.4}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 12a.75.75 0 0 1-1.024.274l-2.165-1.25a.75.75 0 0 1 .75-1.299l2.165 1.25A.75.75 0 0 1 14.928 12Z",clipRule:"evenodd",opacity:.9}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 6a.75.75 0 0 1-1.025.275l-2.165-1.25a.75.75 0 1 1 .75-1.3l2.165 1.25A.75.75 0 0 1 4.536 6Z",clipRule:"evenodd",opacity:.3}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 14.928a.75.75 0 0 1-1.024-.274l-1.25-2.165a.75.75 0 0 1 1.298-.75l1.25 2.165A.75.75 0 0 1 12 14.928Z",clipRule:"evenodd",opacity:.8}),v.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 4.536a.75.75 0 0 1-1.024-.275l-1.25-2.165a.75.75 0 1 1 1.299-.75l1.25 2.165A.75.75 0 0 1 6 4.536Z",clipRule:"evenodd",opacity:.2})),Yne=t=>v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},v.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},v.createElement("path",{d:"M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25"}))),Xne=v.forwardRef(function({trackRef:t,...e},n){const r=Am(),{mergedProps:i,inFocus:s}=vne({trackRef:t??r,props:e});return v.createElement(Rm.Consumer,null,o=>o!==void 0&&v.createElement("button",{ref:n,...i},e.children?e.children:s?v.createElement(Yne,null):v.createElement(Bne,null)))}),ky=v.forwardRef(function({kind:t,initialSelection:e,onActiveDeviceChange:n,onDeviceListChange:r,onDeviceSelectError:i,exactMatch:s,track:o,requestPermissions:a,onError:l,...u},c){const d=Om(),h=v.useCallback(I=>{d&&d.emit(V.MediaDevicesError,I),l==null||l(I)},[d,l]),{devices:p,activeDeviceId:g,setActiveMediaDevice:m,className:k}=Tne({kind:t,room:d,track:o,requestPermissions:a,onError:h});v.useEffect(()=>{e!==void 0&&m(e)},[m]),v.useEffect(()=>{typeof r=="function"&&r(p)},[r,p]),v.useEffect(()=>{g&&g!==""&&(n==null||n(g))},[g]);const y=async I=>{try{await m(I,{exact:s})}catch(R){if(R instanceof Error)i==null||i(R);else throw R}},w=v.useMemo(()=>Js(u,{className:k},{className:"lk-list"}),[k,u]),T=!!p.find(I=>I.label.toLowerCase().startsWith("default"));function x(I,R,C){return I===R||!T&&C===0&&R==="default"}return v.createElement("ul",{ref:c,...w},p.map((I,R)=>v.createElement("li",{key:I.deviceId,id:I.deviceId,"data-lk-active":x(I.deviceId,g,R),"aria-selected":x(I.deviceId,g,R),role:"option"},v.createElement("button",{className:"lk-button",onClick:()=>y(I.deviceId)},I.label))))}),Zne=v.forwardRef(function({label:t,...e},n){const r=Nm(),{mergedProps:i,canPlayAudio:s}=Cne({room:r,props:e}),{mergedProps:o,canPlayVideo:a}=xne({room:r,props:i}),{style:l,...u}=o;return l.display=s&&a?"none":"block",v.createElement("button",{ref:n,style:l,...u},t??`Start ${s?"Video":"Audio"}`)});function z2(t,e){switch(t){case $.Source.Microphone:return e?v.createElement(Hne,null):v.createElement(qne,null);case $.Source.Camera:return e?v.createElement(Fne,null):v.createElement(Une,null);case $.Source.ScreenShare:return e?v.createElement(Jne,null):v.createElement($2,null);default:return}}function ere(t){switch(t){case ir.Excellent:return v.createElement(Wne,null);case ir.Good:return v.createElement(Kne,null);case ir.Poor:return v.createElement(Gne,null);default:return v.createElement(Qne,null)}}const Ju=v.forwardRef(function({showIcon:t,...e},n){const{buttonProps:r,enabled:i}=Ane(e);return v.createElement("button",{ref:n,...r},(t??!0)&&z2(e.source,i),e.children)}),tre=v.forwardRef(function(t,e){const{className:n,quality:r}=mne(t),i=v.useMemo(()=>({...Js(t,{className:n}),"data-lk-quality":r}),[r,t,n]);return v.createElement("div",{ref:e,...i},t.children??ere(r))}),rx=v.forwardRef(function({participant:t,...e},n){const r=fd(t),{className:i,infoObserver:s}=v.useMemo(()=>Ite(r),[r]),{identity:o,name:a}=On(s,{name:r.name,identity:r.identity,metadata:r.metadata}),l=v.useMemo(()=>Js(e,{className:i,"data-lk-participant-name":a}),[e,i,a]);return v.createElement("span",{ref:n,...l},a!==""?a:o,e.children)}),nre=v.forwardRef(function({trackRef:t,show:e="always",...n},r){const{className:i,isMuted:s}=Rne(t),o=e==="always"||e==="muted"&&s||e==="unmuted"&&!s,a=v.useMemo(()=>Js(n,{className:i}),[i,n]);return o?v.createElement("div",{ref:r,...a,"data-lk-muted":s},n.children??z2(t.source,!s)):null}),q2=t=>v.createElement("svg",{width:320,height:320,viewBox:"0 0 320 320",preserveAspectRatio:"xMidYMid meet",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},v.createElement("path",{d:"M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",fill:"white",fillOpacity:.25}),v.createElement("path",{d:"M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",fill:"white",fillOpacity:.25}));function H2(t,e={}){const[n,r]=v.useState(Xb(t)),[i,s]=v.useState(n==null?void 0:n.isMuted),[o,a]=v.useState(n==null?void 0:n.isSubscribed),[l,u]=v.useState(n==null?void 0:n.track),[c,d]=v.useState("landscape"),h=v.useRef(),{className:p,trackObserver:g}=v.useMemo(()=>ute(t),[t.participant.sid??t.participant.identity,t.source,An(t)&&t.publication.trackSid]);return v.useEffect(()=>{const m=g.subscribe(k=>{Ce.debug("update track",k),r(k),s(k==null?void 0:k.isMuted),a(k==null?void 0:k.isSubscribed),u(k==null?void 0:k.track)});return()=>m==null?void 0:m.unsubscribe()},[g]),v.useEffect(()=>{var m,k;return l&&(h.current&&l.detach(h.current),(m=e.element)!=null&&m.current&&!(t.participant.isLocal&&(l==null?void 0:l.kind)==="audio")&&l.attach(e.element.current)),h.current=(k=e.element)==null?void 0:k.current,()=>{h.current&&(l==null||l.detach(h.current))}},[l,e.element]),v.useEffect(()=>{var m,k;if(typeof((m=n==null?void 0:n.dimensions)==null?void 0:m.width)=="number"&&typeof((k=n==null?void 0:n.dimensions)==null?void 0:k.height)=="number"){const y=n.dimensions.width>n.dimensions.height?"landscape":"portrait";d(y)}},[n]),{publication:n,isMuted:i,isSubscribed:o,track:l,elementProps:Js(e.props,{className:p,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":n==null?void 0:n.source,...(n==null?void 0:n.kind)==="video"&&{"data-lk-orientation":c}})}}var rre="Expected a function",ix=NaN,ire="[object Symbol]",sre=/^\s+|\s+$/g,ore=/^[-+]0x[0-9a-f]+$/i,are=/^0b[01]+$/i,lre=/^0o[0-7]+$/i,ure=parseInt,cre=typeof Eu=="object"&&Eu&&Eu.Object===Object&&Eu,dre=typeof self=="object"&&self&&self.Object===Object&&self,fre=cre||dre||Function("return this")(),hre=Object.prototype,pre=hre.toString,mre=Math.max,gre=Math.min,wy=function(){return fre.Date.now()};function yre(t,e,n){var r,i,s,o,a,l,u=0,c=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(rre);e=sx(e)||0,e0(n)&&(c=!!n.leading,d="maxWait"in n,s=d?mre(sx(n.maxWait)||0,e):s,h="trailing"in n?!!n.trailing:h);function p(R){var C=r,_=i;return r=i=void 0,u=R,o=t.apply(_,C),o}function g(R){return u=R,a=setTimeout(y,e),c?p(R):o}function m(R){var C=R-l,_=R-u,P=e-C;return d?gre(P,s-_):P}function k(R){var C=R-l,_=R-u;return l===void 0||C>=e||C<0||d&&_>=s}function y(){var R=wy();if(k(R))return w(R);a=setTimeout(y,m(R))}function w(R){return a=void 0,h&&r?p(R):(r=i=void 0,o)}function T(){a!==void 0&&clearTimeout(a),u=0,r=l=i=a=void 0}function x(){return a===void 0?o:w(wy())}function I(){var R=wy(),C=k(R);if(r=arguments,i=this,l=R,C){if(a===void 0)return g(l);if(d)return a=setTimeout(y,e),p(l)}return a===void 0&&(a=setTimeout(y,e)),o}return I.cancel=T,I.flush=x,I}function e0(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function vre(t){return!!t&&typeof t=="object"}function bre(t){return typeof t=="symbol"||vre(t)&&pre.call(t)==ire}function sx(t){if(typeof t=="number")return t;if(bre(t))return ix;if(e0(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=e0(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(sre,"");var n=are.test(t);return n||lre.test(t)?ure(t.slice(2),n?2:8):ore.test(t)?ix:+t}var kre=yre;const ox=ZL(kre);function wre(t){const e=v.useRef(t);e.current=t,v.useEffect(()=>()=>{e.current()},[])}function Tre(t,e=500,n){const r=v.useRef();wre(()=>{r.current&&r.current.cancel()});const i=v.useMemo(()=>{const s=ox(t,e,n),o=(...a)=>s(...a);return o.cancel=()=>{s.cancel()},o.isPending=()=>!!r.current,o.flush=()=>s.flush(),o},[t,e,n]);return v.useEffect(()=>{r.current=ox(t,e,n)},[t,e,n]),i}function Sre(t,e,n){const r=(u,c)=>u===c,i=t instanceof Function?t():t,[s,o]=v.useState(i),a=v.useRef(i),l=Tre(o,e,n);return r(a.current,i)||(l(i),a.current=i),[s,l]}function _re({threshold:t=0,root:e=null,rootMargin:n="0%",freezeOnceVisible:r=!1,initialIsIntersecting:i=!1,onChange:s}={}){var o;const[a,l]=v.useState(null),[u,c]=v.useState(()=>({isIntersecting:i,entry:void 0})),d=v.useRef();d.current=s;const h=((o=u.entry)==null?void 0:o.isIntersecting)&&r;v.useEffect(()=>{if(!a||!("IntersectionObserver"in window)||h)return;let m;const k=new IntersectionObserver(y=>{const w=Array.isArray(k.thresholds)?k.thresholds:[k.thresholds];y.forEach(T=>{const x=T.isIntersecting&&w.some(I=>T.intersectionRatio>=I);c({isIntersecting:x,entry:T}),d.current&&d.current(x,T),x&&r&&m&&(m(),m=void 0)})},{threshold:t,root:e,rootMargin:n});return k.observe(a),()=>{k.disconnect()}},[a,JSON.stringify(t),e,n,h,r]);const p=v.useRef(null);v.useEffect(()=>{var m;!a&&(m=u.entry)!=null&&m.target&&!r&&!h&&p.current!==u.entry.target&&(p.current=u.entry.target,c({isIntersecting:i,entry:void 0}))},[a,u.entry,r,h,i]);const g=[l,!!u.isIntersecting,u.entry];return g.ref=g[0],g.isIntersecting=g[1],g.entry=g[2],g}const Ere=v.forwardRef(function({onTrackClick:t,onClick:e,onSubscriptionStatusChanged:n,trackRef:r,manageSubscription:i,...s},o){const a=Nl(r),l=v.useRef(null);v.useImperativeHandle(o,()=>l.current);const u=_re({root:l.current}),[c]=Sre(u,3e3);v.useEffect(()=>{i&&a.publication instanceof Lc&&(c==null?void 0:c.isIntersecting)===!1&&(u==null?void 0:u.isIntersecting)===!1&&a.publication.setSubscribed(!1)},[c,a,i]),v.useEffect(()=>{i&&a.publication instanceof Lc&&(u==null?void 0:u.isIntersecting)===!0&&a.publication.setSubscribed(!0)},[u,a,i]);const{elementProps:d,publication:h,isSubscribed:p}=H2(a,{element:l,props:s});v.useEffect(()=>{n==null||n(!!p)},[p,n]);const g=m=>{e==null||e(m),t==null||t({participant:a==null?void 0:a.participant,track:h})};return v.createElement("video",{ref:l,...d,muted:!0,onClick:g})}),W2=v.forwardRef(function({trackRef:t,onSubscriptionStatusChanged:e,volume:n,muted:r,...i},s){const o=Nl(t),a=v.useRef(null);v.useImperativeHandle(s,()=>a.current);const{elementProps:l,isSubscribed:u,track:c,publication:d}=H2(o,{element:a,props:i});return v.useEffect(()=>{e==null||e(!!u)},[u,e]),v.useEffect(()=>{c===void 0||n===void 0||(c instanceof Ha?c.setVolume(n):Ce.warn("Volume can only be set on remote audio tracks."))},[n,c]),v.useEffect(()=>{d===void 0||r===void 0||(d instanceof Lc?d.setEnabled(!r):Ce.warn("Can only call setEnabled on remote track publications."))},[r,d,c]),v.createElement("audio",{ref:a,...l})});function Cre(t){const e=!!N2();return t.participant&&!e?v.createElement(A2.Provider,{value:t.participant},t.children):v.createElement(v.Fragment,null,t.children)}function xre(t){const e=!!Am();return t.trackRef&&!e?v.createElement(jw.Provider,{value:t.trackRef},t.children):v.createElement(v.Fragment,null,t.children)}const t0=v.forwardRef(function({trackRef:t,children:e,onParticipantClick:n,disableSpeakingIndicator:r,...i},s){var o,a;const l=Nl(t),{elementProps:u}=_ne({htmlProps:i,disableSpeakingIndicator:r,onParticipantClick:n,trackRef:l}),c=Lne(l.participant),d=dd(),h=(o=rne())==null?void 0:o.autoSubscription,p=v.useCallback(g=>{l.source&&!g&&d&&d.pin.dispatch&&w2(l,d.pin.state)&&d.pin.dispatch({msg:"clear_pin"})},[l,d]);return v.createElement("div",{ref:s,style:{position:"relative"},...u},v.createElement(xre,{trackRef:l},v.createElement(Cre,{participant:l.participant},e??v.createElement(v.Fragment,null,An(l)&&(((a=l.publication)==null?void 0:a.kind)==="video"||l.source===$.Source.Camera||l.source===$.Source.ScreenShare)?v.createElement(Ere,{trackRef:l,onSubscriptionStatusChanged:p,manageSubscription:h}):An(l)&&v.createElement(W2,{trackRef:l,onSubscriptionStatusChanged:p}),v.createElement("div",{className:"lk-participant-placeholder"},v.createElement(q2,null)),v.createElement("div",{className:"lk-participant-metadata"},v.createElement("div",{className:"lk-participant-metadata-item"},l.source===$.Source.Camera?v.createElement(v.Fragment,null,c&&v.createElement(zne,{style:{marginRight:"0.25rem"}}),v.createElement(nre,{trackRef:{participant:l.participant,source:$.Source.Microphone},show:"muted"}),v.createElement(rx,null)):v.createElement(v.Fragment,null,v.createElement($2,{style:{marginRight:"0.25rem"}}),v.createElement(rx,null,"'s screen"))),v.createElement(tre,{className:"lk-participant-metadata-item"}))),v.createElement(Xne,{trackRef:l}))))});function Ire(t){const e=Js(t,{className:"lk-focus-layout"});return v.createElement("div",{...e},t.children)}function Pre({trackRef:t,...e}){return v.createElement(t0,{trackRef:t,...e})}function K2({tracks:t,...e}){return v.createElement(v.Fragment,null,t.map(n=>v.createElement(jw.Provider,{value:n,key:nn(n)},one(e.children))))}function Rre({totalPageCount:t,nextPage:e,prevPage:n,currentPage:r,pagesContainer:i}){const[s,o]=v.useState(!1);return v.useEffect(()=>{let a;return i&&(a=qte(i.current,2e3).subscribe(o)),()=>{a&&a.unsubscribe()}},[i]),v.createElement("div",{className:"lk-pagination-control","data-lk-user-interaction":s},v.createElement("button",{className:"lk-button",onClick:n},v.createElement(tx,null)),v.createElement("span",{className:"lk-pagination-count"},`${r} of ${t}`),v.createElement("button",{className:"lk-button",onClick:e},v.createElement(tx,null)))}const Are=v.forwardRef(function({totalPageCount:t,currentPage:e},n){const r=new Array(t).fill("").map((i,s)=>s+1===e?v.createElement("span",{"data-lk-active":!0,key:s}):v.createElement("span",{key:s}));return v.createElement("div",{ref:n,className:"lk-pagination-indicator"},r)});function Nre({tracks:t,...e}){const n=v.createRef(),r=v.useMemo(()=>Js(e,{className:"lk-grid-layout"}),[e]),{layout:i}=bne(n,t.length),s=Sne(i.maxTiles,t);return Ine(n,{onLeftSwipe:s.nextPage,onRightSwipe:s.prevPage}),v.createElement("div",{ref:n,"data-lk-pagination":s.totalPageCount>1,...r},v.createElement(K2,{tracks:s.tracks},e.children),t.length>i.maxTiles&&v.createElement(v.Fragment,null,v.createElement(Are,{totalPageCount:s.totalPageCount,currentPage:s.currentPage}),v.createElement(Rre,{pagesContainer:n,...s})))}const Ore=130,Dre=140,Lre=1,G2=16/10,Mre=(1-G2)*-1;function Ure({tracks:t,orientation:e,...n}){const r=v.useRef(null),[i,s]=v.useState(0),{width:o,height:a}=U2(r),l=e||(a>=o?"vertical":"horizontal"),u=l==="vertical"?Math.max(o*Mre,Ore):Math.max(a*G2,Dre),c=jee(),d=Math.max(l==="vertical"?(a-c)/u:(o-c)/u,Lre);let h=Math.round(d);Math.abs(d-i)<.5?h=Math.round(i):i!==d&&s(d);const p=F2(t,h);return v.useLayoutEffect(()=>{r.current&&(r.current.dataset.lkOrientation=l,r.current.style.setProperty("--lk-max-visible-tiles",h.toString()))},[h,l]),v.createElement("aside",{key:l,className:"lk-carousel",ref:r,...n},v.createElement(K2,{tracks:p},n.children))}function Fre({value:t,onPinChange:e,onWidgetChange:n,children:r}){const i=nne(t);return v.useEffect(()=>{Ce.debug("PinState Updated",{state:i.pin.state}),e&&i.pin.state&&e(i.pin.state)},[i.pin.state,e]),v.useEffect(()=>{Ce.debug("Widget Updated",{widgetState:i.widget.state}),n&&i.widget.state&&n(i.widget.state)},[n,i.widget.state]),v.createElement(Rm.Provider,{value:i},r)}function jre({volume:t,muted:e}){const n=j2([$.Source.Microphone,$.Source.ScreenShareAudio,$.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter(r=>!r.participant.isLocal&&r.publication.kind===$.Kind.Audio);return v.createElement("div",{style:{display:"none"}},n.map(r=>v.createElement(W2,{key:nn(r),trackRef:r,volume:t,muted:e})))}function Vre(t){const e=v.useMemo(()=>Js(t,{className:"lk-toast"}),[t]);return v.createElement("div",{...e},t.children)}function Bre(t){const[e,n]=v.useState(void 0),r=Bw(t.room);return v.useEffect(()=>{switch(r){case Ie.Reconnecting:n(v.createElement(v.Fragment,null,v.createElement(nx,{className:"lk-spinner"})," Reconnecting"));break;case Ie.Connecting:n(v.createElement(v.Fragment,null,v.createElement(nx,{className:"lk-spinner"})," Connecting"));break;case Ie.Disconnected:n(v.createElement(v.Fragment,null,"Disconnected"));break;default:n(void 0);break}},[r]),e?v.createElement(Vre,{className:"lk-toast-connection-state"},e):v.createElement(v.Fragment,null)}const $re=v.forwardRef(function({entry:t,hideName:e=!1,hideTimestamp:n=!1,messageFormatter:r,...i},s){var o,a,l;const u=v.useMemo(()=>r?r(t.message):t.message,[t.message,r]),c=!!t.editTimestamp,d=new Date(t.timestamp),h=navigator?navigator.language:"en-US";return v.createElement("li",{ref:s,className:"lk-chat-entry",title:d.toLocaleTimeString(h,{timeStyle:"full"}),"data-lk-message-origin":(o=t.from)!=null&&o.isLocal?"local":"remote",...i},(!n||!e||c)&&v.createElement("span",{className:"lk-meta-data"},!e&&v.createElement("strong",{className:"lk-participant-name"},((a=t.from)==null?void 0:a.name)??((l=t.from)==null?void 0:l.identity)),(!n||c)&&v.createElement("span",{className:"lk-timestamp"},c&&"edited ",d.toLocaleTimeString(h,{timeStyle:"short"}))),v.createElement("span",{className:"lk-message-body"},u))});function fp({kind:t,initialSelection:e,onActiveDeviceChange:n,tracks:r,requestPermissions:i=!1,...s}){const[o,a]=v.useState(!1),[l,u]=v.useState([]),[c,d]=v.useState(!0),[h,p]=v.useState(i),g=(w,T)=>{Ce.debug("handle device change"),a(!1),n==null||n(w,T)},m=v.useRef(null),k=v.useRef(null);v.useLayoutEffect(()=>{o&&p(!0)},[o]),v.useLayoutEffect(()=>{m.current&&k.current&&(l||c)&&Vee(m.current,k.current).then(({x:w,y:T})=>{k.current&&Object.assign(k.current.style,{left:`${w}px`,top:`${T}px`})}),d(!1)},[m,k,l,c]);const y=v.useCallback(w=>{k.current&&w.target!==m.current&&o&&Bee(k.current,w)&&a(!1)},[o,k,m]);return v.useEffect(()=>(document.addEventListener("click",y),window.addEventListener("resize",()=>d(!0)),()=>{document.removeEventListener("click",y),window.removeEventListener("resize",()=>d(!0))}),[y,d]),v.createElement(v.Fragment,null,v.createElement("button",{className:"lk-button lk-button-menu","aria-pressed":o,...s,onClick:()=>a(!o),ref:m},s.children),!s.disabled&&v.createElement("div",{className:"lk-device-menu",ref:k,style:{visibility:o?"visible":"hidden"}},t?v.createElement(ky,{initialSelection:e,onActiveDeviceChange:w=>g(t,w),onDeviceListChange:u,kind:t,track:r==null?void 0:r[t],requestPermissions:h}):v.createElement(v.Fragment,null,v.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),v.createElement(ky,{kind:"audioinput",onActiveDeviceChange:w=>g("audioinput",w),onDeviceListChange:u,track:r==null?void 0:r.audioinput,requestPermissions:h}),v.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),v.createElement(ky,{kind:"videoinput",onActiveDeviceChange:w=>g("videoinput",w),onDeviceListChange:u,track:r==null?void 0:r.videoinput,requestPermissions:h}))))}function zre(){v.useEffect(()=>{ane()},[])}function qre(t,e){const[n,r]=v.useState(),i=v.useMemo(()=>new Tn,[]);return v.useEffect(()=>{let s=!1,o=[];return i.lock().then(async a=>{try{(t.audio||t.video)&&(o=await Ew(t),s?o.forEach(l=>l.stop()):r(o))}catch(l){e&&l instanceof Error?e(l):Ce.error(l)}finally{a()}}),()=>{s=!0,o.forEach(a=>{a.stop()})}},[JSON.stringify(t,M2),e,i]),n}function Hre({defaults:t={},onValidate:e,onSubmit:n,onError:r,debug:i,joinLabel:s="Join Room",micLabel:o="Microphone",camLabel:a="Camera",userLabel:l="Username",persistUserChoices:u=!0,videoProcessor:c,...d}){const[h,p]=v.useState(pa),g={...t.audioDeviceId!==void 0&&{audioDeviceId:t.audioDeviceId},...t.videoDeviceId!==void 0&&{videoDeviceId:t.videoDeviceId},...t.audioEnabled!==void 0&&{audioEnabled:t.audioEnabled},...t.videoEnabled!==void 0&&{videoEnabled:t.videoEnabled},...t.username!==void 0&&{username:t.username}},{userChoices:m,saveAudioInputDeviceId:k,saveAudioInputEnabled:y,saveVideoInputDeviceId:w,saveVideoInputEnabled:T,saveUsername:x}=V2({defaults:g,preventSave:!u,preventLoad:!u}),[I,R]=v.useState(m.audioEnabled),[C,_]=v.useState(m.videoEnabled),[P,N]=v.useState(m.audioDeviceId),[A,D]=v.useState(m.videoDeviceId),[L,ae]=v.useState(m.username);v.useEffect(()=>{y(I)},[I,y]),v.useEffect(()=>{T(C)},[C,T]),v.useEffect(()=>{k(P)},[P,k]),v.useEffect(()=>{w(A)},[A,w]),v.useEffect(()=>{x(L)},[L,x]);const re=qre({audio:I?{deviceId:m.audioDeviceId}:!1,video:C?{deviceId:m.videoDeviceId,processor:c}:!1},r),Te=v.useRef(null),ue=v.useMemo(()=>re==null?void 0:re.filter(be=>be.kind===$.Kind.Video)[0],[re]),Q=v.useMemo(()=>{if(ue){const{facingMode:be}=VL(ue);return be}else return"undefined"},[ue]),se=v.useMemo(()=>re==null?void 0:re.filter(be=>be.kind===$.Kind.Audio)[0],[re]);v.useEffect(()=>(Te.current&&ue&&(ue.unmute(),ue.attach(Te.current)),()=>{ue==null||ue.detach()}),[ue]);const[M,Se]=v.useState(),ye=v.useCallback(be=>typeof e=="function"?e(be):be.username!=="",[e]);v.useEffect(()=>{const be={username:L,videoEnabled:C,videoDeviceId:A,audioEnabled:I,audioDeviceId:P};p(be),Se(ye(be))},[L,C,ye,I,P,A]);function U(be){be.preventDefault(),ye(h)?typeof n=="function"&&n(h):Ce.warn("Validation failed with: ",h)}return zre(),v.createElement("div",{className:"lk-prejoin",...d},v.createElement("div",{className:"lk-video-container"},ue&&v.createElement("video",{ref:Te,width:"1280",height:"720","data-lk-facing-mode":Q}),(!ue||!C)&&v.createElement("div",{className:"lk-camera-off-note"},v.createElement(q2,null))),v.createElement("div",{className:"lk-button-group-container"},v.createElement("div",{className:"lk-button-group audio"},v.createElement(Ju,{initialState:I,source:$.Source.Microphone,onChange:be=>R(be)},o),v.createElement("div",{className:"lk-button-group-menu"},v.createElement(fp,{initialSelection:P,kind:"audioinput",disabled:!se,tracks:{audioinput:se},onActiveDeviceChange:(be,mt)=>N(mt)}))),v.createElement("div",{className:"lk-button-group video"},v.createElement(Ju,{initialState:C,source:$.Source.Camera,onChange:be=>_(be)},a),v.createElement("div",{className:"lk-button-group-menu"},v.createElement(fp,{initialSelection:A,kind:"videoinput",disabled:!ue,tracks:{videoinput:ue},onActiveDeviceChange:(be,mt)=>D(mt)})))),v.createElement("form",{className:"lk-username-container"},v.createElement("input",{className:"lk-form-control",id:"username",name:"username",type:"text",defaultValue:L,placeholder:l,onChange:be=>ae(be.target.value),autoComplete:"off"}),v.createElement("button",{className:"lk-button lk-join-button",type:"submit",onClick:U,disabled:!M},s)),i&&v.createElement(v.Fragment,null,v.createElement("strong",null,"User Choices:"),v.createElement("ul",{className:"lk-list",style:{overflow:"hidden",maxWidth:"15rem"}},v.createElement("li",null,"Username: ",`${h.username}`),v.createElement("li",null,"Video Enabled: ",`${h.videoEnabled}`),v.createElement("li",null,"Audio Enabled: ",`${h.audioEnabled}`),v.createElement("li",null,"Video Device: ",`${h.videoDeviceId}`),v.createElement("li",null,"Audio Device: ",`${h.audioDeviceId}`))))}var Q2={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(Sy,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function a(m,k){var y=m[k];if(typeof y.bind=="function")return y.bind(m);try{return Function.prototype.bind.call(y,m)}catch{return function(){return Function.prototype.apply.apply(y,[m,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(m){return m==="debug"&&(m="log"),typeof console===n?!1:m==="trace"&&r?l:console[m]!==void 0?a(console,m):console.log!==void 0?a(console,"log"):e}function c(){for(var m=this.getLevel(),k=0;k<i.length;k++){var y=i[k];this[y]=k<m?e:this.methodFactory(y,m,this.name)}if(this.log=this.debug,typeof console===n&&m<this.levels.SILENT)return"No console available for logging"}function d(m){return function(){typeof console!==n&&(c.call(this),this[m].apply(this,arguments))}}function h(m,k,y){return u(m)||d.apply(this,arguments)}function p(m,k){var y=this,w,T,x,I="loglevel";typeof m=="string"?I+=":"+m:typeof m=="symbol"&&(I=void 0);function R(A){var D=(i[A]||"silent").toUpperCase();if(!(typeof window===n||!I)){try{window.localStorage[I]=D;return}catch{}try{window.document.cookie=encodeURIComponent(I)+"="+D+";"}catch{}}}function C(){var A;if(!(typeof window===n||!I)){try{A=window.localStorage[I]}catch{}if(typeof A===n)try{var D=window.document.cookie,L=encodeURIComponent(I),ae=D.indexOf(L+"=");ae!==-1&&(A=/^([^;]+)/.exec(D.slice(ae+L.length+1))[1])}catch{}return y.levels[A]===void 0&&(A=void 0),A}}function _(){if(!(typeof window===n||!I)){try{window.localStorage.removeItem(I)}catch{}try{window.document.cookie=encodeURIComponent(I)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function P(A){var D=A;if(typeof D=="string"&&y.levels[D.toUpperCase()]!==void 0&&(D=y.levels[D.toUpperCase()]),typeof D=="number"&&D>=0&&D<=y.levels.SILENT)return D;throw new TypeError("log.setLevel() called with invalid level: "+A)}y.name=m,y.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},y.methodFactory=k||h,y.getLevel=function(){return x??T??w},y.setLevel=function(A,D){return x=P(A),D!==!1&&R(x),c.call(y)},y.setDefaultLevel=function(A){T=P(A),C()||y.setLevel(A,!1)},y.resetLevel=function(){x=null,_(),c.call(y)},y.enableAll=function(A){y.setLevel(y.levels.TRACE,A)},y.disableAll=function(A){y.setLevel(y.levels.SILENT,A)},y.rebuild=function(){if(o!==y&&(w=P(o.getLevel())),c.call(y),o===y)for(var A in s)s[A].rebuild()},w=P(o?o.getLevel():"WARN");var N=C();N!=null&&(x=P(N)),c.call(y)}o=new p,o.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var y=s[k];return y||(y=s[k]=new p(k,o.methodFactory)),y};var g=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=g),o},o.getLoggers=function(){return s},o.default=o,o})})(Q2);var Wre=Q2.exports;const Kre=yp(Wre);function Qa(t){return typeof t>"u"?!1:Gre(t)||Qre(t)}function Gre(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function Qre(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function Jre(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function ax(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(Jre(t))return`${t.participant.identity}_${t.source}_placeholder`;if(Qa(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function Yre(t,e){return t===void 0||e===void 0?!1:Qa(t)&&Qa(e)?t.publication.trackSid===e.publication.trackSid:ax(t)===ax(e)}function Xre(){return typeof document<"u"}var Zre=[V.ConnectionStateChanged,V.RoomMetadataChanged,V.ActiveSpeakersChanged,V.ConnectionQualityChanged,V.ParticipantConnected,V.ParticipantDisconnected,V.ParticipantPermissionsChanged,V.ParticipantMetadataChanged,V.ParticipantNameChanged,V.ParticipantAttributesChanged,V.TrackMuted,V.TrackUnmuted,V.TrackPublished,V.TrackUnpublished,V.TrackStreamStateChanged,V.TrackSubscriptionFailed,V.TrackSubscriptionPermissionChanged,V.TrackSubscriptionStatusChanged];[...Zre,V.LocalTrackPublished,V.LocalTrackUnpublished];B.TrackPublished,B.TrackUnpublished,B.TrackMuted,B.TrackUnmuted,B.TrackStreamStateChanged,B.TrackSubscribed,B.TrackUnsubscribed,B.TrackSubscriptionPermissionChanged,B.TrackSubscriptionFailed,B.LocalTrackPublished,B.LocalTrackUnpublished;var eie=[B.ConnectionQualityChanged,B.IsSpeakingChanged,B.ParticipantMetadataChanged,B.ParticipantPermissionsChanged,B.TrackMuted,B.TrackUnmuted,B.TrackPublished,B.TrackUnpublished,B.TrackStreamStateChanged,B.TrackSubscriptionFailed,B.TrackSubscriptionPermissionChanged,B.TrackSubscriptionStatusChanged];[...eie,B.LocalTrackPublished,B.LocalTrackUnpublished];var rh=Kre.getLogger("lk-components-js");rh.setDefaultLevel("WARN");new TextEncoder;new TextDecoder;function tie(t){const e=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,r]=v.useState(e(t));function i(){r(e(t))}return v.useEffect(()=>{const s=window.matchMedia(t);return i(),s.addListener?s.addListener(i):s.addEventListener("change",i),()=>{s.removeListener?s.removeListener(i):s.removeEventListener("change",i)}},[t]),n}function nie(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}class rie{getToken(e,n){return rr.post("/openvidu/token",{roomName:e,participantName:n})}startRecording(e){return rr.post("/openvidu/recordings/start",{roomName:e})}stopRecording(e){return rr.post("/openvidu/recordings/stop",{roomName:e})}deleteRecording(e){return rr.delete(`/openvidu/recordings/${e}`)}listRecordings(e,n){const r="/openvidu/recordings"+(e?`?roomName=${e}`+(n?`&roomId=${n}`:""):"");return rr.get(r)}}const Yu=new rie;function iie(){const t=Ol(),[e,n]=v.useState("錄製"),{summarizeMeeting:r}=rd(),{user:i}=Fr(),[s,o]=v.useState(null),a=()=>{Ue.success("摘要生成完成",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},l=()=>{Ue.error("摘要生成失敗",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})};v.useEffect(()=>{const c=async d=>{if(d)n("停止");else if(n("錄製"),console.log(s),s)if(i)try{await r({s3FileName:s})?a():l()}catch{l()}else l()};return t.on(V.RecordingStatusChanged,c),()=>{t.off(V.RecordingStatusChanged,c)}},[t,i,s]);const u=async()=>{if(t.isRecording){n("停止中...");const c=await Yu.stopRecording(t.name);console.log(c.data.recording),c.status===409?n("停止"):c.status===200&&o(c.data.recording.name)}else{n("錄製中...");const c=await Yu.startRecording(t.name);console.log(c.data),c.status===409&&n("錄製")}};return E.jsxs("button",{onClick:u,id:"recordButton",className:"flex items-center justify-center px-6 py-3 rounded-md bg-red-600 text-white font-bold text-lg shadow-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2",children:[E.jsx("span",{id:"recordIcon",className:"mr-2 w-4 h-4 bg-red-800 rounded-full"}),E.jsxs("span",{id:"recordText",children:[" ",e]})]})}function sie({variation:t,controls:e,saveUserChoices:n=!0,onDeviceError:r,...i}){var _;const[s,o]=v.useState(!1),a=dd();v.useEffect(()=>{var P,N;((P=a==null?void 0:a.widget.state)==null?void 0:P.showChat)!==void 0&&o((N=a==null?void 0:a.widget.state)==null?void 0:N.showChat)},[(_=a==null?void 0:a.widget.state)==null?void 0:_.showChat]);const u=tie(`(max-width: ${s?1e3:760}px)`)?"minimal":"verbose";t??(t=u);const c={leave:!0,...e},d=wne();d?(c.camera??(c.camera=d.canPublish),c.microphone??(c.microphone=d.canPublish),c.screenShare??(c.screenShare=d.canPublish),c.chat??(c.chat=d.canPublishData&&(e==null?void 0:e.chat))):(c.camera=!1,c.chat=!1,c.microphone=!1,c.screenShare=!1);const h=v.useMemo(()=>t==="minimal"||t==="verbose",[t]),p=v.useMemo(()=>t==="textOnly"||t==="verbose",[t]),g=nie(),[m,k]=v.useState(!1),y=v.useCallback(P=>{k(P)},[k]),{saveAudioInputEnabled:w,saveVideoInputEnabled:T,saveAudioInputDeviceId:x,saveVideoInputDeviceId:I}=V2({preventSave:!n}),R=v.useCallback((P,N)=>N?w(P):null,[w]),C=v.useCallback((P,N)=>N?T(P):null,[T]);return E.jsxs("div",{className:"lk-control-bar",...i,children:[c.microphone&&E.jsxs("div",{className:"lk-button-group",children:[E.jsx(Ju,{source:$.Source.Microphone,showIcon:h,onChange:R,onDeviceError:P=>r==null?void 0:r({source:$.Source.Microphone,error:P}),children:p&&"麥克風"}),E.jsx("div",{className:"lk-button-group-menu",children:E.jsx(fp,{kind:"audioinput",onActiveDeviceChange:(P,N)=>x(N??"default")})})]}),c.camera&&E.jsxs("div",{className:"lk-button-group",children:[E.jsx(Ju,{source:$.Source.Camera,showIcon:h,onChange:C,onDeviceError:P=>r==null?void 0:r({source:$.Source.Camera,error:P}),children:p&&"相機"}),E.jsx("div",{className:"lk-button-group-menu",children:E.jsx(fp,{kind:"videoinput",onActiveDeviceChange:(P,N)=>I(N??"default")})})]}),c.screenShare&&g&&E.jsx(Ju,{source:$.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:h,onChange:y,onDeviceError:P=>r==null?void 0:r({source:$.Source.ScreenShare,error:P}),children:p&&(m?"停止螢幕分享":"開始螢幕分享")}),c.chat&&E.jsxs(B2,{children:[h&&E.jsx(Vne,{}),p&&"聊天"]}),E.jsx(iie,{}),c.leave&&E.jsxs(Mne,{children:[h&&E.jsx($ne,{}),p&&"離開"]}),E.jsx(Zne,{})]})}function oie(t,e,n){return v.Children.map(t,r=>v.isValidElement(r)&&v.Children.only(t)?(r.props.class&&(e??(e={}),e.class=Rs(r.props.class,e.class),e.style={...r.props.style,...e.style}),v.cloneElement(r,{...e,key:n})):r)}function aie({messageFormatter:t,messageDecoder:e,messageEncoder:n,channelTopic:r,...i}){const s=v.useRef(null),o=v.useRef(null),a=v.useMemo(()=>({messageDecoder:e,messageEncoder:n,channelTopic:r}),[e,n,r]),{send:l,chatMessages:u,isSending:c}=Dne(a),d=dd(),h=v.useRef(0);async function p(g){g.preventDefault(),s.current&&s.current.value.trim()!==""&&l&&(await l(s.current.value),s.current.value="",s.current.focus())}return v.useEffect(()=>{var g;o&&((g=o.current)==null||g.scrollTo({top:o.current.scrollHeight}))},[o,u]),v.useEffect(()=>{var k,y,w,T,x;if(!d||u.length===0)return;if((k=d.widget.state)!=null&&k.showChat&&u.length>0&&h.current!==((y=u[u.length-1])==null?void 0:y.timestamp)){h.current=(w=u[u.length-1])==null?void 0:w.timestamp;return}const g=u.filter(I=>!h.current||I.timestamp>h.current).length,{widget:m}=d;g>0&&((T=m.state)==null?void 0:T.unreadMessages)!==g&&((x=m.dispatch)==null||x.call(m,{msg:"unread_msg",count:g}))},[u,d==null?void 0:d.widget]),E.jsxs("div",{...i,className:"lk-chat",children:[E.jsxs("div",{className:"lk-chat-header",children:["聊天室",d&&E.jsx(B2,{className:"lk-close-button",children:E.jsx(jne,{})})]}),E.jsx("ul",{className:"lk-list lk-chat-messages",ref:o,children:i.children?u.map((g,m)=>oie(i.children,{entry:g,key:g.id??m,messageFormatter:t})):u.map((g,m,k)=>{const y=m>=1&&k[m-1].from===g.from,w=m>=1&&g.timestamp-k[m-1].timestamp<6e4;return E.jsx($re,{hideName:y,hideTimestamp:y===!1?!1:w,entry:g,messageFormatter:t},g.id??m)})}),E.jsxs("form",{className:"lk-chat-form",onSubmit:p,children:[E.jsx("input",{className:"lk-form-control lk-chat-form-input",disabled:c,ref:s,type:"text",placeholder:"輸入訊息...",onInput:g=>g.stopPropagation(),onKeyDown:g=>g.stopPropagation(),onKeyUp:g=>g.stopPropagation()}),E.jsx("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:c,children:"傳送"})]})]})}function lie({chatMessageFormatter:t,chatMessageDecoder:e,chatMessageEncoder:n,SettingsComponent:r,...i}){var g,m;const[s,o]=v.useState({showChat:!1,unreadMessages:0,showSettings:!1}),a=v.useRef(null),l=j2([{source:$.Source.Camera,withPlaceholder:!0},{source:$.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[V.ActiveSpeakersChanged],onlySubscribed:!1}),u=k=>{rh.debug("updating widget state",k),o(k)},c=tne(),d=l.filter(Qa).filter(k=>k.publication.source===$.Source.ScreenShare),h=(g=Ene(c))==null?void 0:g[0],p=l.filter(k=>!Yre(k,h));return v.useEffect(()=>{var k,y,w,T,x,I;if(d.some(R=>R.publication.isSubscribed)&&a.current===null?(rh.debug("Auto set screen share focus:",{newScreenShareTrack:d[0]}),(y=(k=c.pin).dispatch)==null||y.call(k,{msg:"set_pin",trackReference:d[0]}),a.current=d[0]):a.current&&!d.some(R=>{var C,_;return R.publication.trackSid===((_=(C=a.current)==null?void 0:C.publication)==null?void 0:_.trackSid)})&&(rh.debug("Auto clearing screen share focus."),(T=(w=c.pin).dispatch)==null||T.call(w,{msg:"clear_pin"}),a.current=null),h&&!Qa(h)){const R=l.find(C=>C.participant.identity===h.participant.identity&&C.source===h.source);R!==h&&Qa(R)&&((I=(x=c.pin).dispatch)==null||I.call(x,{msg:"set_pin",trackReference:R}))}},[d.map(k=>`${k.publication.trackSid}_${k.publication.isSubscribed}`).join(),(m=h==null?void 0:h.publication)==null?void 0:m.trackSid,l]),E.jsxs("div",{className:"lk-video-conference",...i,children:[Xre()&&E.jsxs(Fre,{value:c,onWidgetChange:u,children:[E.jsxs("div",{className:"lk-video-conference-inner",children:[h?E.jsx("div",{className:"lk-focus-layout-wrapper",children:E.jsxs(Ire,{children:[E.jsx(Ure,{tracks:p,children:E.jsx(t0,{})}),h&&E.jsx(Pre,{trackRef:h})]})}):E.jsx("div",{className:"lk-grid-layout-wrapper",children:E.jsx(Nre,{tracks:l,children:E.jsx(t0,{})})}),E.jsx(sie,{controls:{chat:!0,settings:!!r}})]}),E.jsx(aie,{style:{display:s.showChat?"grid":"none"},messageFormatter:t,messageEncoder:n,messageDecoder:e}),r&&E.jsx("div",{className:"lk-settings-menu-modal",style:{display:s.showSettings?"block":"none"},children:E.jsx(r,{})})]}),E.jsx(jre,{}),E.jsx(Bre,{})]})}function uie(){const t=v.useCallback(async(r,i)=>{var s=await Yu.getToken(r,i);return s.data},[]),e=v.useCallback(async r=>{await Yu.startRecording(r)},[]),n=v.useCallback(async r=>{await Yu.startRecording(r)},[]);return{getToken:t,startRecording:e,stopRecording:n}}function cie(){const t=qi(),e="quickstart-room",{getToken:n}=uie(),[r,i]=v.useState(""),[s,o]=v.useState(""),[a,l]=v.useState(!1);async function u(c){var d=await n(e,c.username);i(d.token),o(d.serverUrl),l(!0)}return E.jsx("div",{className:`
                fixed
                top-0 left-0 right-0 bottom-0
                place-content-center
                bg-black
            `,"data-lk-theme":"default",children:a?E.jsx(cne,{video:!0,audio:!0,token:r,serverUrl:s,"data-lk-theme":"default",style:{height:"100dvh"},onDisconnected:()=>t(-1),children:E.jsx(lie,{})}):E.jsx(Hre,{camLabel:"相機",micLabel:"麥克風",joinLabel:"加入",userLabel:"使用者名稱",onSubmit:u})})}const me=t=>typeof t=="string",mu=()=>{let t,e;const n=new Promise((r,i)=>{t=r,e=i});return n.resolve=t,n.reject=e,n},lx=t=>t==null?"":""+t,die=(t,e,n)=>{t.forEach(r=>{e[r]&&(n[r]=e[r])})},fie=/###/g,ux=t=>t&&t.indexOf("###")>-1?t.replace(fie,"."):t,cx=t=>!t||me(t),Xu=(t,e,n)=>{const r=me(e)?e.split("."):e;let i=0;for(;i<r.length-1;){if(cx(t))return{};const s=ux(r[i]);!t[s]&&n&&(t[s]=new n),Object.prototype.hasOwnProperty.call(t,s)?t=t[s]:t={},++i}return cx(t)?{}:{obj:t,k:ux(r[i])}},dx=(t,e,n)=>{const{obj:r,k:i}=Xu(t,e,Object);if(r!==void 0||e.length===1){r[i]=n;return}let s=e[e.length-1],o=e.slice(0,e.length-1),a=Xu(t,o,Object);for(;a.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),a=Xu(t,o,Object),a!=null&&a.obj&&typeof a.obj[`${a.k}.${s}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${s}`]=n},hie=(t,e,n,r)=>{const{obj:i,k:s}=Xu(t,e,Object);i[s]=i[s]||[],i[s].push(n)},hp=(t,e)=>{const{obj:n,k:r}=Xu(t,e);if(n&&Object.prototype.hasOwnProperty.call(n,r))return n[r]},pie=(t,e,n)=>{const r=hp(t,n);return r!==void 0?r:hp(e,n)},J2=(t,e,n)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?me(t[r])||t[r]instanceof String||me(e[r])||e[r]instanceof String?n&&(t[r]=e[r]):J2(t[r],e[r],n):t[r]=e[r]);return t},aa=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var mie={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const gie=t=>me(t)?t.replace(/[&<>"'\/]/g,e=>mie[e]):t;class yie{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const vie=[" ",",","?","!",";"],bie=new yie(20),kie=(t,e,n)=>{e=e||"",n=n||"";const r=vie.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(r.length===0)return!0;const i=bie.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!i.test(t);if(!s){const o=t.indexOf(n);o>0&&!i.test(t.substring(0,o))&&(s=!0)}return s},n0=function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const r=e.split(n);let i=t;for(let s=0;s<r.length;){if(!i||typeof i!="object")return;let o,a="";for(let l=s;l<r.length;++l)if(l!==s&&(a+=n),a+=r[l],o=i[a],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<r.length-1)continue;s+=l-s+1;break}i=o}return i},pp=t=>t==null?void 0:t.replace("_","-"),wie={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var n,r;(r=(n=console==null?void 0:console[t])==null?void 0:n.apply)==null||r.call(n,console,e)}};class mp{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||wie,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,i){return i&&!this.debug?null:(me(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new mp(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new mp(this.logger,e)}}var Xr=new mp;class Dm{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const i=this.observers[r].get(n)||0;this.observers[r].set(n,i+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(o=>{let[a,l]=o;for(let u=0;u<l;u++)a(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[a,l]=o;for(let u=0;u<l;u++)a.apply(a,[e,...r])})}}class fx extends Dm{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r){var u,c;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,n],r&&(Array.isArray(r)?a.push(...r):me(r)&&s?a.push(...r.split(s)):a.push(r)));const l=hp(this.data,a);return!l&&!n&&!r&&e.indexOf(".")>-1&&(e=a[0],n=a[1],r=a.slice(2).join(".")),l||!o||!me(r)?l:n0((c=(u=this.data)==null?void 0:u[e])==null?void 0:c[n],r,s)}addResource(e,n,r,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let a=[e,n];r&&(a=a.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(a=e.split("."),i=n,n=a[1]),this.addNamespaces(n),dx(this.data,a,i),s.silent||this.emit("added",e,n,r,i)}addResources(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const s in r)(me(r[s])||Array.isArray(r[s]))&&this.addResource(e,n,s,r[s],{silent:!0});i.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},a=[e,n];e.indexOf(".")>-1&&(a=e.split("."),i=r,r=n,n=a[1]),this.addNamespaces(n);let l=hp(this.data,a)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),i?J2(l,r,s):l={...l,...r},dx(this.data,a,l),o.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(i=>n[i]&&Object.keys(n[i]).length>0)}toJSON(){return this.data}}var Y2={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,i){return t.forEach(s=>{var o;e=((o=this.processors[s])==null?void 0:o.process(e,n,r,i))??e}),e}};const hx={};class gp extends Dm{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),die(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Xr.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,n);return(r==null?void 0:r.res)!==void 0}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let s=n.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!kie(e,r,i);if(o&&!a){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:me(s)?[s]:s};const u=e.split(r);(r!==i||r===i&&this.options.ns.indexOf(u[0])>-1)&&(s=u.shift()),e=u.join(i)}return{key:e,namespaces:me(s)?[s]:s}}translate(e,n,r){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const i=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,s=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:o,namespaces:a}=this.extractFromKey(e[e.length-1],n),l=a[a.length-1],u=n.lng||this.language,c=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((u==null?void 0:u.toLowerCase())==="cimode"){if(c){const x=n.nsSeparator||this.options.nsSeparator;return i?{res:`${l}${x}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:`${l}${x}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:o}const d=this.resolve(e,n);let h=d==null?void 0:d.res;const p=(d==null?void 0:d.usedKey)||o,g=(d==null?void 0:d.exactUsedKey)||o,m=Object.prototype.toString.apply(h),k=["[object Number]","[object Function]","[object RegExp]"],y=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,T=!me(h)&&typeof h!="boolean"&&typeof h!="number";if(w&&h&&T&&k.indexOf(m)<0&&!(me(y)&&Array.isArray(h))){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const x=this.options.returnedObjectHandler?this.options.returnedObjectHandler(p,h,{...n,ns:a}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(d.res=x,d.usedParams=this.getUsedParamsDetails(n),d):x}if(s){const x=Array.isArray(h),I=x?[]:{},R=x?g:p;for(const C in h)if(Object.prototype.hasOwnProperty.call(h,C)){const _=`${R}${s}${C}`;I[C]=this.translate(_,{...n,joinArrays:!1,ns:a}),I[C]===_&&(I[C]=h[C])}h=I}}else if(w&&me(y)&&Array.isArray(h))h=h.join(y),h&&(h=this.extendTranslation(h,e,n,r));else{let x=!1,I=!1;const R=n.count!==void 0&&!me(n.count),C=gp.hasDefaultValue(n),_=R?this.pluralResolver.getSuffix(u,n.count,n):"",P=n.ordinal&&R?this.pluralResolver.getSuffix(u,n.count,{ordinal:!1}):"",N=R&&!n.ordinal&&n.count===0,A=N&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${_}`]||n[`defaultValue${P}`]||n.defaultValue;!this.isValidLookup(h)&&C&&(x=!0,h=A),this.isValidLookup(h)||(I=!0,h=o);const L=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&I?void 0:h,ae=C&&A!==h&&this.options.updateMissing;if(I||x||ae){if(this.logger.log(ae?"updateKey":"missingKey",u,l,o,ae?A:h),s){const Q=this.resolve(o,{...n,keySeparator:!1});Q&&Q.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let re=[];const Te=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Te&&Te[0])for(let Q=0;Q<Te.length;Q++)re.push(Te[Q]);else this.options.saveMissingTo==="all"?re=this.languageUtils.toResolveHierarchy(n.lng||this.language):re.push(n.lng||this.language);const ue=(Q,se,M)=>{var ye;const Se=C&&M!==h?M:L;this.options.missingKeyHandler?this.options.missingKeyHandler(Q,l,se,Se,ae,n):(ye=this.backendConnector)!=null&&ye.saveMissing&&this.backendConnector.saveMissing(Q,l,se,Se,ae,n),this.emit("missingKey",Q,l,se,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&R?re.forEach(Q=>{const se=this.pluralResolver.getSuffixes(Q,n);N&&n[`defaultValue${this.options.pluralSeparator}zero`]&&se.indexOf(`${this.options.pluralSeparator}zero`)<0&&se.push(`${this.options.pluralSeparator}zero`),se.forEach(M=>{ue([Q],o+M,n[`defaultValue${M}`]||A)})}):ue(re,o,A))}h=this.extendTranslation(h,e,n,d,r),I&&h===o&&this.options.appendNamespaceToMissingKey&&(h=`${l}:${o}`),(I||x)&&this.options.parseMissingKeyHandler&&(h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${o}`:o,x?h:void 0))}return i?(d.res=h,d.usedParams=this.getUsedParamsDetails(n),d):h}extendTranslation(e,n,r,i,s){var u,c;var o=this;if((u=this.i18nFormat)!=null&&u.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const d=me(e)&&(((c=r==null?void 0:r.interpolation)==null?void 0:c.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let h;if(d){const g=e.match(this.interpolator.nestingRegexp);h=g&&g.length}let p=r.replace&&!me(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,r.lng||this.language||i.usedLng,r),d){const g=e.match(this.interpolator.nestingRegexp),m=g&&g.length;h<m&&(r.nest=!1)}!r.lng&&i&&i.res&&(r.lng=this.language||i.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var g=arguments.length,m=new Array(g),k=0;k<g;k++)m[k]=arguments[k];return(s==null?void 0:s[0])===m[0]&&!r.context?(o.logger.warn(`It seems you are nesting recursively key: ${m[0]} in key: ${n[0]}`),null):o.translate(...m,n)},r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,l=me(a)?[a]:a;return e!=null&&(l!=null&&l.length)&&r.applyPostProcessor!==!1&&(e=Y2.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,i,s,o,a;return me(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const u=this.extractFromKey(l,n),c=u.key;i=c;let d=u.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const h=n.count!==void 0&&!me(n.count),p=h&&!n.ordinal&&n.count===0,g=n.context!==void 0&&(me(n.context)||typeof n.context=="number")&&n.context!=="",m=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);d.forEach(k=>{var y,w;this.isValidLookup(r)||(a=k,!hx[`${m[0]}-${k}`]&&((y=this.utils)!=null&&y.hasLoadedNamespace)&&!((w=this.utils)!=null&&w.hasLoadedNamespace(a))&&(hx[`${m[0]}-${k}`]=!0,this.logger.warn(`key "${i}" for languages "${m.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),m.forEach(T=>{var R;if(this.isValidLookup(r))return;o=T;const x=[c];if((R=this.i18nFormat)!=null&&R.addLookupKeys)this.i18nFormat.addLookupKeys(x,c,T,k,n);else{let C;h&&(C=this.pluralResolver.getSuffix(T,n.count,n));const _=`${this.options.pluralSeparator}zero`,P=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(x.push(c+C),n.ordinal&&C.indexOf(P)===0&&x.push(c+C.replace(P,this.options.pluralSeparator)),p&&x.push(c+_)),g){const N=`${c}${this.options.contextSeparator}${n.context}`;x.push(N),h&&(x.push(N+C),n.ordinal&&C.indexOf(P)===0&&x.push(N+C.replace(P,this.options.pluralSeparator)),p&&x.push(N+_))}}let I;for(;I=x.pop();)this.isValidLookup(r)||(s=I,r=this.getResource(T,k,I,n))}))})}),{res:r,usedKey:i,exactUsedKey:s,usedLng:o,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r){var s;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(s=this.i18nFormat)!=null&&s.getResource?this.i18nFormat.getResource(e,n,r,i):this.resourceStore.getResource(e,n,r,i)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!me(e.replace);let i=r?e.replace:e;if(r&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!r){i={...i};for(const s of n)delete i[s]}return i}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}class px{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Xr.create("languageUtils")}getScriptPartFromCode(e){if(e=pp(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=pp(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(me(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const i=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(i))&&(n=i)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return n=i;n=this.options.supportedLngs.find(s=>{if(s===i)return s;if(!(s.indexOf("-")<0&&i.indexOf("-")<0)&&(s.indexOf("-")>0&&i.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===i||s.indexOf(i)===0&&i.length>1))return s})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),me(e)&&(e=[e]),Array.isArray(e))return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes(n||this.options.fallbackLng||[],e),i=[],s=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return me(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):me(e)&&s(this.formatLanguageCode(e)),r.forEach(o=>{i.indexOf(o)<0&&s(this.formatLanguageCode(o))}),i}}const mx={zero:0,one:1,two:2,few:3,many:4,other:5},gx={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Tie{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=Xr.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,n){this.rules[e]=n}clearCache(){this.pluralRulesCache={}}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=pp(e==="dev"?"en":e),i=n.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:r,type:i});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(r,{type:i})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),gx;if(!e.match(/-|_/))return gx;const l=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(l,n)}return this.pluralRulesCache[s]=o,o}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),(r==null?void 0:r.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(i=>`${n}${i}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.getRule(e,n);return r||(r=this.getRule("dev",n)),r?r.resolvedOptions().pluralCategories.sort((i,s)=>mx[i]-mx[s]).map(i=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.getRule(e,r);return i?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i.select(n)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",n,r))}}const yx=function(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=pie(t,e,n);return!s&&i&&me(n)&&(s=n0(t,n,r),s===void 0&&(s=n0(e,n,r))),s},Ty=t=>t.replace(/\$/g,"$$$$");class Sie{constructor(){var n;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Xr.create("interpolator"),this.options=e,this.format=((n=e==null?void 0:e.interpolation)==null?void 0:n.format)||(r=>r),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:n,escapeValue:r,useRawValueToEscape:i,prefix:s,prefixEscaped:o,suffix:a,suffixEscaped:l,formatSeparator:u,unescapeSuffix:c,unescapePrefix:d,nestingPrefix:h,nestingPrefixEscaped:p,nestingSuffix:g,nestingSuffixEscaped:m,nestingOptionsSeparator:k,maxReplaces:y,alwaysFormat:w}=e.interpolation;this.escape=n!==void 0?n:gie,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=s?aa(s):o||"{{",this.suffix=a?aa(a):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=c?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=h?aa(h):p||aa("$t("),this.nestingSuffix=g?aa(g):m||aa(")"),this.nestingOptionsSeparator=k||",",this.maxReplaces=y||1e3,this.alwaysFormat=w!==void 0?w:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>(n==null?void 0:n.source)===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,r,i){var p;let s,o,a;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=g=>{if(g.indexOf(this.formatSeparator)<0){const w=yx(n,l,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(w,void 0,r,{...i,...n,interpolationkey:g}):w}const m=g.split(this.formatSeparator),k=m.shift().trim(),y=m.join(this.formatSeparator).trim();return this.format(yx(n,l,k,this.options.keySeparator,this.options.ignoreJSONStructure),y,r,{...i,...n,interpolationkey:k})};this.resetRegExp();const c=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((p=i==null?void 0:i.interpolation)==null?void 0:p.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>Ty(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?Ty(this.escape(g)):Ty(g)}].forEach(g=>{for(a=0;s=g.regex.exec(e);){const m=s[1].trim();if(o=u(m),o===void 0)if(typeof c=="function"){const y=c(e,s,i);o=me(y)?y:""}else if(i&&Object.prototype.hasOwnProperty.call(i,m))o="";else if(d){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${e}`),o="";else!me(o)&&!this.useRawValueToEscape&&(o=lx(o));const k=g.safeValue(o);if(e=e.replace(s[0],k),d?(g.regex.lastIndex+=o.length,g.regex.lastIndex-=s[0].length):g.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,s,o;const a=(l,u)=>{const c=this.nestingOptionsSeparator;if(l.indexOf(c)<0)return l;const d=l.split(new RegExp(`${c}[ ]*{`));let h=`{${d[1]}`;l=d[0],h=this.interpolate(h,o);const p=h.match(/'/g),g=h.match(/"/g);(((p==null?void 0:p.length)??0)%2===0&&!g||g.length%2!==0)&&(h=h.replace(/'/g,'"'));try{o=JSON.parse(h),u&&(o={...u,...o})}catch(m){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,m),`${l}${c}${h}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;i=this.nestingRegexp.exec(e);){let l=[];o={...r},o=o.replace&&!me(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let u=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){const c=i[1].split(this.formatSeparator).map(d=>d.trim());i[1]=c.shift(),l=c,u=!0}if(s=n(a.call(this,i[1].trim(),o),o),s&&i[0]===e&&!me(s))return s;me(s)||(s=lx(s)),s||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),s=""),u&&(s=l.reduce((c,d)=>this.format(c,d,r.lng,{...r,interpolationkey:i[1].trim()}),s.trim())),e=e.replace(i[0],s),this.regexp.lastIndex=0}return e}}const _ie=t=>{let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const i=r[1].substring(0,r[1].length-1);e==="currency"&&i.indexOf(":")<0?n.currency||(n.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?n.range||(n.range=i.trim()):i.split(";").forEach(o=>{if(o){const[a,...l]=o.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),c=a.trim();n[c]||(n[c]=u),u==="false"&&(n[c]=!1),u==="true"&&(n[c]=!0),isNaN(u)||(n[c]=parseInt(u,10))}})}return{formatName:e,formatOptions:n}},la=t=>{const e={};return(n,r,i)=>{let s=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(s={...s,[i.interpolationkey]:void 0});const o=r+JSON.stringify(s);let a=e[o];return a||(a=t(pp(r),i),e[o]=a),a(n)}};class Eie{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Xr.create("formatter"),this.options=e,this.formats={number:la((n,r)=>{const i=new Intl.NumberFormat(n,{...r});return s=>i.format(s)}),currency:la((n,r)=>{const i=new Intl.NumberFormat(n,{...r,style:"currency"});return s=>i.format(s)}),datetime:la((n,r)=>{const i=new Intl.DateTimeFormat(n,{...r});return s=>i.format(s)}),relativetime:la((n,r)=>{const i=new Intl.RelativeTimeFormat(n,{...r});return s=>i.format(s,r.range||"day")}),list:la((n,r)=>{const i=new Intl.ListFormat(n,{...r});return s=>i.format(s)})},this.init(e)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=n.interpolation.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=la(n)}format(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=n.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(a=>a.indexOf(")")>-1)){const a=s.findIndex(l=>l.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,a)].join(this.formatSeparator)}return s.reduce((a,l)=>{var d;const{formatName:u,formatOptions:c}=_ie(l);if(this.formats[u]){let h=a;try{const p=((d=i==null?void 0:i.formatParams)==null?void 0:d[i.interpolationkey])||{},g=p.locale||p.lng||i.locale||i.lng||r;h=this.formats[u](a,g,{...c,...i,...p})}catch(p){this.logger.warn(p)}return h}else this.logger.warn(`there was no format function for ${u}`);return a},e)}}const Cie=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class xie extends Dm{constructor(e,n,r){var s,o;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=i,this.logger=Xr.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(o=(s=this.backend)==null?void 0:s.init)==null||o.call(s,r,i.backend,i)}queueLoad(e,n,r,i){const s={},o={},a={},l={};return e.forEach(u=>{let c=!0;n.forEach(d=>{const h=`${u}|${d}`;!r.reload&&this.store.hasResourceBundle(u,d)?this.state[h]=2:this.state[h]<0||(this.state[h]===1?o[h]===void 0&&(o[h]=!0):(this.state[h]=1,c=!1,o[h]===void 0&&(o[h]=!0),s[h]===void 0&&(s[h]=!0),l[d]===void 0&&(l[d]=!0)))}),c||(a[u]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}loaded(e,n,r){const i=e.split("|"),s=i[0],o=i[1];n&&this.emit("failedLoading",s,o,n),!n&&r&&this.store.addResourceBundle(s,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2,n&&r&&(this.state[e]=0);const a={};this.queue.forEach(l=>{hie(l.loaded,[s],o),Cie(l,e),n&&l.errors.push(n),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{a[u]||(a[u]={});const c=l.loaded[u];c.length&&c.forEach(d=>{a[u][d]===void 0&&(a[u][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(l=>!l.done)}read(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:i,wait:s,callback:o});return}this.readingCalls++;const a=(u,c)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(u&&c&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,i+1,s*2,o)},s);return}o(u,c)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const u=l(e,n);u&&typeof u.then=="function"?u.then(c=>a(null,c)).catch(a):a(null,u)}catch(u){a(u)}return}return l(e,n,a)}prepareLoading(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();me(e)&&(e=this.languageUtils.toResolveHierarchy(e)),me(n)&&(n=[n]);const s=this.queueLoad(e,n,r,i);if(!s.toLoad.length)return s.pending.length||i(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),i=r[0],s=r[1];this.read(i,s,"read",void 0,void 0,(o,a)=>{o&&this.logger.warn(`${n}loading namespace ${s} for language ${i} failed`,o),!o&&a&&this.logger.log(`${n}loaded namespace ${s} for language ${i}`,a),this.loaded(e,o,a)})}saveMissing(e,n,r,i,s){var l,u,c,d,h;let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((u=(l=this.services)==null?void 0:l.utils)!=null&&u.hasLoadedNamespace&&!((d=(c=this.services)==null?void 0:c.utils)!=null&&d.hasLoadedNamespace(n))){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if((h=this.backend)!=null&&h.create){const p={...o,isUpdate:s},g=this.backend.create.bind(this.backend);if(g.length<6)try{let m;g.length===5?m=g(e,n,r,i,p):m=g(e,n,r,i),m&&typeof m.then=="function"?m.then(k=>a(null,k)).catch(a):a(null,m)}catch(m){a(m)}else g(e,n,r,i,a,p)}!e||!e[0]||this.store.addResource(e[0],n,r,i)}}}const vx=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),me(t[1])&&(e.defaultValue=t[1]),me(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),bx=t=>{var e,n;return me(t.ns)&&(t.ns=[t.ns]),me(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),me(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),((n=(e=t.supportedLngs)==null?void 0:e.indexOf)==null?void 0:n.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t},hf=()=>{},Iie=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(n=>{typeof t[n]=="function"&&(t[n]=t[n].bind(t))})};class jc extends Dm{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=bx(e),this.services={},this.logger=Xr,this.modules={external:[]},Iie(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof n=="function"&&(r=n,n={}),n.defaultNS==null&&n.ns&&(me(n.ns)?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const i=vx();this.options={...i,...this.options,...bx(n)},this.options.interpolation={...i.interpolation,...this.options.interpolation},n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);const s=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?Xr.init(s(this.modules.logger),this.options):Xr.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=Eie;const d=new px(this.options);this.store=new fx(this.options.resources,this.options);const h=this.services;h.logger=Xr,h.resourceStore=this.store,h.languageUtils=d,h.pluralResolver=new Tie(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),c&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(h.formatter=s(c),h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new Sie(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new xie(s(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",function(p){for(var g=arguments.length,m=new Array(g>1?g-1:0),k=1;k<g;k++)m[k-1]=arguments[k];e.emit(p,...m)}),this.modules.languageDetector&&(h.languageDetector=s(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=s(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new gp(this.services,this.options),this.translator.on("*",function(p){for(var g=arguments.length,m=new Array(g>1?g-1:0),k=1;k<g;k++)m[k-1]=arguments[k];e.emit(p,...m)}),this.modules.external.forEach(p=>{p.init&&p.init(this)})}if(this.format=this.options.interpolation.format,r||(r=hf),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=function(){return e.store[c](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=function(){return e.store[c](...arguments),e}});const l=mu(),u=()=>{const c=(d,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(h),r(d,h)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?u():setTimeout(u,0),l}loadResources(e){var s,o;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hf;const i=me(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const a=[],l=u=>{if(!u||u==="cimode")return;this.services.languageUtils.toResolveHierarchy(u).forEach(d=>{d!=="cimode"&&a.indexOf(d)<0&&a.push(d)})};i?l(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>l(c)),(o=(s=this.options.preload)==null?void 0:s.forEach)==null||o.call(s,u=>l(u)),this.services.backendConnector.load(a,this.options.ns,u=>{!u&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(u)})}else r(null)}reloadResources(e,n,r){const i=mu();return typeof e=="function"&&(r=e,e=void 0),typeof n=="function"&&(r=n,n=void 0),e||(e=this.languages),n||(n=this.options.ns),r||(r=hf),this.services.backendConnector.reload(e,n,s=>{i.resolve(),r(s)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Y2.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,n){var r=this;this.isLanguageChangingTo=e;const i=mu();this.emit("languageChanging",e);const s=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,u)=>{u?(s(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,i.resolve(function(){return r.t(...arguments)}),n&&n(l,function(){return r.t(...arguments)})},a=l=>{var c,d;!e&&!l&&this.services.languageDetector&&(l=[]);const u=me(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||s(u),this.translator.language||this.translator.changeLanguage(u),(d=(c=this.services.languageDetector)==null?void 0:c.cacheUserLanguage)==null||d.call(c,u)),this.loadResources(u,h=>{o(h,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),i}getFixedT(e,n,r){var i=this;const s=function(o,a){let l;if(typeof a!="object"){for(var u=arguments.length,c=new Array(u>2?u-2:0),d=2;d<u;d++)c[d-2]=arguments[d];l=i.options.overloadTranslationOptionHandler([o,a].concat(c))}else l={...a};l.lng=l.lng||s.lng,l.lngs=l.lngs||s.lngs,l.ns=l.ns||s.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||r||s.keyPrefix);const h=i.options.keySeparator||".";let p;return l.keyPrefix&&Array.isArray(o)?p=o.map(g=>`${l.keyPrefix}${h}${g}`):p=l.keyPrefix?`${l.keyPrefix}${h}${o}`:o,i.t(p,l)};return me(e)?s.lng=e:s.lngs=e,s.ns=n,s.keyPrefix=r,s}t(){var i;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(i=this.translator)==null?void 0:i.translate(...n)}exists(){var i;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(i=this.translator)==null?void 0:i.exists(...n)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(a,l)=>{const u=this.services.backendConnector.state[`${a}|${l}`];return u===-1||u===0||u===2};if(n.precheck){const a=n.precheck(this,o);if(a!==void 0)return a}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!i||o(s,e)))}loadNamespaces(e,n){const r=mu();return this.options.ns?(me(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{r.resolve(),n&&n(i)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=mu();me(e)&&(e=[e]);const i=this.options.preload||[],s=e.filter(o=>i.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=i.concat(s),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}dir(e){var i,s;if(e||(e=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=((s=this.services)==null?void 0:s.languageUtils)||new px(vx());return n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new jc(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hf;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},s=new jc(i);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(a=>{s[a]=this[a]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},r){const a=Object.keys(this.store.data).reduce((l,u)=>(l[u]={...this.store.data[u]},Object.keys(l[u]).reduce((c,d)=>(c[d]={...l[u][d]},c),{})),{});s.store=new fx(a,i),s.services.resourceStore=s.store}return s.translator=new gp(s.services,i),s.translator.on("*",function(a){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];s.emit(a,...u)}),s.init(i,n),s.translator.options=i,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const an=jc.createInstance();an.createInstance=jc.createInstance;an.createInstance;an.dir;an.init;an.loadResources;an.reloadResources;an.use;an.changeLanguage;an.getFixedT;an.t;an.exists;an.setDefaultNamespace;an.hasLoadedNamespace;an.loadNamespaces;an.loadLanguages;an.use(N8).init({resources:{en:{translation:{appName:"Sumeet",welcome_back:"Welcome back",please_sign_in:"Please sign in to continue",gotoDashboard:"Go to Dashboard",title:"Never Take Meeting Notes Again",description:"Transform the way you meet with AI-driven transcription, summaries, and insights. Focus on the conversation, and we'll handle the documentation.",freeStart:"Start for Free",whyChoose:"Why Choose Sumeet",howItWorks:"How It Works",uploadRecording:"Upload recording",aiProcessing:"AI Processing",shareCollaborate:"Share & Collaborate",feature1:"Smart Transcription",feature1Desc:"Automatic transcription with speaker detection and timestamps",feature2:"Team Collaboration",feature2Desc:"Share insights and collaborate with your team in real-time",feature3:"Secure & Private",feature3Desc:"Enterprise-grade security with end-to-end encryption",feature4:"Multi-language Support",feature4Desc:"Support for multiple languages and automatic translation",uploadDescription:"Upload your meeting recording in any format",aiProcessingDescription:"Our AI automatically transcribes and summarizes your meeting",shareCollaborateDescription:"Share insights with your team and collaborate effectively",SumeetDescription:"Transform your virtual meetings with AI-powered features and seamless collaboration.",quickLinks:"Quick Links",login:"Login",signUp:"Sign Up",legal:"Legal",privacyPolicy:"Privacy Policy",termsOfService:"Terms of Service",startDashboard:"Start Dashboard",HELLO:"Hello",googleLogin:"Login with Google",footer:{title:"Sumeet",description:"Transform your virtual meetings with AI-powered features and seamless collaboration.",quickLinks:"Quick Links",login:"Login",signUp:"Sign Up",legal:"Legal",privacyPolicy:"Privacy Policy",termsOfService:"Terms of Service",copyright:"All rights reserved."},profile:"Settings",welcome_user:"Welcome, {{name}}!",guest:"Guest",meetingNotes:"Meeting Notes",meeting_notes:"Meeting Notes",upload_meeting:"Upload Meeting",new_meeting:"New Meeting",home:"Home",upload:"Upload",uploadingAndGenerating:"uploading and generating summary",newestFirst:"Newest first",oldestFirst:"Oldest first",selectMeetings:"Select meetings",filterByTags:"Filter by tags",deleteMeetings:"Delete Meeting",clearAll:"Clear all",logout:"Logout",english_short:"English",chinese_short:"Chinese",dashboard:"Dashboard",profile_headerTitle:"Profile",profile_statsTitle:"Stats",profile_activityFeedTitle:"Recent Activities",profile_settingsTitle:"Settings",profile_editModalTitle:"Edit Profile",profile_activities:{upload:'Uploaded "{{title}}"',process:'Completed processing "{{title}}"',edit:"Updated profile information"},profile_settings:{lineNotifications:"Line Notifications",emailNotifications:"Email Notifications",lineNotificationsDesc:"Receive Line notification updates about your meetings",emailNotificationsDesc:"Receive email updates about your meetings",systemAlerts:"System Alerts",systemAlertsDesc:"Get notified when processing is complete",darkMode:"Dark Mode",darkModeDesc:"Switch between light and dark themes"},upload_meeting_Btn:{uploadMeetingRecording:"Upload Meeting Recording",dragAndDrop:"Drag and drop your recording file here, or",browse:"browse",uploadRecording:"Upload Recording",successNotification:"Meeting summary completed!",errorNotification:"Upload failed!"},meetingPage:{joinRoom:"Join a Video Room",participant:"Participant",room:"Room",joinButton:"Join!",roomTitle:"Room",leaveRoom:"Leave Room"},chatbot:{name:"Forgetful Buddy",header:"I am here and ready to answer in minutes",footer:"I will solve your problem!",send:"Send",placeholder:"Write a message"},Transcript:"Transcript",Summary:"Summary",confirmDelete:"Confirm Delete",confirmRegenerate:"Confirm Regenerate",regenerateMeetings:"Regenerate Meetings",confirm:"Confirm",cancel:"Cancel",lineNotification:{title:"Line Notificaiton",active:"Active",activeDesc:"Receive Line notification updates about your meetings",lineId:"Line ID",bind:"Bind",unbind:"Unbind"},language:"Language"}},zh:{translation:{appName:"AI智匯雲",welcome_back:"歡迎回來",please_sign_in:"請登錄以繼續",gotoDashboard:"前往控制面板",title:"永不再記會議筆記",description:"使用AI驅動的文字記錄、摘要和見解，轉變你的會議方式。專注於對話，我們來處理文檔。",freeStart:"免費開始",whyChoose:"為什麼選擇 AI智匯雲",howItWorks:"如何運作",uploadRecording:"上傳會議記錄",aiProcessing:"AI處理",shareCollaborate:"分享與協作",feature1:"智慧文字記錄",feature1Desc:"自動文字轉錄，帶有講者識別和時間戳",feature2:"團隊協作",feature2Desc:"即時分享見解並與團隊協作",feature3:"安全與隱私",feature3Desc:"企業級安全性，端對端加密",feature4:"多語言支援",feature4Desc:"支援多語言及自動翻譯",uploadDescription:"上傳你的會議錄音，支持任何格式",aiProcessingDescription:"我們的AI會自動轉錄並總結你的會議",shareCollaborateDescription:"與你的團隊分享見解並有效協作",SumeetDescription:"使用AI功能和無縫協作，徹底改變你的虛擬會議。",quickLinks:"快速連結",login:"登入",signUp:"註冊",legal:"法律",privacyPolicy:"隱私政策",termsOfService:"服務條款",startDashboard:"開始使用控制面板",HELLO:"您好",googleLogin:"使用Google登錄",footer:{title:"AI智匯雲",description:"利用 AI 功能和無縫協作，改變您的虛擬會議體驗。",quickLinks:"快速連結",login:"登入",signUp:"註冊",legal:"法律條款",privacyPolicy:"隱私政策",termsOfService:"服務條款",copyright:"版權所有。"},profile:"設定",welcome_user:"歡迎, {{name}}!",guest:"訪客",meetingNotes:"會議筆記",meeting_notes:"會議筆記",upload_meeting:"上傳會議",new_meeting:"新增會議",home:"首頁",upload:"上傳",uploadingAndGenerating:"正在上傳並生成摘要",newestFirst:"最新優先",oldestFirst:"最舊優先",selectMeetings:"選擇會議",filterByTags:"篩選標籤",deleteMeetings:"刪除會議",clearAll:"清除所有篩選條件",logout:"登出",english_short:"英文",chinese_short:"中文",dashboard:"控制面板",profile_headerTitle:"個人資料",profile_statsTitle:"統計資料",profile_activityFeedTitle:"最近活動",profile_settingsTitle:"設定",profile_editModalTitle:"編輯個人資料",profile_activities:{upload:"上傳了「{{title}}」",process:"完成處理「{{title}}」",edit:"更新了個人資料"},profile_settings:{lineNotifications:"Line通知",lineNotificationsDesc:"接收有關您會議的Line通知",emailNotifications:"電子郵件通知",emailNotificationsDesc:"接收有關您會議的電子郵件更新",systemAlerts:"系統提醒",systemAlertsDesc:"在處理完成時獲取通知",darkMode:"深色模式",darkModeDesc:"在淺色和深色主題之間切換"},upload_meeting_Btn:{uploadMeetingRecording:"上傳會議錄音",dragAndDrop:"將會議文件拖曳到這裡，或",browse:"瀏覽",uploadRecording:"上傳會議記錄",successNotification:"會議總結已完成!",errorNotification:"上傳失敗!"},meetingPage:{joinRoom:"加入視訊會議",participant:"參與名",room:"房間",joinButton:"加入！",roomTitle:"房間",leaveRoom:"離開房間"},chatbot:{name:"智匯幫手",header:"我在這裡，隨時準備為您解答",footer:"讓我解決你的問題",send:"傳送",placeholder:"請輸入問題"},Transcript:"錄音逐字稿",Summary:"總結",confirmDelete:"確認刪除",confirmRegenerate:"確認重新生成摘要",regenerateMeetings:"重新生成摘要",confirm:"確認",cancel:"取消",lineNotification:{title:"Line通知",active:"開啟通知",activeDesc:"接收有關您會議的Line通知",lineId:"Line ID",bind:"綁定",unbind:"解除綁定"},language:"語言"}}},lng:"zh",fallbackLng:"zh",interpolation:{escapeValue:!1}});function kx({children:t}){return E.jsx(E.Fragment,{children:t})}function Pie(){return E.jsx(yz,{children:E.jsxs(vz,{children:[E.jsx(zU,{children:E.jsxs(VU,{children:[E.jsx(qr,{path:"/",element:E.jsx(kx,{children:E.jsx(SG,{})})}),E.jsx(qr,{path:"/login",element:E.jsx(kx,{children:E.jsx(EQ,{})})}),E.jsxs(qr,{path:"/dashboard",element:E.jsx(J7,{children:E.jsx(Y7,{children:E.jsx(hG,{})})}),children:[E.jsx(qr,{index:!0,element:E.jsx(AG,{})}),E.jsx(qr,{path:"upload",element:E.jsx(hQ,{})}),E.jsx(qr,{path:"meetingSummary/:id",element:E.jsx(yQ,{})}),E.jsx(qr,{path:"profile",element:E.jsx(_Q,{})}),E.jsx(qr,{path:"meeting",element:E.jsx(cie,{})})]}),E.jsx(qr,{path:"*",element:E.jsx(GP,{to:"/",replace:!0})})]})}),E.jsx(fQ,{})]})})}LP(document.getElementById("root")).render(E.jsx(v.StrictMode,{children:E.jsx(Pie,{})}));
